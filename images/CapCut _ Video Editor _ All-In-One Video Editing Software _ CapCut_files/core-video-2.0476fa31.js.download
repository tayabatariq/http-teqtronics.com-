(globalThis.__LOADABLE_LOADED_CHUNKS__=globalThis.__LOADABLE_LOADED_CHUNKS__||[]).push([["9023"],{814250:function(e,t,i){let r=i(289208).stringify,n=i(155508);e.exports=function(e){return{parse:n(e),stringify:r}},e.exports.parse=n(),e.exports.stringify=r},374345:function(e,t,i){"use strict";e.exports=i.p+"static/assets/vesdk-lvapi-opt.worker.3a137913.mjs"},664686:function(e,t,i){"use strict";e.exports=i.p+"static/wasm/04e12651393f2f92.module.wasm"},150002:function(e,t,i){"use strict";i.d(t,{a:function(){return a}});var r=i(593642),n=i(690613);class a{check(e){return(0,n.ly)()}run(e,t,i){return this.do(t=>{e(t)},t,i)}constructor(e){this.actionKey=(0,r.Rl)(),this.options=e}}},201483:function(e,t,i){"use strict";i.d(t,{r:function(){return r.r}});var r=i(381071)},285151:function(e,t,i){"use strict";i.d(t,{B:function(){return c}});var r=i(653322),n=i(150002),a=i(862213),o=i(76592),s=i(331509),l=i(475028),d=i(690613);let u=(0,l.i)(r.H.AttachmentDeleteAiWriterInfoNotExist,"");class c extends n.a{get type(){return a.Us.ATTACHMENT_REMOVE_AI_WRITER_INFOS}check(e){for(let t of this.options.segmentIds)if(!e.getAiWriterInfoMap().has(t))return u(`delete ai writer info not exist: ${t}`);return(0,d.ly)()}do(e,t,i){for(let t of this.options.segmentIds)e(new o.h({attachmentKey:s.d3.AiWriter,key:t}))}}},220780:function(e,t,i){"use strict";i.d(t,{o:function(){return p}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(419537),d=i(331509),u=i(211561);let c=(0,a.i)(s.H.AttachmentUpdateAiWriterInfoNotExist,"");class p extends r.a{get type(){return n.U.ATTACHMENT_UPDATE_AI_WRITER_INFO}check(e){return e.getAiWriterInfoMap().has(this.options.segmentId)?(0,o.ly)():c(`update ai writer info not exist: ${this.options.segmentId}`)}do(e,t,i){e(new l.K({attachmentKey:d.d3.AiWriter,key:this.options.segmentId,delta:new u.nii({aiWriterType:this.options.aiWriterType})}))}}},360828:function(e,t,i){"use strict";i.d(t,{d:function(){return p}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(419537),d=i(331509),u=i(211561);let c=(0,a.i)(s.H.AttachmentUpdateVideoAlgorithmNotExist,"");class p extends r.a{get type(){return n.U.ATTACHMENT_UPDATE_VIDEO_ALGORITHM}check(e){return e.getVideoAlgorithmMap().has(this.options.segmentId)?(0,o.ly)():c(`update video algorithm not exist: ${this.options.segmentId}`)}do(e,t,i){e(new l.K({attachmentKey:d.d3.VideoAlgorithm,key:this.options.segmentId,delta:new u.Llt({path:this.options.path,trackId:this.options.trackId,materialId:this.options.materialId,pipelineId:this.options.pipelineId,algorithms:this.options.algorithms})}))}}},53836:function(e,t,i){"use strict";i.d(t,{Q:function(){return m}});var r=i(150002),n=i(862213),a=i(481631),o=i(475028),s=i(690613),l=i(653322),d=i(129862),u=i(283751);let c=(0,o.i)(l.H.RemoveAudioVocalBeautifySegmentNotExist,""),p=(0,o.i)(l.H.RemoveAudioVocalBeautifySegmentTypeNotValid,"");class m extends r.a{get type(){return n.Us.REMOVE_AUDIO_VOCAL_BEAUTIFY}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,a.Y9)(i)||(0,a.he)(i)?(0,s.ly)():p(`segmentType not valid: ${i.__segment_struct_type}`):c(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,a.he)(r)||(0,a.Y9)(r)){let i=(0,a.xX)({__segment_struct_type:r.__segment_struct_type});i.vocalBeautify=null;let o=(0,a.xX)({__segment_struct_type:r.__segment_struct_type});u.T.pick(r,i,o),e(new d.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:o}))}}}},783959:function(e,t,i){"use strict";i.d(t,{$:function(){return _},T:function(){return v}});var r=i(475028),n=i(690613),a=i(211561),o=i(481631),s=i(129862),l=i(340294),d=i(150002),u=i(853277),c=i(653322),p=i(217201),m=i(81649),h=i(283751);let g=(0,r.i)(c.H.SetAudioSpeedSegmentNotExist,""),f=(0,r.i)(c.H.SetAudioSpeedSegmentTypeNotValid,""),y=(0,r.i)(c.H.SetAudioSpeedSpeedNotValid,"");function _(e,t,i,r){var n,d;let{segmentId:u}=t,c=t.value,g=e.getSegmentByTrackType(u,a.pNd.TrackTypeAudio),f=null!==(n=t.targetStartTime)&&void 0!==n?n:g.targetTimerange.start,y=new a.CCx,_=new a.Zk4;y.speed=_;let v=new m.O1(e.getDraftProperty().fps),I=l.pM.div(g.sourceTimerange.duration,c,"bigint");y.targetTimerange=new a.zel;let T=v.gen(f).tail,x=v.gen(f+I).tail;y.targetTimerange.start=T,y.targetTimerange.duration=x-T,y.speed.speed=c,e.isTTSAutoUpdate(g.material.textId)&&p.c8.syncAudioToText(e,g,i,r),y.speed.mode=a.yY$.SpeedModeNormal,g.speed.curveSpeed&&(y.speed.curveSpeed=null);let k=e.getTrackBySegmentId(g.id,[]),{fade:w}=g,A=g.speed.speed;if(w&&c>A){if(w.fadeInDuration>I){let e=new a.lMN;y.fade=e,e.fadeInDuration=I}if(w.fadeOutDuration>I){let e=new a.lMN;y.fade=e,e.fadeOutDuration=I}}c<A&&p.c8.moveSegmentsIfConflict(e,k,new Map([[g,new a.tnv({start:null!==(d=y.targetTimerange.start)&&void 0!==d?d:g.targetTimerange.start,duration:I})]]),[a.pNd.TrackTypeAudio],i);let b=(0,o.xX)({__segment_struct_type:g.__segment_struct_type});h.T.pick(g,y,b),i(new s.F({trackId:e.getTrackBySegmentId(g.id).id,trackIndex:e.getTrackIndexBySegmentId(g.id),segmentId:g.id,segmentDelta:y,sourceSegmentDelta:b}))}class v extends d.a{get type(){return u.U.SET_AUDIO_SPEED}check(e){let{segmentId:t,value:i}=this.options,r=e.getSegmentById(t);return r?(0,o.Y9)(r)?i>0?(0,n.ly)():y(`speed not valid: ${i}`):f(`segmentType not valid: ${r.__segment_struct_type}`):g(`segment not exist: ${t}`)}do(e,t,i){_(t,this.options,e,i)}}},267026:function(e,t,i){"use strict";i.d(t,{M:function(){return h}});var r=i(150002),n=i(862213),a=i(211561),o=i(481631),s=i(475028),l=i(690613),d=i(653322),u=i(129862),c=i(283751);let p=(0,s.i)(d.H.SetAudioVocalBeautifySegmentNotExist,""),m=(0,s.i)(d.H.SetAudioVocalBeautifySegmentTypeNotValid,"");class h extends r.a{get type(){return n.Us.SET_AUDIO_VOCAL_BEAUTIFY}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?(0,l.ly)():m(`segmentType not valid: ${i.__segment_struct_type}`):p(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,o.he)(r)||(0,o.Y9)(r)){let i=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});i.vocalBeautify=new a.ck6({enable:this.options.enable,timeRange:this.options.timeRange,productionPath:this.options.productionPath,ambientSoundLevel:this.options.ambientSoundLevel});let s=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});c.T.pick(r,i,s),e(new u.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:s}))}}}},892504:function(e,t,i){"use strict";i.d(t,{M:function(){return h}});var r=i(475028),n=i(690613),a=i(211561),o=i(481631),s=i(129862),l=i(150002),d=i(853277),u=i(653322),c=i(283751);let p=(0,r.i)(u.H.SetAudioVoiceEffectSegmentNotExist,""),m=(0,r.i)(u.H.SetAudioVoiceEffectSegmentTypeNotValid,"");class h extends l.a{get type(){return d.U.SET_AUDIO_VOICE_EFFECT}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?(0,n.ly)():m(`segmentType not valid: ${i.__segment_struct_type}`):p(`segment not exist: ${t}`)}do(e,t,i){var r;let{segmentId:n,resourceId:l}=this.options,d=t.getSegmentNodeById(n,[]),u=d.segment,p=d.trackNode.track.id,m=(0,o.Y9)(u)?new a.CCx:new a.NOn,{checkFlag:h}=u.material;if((h&Number(a.sQs.VoiceChangeFlag))==0){let e=(0,o.Y9)(u)?new a.yB$:new a.K2q;m.material=e,e.checkFlag=h|Number(a.sQs.VoiceChangeFlag)}let g=new a.Yy,f=null===(r=u.voiceChange)||void 0===r?void 0:r[0];if((null==f?void 0:f.resourceId)!==l){this._setVoiceChange(g),m.voiceChange=[g];let{newCommonKeyframes:i,isChange:r}=this._getNewCommonKeyframes(u,[a.Eu.KFTypeEffectAdjustParam1,a.Eu.KFTypeEffectAdjustParam2,a.Eu.KFTypeEffectAdjustParam3]);r&&(m.commonKeyframes=i);let l=(0,o.xX)({__segment_struct_type:u.__segment_struct_type});c.T.pick(u,m,l),e(new s.F({trackId:p,trackIndex:t.getTrackIndexBySegmentId(n),segmentId:n,segmentDelta:m,sourceSegmentDelta:l}))}}_setVoiceChange(e){for(let t of(e.name=this.options.name,e.path=this.options.resourcePath,e.resourceId=this.options.resourceId,e.categoryId=this.options.categoryId,e.categoryName=this.options.categoryName,e.audioAdjustParams=[],e.productionPath=this.options.productionPath,e.subType=this.options.audioEffectType,e.speakerId=this.options.speakerId,e.sourcePlatform=this.options.sourcePlatform,e.thirdResourceId=this.options.thirdResourceId,e.isVcCloneTone=this.options.isVcCloneTone,this.options.audioAdjustParams))e.audioAdjustParams.push(new a.t55({name:t.name,value:t.value,defaultValue:t.defaultValue,parameterIndex:t.parameterIndex,portIndex:t.portIndex,minValue:t.minValue,maxValue:t.maxValue}))}_getNewCommonKeyframes(e,t){let i=[],r=!1;for(let n of e.commonKeyframes){if(t.includes(n.propertyType)){r=!0;continue}i.push(n)}return{newCommonKeyframes:i,isChange:r}}constructor(e){var t,i,r,n,o,s,l,d,u,c,p,m;super({segmentId:e.segmentId,name:null!==(t=e.name)&&void 0!==t?t:"",resourceId:null!==(i=e.resourceId)&&void 0!==i?i:"",resourcePath:null!==(r=e.resourcePath)&&void 0!==r?r:"",categoryId:null!==(n=e.categoryId)&&void 0!==n?n:"",categoryName:null!==(o=e.categoryName)&&void 0!==o?o:"",audioAdjustParams:(null!==(s=e.audioAdjustParams)&&void 0!==s?s:[]).map(e=>{var t,i,r,n,a,o,s;return{value:null!==(t=e.value)&&void 0!==t?t:0,defaultValue:null!==(i=e.defaultValue)&&void 0!==i?i:0,parameterIndex:null!==(r=e.parameterIndex)&&void 0!==r?r:0,portIndex:null!==(n=e.portIndex)&&void 0!==n?n:0,name:null!==(a=e.name)&&void 0!==a?a:"",minValue:null!==(o=e.minValue)&&void 0!==o?o:0,maxValue:null!==(s=e.maxValue)&&void 0!==s?s:1}}),productionPath:null!==(l=e.productionPath)&&void 0!==l?l:"",audioEffectType:null!==(d=e.audioEffectType)&&void 0!==d?d:a.xbm.AudioEffectTypeNormal,speakerId:null!==(u=e.speakerId)&&void 0!==u?u:"",sourcePlatform:null!==(c=e.sourcePlatform)&&void 0!==c?c:a.nj7.EffectPlatformLoki,thirdResourceId:null!==(p=e.thirdResourceId)&&void 0!==p?p:"",isVcCloneTone:null!==(m=e.isVcCloneTone)&&void 0!==m&&m})}}},660141:function(e,t,i){"use strict";i.d(t,{N:function(){return g}});var r=i(150002),n=i(862213),a=i(211561),o=i(481631),s=i(475028),l=i(690613),d=i(653322),u=i(129862),c=i(283751);let p=(0,s.i)(d.H.UpdateAudioVocalBeautifySegmentNotExist,""),m=(0,s.i)(d.H.UpdateAudioVocalBeautifySegmentTypeNotValid,""),h=(0,s.i)(d.H.UpdateAudioVocalBeautifySegmentHasNotVocalBeautify,"");class g extends r.a{get type(){return n.Us.UPDATE_AUDIO_VOCAL_BEAUTIFY}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?void 0===i.vocalBeautify?h(`segment has not vocal beautify: ${i.id}`):(0,l.ly)():m(`segmentType not valid: ${i.__segment_struct_type}`):p(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,o.he)(r)||(0,o.Y9)(r)){let i=(0,o.xX)({__segment_struct_type:r.__segment_struct_type}),s=new a.ck6;void 0!==this.options.enable&&(s.enable=this.options.enable),void 0!==this.options.timeRange&&(s.timeRange=new a.zel(this.options.timeRange)),void 0!==this.options.productionPath&&(s.productionPath=this.options.productionPath),void 0!==this.options.ambientSoundLevel&&(s.ambientSoundLevel=this.options.ambientSoundLevel),i.vocalBeautify=s;let l=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});c.T.pick(r,i,l),e(new u.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:l}))}}}},871806:function(e,t,i){"use strict";i.d(t,{G:function(){return h}});var r=i(150002),n=i(862213),a=i(211561),o=i(481631),s=i(475028),l=i(690613),d=i(653322),u=i(129862),c=i(283751);let p=(0,s.i)(d.H.UpdateAudioVocalSeparationSegmentNotExist,""),m=(0,s.i)(d.H.UpdateAudioVocalSeparationSegmentTypeNotValid,"");class h extends r.a{get type(){return n.Us.UPDATE_AUDIO_VOCAL_SEPARATION}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?(0,l.ly)():m(`segmentType not valid: ${i.__segment_struct_type}`):p(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,o.he)(r)||(0,o.Y9)(r)){let i=(0,o.xX)({__segment_struct_type:r.__segment_struct_type}),s=new a.HVf;void 0!==this.options.timeRange&&(s.timeRange=new a.zel(this.options.timeRange)),void 0!==this.options.productionPath&&(s.productionPath=this.options.productionPath),void 0!==this.options.choice&&(this.options.choice===a.ZTd.None&&(s.timeRange=null),s.choice=this.options.choice),i.vocalSeparation=s;let l=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});c.T.pick(r,i,l),e(new u.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:l}))}}}},743007:function(e,t,i){"use strict";i.d(t,{E:function(){return p}});var r=i(150002),n=i(853277),a=i(700857),o=i(690613),s=i(268468),l=i(430832),d=i(646290),u=i(313934),c=i(150251);class p extends r.a{get type(){return p.type}check(e){return(0,o.ly)()}do(e,t,i){let r=new s.ry,n=new s.Uw,o=t.getDraftProperty();Object.keys(o).forEach(e=>{e!==c.I9&&(o[e]&&!n[e]?r[e]=null:r[e]=n[e])}),e(new a.W({propertyDelta:r}));let p=new s.UK,m=new s.UY,h=t.getDraftMetadata();Object.keys(h).forEach(e=>{e!==c.I9&&(h[e]&&!m[e]?p[e]=null:p[e]=m[e])}),e(new d.e({metadataDelta:p}));let g=t.getAllTracks();for(let i=g.length-1;i>=0;i--){for(let r=g[i].segments.length-1;r>=0;r--)e(new u.j({draftId:t.getDraftId(),trackId:g[i].id,trackIndex:i,segmentId:g[i].segments[r].id,targetTimerange:g[i].segments[r].targetTimerange}));e(new l.R({trackId:g[i].id,trackIndex:i,trackProperty:g[i]}))}}}p.type=n.U.CLEAR_DRAFT},522699:function(e,t,i){"use strict";i.d(t,{H:function(){return h}});var r=i(475028),n=i(690613),a=i(211561),o=i(150002),s=i(853277),l=i(653322),d=i(129862),u=i(481631),c=i(283751);let p=(0,r.i)(l.H.UpdateEffectAdjustParamsSegmentNotExist,""),m=(0,r.i)(l.H.UpdateEffectAdjustParamsSegmentTypeNotValid,"");class h extends o.a{get type(){return s.U.UPDATE_EFFECT_ADJUST_PARAMS}check(e){let{segmentId:t}=this.options,i=e.getSegmentAtPositionById(t);return i?(0,u.w5)(i.segment)?(0,n.ly)():m(`segment type not valid: ${i.segment.__segment_struct_type}`):p(`segment not exist: ${t}`)}do(e,t){let{segmentId:i,adjustParams:r}=this.options,n=t.getSegmentAtPositionById(i),{trackId:o,trackIndex:s}=n,l=n.segment,p=l.material.adjustParams,m=[];for(let e of r){let t=e.clone();m.push(t)}for(let e of p){if(!r.find(t=>t.name===e.name))m.push(e)}let h=new a.UJq;h.adjustParams=m;let g=new a.LtW;g.material=h;let f=(0,u.xX)({__segment_struct_type:l.__segment_struct_type});c.T.pick(l,g,f),e(new d.F({trackId:o,trackIndex:s,segmentId:i,segmentDelta:g,sourceSegmentDelta:f}))}}},451678:function(e,t,i){"use strict";i.d(t,{y:function(){return f}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(602777),l=i(653322),d=i(340294),u=i(794560),c=i(81649);let p=(0,a.i)(l.H.SetSegmentTimeRangeNotExist,""),m=(0,a.i)(l.H.SetSegmentTimeRangeClipDurationNotValid,""),h=(0,a.i)(l.H.SetSegmentTimeRangeClipStartNotValid,""),g=(e,t,i)=>{let r=e.targetTimerange.duration+e.targetTimerange.start,n=1;if(t.type===s.pN.TrackTypeVideo||t.type===s.pN.TrackTypeAudio){var a,o;if((null===(a=e.material)||void 0===a?void 0:a.type)!==s.cV.MetaTypePhoto){n=null!==(o=e.speed.speed)&&void 0!==o?o:n;let t=d.pM.times(i-r,n,"bigint");if(e.sourceTimerange.duration+t<0)return!1}}return!0};class f extends r.a{get type(){return f.type}check(e){let{segmentId:t,trackId:i,clipType:r,clipTime:n}=this.options,a=e.getSegmentById(t),l=e.getTrackById(i);return a?r===s.ZX.ClipDuration&&n<=0?m(`in ${r}, clipTime is not valid:${n}`):r===s.ZX.ClipStart&&n>=a.targetTimerange.start+a.targetTimerange.duration?h(`in ${r}, clipTime is not valid:${n}`):r!==s.ZX.ClipDuration||g(a,l,n)?(0,o.ly)():m(`in ${r}, clipTime is not valid:${n}`):p(`segment is not exist id: ${t}`)}do(e,t,i){(0,u.c)(t,this.options,e,i)}constructor(e,t){super(e);let i=new c.O1(t.getDraftProperty().fps);this.options.clipTime=i.gen(this.options.clipTime).tail}}f.type=n.U.UPDATE_SEGMENT_TIME_RANGE},275496:function(e,t,i){"use strict";i.d(t,{a:function(){return v}});var r=i(150002),n=i(853277),a=i(916862),o=i(475028),s=i(690613),l=i(211561),d=i(653322),u=i(712616),c=i(912224),p=i(881337),m=i(217201),h=i(698159),g=i(711999),f=i(81649);let y=(0,o.i)(d.H.AddSubtitlesActionIdEmpty,""),_=(0,o.i)(d.H.AddSubtitlesActionTrackIsNotExist,"");class v extends r.a{get type(){return v.type}check(e){let{segInfos:t,trackIndex:i}=this.options;return t.length<1&&y("segments length is 0"),!e.getAllTracks()[i]&&_(`trackIndex:${i} is undefined`),(0,s.ly)()}do(e,t,i){(0,g.F)([0,0],l.rxY.CanvasRatio16To9,!1,t,e);let{type:r,segInfos:n,trackIndex:o,taskIdList:s,taskLanguage:d}=this.options;n.sort((e,t)=>e.timeRange.start>t.timeRange.start?1:e.timeRange.start<t.timeRange.start?-1:0);let f=new c.eK().nextTextAndStickerRenderIndex(t);for(let i of n){var y;let n=u.i.makeRichTextSegment((0,p.aMe)({...i,material:(0,p.U_g)(null!==(y=i.material)&&void 0!==y?y:{}),textEffect:(0,p.ABm)(i.textEffect),shapeEffect:(0,p.ABm)(i.shapeEffect),clip:(0,p.cE6)(i.clip)}),r,f++);n.id=i.segmentId;let[a,s]=m.c8.insertSegment(t,t.getAllTracks()[o],n,new m.vp(l.pNd.TrackTypeText,o,u.i.textFlagType(r)));-1!==a&&(0,h.W)(s,e)}s&&d&&(0,a.g)(s,d,r,e)}constructor(e,t){super(e);let i=new f.O1(t.getDraftProperty().fps);this.options.segInfos=this.options.segInfos.map(e=>{let t=i.gen(e.timeRange.start).tail,r=i.gen(e.timeRange.start+e.timeRange.duration).tail;return{...e,timeRange:{start:t,duration:r-t}}})}}v.type=n.U.ADD_SUBTITLES_ACTION},377938:function(e,t,i){"use strict";i.d(t,{t:function(){return p}});var r=i(475028),n=i(690613),a=i(481631),o=i(150002),s=i(853277),l=i(712616),d=i(340294),u=i(653322);let c=(0,r.i)(u.H.UpdateTextAnimationActionSegmentIdEmpty,"");class p extends o.a{get type(){return s.U.UPDATE_TEXT_ANIMATION_ACTION}check(){let{segmentIds:e}=this.options;return 0===e.length&&c("segmentIds length is 0"),(0,n.ly)()}do(e,t,i){let{segmentIds:r,material:n,isKtv:o,ktvColor:s}=this.options;for(let i of r){let{segment:r}=t.getSegmentAtPositionById(i);if(!((0,a.Ft)(r)||(0,a.P2)(r)))continue;let u=d.pM.div(n.duration,r.targetTimerange.duration);n.duration=d.pM.times(r.targetTimerange.duration,u,"bigint"),l.i.updateTextAnim(r,n,e,t),(0,a.Ft)(r)&&o&&l.i.updateTextKtvColorBySegment(r,e,t,s)}}}p.type=s.U.UPDATE_TEXT_ANIMATION_ACTION},494065:function(e,t,i){"use strict";i.d(t,{q:function(){return p}});var r=i(789786),n=i(836092),a=i(549269),o=i(542023),s=i(418474),l=i(851163),d=i(377938),u=i(529628),c=i(575534);class p extends c.e{add(e){return this._mixApplyLocal({action:new s.L(e,this._videoDocument)},{canUndoRedo:!0})}addAnimation(e){return this._mixApplyLocal({action:new d.t(e)})}updateAnimation(e){return this._mixApplyLocal({action:new d.t(e)})}deleteAnimation(e){return this._mixApplyLocal({action:new l.n(e)})}addVideoTracker(e){return this._mixApplyLocal({action:new n.V({...e})})}updateVideoTracker(e){return this._mixApplyLocal({action:new o.V({...e})},{undoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0,redoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0})}removeVideoTracker(e){return this._mixApplyLocal({action:new a.$({...e})},{undoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0,redoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0})}}(0,r.gn)([(0,u.cM)("stickerApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IStickerAddActionOptions?Object:IStickerAddActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"add",null),(0,r.gn)([(0,u.cM)("textApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateTextAnimationActionOptions?Object:IUpdateTextAnimationActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"addAnimation",null),(0,r.gn)([(0,u.cM)("textApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateTextAnimationActionOptions?Object:IUpdateTextAnimationActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"updateAnimation",null),(0,r.gn)([(0,u.cM)("textApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveTextAnimationActionOptions?Object:IRemoveTextAnimationActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"deleteAnimation",null),(0,r.gn)([(0,u.cM)("stickerApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddVideoTrackerOptions?Object:IAddVideoTrackerOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"addVideoTracker",null),(0,r.gn)([(0,u.cM)("stickerApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateVideoTrackerOptions?Object:IUpdateVideoTrackerOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"updateVideoTracker",null),(0,r.gn)([(0,u.cM)("stickerApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveVideoTrackerOptions?Object:IRemoveVideoTrackerOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"removeVideoTracker",null)},862674:function(e,t,i){"use strict";i.d(t,{l:()=>y});var r=i("789786"),n=i("215051"),a=i("150002"),o=i("853277"),s=i("475028"),l=i("690613"),d=i("653322"),u=i("430832");let c=(0,s.i)(d.H.AddTargetIndexNotValid,"");class p extends a.a{get type(){return p.type}check(e){return this.options.trackIndex<0?c(`trackIndex is not valid:${this.options.trackIndex}`):(0,l.ly)()}do(e,t,i){e(new u.R({trackId:t.getAllTracks()[this.options.trackIndex].id,trackIndex:this.options.trackIndex,trackProperty:t.getAllTracks()[this.options.trackIndex]}))}}p.type=o.U.DELETE_TRACK;var m=i("884012"),h=i("691989"),g=i("529628"),f=i("575534");class y extends f.e{add(e){return this._mixApplyLocal({action:new n.g(e)})}delete(e){return this._mixApplyLocal({action:new p(e)})}mute(e){let t=this._videoDocument.getTrackById(e.trackId);return t&&this._videoDocument.isMainTrack(t)?this._mixApplyLocal({action:new m.g(e)}):this._mixApplyLocal({action:new h.f(e)})}}(0,r.gn)([(0,g.cM)("trackApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddTrackActionOptions?Object:IAddTrackActionOptions]),(0,r.w6)("design:returntype",void 0)],y.prototype,"add",null),(0,r.gn)([(0,g.cM)("trackApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IDeleteTrackActionOptions?Object:IDeleteTrackActionOptions]),(0,r.w6)("design:returntype",void 0)],y.prototype,"delete",null),(0,r.gn)([(0,g.cM)("trackApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IMuteTrackActionOptions?Object:IMuteTrackActionOptions]),(0,r.w6)("design:returntype",void 0)],y.prototype,"mute",null)},666227:function(e,t,i){"use strict";i.d(t,{q:()=>eR});var r=i("789786"),n=i("201519"),a=i("915106"),o=i("745337"),s=i("314409"),l=i("393409"),d=i("179247"),u=i("71362"),c=i("885956"),p=i("128324"),m=i("868498"),h=i("595657"),g=i("895496"),f=i("150002"),y=i("853277"),_=i("211561"),v=i("448218"),I=i("690613"),T=i("481631");class x extends f.a{get type(){return x.type}check(e){return(0,I.ly)()}do(e,t,i){var r;let n=t.getSegmentById(this.options.segId);if(!n||!(0,T.he)(n))return;let a=new _.fln;a.image=this.options.imagePath,a.type=_.cVg.MetaTypeCanvasImage,a.imageId=this.options.imageId,a.imageName=this.options.imageName,a.sourcePlatform=this.options.sourcePlatform,a.teamId=null!==(r=this.options.teamId)&&void 0!==r?r:"",this.options.isLocalImageFile?a.albumImage=this.options.imagePath:a.albumImage="";let o=new _.NOn;o.background=new _.Fq$(a),(0,v.W)((0,v.l)(t,this.options.segId,o),e)}}x.type=y.U.VIDEO_BACKGROUND_IMAGE;var k=i("983231"),w=i("350052"),A=i("323326"),b=i("229721"),S=i("64653"),O=i("475028"),C=i("653322"),M=i("20315");let F=(0,O.i)(C.H.FadeVideoSegmentNotExist,""),R=(0,O.i)(C.H.FadeVideoTypeNotValid,"");class E extends f.a{get type(){return E.type}check(e){for(let t of this.options.segIds){let i=e.getSegmentById(t);if(!i)return F("segment is not exist");if(!(0,T.he)(i))return R(`segment type is not valid, type is ${i.__segment_struct_type}`)}return(0,I.ly)()}do(e,t,i){let r=M.Ry.doVideoAudioFadeInOutAction(t,this.options.segIds,void 0!==this.options.fadeInDuration?BigInt(this.options.fadeInDuration):-1n,void 0!==this.options.fadeOutDuration?BigInt(this.options.fadeOutDuration):-1n);(0,v.W)(r,e)}}E.type=y.U.VIDEO_FADE;var P=i("60680"),V=i("554458"),j=i("999642"),z=i("342954"),D=i("257675"),N=i("84260"),B=i("915359"),L=i("26459"),U=i("124401"),H=i("30540"),W=i("959829"),$=i("268501"),Z=i("83494"),K=i("399815"),q=i("818712"),G=i("93007"),X=i("875554"),Y=i("862227");let J=(0,O.i)(C.H.SetVideoChromaShadowSegmentNotExist,""),Q=(0,O.i)(C.H.SetVideoChromaShadowSegmentTypeNotValid,"");class ee extends f.a{get type(){return ee.type}check(e){let{segId:t}=this.options,i=e.getSegmentById(t);return i?(0,T.he)(i)?(0,I.ly)():Q(`segment type not valid: ${t}`):J(`segment not exist: ${t}`)}do(e,t){let{segId:i}=this.options,r=t.getSegmentNodeById(i,[]),n=null==r?void 0:r.segment,a=_.Eu.KFTypeChromaShadow;new Y.u(this.options).execute(this.options,t,n,[a],e)}}ee.type=y.U.VIDEO_SET_CHROMA_SHADOW;var et=i("754774");let ei=(0,O.i)(C.H.SetVideoChromaIntensitySegmentNotExist,""),er=(0,O.i)(C.H.SetVideoChromaIntensitySegmentTypeNotValid,"");class en extends f.a{get type(){return en.type}check(e){let{segId:t}=this.options,i=e.getSegmentById(t);return i?(0,T.he)(i)?(0,I.ly)():er(`segment type not valid: ${t}`):ei(`segment not exist: ${t}`)}do(e,t,i){let{segId:r}=this.options,n=t.getSegmentNodeById(r,[]),a=null==n?void 0:n.segment,o=_.Eu.KFTypeChromaSpill;new et.K(this.options).execute(this.options,t,a,[o],e)}}en.type=y.U.VIDEO_SET_CHROMA_SPILL;var ea=i("651405"),eo=i("916791"),es=i("335378"),el=i("357230"),ed=i("705565"),eu=i("987061"),ec=i("57089"),ep=i("604277"),em=i("207730"),eh=i("708523"),eg=i("321965"),ef=i("286873"),ey=i("280700"),e_=i("129862"),ev=i("176791"),eI=i("217201"),eT=i("912224"),ex=i("81649"),ek=i("283751");let ew=(0,O.i)(C.H.UpdateVideoTransitionSegmentNotExist,""),eA=(0,O.i)(C.H.UpdateVideoTransitionTypeNotValid,""),eb=(0,O.i)(C.H.UpdateVideoTransitionEmpty,"");class eS extends f.a{get type(){return eS.type}check(e){let{segId:t}=this.options,i=(0,ey.Cm)(e.getAllTracks(),t);if(!i)return ew("segment is not exist");let{segmentIndex:r,trackIndex:n}=i,a=e.getAllTracks()[n].segments[r];return"SegmentVideo"!==a.__segment_struct_type?eA(`segment type is not video, type is ${a.__segment_struct_type}`):(!a.transition&&eb("transition is undefined, cannot be updated"),(0,I.ly)())}do(e,t,i){let r;let{segId:n,duration:a}=this.options,{renderIndexTrackModeOn:o}=t.getDraftProperty(),{segmentIndex:s,trackIndex:l,trackId:d}=(0,ey.Cm)(t.getAllTracks(),n),u=t.getAllTracks()[l],c=u.segments[s];s+1<u.segments.length&&(r=u.segments[s+1]),r&&new ev.wK().updateVideoAnimationsWithTrans(c,r,this.options.duration,e,t),!o&&r&&c.renderIndex!==r.renderIndex&&(0,v.W)(new eT.eK().ensureInSameRenderLayer(t,c,r),e);let p=new _.TBZ;p.duration=a;let m=new _.NOn;m.transition=p;let h=(0,T.xX)({__segment_struct_type:c.__segment_struct_type});ek.T.pick(c,m,h),e(new e_.F({segmentId:n,trackId:d,trackIndex:l,segmentDelta:m,sourceSegmentDelta:h})),(0,v.W)(eI.c8.adjustTrackTargetStartTime(t,u),e)}constructor(e,t){super(e);let i=new ex.O1(t.getDraftProperty().fps/2);this.options.duration=i.gen(this.options.duration).tail}}eS.type=y.U.VIDEO_UPDATE_TRANSITION;var eO=i("97244"),eC=i("529628"),eM=i("612441"),eF=i("575534");class eR extends eF.e{add(e){return this._mixApplyLocal({action:new l.k(e,this._videoDocument)})}setMaterial(e){return this._mixApplyLocal({action:new eg.a(e)})}setMask(e){return this._mixApplyLocal({action:new c.z(e)})}clearMask(e){return this._mixApplyLocal({action:new z.D(e)})}addAnimation(e){return this._mixApplyLocal({action:new d.O(e)})}deleteAnimation(e){return this._mixApplyLocal({action:new b.N(e)})}updateAnimation(e){return this._mixApplyLocal({action:new em.L({segId:e.segId,animation:new _.FJA(e.animation)})})}crop(e){return this._mixApplyLocal({action:new A.E(e)})}reverse(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new U.x(e)},{canUndoRedo:t,commit:i})}muteOn(){return this._mixApplyLocal({action:new s.$({muted:!0})})}muteOff(){return this._mixApplyLocal({action:new s.$({muted:!1})})}denoiseOn(e){return this._mixApplyLocal({action:new S.m({...e,isDenoise:!0})})}denoiseOff(e){return this._mixApplyLocal({action:new S.m({...e,isDenoise:!1})})}setFade(e){return this._mixApplyLocal({action:new E(e)})}seprateAudio(e){return this._mixApplyLocal({action:new H.k(e)})}setMatting(e){return this._mixApplyLocal({action:new V.i({...e,isAiMattingEnable:!0})})}clearMatting(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new V.i({...e,isAiMattingEnable:!1})},{canUndoRedo:t,commit:i})}setOpacity(e){return this._mixApplyLocal({action:new h.J(e)})}clearBackground(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new k.L(e)},{canUndoRedo:t,commit:i})}setBackgroundBlur(e){return this._mixApplyLocal({action:new $.O(e)})}setBackgroundColor(e){return this._mixApplyLocal({action:new Z.E(e)})}setBackgroundImage(e){return this._mixApplyLocal({action:new x(e)})}formatVideo(e){return this._mixApplyLocal({action:new P.Q(e)},{undoSelectedSegIds:[e.segId],redoSelectedSegIds:[e.segId]})}setSpeed(e){return this._mixApplyLocal({action:new eu.X8({...e,mode:_.yY$.SpeedModeNormal})},{undoSelectedSegIds:[e.segId],redoSelectedSegIds:[e.segId]})}setBasicColor(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this._mixApplyLocal({action:new K.r(e)},{canUndoRedo:t})}resetBasicColor(e){return this._mixApplyLocal({action:new B.P(e)})}setVolume(e){return this._mixApplyLocal({action:new ep.U(e)})}setCurveSpeed(e){return this._mixApplyLocal({action:new eu.X8({...e,mode:_.yY$.SpeedModeCurve})},{undoSelectedSegIds:[e.segId],redoSelectedSegIds:[e.segId]})}pitchOn(e){return this._mixApplyLocal({action:new j.n({...e,modifyTone:!0})})}pitchOff(e){return this._mixApplyLocal({action:new j.n({...e,modifyTone:!1})})}setTransition(e){return this._mixApplyLocal({action:new m.s(e,this._videoDocument)},{canUndoRedo:!0})}updateTransition(e){return this._mixApplyLocal({action:new eS(e,this._videoDocument)},{undoSelectedSegIds:[`${e.segId}_transition`],redoSelectedSegIds:[`${e.segId}_transition`]})}clearTransition(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new N.K(e)},{canUndoRedo:t,commit:i})}setFigure(e){return this._mixApplyLocal({action:new eo.c(e)})}setMakeupRoot(e){return this._mixApplyLocal({action:new es.Y(e)})}clearFigure(e){return this._mixApplyLocal({action:new w.H(e)})}setFigureFaceId(e){return this._mixApplyLocal({action:new ea.c(e)})}setMix(e){return this._mixApplyLocal({action:new el.h(e)})}setChromaColor(e){return this._mixApplyLocal({action:new q.s(e)})}setChromaIntensity(e){return this._mixApplyLocal({action:new X.w(e)})}setChromaShadow(e){return this._mixApplyLocal({action:new ee(e)})}setChromaEdgeSmooth(e){return this._mixApplyLocal({action:new G.y(e)})}setChromaSpill(e){return this._mixApplyLocal({action:new en(e)})}resetChroma(e){return this._mixApplyLocal({action:new L.l(e)})}applyAllChroma(e){return this._mixApplyLocal({action:new g.G(e)})}removeSmartCrop(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this._mixApplyLocal({action:new o.B(e)},{canUndoRedo:t})}addSmartCrop(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this._mixApplyLocal({action:new a.Q(e)},{canUndoRedo:t})}setSmartColorAdjust(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new ed.C(e)},{canUndoRedo:t,commit:i})}addObjectLocked(e){return this._mixApplyLocal({action:new p.U(e)})}updateObjectLocked(e){return this._mixApplyLocal({action:new ef.w(e)})}removeObjectLocked(e){return this._mixApplyLocal({action:new D.j(e)})}setStable(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new ec.Q(e)},{canUndoRedo:t,commit:i})}setVideoAlgorithm(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this._mixApplyLocal({action:new W.B(e)},{canUndoRedo:t,commit:i})}addDigitalHuman(e){return this._mixApplyLocal({action:new u.m(e,this._videoDocument)})}updateDigitalHuman(e){return this._mixApplyLocal({action:new eh.H(e,this._videoDocument)})}updateDigitalHumanRendered(e){let t=this._videoDocument.getSegmentById(e.segmentId);if(t&&(0,T.NH)(t)&&t.materialDraft){let i={draftId:this._videoDocument.metadata.id,identifier:{sourceTimerange:t.sourceTimerange,materialDraft:{draft:{metadata:{id:t.materialDraft.draft.metadata.id}}}},substitute:{}};e.sourceTimerangeParam&&(i.substitute.sourceTimerange=e.sourceTimerangeParam),t.materialDraft&&(i.substitute.materialDraft=null);let[r]=new ev.wK().insertVideoSegments([e.videoParam],0,this._videoDocument);r.material.isAiGenerateContent=!0,i.substitute.material=r.material;let a=new _.v5b;a.flag=BigInt(eO.Ez.webAiMattingFlag|eO.Ez.enableFlag),a.path=e.mattingPath,i.substitute.material.matting=a;let o=this._mixApplyLocal({action:new n.a(i)},{canUndoRedo:!1,clearRedoStack:!1});return eM.ty.execute(i),o}return(0,I.ly)()}}(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoAddActionOptions?Object:IVideoAddActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"add",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoUpdateMaterialOptions?Object:IVideoUpdateMaterialOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setMaterial",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoAddMaskActionOptions?Object:IVideoAddMaskActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setMask",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoRemoveMaskActionOptions?Object:IVideoRemoveMaskActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"clearMask",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoAddAnimationActionOptions?Object:IVideoAddAnimationActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"addAnimation",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoDeleteAnimationActionOptions?Object:IVideoDeleteAnimationActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"deleteAnimation",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoUpdateAnimationActionOptions?Object:IVideoUpdateAnimationActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"updateAnimation",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoCropActionOptions?Object:IVideoCropActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"crop",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoReverseActionOptions?Object:IVideoReverseActionOptions,void 0,void 0]),(0,r.w6)("design:returntype","undefined"==typeof ILvErrorOr?Object:ILvErrorOr)],eR.prototype,"reverse",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"muteOn",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"muteOff",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"denoiseOn",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"denoiseOff",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoFadeActionOptions?Object:IVideoFadeActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setFade",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSeparateAudioActionOptions?Object:IVideoSeparateAudioActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"seprateAudio",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setMatting",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit,void 0,void 0]),(0,r.w6)("design:returntype","undefined"==typeof ILvErrorOr?Object:ILvErrorOr)],eR.prototype,"clearMatting",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoOpacityActionOptions?Object:IVideoOpacityActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setOpacity",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoClearBackgroundActionOptions?Object:IVideoClearBackgroundActionOptions,void 0,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"clearBackground",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetBackgroundBlurActionOptions?Object:IVideoSetBackgroundBlurActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setBackgroundBlur",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetBackgroundColorActionOptions?Object:IVideoSetBackgroundColorActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setBackgroundColor",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetBackgroundImageActionOptions?Object:IVideoSetBackgroundImageActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setBackgroundImage",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoFormatActionOptions?Object:IVideoFormatActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"formatVideo",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setSpeed",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetBasicColorActionOptions?Object:ISetBasicColorActionOptions,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setBasicColor",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IResetBasicColorActionOptions?Object:IResetBasicColorActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"resetBasicColor",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetVolumeActionOptions?Object:IVideoSetVolumeActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setVolume",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setCurveSpeed",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"pitchOn",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"pitchOff",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetTransitionActionOptions?Object:IVideoSetTransitionActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setTransition",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoUpdateTransitionActionOptions?Object:IVideoUpdateTransitionActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"updateTransition",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoClearTransitionActionOptions?Object:IVideoClearTransitionActionOptions,void 0,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"clearTransition",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetFigureActionOptions?Object:IVideoSetFigureActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setFigure",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetMakeupRootAction?Object:IVideoSetMakeupRootAction]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setMakeupRoot",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoClearFigureActionOptions?Object:IVideoClearFigureActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"clearFigure",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetFigureFaceIdActionOptions?Object:IVideoSetFigureFaceIdActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setFigureFaceId",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoMixActionOptions?Object:IVideoMixActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setMix",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetChromaColorActionOptions?Object:IVideoSetChromaColorActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setChromaColor",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetChromaIntensityActionOptions?Object:IVideoSetChromaIntensityActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setChromaIntensity",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetChromaShadowActionOptions?Object:IVideoSetChromaShadowActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setChromaShadow",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetChromaEdgeSmoothActionOptions?Object:IVideoSetChromaEdgeSmoothActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setChromaEdgeSmooth",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetChromaSpillActionOptions?Object:IVideoSetChromaSpillActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setChromaSpill",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoResetChromaActionOptions?Object:IVideoResetChromaActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"resetChroma",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoApplyAllChromaActionOptions?Object:IVideoApplyAllChromaActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"applyAllChroma",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveSmartCropActionOptions?Object:IRemoveSmartCropActionOptions,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"removeSmartCrop",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddSmartCropActionOptions?Object:IAddSmartCropActionOptions,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"addSmartCrop",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetSmartColorAdjustActionOptions?Object:IVideoSetSmartColorAdjustActionOptions,void 0,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setSmartColorAdjust",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoAddObjectLockedActionOptions?Object:IVideoAddObjectLockedActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"addObjectLocked",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoUpdateObjectLockedActionOptions?Object:IVideoUpdateObjectLockedActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"updateObjectLocked",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoRemoveObjectLockedActionOptions?Object:IVideoRemoveObjectLockedActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"removeObjectLocked",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetStableActionOptions?Object:IVideoSetStableActionOptions,void 0,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setStable",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetAlgorithmsActionOptions?Object:IVideoSetAlgorithmsActionOptions,void 0,void 0]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"setVideoAlgorithm",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoAddDigitalHumanActionOptions?Object:IVideoAddDigitalHumanActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"addDigitalHuman",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoUpdateDigitalHumanActionOptions?Object:IVideoUpdateDigitalHumanActionOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"updateDigitalHuman",null),(0,r.gn)([(0,eC.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoUpdateDigitalHumanRenderedOptions?Object:IVideoUpdateDigitalHumanRenderedOptions]),(0,r.w6)("design:returntype",void 0)],eR.prototype,"updateDigitalHumanRendered",null)},754079:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var r=i(211561);let n=new class e{initPrevFrameSegmentIds(e){this.prevFrameSegmentIds=e}getFirstFrameSegmentIds(e){let t=new Set;for(let i of e.getTracksByTypes([])){if([r.pNd.TrackTypeAudio,r.pNd.TrackTypeTextToVideoTextAudio].includes(i.type))continue;let e=i.segments;if(0===e.length)continue;let n=e[0];0n===n.targetTimerange.start&&t.add(n.id)}return Array.from(t)}frameHasChange(e,t){let i=!1,r=this.getFirstFrameSegmentIds(t);return r.length!==this.prevFrameSegmentIds.length&&(i=!0),e.forEach(e=>{this.prevFrameSegmentIds.includes(e)&&(i=!0),r.includes(e)&&(i=!0)}),this.prevFrameSegmentIds=this.getFirstFrameSegmentIds(t),i}constructor(){this.prevFrameSegmentIds=[]}}},310693:function(e,t,i){"use strict";i.d(t,{h:function(){return r.h}});var r=i(87333)},114854:function(e,t,i){"use strict";i.d(t,{D:function(){return s},J:function(){return l}});var r=i(391889),n=i(211561),a=i(33926),o=i(481631);function s(){for(var e,t,i,s,l,d,u,c,p=arguments.length,m=Array(p),h=0;h<p;h++)m[h]=arguments[h];let[g,f,{unshift:y,push:_,remove:v},I]=m,T=f.getMainTrack();if(!T||(null==T?void 0:T.segments.length)===0)return;let x=!1,k=[],w=0,A=0,b=0,S=0,O=0,C=0,M=[],F=[],R=T.segments[T.segments.length-1],E=R?R.targetTimerange.start+R.targetTimerange.duration+a.D:0n,P=[];for(let n of g){if(n.type!==r.C8.MOVE){M.push(n),n.type===r.C8.UPDATE&&(null===(t=n.item.segment)||void 0===t?void 0:null===(e=t.targetTimerange)||void 0===e?void 0:e.duration)!==void 0&&(null===(s=n.item.segment)||void 0===s?void 0:null===(i=s.targetTimerange)||void 0===i?void 0:i.duration)!==null&&n.item.beforeTargetTimeRange&&n.item.segment.targetTimerange.duration>n.item.beforeTargetTimeRange.duration&&(x=!0);continue}if(0===n.item.trackIndex&&0===n.item.segment.trackRenderIndex){(null===(d=n.item.segment)||void 0===d?void 0:null===(l=d.targetTimerange)||void 0===l?void 0:l.start)!==void 0&&(null===(c=n.item.segment)||void 0===c?void 0:null===(u=c.targetTimerange)||void 0===u?void 0:u.start)!==null&&n.item.beforeTargetTimeRange&&n.item.segment.targetTimerange.start<n.item.beforeTargetTimeRange.start&&(x=!0);let e=f.getSegmentById(n.item.id);if(!e)continue;let t=e.clone();t.targetTimerange.start=E,E+=t.targetTimerange.duration,I.updateTimeInfo(t);let i=g.findIndex(t=>t.type===r.C8.MOVE&&t.item.id===e.id);P.push(i),F.push({id:n.item.id,segment:n.item.segment,trackIndex:0,segmentType:n.item.segment.__segment_struct_type});let a=g.findIndex(t=>{if(t.type===r.C8.UPDATE&&!!(0,o.RF)(t.item.segment)&&!!t.item.segment.transition)return t.item.id===e.id});if(a>-1){let e=g[a];v(a),F.push(e.item)}}M.push({item:{id:n.item.id,trackIndex:n.item.trackIndex,path:n.item.path},order:n.order,type:r.C8.DELETE}),M.push({item:{segment:n.item.segment,trackIndex:n.item.segment.trackRenderIndex,path:n.item.path,segmentType:n.item.segment.__segment_struct_type},order:n.order+.5,type:r.C8.ADD})}for(let e of P.reverse())v(e);for(let e of M){if(0===e.item.trackIndex)e.type===r.C8.ADD&&(k.push(e.item.segment.id),++w,A=Math.min(A,e.order)),e.type===r.C8.UPDATE&&(k.push(e.item.id),++b,S=e.order),e.type===r.C8.DELETE&&(k.push(e.item.id),++O,C=Math.max(C,e.order))}let V="push",j=0;if(O&&w)j=C+.1;else if(b&&O)j=C+.1;else if(w)V="unshift",j=A-.1;else if(b)j=S;else{if(!O)return;j=C+.1}for(let e of x?[...T.segments].reverse():T.segments){if(k.includes(e.id))continue;let t=new n.NOn,i=new n.zel;i.start=e.targetTimerange.start,i.duration=e.targetTimerange.duration,t.targetTimerange=i;let a={type:r.C8.UPDATE,order:j,item:{id:e.id,segment:t,trackIndex:0,segmentType:n.Ocy.SegmentVideo}};"unshift"===V?y(a):_(a)}for(let e of F)_({type:r.C8.UPDATE,order:Number.MAX_SAFE_INTEGER,item:e})}function l(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[a,o,{unshift:s,push:l,remove:d},u]=t,c=o.getMainTrack();if(!c||(null==c?void 0:c.segments.length)===0)return;let p=0;a.length>=0&&(p=a[a.length-1].order+1);let{segments:m}=c;for(let e of m){let t=new n.NOn,i=new n.zel;i.start=e.targetTimerange.start,i.duration=e.targetTimerange.duration,t.targetTimerange=i,l({type:r.C8.UPDATE,order:p++,item:{id:e.id,segment:t,trackIndex:0,segmentType:n.Ocy.SegmentVideo}})}}},696011:function(e,t,i){"use strict";i.d(t,{Bk:function(){return s},G4:function(){return l},Pc:function(){return d},Ye:function(){return o}});var r,n=i(363397),a=i(211561);let o=1920,s=1080;var l=((r={})[r.landscape=0]="landscape",r[r.portrait=1]="portrait",r);let d={calculateCanvasSize(e,t,i,r){let n=0;if(t===a.rxY.CanvasRatioOriginal){let t=e.getTracksByTypes([a.pNd.TrackTypeVideo]),i=o,r=s;if(t.length>0)for(let e of t[0].segments){if("SegmentVideo"!==e.__segment_struct_type)continue;let{material:t}=e;i=t.width,r=t.height;break}(!i||!r)&&(i=o,r=s),n=i/r}else n=this.convertRatioToFloat(t);let l=0,d=0;return n>1?d=(l=r)/n:l=n*(d=r),[Math.ceil(l),Math.ceil(d)]},convertRatioToFloat(e){if(e===a.rxY.CanvasRatioOriginal)return 16/9;{let t=(0,n.g7)(e),i=t.indexOf(":");if(i<=0||i>=t.length-1)return 16/9;let r=parseFloat(t.substring(0,i));return r/parseFloat(t.substring(i+1))}},getCanvasDirection(e){let t;switch(e.ratio){case a.rxY.CanvasRatio9To16:case a.rxY.CanvasRatio3To4:case a.rxY.CanvasRatio1_125To2_436:t=1;break;case a.rxY.CanvasRatio1To1:case a.rxY.CanvasRatio16To9:case a.rxY.CanvasRatio4To3:case a.rxY.CanvasRatio2To1:case a.rxY.CanvasRatio2_35To1:case a.rxY.CanvasRatio1_85To1:t=0;break;case a.rxY.CanvasRatioOriginal:case a.rxY.CanvasRatioCustom:t=e.width>=e.height?0:1;break;default:t=0}return t},tryResizeCanvasSize(e,t,i,r){let n=i/e,a=r/t;return n>a?[Math.round(e*a),r]:[i,Math.round(t*n)]}}},27574:function(e,t,i){"use strict";i.d(t,{T:function(){return n}});var r=i(881337);let n=e=>{var t,i,n,a,o,s;return(0,r.ABm)({effectId:null==e?void 0:e.effect_id,resId:null==e?void 0:e.res_id,thirdResourceId:null==e?void 0:e.third_resource_id,name:null==e?void 0:e.name,type:(null==e?void 0:e.type)!==void 0?"figure":void 0,subType:(null==e?void 0:e.sub_type)!==void 0?null==e?void 0:e.sub_type:void 0,path:null==e?void 0:e.path,value:null!==(s=null==e?void 0:e.value)&&void 0!==s?s:1,categoryId:null==e?void 0:e.category_id,categoryName:null==e?void 0:e.category_name,platform:null==e?void 0:e.platform,version:(null==e?void 0:e.version)||((null==e?void 0:e.isPrefab)?"v2":""),sourcePlatform:(null==e?void 0:e.source_platform)!==void 0?null==e?void 0:e.source_platform:void 0,adjustParams:((null==e?void 0:e.adjust_params)||[]).map(e=>({adjustKey:e.adjust_key,adjustValue:e.adjust_value,defaultValue:e.default_value,flags:e.flags})),hslParams:(null==e?void 0:e.hsl_params)?(0,r.BZR)({hslColorType:e.hsl_params.hsl_color_type,hue:e.hsl_params.hue,saturation:e.hsl_params.saturation,lightness:e.hsl_params.lightness,interacting:e.hsl_params.interacting,path:e.hsl_params.path,visible:e.hsl_params.visible}):void 0,formulaId:null==e?void 0:e.formula_id,enableSkinToneCorrection:null==e?void 0:e.enable_skin_tone_correction,colorCurvesParams:(null==e?void 0:e.color_curves_params)?(0,r.CTM)({panel:e.color_curves_params.panel,resourceId:e.color_curves_params.resource_id,path:e.color_curves_params.path,luma:(e.color_curves_params.luma||[]).map(e=>(0,r.Sz3)({anchor:(0,r.ZoZ)(e.anchor||{}),leftControl:(0,r.ZoZ)(e.left_control||{}),rightControl:(0,r.ZoZ)(e.right_control||{})})),red:(e.color_curves_params.red||[]).map(e=>(0,r.Sz3)({anchor:(0,r.ZoZ)(e.anchor||{}),leftControl:(0,r.ZoZ)(e.left_control||{}),rightControl:(0,r.ZoZ)(e.right_control||{})})),green:(e.color_curves_params.green||[]).map(e=>(0,r.Sz3)({anchor:(0,r.ZoZ)(e.anchor||{}),leftControl:(0,r.ZoZ)(e.left_control||{}),rightControl:(0,r.ZoZ)(e.right_control||{})})),blue:(e.color_curves_params.blue||[]).map(e=>(0,r.Sz3)({anchor:(0,r.ZoZ)(e.anchor||{}),leftControl:(0,r.ZoZ)(e.left_control||{}),rightControl:(0,r.ZoZ)(e.right_control||{})}))}):void 0,colorWheelsParam:(0,r.GSF)((null==e?void 0:e.color_wheels_param)||{}),algorithmArtifactPath:null==e?void 0:e.algorithm_artifact_path,intensityKey:null==e?void 0:e.intensity_key,faceAdjustParams:((null==e?void 0:e.face_adjust_params)||[]).map(e=>(0,r.nV7)({faceId:e.face_id,enable:e.enable,adjustParams:((null==e?void 0:e.adjust_params)||[]).map(e=>(0,r.Q2f)({adjustKey:e.adjust_key,adjustValue:e.adjust_value,defaultValue:e.default_value,flags:void 0!==e.flags?BigInt(e.flags):-1n})),disablePart:e.disable_part})),exclusionGroup:null==e?void 0:e.exclusion_group,panelId:null==e?void 0:e.panel_id,bloomActionParams:(0,r.vSN)({color:null==e?void 0:null===(t=e.bloom_action_params)||void 0===t?void 0:t.color,strength:null==e?void 0:null===(i=e.bloom_action_params)||void 0===i?void 0:i.strength,range:null==e?void 0:null===(n=e.bloom_action_params)||void 0===n?void 0:n.range,dirX:null==e?void 0:null===(a=e.bloom_action_params)||void 0===a?void 0:a.dir_x,dirY:null==e?void 0:null===(o=e.bloom_action_params)||void 0===o?void 0:o.dir_y}),requestId:null==e?void 0:e.request_id})}},115406:function(e,t,i){"use strict";var r=i(438176);r.H&&new URL(i(193985),i.b).href,r.H&&new URL(i(742135),i.b).href,r.H&&new URL(i(374345),i.b).href,r.H&&new URL(i(237359),i.b).href,r.H&&new URL(i(49705),i.b).href,r.H&&new URL(i(198326),i.b).href,r.H&&new URL(i(662498),i.b).href,r.H&&new URL(i(664686),i.b).href},13057:function(e,t,i){"use strict";i(881337)},276117:function(e,t,i){"use strict";i(881337)},139081:function(e,t,i){"use strict";i(881337)},705482:function(e,t,i){"use strict";i(881337)},890625:function(e,t,i){"use strict";i(881337)},576451:function(e,t,i){"use strict";i(881337)},826917:function(e,t,i){"use strict";i(881337)},788453:function(e,t,i){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:void 0!==e.name?e.name:"",effectId:void 0!==e.effectId?e.effectId:"",resourceId:void 0!==e.resourceId?e.resourceId:"",path:void 0!==e.path?e.path:"",duration:void 0!==e.duration?BigInt(e.duration):0n,isOverlap:void 0!==e.isOverlap&&e.isOverlap,platform:void 0!==e.platform?e.platform:"all",categoryId:void 0!==e.categoryId?e.categoryId:"",categoryName:void 0!==e.categoryName?e.categoryName:"",requestId:void 0!==e.requestId?e.requestId:""}}i.d(t,{k:function(){return r}})},872630:function(e,t,i){"use strict";i.d(t,{C:function(){return n}});var r=i(881337);function n(){var e,t,i,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{panel:void 0!==a.panel?a.panel:"",resourceId:void 0!==a.resourceId?a.resourceId:"",path:void 0!==a.path?a.path:"",luma:(null!==(e=null==a?void 0:a.luma)&&void 0!==e?e:[]).map(e=>(0,r.Sz3)(e)),red:(null!==(t=null==a?void 0:a.red)&&void 0!==t?t:[]).map(e=>(0,r.Sz3)(e)),green:(null!==(i=null==a?void 0:a.green)&&void 0!==i?i:[]).map(e=>(0,r.Sz3)(e)),blue:(null!==(n=null==a?void 0:a.blue)&&void 0!==n?n:[]).map(e=>(0,r.Sz3)(e))}}},215920:function(e,t,i){"use strict";i(881337)},788775:function(e,t,i){"use strict";i(881337)},117840:function(e,t,i){"use strict";i.d(t,{np:function(){return n}});var r,n=((r={})[r.AUDIO_BEAT_GEAR_LOW=0]="AUDIO_BEAT_GEAR_LOW",r[r.AUDIO_BEAT_GEAR_HIGH=1]="AUDIO_BEAT_GEAR_HIGH",r[r.AUDIO_BEAT_GEAR_NONE=404]="AUDIO_BEAT_GEAR_NONE",r)},620327:function(e,t,i){"use strict";i(881337)},807316:function(e,t,i){"use strict";i(881337)},85716:function(e,t,i){"use strict";i(881337)},636093:function(e,t,i){"use strict";i.d(t,{W:function(){return a}});var r=i(881337),n=i(602777);function a(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{version:void 0!==t.version?t.version:"",effectId:void 0!==t.effectId?t.effectId:"",resourceId:void 0!==t.resourceId?t.resourceId:"",path:void 0!==t.path?t.path:"",draftPath:void 0!==t.draftPath?t.draftPath:"",name:void 0!==t.name?t.name:"",platform:void 0!==t.platform?t.platform:"all",categoryId:void 0!==t.categoryId?t.categoryId:"",categoryName:void 0!==t.categoryName?t.categoryName:"",timeRange:void 0!==t.timeRange?(0,r.xrB)(t.timeRange):(0,r.xrB)({}),resourceTexts:(null!==(e=null==t?void 0:t.resourceTexts)&&void 0!==e?e:[]).map(e=>e),sourcePlatform:void 0!==t.sourcePlatform?t.sourcePlatform:n.nj.EffectPlatformLoki,formulaId:void 0!==t.formulaId?t.formulaId:"",clip:void 0!==t.clip?(0,r.cE6)(t.clip):(0,r.cE6)({}),ttsAutoUpdate:void 0!==t.ttsAutoUpdate&&t.ttsAutoUpdate,is3d:void 0!==t.is3d&&t.is3d,requestId:void 0!==t.requestId?t.requestId:""}}},381197:function(e,t,i){"use strict";i(881337)},759286:function(e,t,i){"use strict";i(881337)},306166:function(e,t,i){"use strict";i.d(t,{O:function(){return n}});var r=i(881337);function n(){var e,t;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segId:void 0!==i.segId?i.segId:"",textMaterial:void 0!==i.textMaterial?(0,r.U_g)(i.textMaterial):(0,r.U_g)({}),bloomMaterial:void 0!==i.bloomMaterial?(0,r.ABm)(i.bloomMaterial):(0,r.ABm)({}),syncToAll:void 0!==i.syncToAll&&i.syncToAll,syncToActionTime:void 0!==i.syncToActionTime?BigInt(i.syncToActionTime):-1n,modifyFlags:(null!==(e=null==i?void 0:i.modifyFlags)&&void 0!==e?e:[]).map(e=>e),isKeyframe:void 0===i.isKeyframe||i.isKeyframe,keyframeId:void 0!==i.keyframeId?i.keyframeId:"",selectionUpdate:void 0!==i.selectionUpdate&&i.selectionUpdate,isAutoFillKeyframe:void 0===i.isAutoFillKeyframe||i.isAutoFillKeyframe,segmentIds:(null!==(t=null==i?void 0:i.segmentIds)&&void 0!==t?t:[]).map(e=>e)}}},380976:function(e,t,i){"use strict";i.d(t,{u:function(){return n}});var r=i(881337);function n(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segId:void 0!==t.segId?t.segId:"",textMaterialId:void 0!==t.textMaterialId?t.textMaterialId:"",textMaterial:void 0!==t.textMaterial?(0,r.U_g)(t.textMaterial):(0,r.U_g)({}),modifyFlags:(null!==(e=null==t?void 0:t.modifyFlags)&&void 0!==e?e:[]).map(e=>e),selectionUpdate:void 0!==t.selectionUpdate&&t.selectionUpdate,draftPath:void 0!==t.draftPath?t.draftPath:""}}},197013:function(e,t,i){"use strict";i(881337)},569385:function(e,t,i){"use strict";i(881337)},456955:function(e,t,i){"use strict";i(881337)},188744:function(e,t,i){"use strict";i(211561)},911838:function(e,t,i){"use strict";i.d(t,{l:function(){return n}});var r=i(587892);class n{static getInstance(){return!n.instance&&(n.instance=new n),n.instance}register(e){if(Array.isArray(e))e.forEach(e=>this.register(e));else{let{attachment:t,name:i}=e;if(this._attachmentMap.has(i))throw Error(`attachment ${i} has been registered`);this._attachmentMap.set(i,t),t.onChange(()=>{this._onChangeAttachment.fire(i)})}}get(e){return this._attachmentMap.get(e)}getAll(){let e={};for(let[t,i]of this._attachmentMap.entries())e[t]=i;return e}getAllDraft(e){let t={};for(let[i,r]of this._attachmentMap.entries())t[i]=r.getDraftStr(e);return t}remove(e){this._attachmentMap.delete(e)}needExtraUpgrade(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var t;let i=this._attachmentMap.get(e);return null!==(t=null==i?void 0:i.needExtraUpgrade())&&void 0!==t&&t}return this._attachmentMap.forEach(e=>{if(e.needExtraUpgrade())return!0}),!1}draftDidUpdate(e,t){for(let[,i]of this._attachmentMap){if(!!(null==i?void 0:i.getHasListenDraftUpdate()))i.draftDidUpdate(e,t)}}constructor(){this._attachmentMap=new Map,this._onChangeAttachment=new r.Q,this.onChangeAttachment=this._onChangeAttachment.event}}n.instance=void 0},265418:function(e,t,i){"use strict";i.d(t,{J:function(){return n}});var r,n=((r={}).AttachmentAsyncTask="async_task_attachment.json",r.AttachmentVideoAlgorithm="attachment_video_algorithm.json",r.AttachmentAiWriter="attachment_ai_writer.json",r.AttachmentAiStory="attachment_ai_story.json",r.AttachmentAiCreator="attachment_ai_creator.json",r)},830187:function(e,t,i){"use strict";i.d(t,{Cg:function(){return a.C},Sy:function(){return s.S},UI:function(){return n.U},cw:function(){return o.cw},fG:function(){return r.f},rt:function(){return o.rt}});var r=i(44991),n=i(848701),a=i(47497),o=i(488890),s=i(521589)},633141:function(e,t,i){"use strict";i.d(t,{V:function(){return o}});var r=i(690613),n=i(626956),a=i(722169);class o extends n.j{repair(e){let{attachment:t}=e,i=null==t?void 0:t.alternative_material_list;return null==i||i.forEach(e=>{e.alternatives=(0,a.uniqBy)(e.alternatives,"id")}),(0,r.oW)(e)}}},899065:function(e,t,i){"use strict";i.d(t,{T:function(){return c}});var r=i(690613),n=i(341360),a=i(283395);let o=1,s=2,l=4,d=8,u={[o]:"Comic-cut",[s]:"Comic-cut",[l]:"Comic-cut",[d]:"Comic-cut"};class c extends n.k{migrateInner(e){if(!("tracks"in e)||!Array.isArray(e.tracks))return(0,r.wf)(a.D.kDeserializeJsonFailed,"no tracks in json");for(let t of e.tracks)if("video"===t.type&&0===t.flag)for(let i of t.segments){let t=i.material_id;this._upgradeTo260000Material(e,t)}return(0,r.oW)(e)}_upgradeTo260000Material(e,t){for(let[i,r]of Object.entries(e.materials)){if("videos"===i){for(let e of r)if(e.id===t&&e.type_option){let t=e.type_option;if(t.length>0){let i=t[0],r=this._convertTypeOptionToAlg(i),n="";for(let i of e.paths)if(i.type===t){n=i.path;break}let a={path:n,algorithm:r,reshape:!1};e.gamePlay=a}}}}}_convertTypeOptionToAlg(e){return u[e]||""}constructor(...e){super(...e),this.version="26.0.0"}}},502186:function(e,t,i){"use strict";i.d(t,{x:function(){return o}});var r=i(340294),n=i(341360),a=i(690613);class o extends n.k{migrateInner(e,t){if("keyframes"in e&&(0,r.Fz)(e.keyframes)){let{keyframes:t}=e;if(!t)return(0,a.oW)(e);["videos","audios","stickers","texts","filters","adjusts"].forEach(e=>{o.fillKeyframeType(t,e,e.slice(0,e.length-1))})}return(0,a.oW)(e)}static fillKeyframeType(e,t,i){if("keyframeKey"in e&&!!Array.isArray(e[t]))e[t].forEach(e=>{e.type=i})}constructor(...e){super(...e),this.version="35.0.1"}}},763974:function(e,t,i){"use strict";i.d(t,{V:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){return this.migrationTo410001Impl(e),(0,r.oW)(e)}migrationTo410001Impl(e){if("materials"in e){let t=e.materials.effects,i=[];for(let e=0;e<t.length;){let r=t[e],n=r.id;i.includes(n)?"figure"===r.type?t.splice(e,1):e++:(i.push(n),e++)}}if("tracks"in e)for(let t of e.tracks){if(!!("type"in t&&"video"===t.type)&&"segments"in t)for(let e of t.segments){let t=e.extra_material_refs,i=[];for(let e=0;e<t.length;){let r=t[e];i.includes(r)?t.splice(e,1):(i.push(r),e++)}}}}constructor(...e){super(...e),this.version="41.0.1"}}},195127:function(e,t,i){"use strict";i.d(t,{j:function(){return o}});var r=i(690613),n=i(341360),a=i(340294);class o extends n.k{migrateInner(e,t){if("materials"in e&&(0,a.Fz)(e.materials)){let t=e.materials;if("videos"in t&&Array.isArray(t.videos)){for(let e of t.videos)if("ai_matting"in e){var i,n,o,s,l,d,u,c,p,m,h,g;let t=e.ai_matting,r=e.path;(null===(o=e.gameplay)||void 0===o?void 0:null===(n=o.path)||void 0===n?void 0:null===(i=n.trim)||void 0===i?void 0:i.call(n))?e.gameplay.path:(null===(d=e.video_algorithm)||void 0===d?void 0:null===(l=d.path)||void 0===l?void 0:null===(s=l.trim)||void 0===s?void 0:s.call(l))?e.video_algorithm.path:(null===(c=e.reverse_intensifies_path)||void 0===c?void 0:null===(u=c.trim)||void 0===u?void 0:u.call(c))?e.reverse_intensifies_path:(null===(m=e.reverse_path)||void 0===m?void 0:null===(p=m.trim)||void 0===p?void 0:p.call(m))?e.reverse_path:(null===(g=e.intensifies_path)||void 0===g?void 0:null===(h=g.trim)||void 0===h?void 0:h.call(g))&&e.intensifies_path;let a={};a.flag=t,e.matting=a}}}return(0,r.oW)(e)}constructor(...e){super(...e),this.version="54.0.0"}}},621062:function(e,t,i){"use strict";i.d(t,{G:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){return(0,r.oW)(e)}constructor(...e){super(...e),this.version="59.0.0"}}},848170:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){return(0,r.oW)(e)}constructor(...e){super(...e),this.version="81.0.0",this.needEnumerateSubDrafts=!1}}},520622:function(e,t,i){"use strict";i.d(t,{E:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){if(!e.materials||!e.materials.audio_effects)return(0,r.oW)(e);for(let t of e.materials.audio_effects)t.constant_material_id=t.id;return(0,r.oW)(e)}constructor(...e){super(...e),this.version="89.0.0",this.needEnumerateSubDrafts=!1}}},352960:function(e,t,i){"use strict";i.d(t,{k:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){let{materials:i}=e,{videos:n}=i;for(let e=0;e<n.length;e++){let t=n[e],i=t.source_platform;(11===i||12===i||13===i||14===i)&&(t.is_copyright=!0)}return(0,r.oW)(e)}constructor(...e){super(...e),this.version="97.0.0",this.needEnumerateSubDrafts=!0}}},879856:function(e,t,i){"use strict";i.d(t,{S:function(){return o}});var r=i(108616),n=i(734755),a=i(214903);class o extends n.G{constructor(e,t){super({type:r.I.Upgrade,attachmentFileName:t,json:e,tasks:[new a.D]})}}},710879:function(e,t,i){"use strict";i.d(t,{S:function(){return a},m:function(){return o}});var r,n,a=((r={}).kSmoothSkinId="7106322605304451614",r.kBeautyId="6976822940608238093",r.kFaceBoxId="7198124349121892919",r.kSkinWhiteningId="6998408303826965006",r.kTeethWhiteningId="6998408263892996639",r.kRootPackId="7280056145232794113",r.kReshapeId="6976823053212717576",r.kReshapeMergeId="7126765507457323557",r.kBigEyesId="6998408219898941982",r.kSlimNoseId="6998408142216237575",r.kManualDeformationId="7108624513650135560",r.kSlimBodyId="6976812219048661540",r.kLongLegsId="6956089104412971534",r.kSlimWaistId="6976812120591569416",r.kSmallHeadId="6976812039847023111",r);var o=((n={}).kLevel1BeautyCategoryId="auto-beauty2",n.kLevel1BeautyBodyCategoryId="auto-beauty3",n.kLevel1BeautyReshapeCategoryId="auto-beauty",n.kLevel1BeautyMakeupCategoryId="makeup",n.kLevel2BeautyCategoryId="34949",n.kLevel2BeautyBodyCategoryId="34950",n.kLevel2BeautyReshapeCategoryId="39814",n)},637139:function(e,t,i){"use strict";i.d(t,{I:function(){return n},U:function(){return a}});var r=i(690613);class n{}class a{getContext(e){return{draft:e}}repair(e){let t=(0,r.oW)(this.getContext(e));for(let e of this.tasks){if(!t.ok)break;t=e.repair(t.value)}return t.ok?(0,r.oW)(t.value.draft):t}}},12826:function(e,t,i){"use strict";i.d(t,{h:function(){return a},j:function(){return n}});var r=i(637139);let n=r.I;class a extends r.U{constructor(e){super(),this.tasks=[],this.tasks=e}}},10669:function(e,t,i){"use strict";i.d(t,{$:function(){return a}});var r=i(690613),n=i(12826);class a extends n.j{repair(e){var t,i,n;let{draft:a}=e;if(!(null===(t=a.materials)||void 0===t?void 0:t.placeholders)||!a.tracks||!Array.isArray(null===(i=a.materials)||void 0===i?void 0:i.placeholders)||!Array.isArray(a.tracks))return(0,r.oW)(e);let o=new Set(a.materials.placeholders.map(e=>null==e?void 0:e.id).filter(Boolean));for(let e of a.tracks){if(!(null==e?void 0:e.segments)||!Array.isArray(null==e?void 0:e.segments))continue;let t=e.segments.length;for(;t--;){let i=e.segments[t];(null==i?void 0:i.id)==="cover_placeholder_video_id"&&(null===(n=i.extra_material_refs)||void 0===n?void 0:n.some(e=>o.has(e)))&&e.segments.splice(t,1)}}return(0,r.oW)(e)}}},135454:function(e,t,i){"use strict";i.d(t,{x:function(){return l}});var r=i(912224),n=i(481631),a=i(234396),o=i(690613),s=i(211561);class l extends a.K{repair(e){let{draft:t}=e;switch(this.getRenderIndexMode(t)){case s.IDM.RenderIndexModeDefault:t.property.renderIndexTrackModeOn=!0,t.property.freeRenderIndexModeOn=!1,r.eK.prototype.rebuildTrackFromRenderIndex(t);break;case s.IDM.RenderIndexModeFree:t.property.renderIndexTrackModeOn=!0,t.property.freeRenderIndexModeOn=!1,r.eK.prototype.buildTrackRenderIndexFromUniqueRenderIndex(t);break;case s.IDM.RenderIndexModeSyncTrack:return(0,o.oW)(e);default:console.error("not allowed to set RenderIndexTrackMode back to default")}for(let e of t.getAllSegments())(0,n.he)(e)&&e.material.type===s.cVg.MetaTypeVideo&&e.materialDraft&&this.repair({draft:e.materialDraft.draft});return(0,o.oW)(e)}getRenderIndexMode(e){return e.property.renderIndexTrackModeOn?s.IDM.RenderIndexModeSyncTrack:e.property.freeRenderIndexModeOn?s.IDM.RenderIndexModeFree:s.IDM.RenderIndexModeDefault}}},528052:function(e,t,i){"use strict";i.d(t,{e:function(){return o}});var r=i(481631),n=i(690613),a=i(234396);class o extends a.K{repair(e){let{draft:t}=e,i=t.getMainTrack();if(null==i?void 0:i.segments.length){let e=i.segments[i.segments.length-1];(0,r.MR)(e)&&(i.segments.pop(),t.metadata.duration=t.getDraftDuration())}return(0,n.oW)(e)}}},198160:function(e,t,i){"use strict";i.d(t,{T:function(){return a}});var r=i(690613),n=i(234396);class a extends n.K{repair(e){let{draft:t}=e;return t.tracks.forEach(e=>{var t;null===(t=e.segments)||void 0===t||t.forEach(e=>{e.targetTimerange.start<0&&(e.targetTimerange.start=0n)})}),(0,r.oW)(e)}}},417273:function(e,t,i){"use strict";i.d(t,{Tl:function(){return w},pN:function(){return k}});var r=i(150251),n=i(645869),a=i(283751),o=i(280700),s=i(89172),l=i(426336),d=i(481631),u=i(669686),c=i(194460),p=i(410256),m=i(361708),h=i(329410),g=i(825245),f=i(508962),y=i(524595),_=i(534418),v=i(859874),I=i(340294),T=i(549480);let x=new Set(["metadata","property","tracks","groupContainer"]);class k extends p.v{static deserialize(e){let t=new k;return t.recovery(l.dlq.deserialize(e)),t}static serialize(e){return l.dlq.serialize(e.archive())}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new k;return t.tracks=this.tracks.map(t=>t.clone(e)),t.property=this.property.clone(e),t.metadata=this.metadata.clone(e),t.groupContainer=this.groupContainer?this.groupContainer.clone(e):void 0,t}_initSetting(){Object.defineProperties(this,{__utils__:{enumerable:!1},__quick__query__:{enumerable:!1}})}updateAiCreator(e){a.T.merge(this.aiCreator,e)}reset(){let e=new k;this.tracks=e.tracks,this.metadata=e.metadata,this.property=e.property,this.property.renderIndexTrackModeOn=!0,this.groupContainer=e.groupContainer,this.subDraftMap=e.subDraftMap,this.attachmentAsyncTask=e.attachmentAsyncTask,this.attachmentVideoAlgorithms=e.attachmentVideoAlgorithms,this.attachmentAiWriter=e.attachmentAiWriter,this.attachmentAiStory=e.attachmentAiStory,this._resetProperty()}create(e){var t;this.reset(),(null==e?void 0:null===(t=e.customRuntimeRepairTasks)||void 0===t?void 0:t.length)&&e.customRuntimeRepairTasks.forEach(e=>e.repair({draft:this}))}recovery(e,t){let i=n.T.toModel(e);this.tracks=i.tracks,this.metadata=i.metadata,this.property=i.property,this.groupContainer=i.groupContainer,this.__quick__query__.clear(),(0,f.fl)(this,t),this.property.renderIndexTrackModeOn=!0,this._resetProperty(),this._updateSubDraftMap(this)}archive(){let e=n.T.toDraft(this);return(0,f.MC)(e),e.lastModifiedPlatform=new l.t4T({appId:348188n,os:"web",osVersion:"",appVersion:s.Ww,appSource:"",deviceId:"",hardDiskId:"",macAddress:""}),e}recoveryAttachmentAsyncTask(e){this.attachmentAsyncTask=n.T.toModelAttachmentAsyncTask(e)}archiveAttachmentVideoAlgorithms(){return n.T.toPersistentAttachmentVideoAlgorithms(this.attachmentVideoAlgorithms)}recoveryAttachmentVideoAlgorithm(e){this.attachmentVideoAlgorithms=n.T.toModelAttachmentVideoAlgorithms(e)}archiveAttachmentAiWriter(){return n.T.toPersistentAttachmentAiWriter(this.attachmentAiWriter)}recoveryAttachmentAiWriter(e){this.attachmentAiWriter=n.T.toModelAttachmentAiWriter(e)}archiveAttachmentAsyncTask(){return n.T.toPersistentAttachmentAsyncTask(this.attachmentAsyncTask)}recoveryAttachmentAiStory(e){this.attachmentAiStory=v.c.deserialize(e)}archiveAttachmentAiStory(){return this.attachmentAiStory.archive()}setDraftId(e){this.metadata.id=e,this._updateSubDraftMap(this)}setDraftUpdateTime(e){this.metadata.updateTime=1000n*BigInt(e)}getDraftById(e){return e&&e!==this.getDraftId()?this.subDraftMap.get(e):this}setDraftName(e){this.property.name=e}updateMetadata(e){let t=new l.UKb;return a.T.merge(this.metadata,e,t),t}updateProperty(e){let t=new l.ryY;return a.T.merge(this.property,e,t),t}updateGroupContainer(e){e?(!this.groupContainer&&(this.groupContainer=new l.Fly),a.T.merge(this.groupContainer,e,new l.k_B)):delete this.groupContainer}insertTrack(e,t){this.tracks.splice(e,0,t),this._resetProperty()}deleteTrack(e){let t=this.tracks.findIndex(t=>t.id===e);this.tracks[t].segments.forEach(e=>{this.__quick__query__.has(e.id)&&this.__quick__query__.delete(e.id)}),this.tracks.splice(t,1),this._updateDraftDuration(),this._resetProperty()}updateTrack(e,t){let i=this.getTrackById(e);for(let e of(a.T.merge(i,t,new l.C4B),(null==i?void 0:i.segments)||[])){let t=(0,d.xX)({__segment_struct_type:e.__segment_struct_type});t.trackAttribute=i.attribute,this.updateSegment(i.id,e.id,t)}this.setDraftUpdateTime(Date.now())}moveTrack(e,t){let i=this.tracks.splice(e,1)[0];this.tracks.splice(t,0,i),this._resetProperty()}moveSegments(e,t,i,r){if(e.length!==r.length)return;let n=[];for(let i=0;i<e.length;i++){let a=this.getSegmentById(e[i]);if(!a)return;this.deleteSegment(this.tracks[t].id,a.id),a.targetTimerange=r[i],n.push(a)}for(let e of n)this.insertSegment(this.tracks[i].id,e);this._resetProperty()}updateSubDraftMap(e,t){this._updateSubDraftMap(e,t)}getSegmentByTrackIdAndSegmentId(e,t){let i=this.getTrackById(e);if(!!i)return i.segments.find(e=>e.id===t)}insertSegment(e,t){let i=this.getTrackById(e);t.trackAttribute=i.attribute;let r=(0,o.tE)(i,t,{fps:this.property.fps});i.segments.splice(r,0,t),this._batchUpdateSegmentTargetTimerange(i,r),this._updateDraftDuration(),this._resetProperty(),m.b.isCombination(t)&&this._updateSubDraftMap(t.materialDraft.draft)}deleteSegment(e,t){let i=this.getTrackById(e),r=this.getSegmentIndexByTrackIdAndSegmentId(e,t);(0,c.y)(this,t);let n=i.segments.splice(r,1)[1];this.property.maintrackAdsorb&&(this._batchUpdateSegmentTargetTimerange(i,r),this._updateDraftDuration()),m.b.isCombination(n)&&this._updateSubDraftMap(n.materialDraft.draft,!0),this.setDraftUpdateTime(Date.now()),this.__quick__query__.has(t)&&this.__quick__query__.delete(t)}updateSegment(e,t,i){let r=this.getSegmentByTrackIdAndSegmentId(e,t),n=i.clone();a.T.merge(r,i,n);let o=this.getTrackById(e);o.segments.sort((e,t)=>I.pM.minus(e.targetTimerange.start,t.targetTimerange.start,"number"));let s=this.getSegmentIndexByTrackIdAndSegmentId(e,t);return this._batchUpdateSegmentTargetTimerange(o,s),this._updateDraftDuration(),m.b.isCombination(r)&&this._updateSubDraftMap(r.materialDraft.draft),this.setDraftUpdateTime(Date.now()),n}_resetProperty(){this._resetTrackRenderIndex(),this.setDraftUpdateTime(Date.now())}_batchUpdateSegmentTargetTimerange(e,t){if(!(0,o.MD)(e)){this._batchUpdateSegmentTargetTimerangeOfSecondaryTrack(e,t);return}let{segments:i}=e,r=0===t?0n:i[t-1].targetTimerange.start+i[t-1].targetTimerange.duration;for(let e=t;e<i.length;e++)i[e].targetTimerange.start=r,r+=i[e].targetTimerange.duration}_batchUpdateSegmentTargetTimerangeOfSecondaryTrack(e,t){let{segments:i}=e;if(t>=i.length-1)return;let r=i[t],n=r.targetTimerange.start+r.targetTimerange.duration,a=n-i[t+1].targetTimerange.start;if(a>0n)for(let e=t+1;e<i.length;e++)i[e].targetTimerange.start+=a}_resetTrackRenderIndex(){this.tracks.forEach((e,t)=>{if(e.type===l.pNd.TrackTypeAudio||e.type===l.pNd.TrackTypeTextToVideoTextAudio)return;let i=e.segments;if(!i.length)return;let r=!1;for(let n of(this.isMainTrack(e)&&(r=!0),i)){if((0,d.he)(n)&&r){n.trackRenderIndex=0;continue}n.trackRenderIndex=t}})}_updateDraftDuration(){let e=0n;this.tracks.forEach(t=>{if(0===t.segments.length)return;let i=t.segments[t.segments.length-1],r=i.targetTimerange.start+i.targetTimerange.duration;r>e&&(e=r)}),this.metadata.duration=e}_updateSubDraftMap(e,t){if(!!e)for(let i of this.collectSubDraft(e))t?this.subDraftMap.delete(i.getDraftId()):this.subDraftMap.set(i.getDraftId(),i)}constructor(){super(),this[r.I9]=w,this.metadata=new l.UYj,this.property=new l.Uwl,this.tracks=[],this.subDraftMap=new Map,this.attachmentAsyncTask=new g.i,this.attachmentVideoAlgorithms=new y.c,this.attachmentAiWriter=new _.b,this.attachmentAiStory=new v.c,this.aiCreator=new T.Dc,this.__utils__=new h.Z(this),this.__quick__query__=new Map,this._initSetting()}}class w extends r.u2{static deserialize(e){let t=new k;return t.recovery(l.dlq.deserialize(e)),t}static serialize(e){let t=new k;return e.metadata&&(t.metadata=e.metadata),e.property&&(t.property=e.property),e.groupContainer&&(t.groupContainer=e.groupContainer),e.tracks&&(t.tracks=e.tracks),l.dlq.serialize(t.archive())}archive(){let e=n.T.toDraft(this);return(0,f.MC)(e),e.lastModifiedPlatform=new l.t4T({appId:348188n,os:"web",osVersion:"",appVersion:s.Ww,appSource:"",deviceId:"",hardDiskId:"",macAddress:""}),e}clone(){var e,t,i,r;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=new w;return a.tracks=null===(e=a.tracks)||void 0===e?void 0:e.map(e=>e.clone(n)),a.property=null===(t=a.property)||void 0===t?void 0:t.clone(n),a.metadata=null===(i=a.metadata)||void 0===i?void 0:i.clone(n),a.groupContainer=null==a?void 0:null===(r=a.groupContainer)||void 0===r?void 0:r.clone(n),a}constructor(e={}){super(),this[r._n]=k,(0,u.fZ)(this,e,x)}}},124157:function(e,t,i){"use strict";i.d(t,{wG:function(){return s}});var r=i(669686),n=i(150251);let a={common:["music_id","is_original"],bigint:{target_start_time:{},source_start_time:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.musicId="",this.targetStartTime=0n,this.sourceStartTime=0n,this.isOriginal=!1,(0,r.tZ)(this,e,o)}}let l={common:["music_id","is_original"],bigint:{target_start_time:{},source_start_time:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},184617:function(e,t,i){"use strict";i.d(t,{G9:function(){return d}});var r=i(602777),n=i(669686),a=i(150251),o=i(128263);let s={common:["prompt","algorithm_id","algorithm_type","ratio","path"],object:{matting_infos:{type:()=>o.Hs}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=p,this.prompt="",this.algorithmId="",this.algorithmType=r.zz.AlgorithmDefault,this.ratio=r.rx.CanvasRatioOriginal,this.path="",this.mattingInfos=new o.Hs,(0,n.tZ)(this,e,l)}}let u={common:["prompt","algorithm_id","algorithm_type","ratio","path"],object:{matting_infos:{type:()=>o.Mu}}},c=(0,n.I2)(u,[]);class p extends a.u2{static deserialize(e){let t=new p;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,c)}}},689127:function(e,t,i){"use strict";i.d(t,{V7:function(){return s},uB:function(){return u}});var r=i(669686),n=i(150251);let a={common:["theme","style_name","style_id","auto_highlight"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.theme="",this.styleName="",this.styleId="",this.autoHighlight="",(0,r.tZ)(this,e,o)}}let l={common:["theme","style_name","style_id","auto_highlight"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},94493:function(e,t,i){"use strict";i.d(t,{Zd:function(){return s}});var r=i(669686),n=i(150251);let a={common:["text_material_id","recommend_segment_id","extra"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.textMaterialId="",this.recommendSegmentId="",this.extra="",(0,r.tZ)(this,e,o)}}let l={common:["text_material_id","recommend_segment_id","extra"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},558515:function(e,t,i){"use strict";i.d(t,{I8:function(){return d},vY:function(){return p}});var r=i(602777),n=i(669686),a=i(150251),o=i(187200);let s={common:["local_task_id","server_task_id","batch_task_id","draft_id","type","submit_type","algo_type","status","detail_info","request_payload","context","attachment_params","result_payload","token","enter_from","err_code","err_msg","sub_type","can_queue","task_version","req_key","request_extra","poll_scene","prepare_resource_time","server_stage"],bigint:{duration:{},create_time:{},in_queue_amount:{},in_queue_time:{},in_queue_time_ms:{},expect_cost_time:{},first_request_time:{},next_request_time:{},pre_create_expect_cost_time:{}},object:{benefit_info:{type:()=>o.mx}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=p,this.localTaskId="",this.serverTaskId="",this.batchTaskId="",this.draftId="",this.type=r.eL.NoneValue,this.submitType=r.eL.NoneValue,this.algoType=0,this.status=r.fv.initial,this.detailInfo="",this.requestPayload="",this.benefitInfo=new o.mx,this.context="",this.attachmentParams="",this.resultPayload="",this.duration=0n,this.createTime=0n,this.inQueueAmount=0n,this.inQueueTime=0n,this.inQueueTimeMs=0n,this.expectCostTime=0n,this.firstRequestTime=0n,this.nextRequestTime=0n,this.token="",this.preCreateExpectCostTime=0n,this.enterFrom="edit_draft",this.errCode=0,this.errMsg="",this.subType=0,this.canQueue=!1,this.taskVersion="",this.reqKey="",this.requestExtra="",this.pollScene=0,this.prepareResourceTime=0,this.serverStage="",(0,n.tZ)(this,e,l)}}let u={common:["local_task_id","server_task_id","batch_task_id","draft_id","type","submit_type","algo_type","status","detail_info","request_payload","context","attachment_params","result_payload","token","enter_from","err_code","err_msg","sub_type","can_queue","task_version","req_key","request_extra","poll_scene","prepare_resource_time","server_stage"],bigint:{duration:{},create_time:{},in_queue_amount:{},in_queue_time:{},in_queue_time_ms:{},expect_cost_time:{},first_request_time:{},next_request_time:{},pre_create_expect_cost_time:{}},object:{benefit_info:{type:()=>o.Re}}},c=(0,n.I2)(u,[]);class p extends a.u2{static deserialize(e){let t=new p;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,c)}}},736788:function(e,t,i){"use strict";i.d(t,{Pg:function(){return s},ST:function(){return u}});var r=i(669686),n=i(150251);let a={common:["class_name","file_name"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.className="",this.fileName="",(0,r.tZ)(this,e,o)}}let l={common:["class_name","file_name"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},369776:function(e,t,i){"use strict";i.d(t,{jq:function(){return s}});var r=i(669686),n=i(150251);let a={common:["face_id","preset_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.faceId="",this.presetId="",(0,r.tZ)(this,e,o)}}let l={common:["face_id","preset_id"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},133314:function(e,t,i){"use strict";var r=i(669686);i(150251);var n=i(26195),a=i(223438);(0,r.I2)({array:{ai_packaging_infos:{type:"object",clsName:()=>n.SL}},object:{ai_packaging_report_info:{type:()=>a.Cn}}},[]);(0,r.I2)({array:{ai_packaging_infos:{type:"object",clsName:()=>n.SL}},object:{ai_packaging_report_info:{type:()=>a.sX}}},[])},467028:function(e,t,i){"use strict";i.d(t,{Lh:function(){return m},kT:function(){return u}});var r=i(669686),n=i(150251),a=i(303745),o=i(597109),s=i(76619);let l={common:["type","keywords_style","capital"],bigint:{fragment_duration:{}},object:{fragment_info:{type:()=>a.oR,nullable:!0},anims_info:{type:()=>o.m5,nullable:!0},keyword_extra_style:{type:()=>s.nt}}},d=(0,r.I2)(l,[]);class u extends n.w8{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=m,this.type="",this.fragmentDuration=0n,this.keywordsStyle="",this.keywordExtraStyle=new s.nt,this.capital="",(0,r.tZ)(this,e,d)}}let c={common:["type","keywords_style","capital"],bigint:{fragment_duration:{}},object:{fragment_info:{type:()=>a.pc,nullable:!0},anims_info:{type:()=>o.Fk,nullable:!0},keyword_extra_style:{type:()=>s.fy}}},p=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=u,(0,r.fZ)(this,e,p)}}},733017:function(e,t,i){"use strict";i.d(t,{Xc:function(){return l}});var r=i(669686),n=i(150251),a=i(760554);let o={common:["sync_direction_control"],object:{anchor:{type:()=>a.KS},left_control:{type:()=>a.KS},right_control:{type:()=>a.KS}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.syncDirectionControl=!0,this.anchor=new a.KS,this.leftControl=new a.KS,this.rightControl=new a.KS,(0,r.tZ)(this,e,s)}}let d={common:["sync_direction_control"],object:{anchor:{type:()=>a.Ly},left_control:{type:()=>a.Ly},right_control:{type:()=>a.Ly}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},5497:function(e,t,i){"use strict";i.d(t,{_X:function(){return p},yP:function(){return d}});var r=i(602777),n=i(669686),a=i(150251),o=i(548782);let s={common:["id","source_platform","name"],array:{speed_points:{type:"object",clsName:()=>o.nR}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=p,this.id="",this.sourcePlatform=r.nj.EffectPlatformLoki,this.name="",this.speedPoints=[],(0,n.tZ)(this,e,l)}}let u={common:["id","source_platform","name"],array:{speed_points:{type:"object",clsName:()=>o.nR}}},c=(0,n.I2)(u,[]);class p extends a.u2{static deserialize(e){let t=new p;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,c)}}},107001:function(e,t,i){"use strict";i.d(t,{am:function(){return s}});var r=i(669686),n=i(150251);let a={common:["segment_id","meta_type"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.segmentId="",this.metaType="",(0,r.tZ)(this,e,o)}}let l={common:["segment_id","meta_type"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},674413:function(e,t,i){"use strict";i.d(t,{P2:function(){return c},zG:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["type","value","image_id","source_platform"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=c,this.type=r.cV.MetaTypeNone,this.value="",this.imageId="",this.sourcePlatform=r.nj.EffectPlatformLoki,(0,n.tZ)(this,e,s)}}let d={common:["type","value","image_id","source_platform"]},u=(0,n.I2)(d,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,u)}}},640999:function(e,t,i){"use strict";i.d(t,{Xl:function(){return s}});var r=i(669686),n=i(150251);let a={common:["key","value"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.key="",this.value=0,(0,r.tZ)(this,e,o)}}let l={common:["key","value"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},41750:function(e,t,i){"use strict";i.d(t,{r8:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["panel","path","resource_id","source_platform"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=c,this.panel="",this.path="",this.resourceId="",this.sourcePlatform=r.nj.EffectPlatformLoki,(0,n.tZ)(this,e,s)}}let d={common:["panel","path","resource_id","source_platform"]},u=(0,n.I2)(d,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,u)}}},855274:function(e,t,i){"use strict";i.d(t,{Lr:function(){return u},Zm:function(){return s}});var r=i(669686),n=i(150251);let a={common:["driver_video_path","output_path","req_key","origin_material_width","origin_material_height"],bigint:{driver_video_duration:{},origin_material_duration:{},origin_target_duration:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.driverVideoPath="",this.driverVideoDuration=0n,this.outputPath="",this.reqKey="",this.originMaterialDuration=0n,this.originMaterialWidth=0,this.originMaterialHeight=0,this.originTargetDuration=0n,(0,r.tZ)(this,e,o)}}let l={common:["driver_video_path","output_path","req_key","origin_material_width","origin_material_height"],bigint:{driver_video_duration:{},origin_material_duration:{},origin_target_duration:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},590466:function(e,t,i){"use strict";i.d(t,{Or:function(){return u},zs:function(){return s}});var r=i(669686),n=i(150251);let a={common:["intensity","x","y","width","height","rotation"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.intensity=0,this.x=.5,this.y=.5,this.width=.33,this.height=.33,this.rotation=0,(0,r.tZ)(this,e,o)}}let l={common:["intensity","x","y","width","height","rotation"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},159088:function(e,t,i){"use strict";i.d(t,{$t:function(){return l},ir:function(){return c}});var r=i(669686),n=i(150251),a=i(475034);let o={common:["text"],bigint:{start_time:{},end_time:{}},array:{words:{type:"object",clsName:()=>a.IR},keyword_ranges:{type:"common"}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.text="",this.startTime=0n,this.endTime=0n,this.words=[],this.keywordRanges=[],(0,r.tZ)(this,e,s)}}let d={common:["text"],bigint:{start_time:{},end_time:{}},array:{words:{type:"object",clsName:()=>a.IR},keyword_ranges:{type:"common"}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},379748:function(e,t,i){"use strict";i.d(t,{Q3:function(){return l}});var r=i(669686),n=i(150251),a=i(53823);let o={common:["lyric_track_id","is_global"],object:{video_effect:{type:()=>a.XX}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.lyricTrackId=0,this.videoEffect=new a.XX,this.isGlobal=!0,(0,r.tZ)(this,e,s)}}let d={common:["lyric_track_id","is_global"],object:{video_effect:{type:()=>a.Ev}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},905940:function(e,t,i){"use strict";i.d(t,{un:function(){return s}});var r=i(669686),n=i(150251);let a={common:["face_id","vertex_list_name"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.faceId=-1,this.vertexListName="",(0,r.tZ)(this,e,o)}}let l={common:["face_id","vertex_list_name"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},757327:function(e,t,i){"use strict";i.d(t,{KT:function(){return d},lM:function(){return p}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","type","fade_type"],bigint:{fade_in_duration:{},fade_out_duration:{}}},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=p,this.id=(0,n.p)(),this.type=r.cV.MetaTypeAudioFade,this.fadeType=0,this.fadeInDuration=0n,this.fadeOutDuration=0n,(0,a.tZ)(this,e,l)}}let u={common:["id","type","fade_type"],bigint:{fade_in_duration:{},fade_out_duration:{}}},c=(0,a.I2)(u,[]);class p extends o.u2{static deserialize(e){let t=new p;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,c)}}},956156:function(e,t,i){"use strict";i.d(t,{Pr:function(){return p},tU:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","type","audio_channel_mapping","is_config_open"]},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=p,this.id=(0,n.p)(),this.type=r.cV.MetaTypeChannelMapping,this.audioChannelMapping=0,this.isConfigOpen=!1,(0,a.tZ)(this,e,l)}}let u={common:["id","type","audio_channel_mapping","is_config_open"]},c=(0,a.I2)(u,[]);class p extends o.u2{static deserialize(e){let t=new p;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,c)}}},398163:function(e,t,i){"use strict";i.d(t,{vI:function(){return u},yF:function(){return m}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(733017);let l={common:["id","type","panel","resource_id","source_platform","path","lumi_hub_path"],array:{luma:{type:"object",clsName:()=>s.Xc},red:{type:"object",clsName:()=>s.Xc},green:{type:"object",clsName:()=>s.Xc},blue:{type:"object",clsName:()=>s.Xc}}},d=(0,a.I2)(l,[]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.type=r.cV.MetaTypeColorCurves,this.panel="",this.resourceId="",this.sourcePlatform=r.nj.EffectPlatformLoki,this.path="",this.luma=[],this.red=[],this.green=[],this.blue=[],this.lumiHubPath="",(0,a.tZ)(this,e,d)}}let c={common:["id","type","panel","resource_id","source_platform","path","lumi_hub_path"],array:{luma:{type:"object",clsName:()=>s.Xc},red:{type:"object",clsName:()=>s.Xc},green:{type:"object",clsName:()=>s.Xc},blue:{type:"object",clsName:()=>s.Xc}}},p=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,p)}}},801927:function(e,t,i){"use strict";i.d(t,{jk:function(){return d}});var r=i(287165),n=i(669686),a=i(150251),o=i(653094);let s={common:["id","segment_id"],array:{refs:{type:"object",clsName:()=>o.XK}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[a.I9]=p,this.id=(0,r.p)(),this.segmentId="",this.refs=[],(0,n.tZ)(this,e,l)}}let u={common:["id","segment_id"],array:{refs:{type:"object",clsName:()=>o.XK}}},c=(0,n.I2)(u,[]);class p extends a.u2{static deserialize(e){let t=new p;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,n.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,c)}}},29709:function(e,t,i){"use strict";i.d(t,{NT:function(){return m},r0:function(){return u}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(180942);let l={common:["type","id","seg_id","plugin_id","plugin_version","effect_name","dir_name","effect_params"],object:{time_range:{type:()=>s.tn,nullable:!0},apply_time_range:{type:()=>s.tn,nullable:!0}}},d=(0,a.I2)(l,[]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.type=r.cV.MetaTypePluginEffect,this.id=(0,n.p)(),this.pluginId="",this.pluginVersion="",this.effectName="",this.dirName="",this.effectParams="",(0,a.tZ)(this,e,d)}}let c={common:["type","id","seg_id","plugin_id","plugin_version","effect_name","dir_name","effect_params"],object:{time_range:{type:()=>s.ze,nullable:!0},apply_time_range:{type:()=>s.ze,nullable:!0}}},p=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,p)}}},2995:function(e,t,i){"use strict";i.d(t,{XE:function(){return m},vx:function(){return u}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(245062);let l={common:["id","type","shape_type","global_alpha","color","border_line_style","border_width","border_color","shadow_color","shadow_alpha","shadow_distance","shadow_angle","check_flag","name"],array:{roundness:{type:"common"},custom_points:{type:"common"},shape_size:{type:"common"}},object:{combo_info:{type:()=>s.$y}}},d=(0,a.I2)(l,[]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.type=r.cV.MetaTypeShape,this.shapeType=0,this.roundness=[],this.customPoints=[],this.shapeSize=[],this.globalAlpha=1,this.color="",this.borderLineStyle=0,this.borderWidth=0,this.borderColor="",this.shadowColor="",this.shadowAlpha=.8,this.shadowDistance=0,this.shadowAngle=0,this.checkFlag=1,this.name="",this.comboInfo=new s.$y,(0,a.tZ)(this,e,d)}}let c={common:["id","type","shape_type","global_alpha","color","border_line_style","border_width","border_color","shadow_color","shadow_alpha","shadow_distance","shadow_angle","check_flag","name"],array:{roundness:{type:"common"},custom_points:{type:"common"},shape_size:{type:"common"}},object:{combo_info:{type:()=>s.PZ}}},p=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,p)}}},217381:function(e,t,i){"use strict";i.d(t,{FM:function(){return c},Mw:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(200322),l=i(937998);let d={common:["id","type","result_path","map_path","version","tracker_type","enable_scale","enable_relative_distance","tracking_time_range","enable_video_tracking"],array:{trackers:{type:"object",clsName:()=>l.es}},object:{config:{type:()=>s.d4}}},u=(0,a.I2)(d,[]);class c extends o.w8{static deserialize(e){let t=new c;return(0,a.Tz)(t,e,d),t}static serialize(e){return(0,a.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,a.he)(this,t,d,e,["id"]),t}constructor(e={}){super(),this[o.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeVideoTracking,this.resultPath="",this.mapPath="",this.config=new s.d4,this.version="",this.trackerType=0,this.enableScale=!1,this.enableRelativeDistance=!1,this.trackingTimeRange=0,this.trackers=[],this.enableVideoTracking=!0,(0,a.tZ)(this,e,u)}}let p={common:["id","type","result_path","map_path","version","tracker_type","enable_scale","enable_relative_distance","tracking_time_range","enable_video_tracking"],array:{trackers:{type:"object",clsName:()=>l.es}},object:{config:{type:()=>s.hd}}},m=(0,a.I2)(p,[]);class h extends o.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,p,!0),t}static serialize(e){return(0,a.o8)(e,p,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,p,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=c,(0,a.fZ)(this,e,m)}}},563091:function(e,t,i){"use strict";i.d(t,{K2:function(){return k},Ub:function(){return I}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(984736),l=i(757327),d=i(156447),u=i(730174),c=i(487253),p=i(445803),m=i(139310),h=i(365013),g=i(560689),f=i(21431),y=i(369776);let _={common:["id","type","path","media_path","local_id","has_audio","reverse_path","intensifies_path","reverse_intensifies_path","intensifies_audio_path","cartoon_path","width","height","category_id","category_name","material_id","material_name","material_url","crop_ratio","crop_scale","extra_type_option","source","source_platform","formula_id","check_flag","is_unified_beauty_mode","picture_from","picture_set_category_id","picture_set_category_name","team_id","local_material_id","origin_material_id","request_id","has_sound_separated","is_text_edit_overdub","is_ai_generate_content","aigc_type","is_copyright","aigc_history_id","aigc_item_id","local_material_from","beauty_body_preset_id","live_photo_cover_path"],bigint:{duration:{},live_photo_timestamp:{}},array:{beauty_face_preset_infos:{type:"object",clsName:()=>y.jq}},object:{crop:{type:()=>s.oI},audio_fade:{type:()=>l.KT,nullable:!0},stable:{type:()=>d.IB},matting:{type:()=>u.v5},video_algorithm:{type:()=>c.PO},object_locked:{type:()=>p.WN,nullable:!0},smart_motion:{type:()=>m.dY,nullable:!0},multi_camera_info:{type:()=>h.k1,nullable:!0},freeze:{type:()=>g.oy,nullable:!0},smart_match_info:{type:()=>f.lb,nullable:!0}}},v=(0,a.I2)(_,[]);class I extends o.w8{static deserialize(e){let t=new I;return(0,a.Tz)(t,e,_),t}static serialize(e){return(0,a.o8)(e,_)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new I;return(0,a.he)(this,t,_,e,["id"]),t}constructor(e={}){super(),this[o.I9]=k,this.id=(0,n.p)(),this.type=r.cV.MetaTypeNone,this.duration=0n,this.path="",this.mediaPath="",this.localId="",this.hasAudio=!0,this.reversePath="",this.intensifiesPath="",this.reverseIntensifiesPath="",this.intensifiesAudioPath="",this.cartoonPath="",this.width=0,this.height=0,this.categoryId="",this.categoryName="",this.materialId="",this.materialName="",this.materialUrl="",this.crop=new s.oI,this.cropRatio="free",this.cropScale=1,this.extraTypeOption=0,this.stable=new d.IB,this.matting=new u.v5,this.source=r.CH.MaterialSourceDefault,this.sourcePlatform=r.cv.MaterialPlatformDefault,this.formulaId="",this.checkFlag=65535,this.videoAlgorithm=new c.PO,this.isUnifiedBeautyMode=!1,this.pictureFrom=r.v.PictureFromNone,this.pictureSetCategoryId="",this.pictureSetCategoryName="",this.teamId="",this.localMaterialId="",this.originMaterialId="",this.requestId="",this.hasSoundSeparated=!1,this.isTextEditOverdub=!1,this.isAiGenerateContent=!1,this.aigcType=r.Eg.AIGCTypeNone,this.isCopyright=!1,this.aigcHistoryId="",this.aigcItemId="",this.localMaterialFrom="",this.beautyBodyPresetId="",this.livePhotoTimestamp=-1n,this.livePhotoCoverPath="",(0,a.tZ)(this,e,v)}}let T={common:["id","type","path","media_path","local_id","has_audio","reverse_path","intensifies_path","reverse_intensifies_path","intensifies_audio_path","cartoon_path","width","height","category_id","category_name","material_id","material_name","material_url","crop_ratio","crop_scale","extra_type_option","source","source_platform","formula_id","check_flag","is_unified_beauty_mode","picture_from","picture_set_category_id","picture_set_category_name","team_id","local_material_id","origin_material_id","request_id","has_sound_separated","is_text_edit_overdub","is_ai_generate_content","aigc_type","is_copyright","aigc_history_id","aigc_item_id","local_material_from","beauty_body_preset_id","live_photo_cover_path"],bigint:{duration:{},live_photo_timestamp:{}},array:{beauty_face_preset_infos:{type:"object",clsName:()=>y.jq}},object:{crop:{type:()=>s.V_},audio_fade:{type:()=>l.lM,nullable:!0},stable:{type:()=>d.un},matting:{type:()=>u.zh},video_algorithm:{type:()=>c.OH},object_locked:{type:()=>p.Bn,nullable:!0},smart_motion:{type:()=>m.X$,nullable:!0},multi_camera_info:{type:()=>h.BQ,nullable:!0},freeze:{type:()=>g.Zv,nullable:!0},smart_match_info:{type:()=>f.cf,nullable:!0}}},x=(0,a.I2)(T,[]);class k extends o.u2{static deserialize(e){let t=new k;return(0,a.Tz)(t,e,T,!0),t}static serialize(e){return(0,a.o8)(e,T,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new k;return(0,a.he)(this,t,T,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=I,(0,a.fZ)(this,e,x)}}},674685:function(e,t,i){"use strict";i.d(t,{WJ:function(){return s}});var r=i(669686),n=i(150251);let a={common:["text"],bigint:{start:{},end:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.text="",this.start=0n,this.end=0n,(0,r.tZ)(this,e,o)}}let l={common:["text"],bigint:{start:{},end:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},166234:function(e,t,i){"use strict";i.d(t,{BC:function(){return c}});var r=i(669686),n=i(150251),a=i(318284),o=i(303220),s=i(724776),l=i(569230);let d={common:["chapter_name"],bigint:{chapter_id:{},total_duration:{}},array:{action_list:{type:"common"},short_text_list:{type:"object",clsName:()=>o.hN},video_infos:{type:"object",clsName:()=>s.U$},highlights:{type:"object",clsName:()=>l.hi}},object:{short_text:{type:()=>a.VG}}},u=(0,r.I2)(d,[]);class c extends n.w8{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d),t}static serialize(e){return(0,r.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e),t}constructor(e={}){super(),this[n.I9]=h,this.chapterName="",this.actionList=[],this.chapterId=0n,this.totalDuration=0n,this.shortText=new a.VG,this.shortTextList=[],this.videoInfos=[],this.highlights=[],(0,r.tZ)(this,e,u)}}let p={common:["chapter_name"],bigint:{chapter_id:{},total_duration:{}},array:{action_list:{type:"common"},short_text_list:{type:"object",clsName:()=>o.hN},video_infos:{type:"object",clsName:()=>s.U$},highlights:{type:"object",clsName:()=>l.hi}},object:{short_text:{type:()=>a.r6}}},m=(0,r.I2)(p,[]);class h extends n.u2{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,p,!0),t}static serialize(e){return(0,r.o8)(e,p,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,p,e,!1,!0),t}constructor(e={}){super(),this[n._n]=c,(0,r.fZ)(this,e,m)}}},431567:function(e,t,i){"use strict";i.d(t,{R8:function(){return s},f_:function(){return u}});var r=i(669686),n=i(150251);let a={common:["theme","style","music"],bigint:{video_duration:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.theme="",this.style="",this.videoDuration=0n,this.music="",(0,r.tZ)(this,e,o)}}let l={common:["theme","style","music"],bigint:{video_duration:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},776320:function(e,t,i){"use strict";i.d(t,{Lt:function(){return u},Qe:function(){return s}});var r=i(669686),n=i(150251);let a={common:["text"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.text="",(0,r.tZ)(this,e,o)}}let l={common:["text"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},303220:function(e,t,i){"use strict";i.d(t,{hN:function(){return s}});var r=i(669686),n=i(150251);let a={common:["text_template","text_rewrite"],bigint:{start:{},end:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.textTemplate="",this.textRewrite="",this.start=0n,this.end=0n,(0,r.tZ)(this,e,o)}}let l={common:["text_template","text_rewrite"],bigint:{start:{},end:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},351421:function(e,t,i){"use strict";i.d(t,{DP:function(){return s}});var r=i(669686),n=i(150251);let a={common:["material_id","chapter_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.materialId="",this.chapterId=0,(0,r.tZ)(this,e,o)}}let l={common:["material_id","chapter_id"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},167953:function(e,t,i){"use strict";i.d(t,{$D:function(){return p},W_:function(){return d}});var r=i(602777),n=i(669686),a=i(150251),o=i(851678);let s={common:["id","name","path","resource_id","source_platform","platform","category_id","category_name","request_id"],object:{bloom_params:{type:()=>o.zA,nullable:!0}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=p,this.id="",this.name="",this.path="",this.resourceId="",this.sourcePlatform=r.nj.EffectPlatformLoki,this.platform="all",this.categoryId="",this.categoryName="",this.requestId="",(0,n.tZ)(this,e,l)}}let u={common:["id","name","path","resource_id","source_platform","platform","category_id","category_name","request_id"],object:{bloom_params:{type:()=>o.Sv,nullable:!0}}},c=(0,n.I2)(u,[]);class p extends a.u2{static deserialize(e){let t=new p;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,c)}}},246870:function(e,t,i){"use strict";i.d(t,{Yl:function(){return u},Zy:function(){return s}});var r=i(669686),n=i(150251);let a={common:["is_image"],bigint:{start:{},duration:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.isImage=!1,this.start=0n,this.duration=0n,(0,r.tZ)(this,e,o)}}let l={common:["is_image"],bigint:{start:{},duration:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},188428:function(e,t,i){"use strict";i.d(t,{CR:function(){return c},K1:function(){return l}});var r=i(669686),n=i(150251),a=i(653094);let o={common:["segment_id"],array:{refs:{type:"object",clsName:()=>a.XK}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.segmentId="",this.refs=[],(0,r.tZ)(this,e,s)}}let d={common:["segment_id"],array:{refs:{type:"object",clsName:()=>a.XK}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},137414:function(e,t,i){"use strict";i.d(t,{fu:function(){return s}});var r=i(669686),n=i(150251);let a={common:["music_id","segment_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.musicId="",this.segmentId="",(0,r.tZ)(this,e,o)}}let l={common:["music_id","segment_id"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},232729:function(e,t,i){"use strict";i.d(t,{Lz:function(){return d}});var r=i(669686),n=i(150251),a=i(542099),o=i(350990);let s={common:["tips","framework"],array:{scenes:{type:"object",clsName:()=>o.xs}},object:{time_range:{type:()=>a.E_}}},l=(0,r.I2)(s,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=p,this.timeRange=new a.E_,this.tips="",this.framework="",this.scenes=[],(0,r.tZ)(this,e,l)}}let u={common:["tips","framework"],array:{scenes:{type:"object",clsName:()=>o.xs}},object:{time_range:{type:()=>a.q9}}},c=(0,r.I2)(u,[]);class p extends n.u2{static deserialize(e){let t=new p;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,c)}}},101506:function(e,t,i){"use strict";i.d(t,{$z:function(){return c},BH:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["level"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=c,this.level=r.Ci.HD,(0,n.tZ)(this,e,s)}}let d={common:["level"]},u=(0,n.I2)(d,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,u)}}},768047:function(e,t,i){"use strict";var r=i(669686);i(150251);var n=i(286524);(0,r.I2)({array:{recognize_tasks:{type:"object",clsName:()=>n.xs}}},[]);(0,r.I2)({array:{recognize_tasks:{type:"object",clsName:()=>n.xs}}},[])},86498:function(e,t,i){"use strict";i.d(t,{QS:function(){return s}});var r=i(669686),n=i(150251);let a={common:["music_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.musicId="",(0,r.tZ)(this,e,o)}}let l={common:["music_id"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},879584:function(e,t,i){"use strict";i.d(t,{HG:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","coverUrl","content","duration","cameraMovement","cameraMovementVid","fragmentType","vid"],array:{segment_ids:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.id="",this.coverUrl="",this.content="",this.duration=0,this.cameraMovement="",this.cameraMovementVid="",this.fragmentType="video",this.vid="",this.segmentIds=[],(0,r.tZ)(this,e,o)}}let l={common:["id","coverUrl","content","duration","cameraMovement","cameraMovementVid","fragmentType","vid"],array:{segment_ids:{type:"common"}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},829354:function(e,t,i){"use strict";i.d(t,{F9:function(){return u},PF:function(){return s}});var r=i(669686),n=i(150251);let a={common:["trend_word"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.trendWord="",(0,r.tZ)(this,e,o)}}let l={common:["trend_word"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},673118:function(e,t,i){"use strict";i.d(t,{CC:function(){return C},M_:function(){return b}});var r=i(602777),n=i(669686),a=i(150251),o=i(180942),s=i(254574),l=i(379012),d=i(280283),u=i(247795),c=i(528156),p=i(757327),m=i(290703),h=i(468699),g=i(372149),f=i(213030),y=i(956156),_=i(519348),v=i(67792),I=i(137234),T=i(132392),x=i(232524),k=i(53823);let w={extend:k.xV,common:["need_crossfade_in","need_crossfade_out","has_left_source_neighbour","has_right_source_neighbour"],bigint:{vocal_separation_version:{},vocal_beauty_version:{}},array:{voice_change:{type:"object",clsName:()=>c.Yy},keyframes:{type:"object",clsName:()=>g.as}},object:{source_timerange:{type:()=>o.tn},material:{type:()=>s.ZD},material_draft:{type:()=>l.Wu,nullable:!0},speed:{type:()=>d.Ug},placeholder_info:{type:()=>u.yu},fade:{type:()=>p.KT,nullable:!0},balance:{type:()=>m.Ld,nullable:!0},beat:{type:()=>h.hW,nullable:!0},realtime_denoise:{type:()=>f.jU,nullable:!0},sound_channel_mapping:{type:()=>y.tU},ai_translate:{type:()=>_.TA,nullable:!0},audio_track_index:{type:()=>v.Be,nullable:!0},loudness:{type:()=>I.o6,nullable:!0},vocal_beautify:{type:()=>T.jG,nullable:!0},vocal_separation:{type:()=>x.Jc}}},A=(0,n.I2)(w,[]);class b extends k.XX{static deserialize(e){let t=new b;return(0,n.Tz)(t,e,w),t}static serialize(e){return(0,n.o8)(e,w)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new b;return(0,n.he)(this,t,w,e,!0),t}constructor(e={}){super(e),this[a.I9]=C,this.__segment_struct_type=r.Oc.SegmentAudio,this.sourceTimerange=new o.tn,this.material=new s.ZD,this.speed=new d.Ug,this.placeholderInfo=new u.yu,this.needCrossfadeIn=!1,this.needCrossfadeOut=!1,this.hasLeftSourceNeighbour=!1,this.hasRightSourceNeighbour=!1,this.keyframes=[],this.soundChannelMapping=new y.tU,this.vocalSeparation=new x.Jc,this.vocalSeparationVersion=0n,this.vocalBeautyVersion=0n,(0,n.tZ)(this,e,A)}}let S={extend:k.FX,common:["need_crossfade_in","need_crossfade_out","has_left_source_neighbour","has_right_source_neighbour"],bigint:{vocal_separation_version:{},vocal_beauty_version:{}},array:{voice_change:{type:"object",clsName:()=>c.Yy},keyframes:{type:"object",clsName:()=>g.as}},object:{source_timerange:{type:()=>o.ze},material:{type:()=>s.yB},material_draft:{type:()=>l.rd,nullable:!0},speed:{type:()=>d.Zk},placeholder_info:{type:()=>u.XW},fade:{type:()=>p.lM,nullable:!0},balance:{type:()=>m.rE,nullable:!0},beat:{type:()=>h.NZ,nullable:!0},realtime_denoise:{type:()=>f.tp,nullable:!0},sound_channel_mapping:{type:()=>y.Pr},ai_translate:{type:()=>_.BJ,nullable:!0},audio_track_index:{type:()=>v.l,nullable:!0},loudness:{type:()=>I.fQ,nullable:!0},vocal_beautify:{type:()=>T.ck,nullable:!0},vocal_separation:{type:()=>x.HV}}},O=(0,n.I2)(S,[]);class C extends k.Ev{static deserialize(e){let t=new C;return(0,n.Tz)(t,e,S,!0),t}static serialize(e){return(0,n.o8)(e,S,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new C;return(0,n.he)(this,t,S,e,!0,!0),t}constructor(e={}){super(),this[a._n]=b,this.__segment_struct_type=r.Oc.SegmentAudio,(0,n.fZ)(this,e,O)}}},625107:function(e,t,i){"use strict";i.d(t,{$u:function(){return m},_$:function(){return u}});var r=i(602777),n=i(669686),a=i(150251),o=i(379012),s=i(53823);let l={extend:s.xV,object:{material:{type:()=>o.Wu}}},d=(0,n.I2)(l,[]);class u extends s.XX{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,l),t}static serialize(e){return(0,n.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,l,e,!0),t}constructor(e={}){super(e),this[a.I9]=m,this.__segment_struct_type=r.Oc.SegmentComposition,this.material=new o.Wu,(0,n.tZ)(this,e,d)}}let c={extend:s.FX,object:{material:{type:()=>o.rd}}},p=(0,n.I2)(c,[]);class m extends s.Ev{static deserialize(e){let t=new m;return(0,n.Tz)(t,e,c,!0),t}static serialize(e){return(0,n.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,n.he)(this,t,c,e,!0,!0),t}constructor(e={}){super(),this[a._n]=u,this.__segment_struct_type=r.Oc.SegmentComposition,(0,n.fZ)(this,e,p)}}},192716:function(e,t,i){"use strict";i.d(t,{M_:function(){return h},wS:function(){return c}});var r=i(602777),n=i(669686),a=i(150251),o=i(686513),s=i(445180),l=i(53823);let d={extend:l.xV,array:{keyframes:{type:"object",clsName:()=>s.Nl}},object:{material:{type:()=>o.eA}}},u=(0,n.I2)(d,[]);class c extends l.XX{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,d),t}static serialize(e){return(0,n.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,d,e,!0),t}constructor(e={}){super(e),this[a.I9]=h,this.__segment_struct_type=r.Oc.SegmentFilter,this.material=new o.eA,this.keyframes=[],(0,n.tZ)(this,e,u)}}let p={extend:l.FX,array:{keyframes:{type:"object",clsName:()=>s.Nl}},object:{material:{type:()=>o.W9}}},m=(0,n.I2)(p,[]);class h extends l.Ev{static deserialize(e){let t=new h;return(0,n.Tz)(t,e,p,!0),t}static serialize(e){return(0,n.o8)(e,p,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,n.he)(this,t,p,e,!0,!0),t}constructor(e={}){super(),this[a._n]=c,this.__segment_struct_type=r.Oc.SegmentFilter,(0,n.fZ)(this,e,m)}}},235369:function(e,t,i){"use strict";i.d(t,{HC:function(){return m},LZ:function(){return u}});var r=i(602777),n=i(669686),a=i(150251),o=i(29709),s=i(53823);let l={extend:s.xV,common:["apply_type","apply_segment_id"],object:{material:{type:()=>o.r0}}},d=(0,n.I2)(l,[]);class u extends s.XX{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,l),t}static serialize(e){return(0,n.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,l,e,!0),t}constructor(e={}){super(e),this[a.I9]=m,this.__segment_struct_type=r.Oc.SegmentPluginEffect,this.applyType=0,this.applySegmentId="",this.material=new o.r0,(0,n.tZ)(this,e,d)}}let c={extend:s.FX,common:["apply_type","apply_segment_id"],object:{material:{type:()=>o.NT}}},p=(0,n.I2)(c,[]);class m extends s.Ev{static deserialize(e){let t=new m;return(0,n.Tz)(t,e,c,!0),t}static serialize(e){return(0,n.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,n.he)(this,t,c,e,!0,!0),t}constructor(e={}){super(),this[a._n]=u,this.__segment_struct_type=r.Oc.SegmentPluginEffect,(0,n.fZ)(this,e,p)}}},29489:function(e,t,i){"use strict";i.d(t,{kp:function(){return f},pV:function(){return m}});var r=i(602777),n=i(669686),a=i(150251),o=i(238830),s=i(468634),l=i(232959),d=i(217381),u=i(53823);let c={extend:u.xV,object:{clip:{type:()=>o.bX},uniform_scale:{type:()=>s._p},material:{type:()=>l.WQ},video_tracking:{type:()=>d.FM,nullable:!0}}},p=(0,n.I2)(c,[]);class m extends u.XX{static deserialize(e){let t=new m;return(0,n.Tz)(t,e,c),t}static serialize(e){return(0,n.o8)(e,c)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,n.he)(this,t,c,e,!0),t}constructor(e={}){super(e),this[a.I9]=f,this.__segment_struct_type=r.Oc.SegmentTextTemplate,this.clip=new o.bX,this.uniformScale=new s._p,this.material=new l.WQ,(0,n.tZ)(this,e,p)}}let h={extend:u.FX,object:{clip:{type:()=>o.tL},uniform_scale:{type:()=>s.Rp},material:{type:()=>l._0},video_tracking:{type:()=>d.Mw,nullable:!0}}},g=(0,n.I2)(h,[]);class f extends u.Ev{static deserialize(e){let t=new f;return(0,n.Tz)(t,e,h,!0),t}static serialize(e){return(0,n.o8)(e,h,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,n.he)(this,t,h,e,!0,!0),t}constructor(e={}){super(),this[a._n]=m,this.__segment_struct_type=r.Oc.SegmentTextTemplate,(0,n.fZ)(this,e,g)}}},139310:function(e,t,i){"use strict";i.d(t,{X$:function(){return m},dY:function(){return u}});var r=i(669686),n=i(150251),a=i(662719),o=i(686513),s=i(874745);let l={common:["cache_path","beats_path","has_updated_keyframe","motion_enable","need_rebuild_keyframes"],array:{keyframes:{type:"object",clsName:()=>a.Hp}},object:{effect:{type:()=>o.eA,nullable:!0},motion_param:{type:()=>s.E$}}},d=(0,r.I2)(l,[]);class u extends n.w8{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=m,this.keyframes=[],this.cachePath="",this.beatsPath="",this.hasUpdatedKeyframe=!1,this.motionEnable=!1,this.needRebuildKeyframes=!1,this.motionParam=new s.E$,(0,r.tZ)(this,e,d)}}let c={common:["cache_path","beats_path","has_updated_keyframe","motion_enable","need_rebuild_keyframes"],array:{keyframes:{type:"object",clsName:()=>a.Hp}},object:{effect:{type:()=>o.W9,nullable:!0},motion_param:{type:()=>s.sr}}},p=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=u,(0,r.fZ)(this,e,p)}}},794554:function(e,t,i){"use strict";i.d(t,{Ac:function(){return l}});var r=i(669686),n=i(150251),a=i(734301);let o={common:["description","subtitle"],bigint:{group_id:{}},array:{shot_infos:{type:"object",clsName:()=>a.FY}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.groupId=0n,this.description="",this.subtitle="",this.shotInfos=[],(0,r.tZ)(this,e,s)}}let d={common:["description","subtitle"],bigint:{group_id:{}},array:{shot_infos:{type:"object",clsName:()=>a.FY}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},734301:function(e,t,i){"use strict";i.d(t,{FY:function(){return s}});var r=i(669686),n=i(150251);let a={common:["vid","material_id","video_caption","shot_id"],bigint:{start:{},end:{},highlight_start:{},highlight_end:{}},array:{highlight_scores:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.vid="",this.materialId="",this.start=0n,this.end=0n,this.highlightScores=[],this.videoCaption="",this.highlightStart=0n,this.highlightEnd=0n,this.shotId="",(0,r.tZ)(this,e,o)}}let l={common:["vid","material_id","video_caption","shot_id"],bigint:{start:{},end:{},highlight_start:{},highlight_end:{}},array:{highlight_scores:{type:"common"}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},689631:function(e,t,i){"use strict";i.d(t,{bq:function(){return l},hj:function(){return c}});var r=i(669686),n=i(150251),a=i(45854);let o={common:["chapter_cnt","auto_subtitle","auto_tts","template_id","draft_id"],object:{music_info:{type:()=>a.Fx}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.chapterCnt=0,this.autoSubtitle=!1,this.autoTts=!1,this.templateId="",this.draftId="",this.musicInfo=new a.Fx,(0,r.tZ)(this,e,s)}}let d={common:["chapter_cnt","auto_subtitle","auto_tts","template_id","draft_id"],object:{music_info:{type:()=>a.u4}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},38629:function(e,t,i){"use strict";i.d(t,{I6:function(){return u},Sj:function(){return s}});var r=i(669686),n=i(150251);let a={common:["has_subtitle_batch_edit_detail"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.hasSubtitleBatchEditDetail=!1,(0,r.tZ)(this,e,o)}}let l={common:["has_subtitle_batch_edit_detail"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},580425:function(e,t,i){"use strict";i.d(t,{Bo:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","category_name","title"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.id="",this.categoryName="",this.title="",(0,r.tZ)(this,e,o)}}let l={common:["id","category_name","title"]},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},211982:function(e,t,i){"use strict";var r=i(669686);i(150251);var n=i(678021);(0,r.I2)({array:{template_item_infos:{type:"object",clsName:()=>n.F2},unlock_template_ids:{type:"common"}}},[]);(0,r.I2)({array:{template_item_infos:{type:"object",clsName:()=>n.F2},unlock_template_ids:{type:"common"}}},[])},636272:function(e,t,i){"use strict";i.d(t,{Kx:function(){return m},w6:function(){return u}});var r=i(669686),n=i(150251),a=i(450911),o=i(914783),s=i(917955);let l={common:["tts_speaker_id","edit_template_url"],array:{section_infos:{type:"object",clsName:()=>a.BO},replace_subtitles:{type:"common"}},object:{cover:{type:()=>o.SL},original_template:{type:()=>s.os}}},d=(0,r.I2)(l,[]);class u extends n.w8{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=m,this.sectionInfos=[],this.cover=new o.SL,this.originalTemplate=new s.os,this.ttsSpeakerId="",this.editTemplateUrl="",this.replaceSubtitles=[],(0,r.tZ)(this,e,d)}}let c={common:["tts_speaker_id","edit_template_url"],array:{section_infos:{type:"object",clsName:()=>a.BO},replace_subtitles:{type:"common"}},object:{cover:{type:()=>o.c$},original_template:{type:()=>s.Kb}}},p=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=u,(0,r.fZ)(this,e,p)}}},512116:function(e,t,i){"use strict";i.d(t,{Rg:function(){return c},sc:function(){return l}});var r=i(669686),n=i(150251),a=i(553859);let o={common:["prompt","seed","model"],object:{font_item:{type:()=>a.Lh}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.prompt="",this.seed=0,this.model="",this.fontItem=new a.Lh,(0,r.tZ)(this,e,s)}}let d={common:["prompt","seed","model"],object:{font_item:{type:()=>a.mF}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},475034:function(e,t,i){"use strict";i.d(t,{IR:function(){return s}});var r=i(669686),n=i(150251);let a={common:["text"],bigint:{start_time:{},end_time:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=u,this.text="",this.startTime=0n,this.endTime=0n,(0,r.tZ)(this,e,o)}}let l={common:["text"],bigint:{start_time:{},end_time:{}}},d=(0,r.I2)(l,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},363651:function(e,t,i){"use strict";i.d(t,{Nk:function(){return l},tg:function(){return c}});var r=i(669686),n=i(150251),a=i(734879);let o={array:{vip_features:{type:"object",clsName:()=>a.He},vip_images:{type:"common"}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=c,this.vipFeatures=[],this.vipImages=[],(0,r.tZ)(this,e,s)}}let d={array:{vip_features:{type:"object",clsName:()=>a.He},vip_images:{type:"common"}}},u=(0,r.I2)(d,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,u)}}},304126:function(e,t,i){"use strict";i.d(t,{V:function(){return d},W:function(){return u}});var r=i(280283),n=i(956156),a=i(254574),o=i(602777),s=i(903849),l=i(211561);function d(e,t,i,d){d.material=(0,s.t0)(e.materials,"audios",[d.materialId],void 0,a.ZD),d.materialDraft=(0,s.t0)(e.materials,"drafts",d.extraMaterialRefs,o.cV.MetaTypeCombination),d.speed=(0,s.t0)(e.materials,"speeds",d.extraMaterialRefs,void 0,r.Ug),d.voiceChange=(0,s.Vm)(e.materials,"audioEffects",d.extraMaterialRefs),d.fade=(0,s.t0)(e.materials,"audioFades",d.extraMaterialRefs),d.balance=(0,s.t0)(e.materials,"audioBalances",d.extraMaterialRefs),d.beat=(0,s.t0)(e.materials,"beats",d.extraMaterialRefs),d.keyframes=(0,s.tI)(e.keyframes,"audios",d.keyframeRefs),d.realtimeDenoise=(0,s.t0)(e.materials,"realtimeDenoises",d.extraMaterialRefs),d.soundChannelMapping=(0,s.t0)(e.materials,"soundChannelMappings",d.extraMaterialRefs,void 0,n.tU),d.vocalSeparation=(0,s.t0)(e.materials,"vocalSeparations",d.extraMaterialRefs,void 0,l.JcE),d.vocalBeautify=(0,s.t0)(e.materials,"vocalBeautifys",d.extraMaterialRefs,void 0,l.jGb),(0,s.j)(e.keyframeGraphList,d)}function u(e,t,i,r,n,a){a.materialId=n.material.id,(0,s.af)(e.materials,"audios",n.material),(0,s.u$)(e.materials,"drafts",i,n.materialDraft),(0,s.u$)(e.materials,"speeds",i,n.speed),(0,s.QN)(e.materials,"audioEffects",i,n.voiceChange),(0,s.u$)(e.materials,"audioFades",i,n.fade),(0,s.u$)(e.materials,"audioBalances",i,n.balance),(0,s.u$)(e.materials,"beats",i,n.beat),(0,s.u4)(e.keyframes,"audios",r,n.keyframes),(0,s.u$)(e.materials,"realtimeDenoises",i,n.realtimeDenoise),(0,s.u$)(e.materials,"soundChannelMappings",i,n.soundChannelMapping),(0,s.u$)(e.materials,"vocalSeparations",i,n.vocalSeparation),(0,s.u$)(e.materials,"vocalBeautifys",i,n.vocalBeautify),(0,s.P$)(i,t,n.id),(0,s.SQ)(e.keyframeGraphList,n,a)}},678016:function(e,t,i){"use strict";i.d(t,{f:function(){return a},q:function(){return o}});var r=i(379012),n=i(903849);function a(e,t,i,a){a.material=(0,n.t0)(e.materials,"drafts",[a.materialId],void 0,r.Wu),(0,n.j)(e.keyframeGraphList,a)}function o(e,t,i,r,a,o){o.materialId=a.material.id,(0,n.af)(e.materials,"drafts",a.material),(0,n.P$)(i,t,a.id),(0,n.SQ)(e.keyframeGraphList,a,o)}},704738:function(e,t,i){"use strict";i.d(t,{K:function(){return o},N:function(){return s}});var r=i(1841),n=i(602777),a=i(903849);function o(e,t,i,o){o.material=(0,a.t0)(e.materials,"handwrites",[o.materialId],void 0,r.Td),o.animations=(0,a.t0)(e.materials,"materialAnimations",o.extraMaterialRefs),o.videoTracking=(0,a.t0)(e.materials,"videoTrackings",o.extraMaterialRefs),o.effects=(0,a.Vm)(e.materials,"effects",o.extraMaterialRefs,n.cV.MetaTypeHandwriteRes),o.keyframes=(0,a.tI)(e.keyframes,"handwrites",o.keyframeRefs),(0,a.j)(e.keyframeGraphList,o)}function s(e,t,i,r,n,o){o.materialId=n.material.id,(0,a.af)(e.materials,"handwrites",n.material),(0,a.u$)(e.materials,"materialAnimations",i,n.animations),(0,a.u$)(e.materials,"videoTrackings",i,n.videoTracking),(0,a.QN)(e.materials,"effects",i,n.effects),(0,a.u4)(e.keyframes,"handwrites",r,n.keyframes),(0,a.P$)(i,t,n.id),(0,a.SQ)(e.keyframeGraphList,n,o)}},595883:function(e,t,i){"use strict";i.d(t,{E:function(){return a},G:function(){return o}});var r=i(29709),n=i(903849);function a(e,t,i,a){a.material=(0,n.t0)(e.materials,"pluginEffects",[a.materialId],void 0,r.r0),a.applySegmentId=(0,n.JY)(t,a.materialId),(0,n.j)(e.keyframeGraphList,a)}function o(e,t,i,r,a,o){o.materialId=a.material.id,(0,n.af)(e.materials,"pluginEffects",a.material),(0,n.SQ)(e.keyframeGraphList,a,o)}},140820:function(e,t,i){"use strict";i.d(t,{L:function(){return a},t:function(){return o}});var r=i(518938),n=i(903849);function a(e,t,i,a){a.material=(0,n.t0)(e.materials,"tailLeaders",[a.materialId],void 0,r.W9),(0,n.j)(e.keyframeGraphList,a)}function o(e,t,i,r,a,o){o.materialId=a.material.id,(0,n.af)(e.materials,"tailLeaders",a.material),(0,n.P$)(i,t,a.id),(0,n.SQ)(e.keyframeGraphList,a,o)}},481631:function(e,t,i){"use strict";i.d(t,{E6:function(){return F},Ex:function(){return W},Ft:function(){return V},Kj:function(){return D},MR:function(){return k},NH:function(){return A},P2:function(){return E},P7:function(){return R},Q2:function(){return P},RF:function(){return H},Si:function(){return M},Um:function(){return z},WX:function(){return N},X1:function(){return q},Y9:function(){return O},YJ:function(){return G},b2:function(){return J},du:function(){return L},g2:function(){return Z},he:function(){return w},it:function(){return U},kj:function(){return j},nJ:function(){return K},nO:function(){return $},oP:function(){return S},ot:function(){return b},w5:function(){return C},xX:function(){return Y},zg:function(){return X}});var r=i(602777),n=i(368229),a=i(808402),o=i(195834),s=i(673118),l=i(969577),d=i(192716),u=i(760399),c=i(325744),p=i(557962),m=i(29489),h=i(806820),g=i(625107),f=i(541345),y=i(235369),_=i(173469),v=i(868202),I=i(571592),T=i(903849);i(211561);var x=i(800788);function k(e){return e.__segment_struct_type===r.Oc.SegmentTailLeader}function w(e){return e.__segment_struct_type===r.Oc.SegmentVideo}function A(e){return w(e)&&!!e.digitalHuman}function b(e){return A(e)&&!!e.materialDraft}function S(e){return A(e)&&!!e.material.materialId}function O(e){return e.__segment_struct_type===r.Oc.SegmentAudio}function C(e){return e.__segment_struct_type===r.Oc.SegmentVideoEffect}function M(e){return e.__segment_struct_type===r.Oc.SegmentFilter}function F(e){return e.__segment_struct_type===r.Oc.SegmentPictureAdjust}function R(e){return e.__segment_struct_type===r.Oc.SegmentImageSticker}function E(e){return e.__segment_struct_type===r.Oc.SegmentSticker}function P(e){return e.__segment_struct_type===r.Oc.SegmentTextTemplate}function V(e){return e.__segment_struct_type===r.Oc.SegmentText}function j(e){return e.__segment_struct_type===r.Oc.SegmentComposition}function z(e){return e.__segment_struct_type===r.Oc.SegmentAdcube}function D(e){return e.__segment_struct_type===r.Oc.SegmentPluginEffect}function N(e){return e.__segment_struct_type===r.Oc.SegmentHandwrite}function B(e){return e.__segment_struct_type===r.Oc.SegmentShape}function L(e){return w(e)&&!!(e.material.extraTypeOption&r.Yz.IsCombinationVideo)}function U(e){return O(e)&&!!e.materialDraft}function H(e){return e.__segment_struct_type===r.Oc.SegmentVideo}function W(e){return e.__segment_struct_type===r.Oc.SegmentAudio}function $(e){return e.__segment_struct_type===r.Oc.SegmentVideoEffect}function Z(e){return e.__segment_struct_type===r.Oc.SegmentFilter}function K(e){return e.__segment_struct_type===r.Oc.SegmentSticker}function q(e){return e.__segment_struct_type===r.Oc.SegmentTextTemplate}function G(e){return e.__segment_struct_type===r.Oc.SegmentText}function X(e){if(k(e))return new a.Zl;if(w(e))return new o.NO;if(O(e))return new s.CC;else if(C(e))return new l.Lt;else if(M(e))return new d.M_;else if(F(e))return new u.MY;else if(R(e))return new c.AO;else if(E(e))return new p.rk;else if(P(e))return new m.kp;else if(V(e))return new h.xK;else if(j(e))return new g.$u;else if(D(e))return new y.HC;else if(N(e))return new _.go;else if(B(e))return new v.Fm;else return null}let Y=e=>{let t=e.__segment_struct_type;switch(t){case r.Oc.SegmentTailLeader:return new a.Zl(e);case r.Oc.SegmentVideo:return new o.NO(e);case r.Oc.SegmentAudio:return new s.CC(e);case r.Oc.SegmentVideoEffect:return new l.Lt(e);case r.Oc.SegmentFilter:return new d.M_(e);case r.Oc.SegmentPictureAdjust:return new u.MY(e);case r.Oc.SegmentImageSticker:return new c.AO(e);case r.Oc.SegmentSticker:return new p.rk(e);case r.Oc.SegmentTextTemplate:return new m.kp(e);case r.Oc.SegmentText:return new h.xK(e);case r.Oc.SegmentComposition:return new g.$u(e);case r.Oc.SegmentAdcube:return new f.Ng(e);case r.Oc.SegmentPluginEffect:return new y.HC(e);case r.Oc.SegmentHandwrite:return new _.go(e);case r.Oc.SegmentShape:return new v.Fm(e);default:(0,x.bP)(t)}};class J{static serialize(e,t){return function(e,t){let i=new n.iE({...t}),r=new Set,a=new Set;return k(t)?(0,I.Lq)(e,e.tracks,r,a,t,i):w(t)?((0,I.cR)(e,e.tracks,r,a,t,i),i.speed=t.speed.speed):O(t)?(i.speed=t.speed.speed,(0,I.Wu)(e,e.tracks,r,a,t,i)):C(t)?(0,I.gs)(e,e.tracks,r,a,t,i):M(t)?(0,I.ES)(e,e.tracks,r,a,t,i):F(t)?(0,I.n8)(e,e.tracks,r,a,t,i):R(t)?(0,I.TK)(e,e.tracks,r,a,t,i):E(t)?(0,I.O_)(e,e.tracks,r,a,t,i):P(t)?(0,I.RV)(e,e.tracks,r,a,t,i):V(t)?(0,I.Z7)(e,e.tracks,r,a,t,i):j(t)?(0,I.qX)(e,e.tracks,r,a,t,i):z(t)?(0,I.$X)(e,e.tracks,r,a,t,i):D(t)?(0,I.GQ)(e,e.tracks,r,a,t,i):N(t)?(0,I.Ni)(e,e.tracks,r,a,t,i):B(t)&&(0,I.eQ)(e,e.tracks,r,a,t,i),i.extraMaterialRefs=Array.from(r),i.keyframeRefs=Array.from(a),i}(e,t)}static deserialize(e,t){return function(e,t){let i;let n=(0,T.Ul)(e,t);switch(n){case r.Oc.SegmentTailLeader:i=new a.wI({...t});break;case r.Oc.SegmentVideo:i=new o._6({...t,speed:void 0});break;case r.Oc.SegmentAudio:i=new s.M_({...t,speed:void 0});break;case r.Oc.SegmentVideoEffect:i=new l.nk({...t});break;case r.Oc.SegmentFilter:i=new d.wS({...t});break;case r.Oc.SegmentPictureAdjust:i=new u.MM({...t});break;case r.Oc.SegmentImageSticker:i=new c.Gf({...t});break;case r.Oc.SegmentSticker:i=new p.S8({...t});break;case r.Oc.SegmentTextTemplate:i=new m.pV({...t});break;case r.Oc.SegmentText:i=new h.Fy({...t});break;case r.Oc.SegmentComposition:i=new g._$({...t});break;case r.Oc.SegmentAdcube:i=new f.C6({...t});break;case r.Oc.SegmentPluginEffect:i=new y.LZ({...t});break;case r.Oc.SegmentHandwrite:i=new _.x_({...t});break;case r.Oc.SegmentShape:i=new v.B6({...t});break;default:throw Error(`unrecognized segment type ${n}`)}let x=new Set(e.tracks.reduce((e,t)=>(e.push(...t.segments.map(e=>{let{materialId:t}=e;return t})),e),[]));return k(i)?(0,I.LN)(e,e.tracks,x,i):w(i)?(0,I.Ie)(e,e.tracks,x,i):O(i)?(0,I.VN)(e,e.tracks,x,i):C(i)?(0,I.a4)(e,e.tracks,x,i):M(i)?(0,I.hK)(e,e.tracks,x,i):F(i)?(0,I.J5)(e,e.tracks,x,i):R(i)?(0,I.ec)(e,e.tracks,x,i):E(i)?(0,I.eZ)(e,e.tracks,x,i):P(i)?(0,I.wY)(e,e.tracks,x,i):V(i)?(0,I.tm)(e,e.tracks,x,i):j(i)?(0,I.fp)(e,e.tracks,x,i):z(i)?(0,I.D8)(e,e.tracks,x,i):D(i)?(0,I.Es)(e,e.tracks,x,i):N(i)?(0,I.K8)(e,e.tracks,x,i):B(i)&&(0,I.S_)(e,e.tracks,x,i),i}(e,t)}}},129862:function(e,t,i){"use strict";i.d(t,{F:function(){return T}});var r=i(211561),n=i(475028),a=i(690613),o=i(283751),s=i(932422),l=i(198544),d=i(392742),u=i(481631),c=i(340294),p=i(356898),m=i(282192);let h=(0,n.i)(l.m.UpdateSegmentSubDraftNotExist,""),g=(0,n.i)(l.m.DeleteSegmentIdNotExist,""),f=(0,n.i)(l.m.UpdateSegmentTargetTimerangeStartInvalid,""),y=(0,n.i)(l.m.UpdateSegmentTargetTimerangeDurationInvalid,"");(0,n.i)(l.m.UpdateSegmentTargetTimerangeOverlap,"");let _=(0,n.i)(l.m.UpdateSegmentSourceTimerangeStartInvalid,""),v=(0,n.i)(l.m.UpdateSegmentSourceTimerangeDurationInvalid,""),I=(0,n.i)(l.m.UpdateSegmentMaterialDurationInvalid,"");class T extends s.m{static deserialize(e){let t=(0,p.GM)(e.segmentDelta),i=(0,p.GM)(e.sourceSegmentDelta);if(!t)throw Error("deserialize update segment error");let r=new T({...e,segmentDelta:t,sourceSegmentDelta:i});return r.updateDataVersion(e.version),r}static serialize(e){let t="{";e.draftId&&(t+=`"draftId":"${e.draftId}",`),t+=`"segmentId":"${e.segmentId}","trackId":"${e.trackId}","trackIndex":${e.trackIndex},`;let i=(0,p.TJ)(e.segmentDelta);t+=`"segmentDelta":${c.HH.stringify(i)},`;let r=(0,p.TJ)(e.sourceSegmentDelta);return t+=`"sourceSegmentDelta":${c.HH.stringify(r)},"version":"${e.version}","type":${e.type}}`}invert(e){var t;let i=(null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e).getSegmentByTrackIdAndSegmentId(this.trackId,this.segmentId),r=(0,u.xX)({__segment_struct_type:i.__segment_struct_type}),n=o.T.pick(i,this.segmentDelta,r);return[new T({draftId:this.draftId,trackId:this.trackId,trackIndex:this.trackIndex,segmentId:this.segmentId,segmentDelta:n,sourceSegmentDelta:this.segmentDelta})]}transform(e,t){let i={[d.x.InsertSegment]:this._transformWithInsertSegmentMutation.bind(this,e,t),[d.x.DeleteSegment]:this._transformWithDeleteSegmentMutation.bind(this,e,t),[d.x.MoveSegment]:this._transformWithMoveSegmentMutation.bind(this,e,t),[d.x.UpdateSegment]:this._transformWithUpdateSegmentMutation.bind(this,e,t),[d.x.InsertTrack]:this._transformWithInsertTrackMutation.bind(this,e,t),[d.x.DeleteTrack]:this._transformWithDeleteTrackMutation.bind(this,e,t),[d.x.MoveTrack]:this._transformWithMoveTrackMutation.bind(this,e,t)};return i[e.type]?i[e.type]():[this]}check(e){let t=e.getDraftById(this.draftId);if(!t)return h(`subDraft not exist: ${this.draftId}`);let{trackId:i,segmentId:n,segmentDelta:o}=this,s=t.getSegmentByTrackIdAndSegmentId(i,n);if(!s)return g(`segment not exist: ${n}`);let{start:l,duration:d}=s.targetTimerange;if(!(l>=0))return f(`start invalid: ${l}`);if(!(d>0))return y(`duration invalid: ${d}`);if(o.targetTimerange&&"bigint"==typeof o.targetTimerange.duration&&o.targetTimerange.duration<=0n)return y(`duration invalid: ${o.targetTimerange.duration}`);if(o.sourceTimerange){var c,p,m,T;if("bigint"==typeof o.sourceTimerange.start&&o.sourceTimerange.start<0n)return _(`start invalid: ${o.sourceTimerange.start}`);let e=null!==(T=null===(c=o.material)||void 0===c?void 0:c.type)&&void 0!==T?T:null===(p=s.material)||void 0===p?void 0:p.type;if("bigint"==typeof o.sourceTimerange.duration){if((0,u.he)(s)){if(e===r.cVg.MetaTypeVideo&&o.sourceTimerange.duration<=0n)return v(`duration invalid: ${o.sourceTimerange.duration}`)}else if((0,u.Y9)(s)&&o.sourceTimerange.duration<=0n)return v(`duration invalid: ${o.sourceTimerange.duration}`)}if("bigint"==typeof(null===(m=o.material)||void 0===m?void 0:m.duration)){if((0,u.he)(s)){if(e===r.cVg.MetaTypeVideo&&o.material.duration<=0n)return I(`duration invalid: ${o.material.duration}`)}else if((0,u.Y9)(s)&&o.material.duration<=0n)return I(`duration invalid: ${o.material.duration}`)}}return(0,a.ly)()}runOnModel(e){var t;return(null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e).updateSegment(this.trackId,this.segmentId,this.segmentDelta)}_transformWithInsertSegmentMutation(e,t){let{segmentDelta:i,trackId:n,trackIndex:a,segmentId:o,sourceSegmentDelta:s,draftId:l}=this,{targetTimerange:d}=i,{targetTimerange:u}=s,{trackId:c,segment:p}=e,{targetTimerange:h}=p;if(n!==c||!h||!u||!d)return[this];d.start,d.duration;let g=h.start+h.duration;if(0===a&&d.start===h.start&&t){let e=i.clone(!1);return e.targetTimerange.start+=h.duration,[new T({draftId:l,trackId:n,trackIndex:a,segmentDelta:e,segmentId:o,sourceSegmentDelta:s})]}if(0!==a&&((0,m.DG)(h,d)||t&&d.start===h.start)){let e=i.clone(!1);return e.targetTimerange=new r.zel({start:g,duration:d.duration}),[new T({draftId:l,trackId:n,segmentId:o,trackIndex:a,segmentDelta:e,sourceSegmentDelta:s})]}return[this]}_transformWithDeleteSegmentMutation(e,t){let{segmentDelta:i,trackId:r,trackIndex:n,segmentId:a,sourceSegmentDelta:o,draftId:s}=this,{targetTimerange:l}=i,{targetTimerange:d}=o,{segmentId:u,trackId:c,targetTimerange:p}=e;if(a===u)return t?[]:[this];if(r!==c||!p||!d||!l)return[this];if(0===n&&l.start>p.start&&t){let e=i.clone();return e.targetTimerange.start-=p.duration,[new T({draftId:s,trackId:r,trackIndex:n,segmentDelta:e,segmentId:a,sourceSegmentDelta:o})]}return[this]}_transformWithMoveSegmentMutation(e,t){let{segmentDelta:i,trackId:r,trackIndex:n,segmentId:a,sourceSegmentDelta:o,draftId:s}=this,{targetTimerange:l}=i,{targetTimerange:d}=o,{srcTrackIndex:u,desTrackIndex:c,srcTargetTimeRanges:p,desTargetTimeRanges:h,srcTrackId:g,desTrackId:f,segmentIds:y}=e,_=y.indexOf(a);if(-1!==_){let e=h[_],t=i.clone(!1);return t.targetTimerange&&(t.targetTimerange.start=e.start),[new T({draftId:s,trackId:f,trackIndex:c,segmentDelta:t,segmentId:a,sourceSegmentDelta:o})]}if(r!==f&&r!==g||!l)return[this];let v=i.clone(!1),{targetTimerange:I}=v;return p.forEach(e=>{0===n&&r===g&&I.start>e.start&&t&&(I.start-=e.duration)}),h.forEach(e=>{let t=e.start+e.duration;if(0!==n&&r===f&&(0,m.DG)(e,I)){let e=t-I.start;I.start+=e}}),[new T({draftId:s,trackId:r,trackIndex:n,segmentDelta:v,segmentId:a,sourceSegmentDelta:o})]}_transformWithUpdateSegmentMutation(e,t){let{segmentDelta:i,trackId:n,trackIndex:a,segmentId:s,sourceSegmentDelta:l,draftId:d}=this,{targetTimerange:u}=i,{targetTimerange:c}=l,{segmentDelta:p,trackId:h,segmentId:g,sourceSegmentDelta:f}=e,{targetTimerange:y}=p,{targetTimerange:_}=f;if(s===g){if(!t)return[this];let e=i.clone(!1);e=o.T.merge(p,e,e);let r=l.clone(!1);return[new T({draftId:d,trackId:n,trackIndex:a,segmentDelta:e,segmentId:s,sourceSegmentDelta:r=o.T.merge(f,r,r)})]}if(n!==h||!y||!c||!u)return[this];if(0===a&&u.start>y.start&&t){let e=u.start+u.duration-(y.start+y.duration),t=i.clone();return t.targetTimerange.start-=e,[new T({draftId:d,trackId:n,trackIndex:a,segmentDelta:t,segmentId:s,sourceSegmentDelta:l})]}let v=y.start+y.duration;if(0!==a&&((0,m.DG)(y,u)||t&&u.start===y.start)){let e=i.clone(!1);return e.targetTimerange=new r.zel({start:v,duration:u.duration}),[new T({draftId:d,trackId:n,segmentId:s,trackIndex:a,segmentDelta:e,sourceSegmentDelta:l})]}return[this]}_transformWithInsertTrackMutation(e,t){let{trackId:i,trackIndex:r,segmentId:n,draftId:a,segmentDelta:o,sourceSegmentDelta:s}=this,{trackIndex:l}=e;return r>=l?[new T({trackId:i,trackIndex:r+1,segmentId:n,draftId:a,segmentDelta:o,sourceSegmentDelta:s})]:[this]}_transformWithDeleteTrackMutation(e,t){let{segmentDelta:i,trackId:r,trackIndex:n,segmentId:a,sourceSegmentDelta:o,draftId:s}=this,{trackId:l,trackIndex:d}=e;return r===l?t?[]:[this]:n>d&&t?[new T({trackId:r,trackIndex:n-1,segmentId:a,draftId:s,segmentDelta:i,sourceSegmentDelta:o})]:[this]}_transformWithMoveTrackMutation(e,t){return[this]}clone(){return new T({draftId:this.draftId,trackId:this.trackId,trackIndex:this.trackIndex,segmentId:this.segmentId,segmentDelta:this.segmentDelta,sourceSegmentDelta:this.sourceSegmentDelta})}constructor(e){var t;super(),this.type=d.x.UpdateSegment,this.draftId=null!==(t=e.draftId)&&void 0!==t?t:"",this.trackId=e.trackId,this.trackIndex=e.trackIndex,this.segmentId=e.segmentId,this.segmentDelta=e.segmentDelta,this.sourceSegmentDelta=e.sourceSegmentDelta}}},900017:function(e,t,i){"use strict";i.d(t,{p:function(){return u}});var r=i(475028),n=i(690613),a=i(932422),o=i(198544),s=i(392742);let l=(0,r.i)(o.m.MoveTrackSrcIndexInvalid,""),d=(0,r.i)(o.m.MoveTrackDesIndexInvalid,"");class u extends a.m{static deserialize(e){let t=new u(e);return t.updateDataVersion(e.version),t}static serialize(e){let t="{";return t+=`"srcIndex":${e.srcIndex},"desIndex":${e.desIndex},"version":"${e.version}","type":${e.type}}`}invert(e){return[new u({srcIndex:this.desIndex,desIndex:this.srcIndex})]}transform(e,t){return[this]}check(e){return this.srcIndex>0&&this.srcIndex<e.tracks.length?this.srcIndex>0&&this.srcIndex<e.tracks.length?(0,n.ly)():d(`desIndex not valid: ${this.desIndex}`):l(`srcIndex not valid: ${this.srcIndex}`)}runOnModel(e){e.moveTrack(this.srcIndex,this.desIndex)}clone(){return new u({srcIndex:this.srcIndex,desIndex:this.desIndex})}constructor(e){super(),this.type=s.x.MoveTrack,this.srcIndex=e.srcIndex,this.desIndex=e.desIndex}}},247559:function(e,t,i){"use strict";i.d(t,{LA:function(){return l},Mk:function(){return d},nu:function(){return c},yT:function(){return u}});var r=i(211561),n=i(358324),a=i(481631),o=i(342040),s=i(521987);function l(e,t,i){return!!(0,a.Y9)(t)&&(e.editor.commit(()=>{if(!!e.audio.add(t).ok){if((0,a.it)(t)&&e.draft.subDraftExecuteAdd(t),void 0!==t.speed&&e.audio.updateTimeInfo(t),void 0!==t.isToneModify&&e.audio.updateTone(t.id,t.isToneModify),void 0!==t.volume||void 0!==t.lastNonzeroVolume||void 0!==t.trackAttribute){let{volume:n}=t,a=t.clone();BigInt(t.trackAttribute)&r.$SW.MuteFlag&&(n=0,a.commonKeyframes.forEach(e=>{e.propertyType===r.Eu.KFTypeVolume&&e.keyframeList.forEach(e=>{e.values=[0]})})),e.audio.delayHandleKeyframe(a,i),e.audio.updateVolume(t.id,n)}void 0!==t.fade&&e.audio.updateAudioFade(t.id,t.fade),void 0!==t.realtimeDenoise&&e.audio.updateRealtimeDenoise(t.id,t.realtimeDenoise),void 0!==t.voiceChange&&e.audio.updateVoiceChange(t.id,t.voiceChange),0!==t.commonKeyframes.length&&e.audio.delayHandleKeyframe(t,i)}}),!0)}function d(){for(var e,t=arguments.length,i=Array(t),d=0;d<t;d++)i[d]=arguments[d];let[u,c,p,m]=i;if(!(0,a.Ex)(p))return!1;let h=m.getSegmentById(c);if(!h)return!1;let g=s.m3.getAudioAlgorithmProductionPath(h).path||(null===(e=p.material)||void 0===e?void 0:e.path)||h.material.path,f=o.k.getInstance().pathRecords.get(g);return f!==u.editor.getClipBase(c).data.res?((0,n.iB)(u,h.id,h),l(u,h,m)):(u.editor.commit(()=>{if((void 0!==p.speed||void 0!==p.sourceTimerange||void 0!==p.targetTimerange)&&u.audio.updateTimeInfo(h),void 0!==p.isToneModify&&u.audio.updateTone(h.id,h.isToneModify),void 0!==p.volume||void 0!==p.lastNonzeroVolume||void 0!==p.trackRenderIndex||void 0!==p.trackAttribute&&null!==p.trackAttribute){var e;let{volume:t}=h,i=h.clone(),n=null!==(e=p.trackAttribute)&&void 0!==e?e:function(e,t){let i=e.getTrackBySegmentId(t);if(i)return i.attribute}(m,h.id);void 0!==n&&BigInt(n)&r.$SW.MuteFlag&&(t=0,i.commonKeyframes.forEach(e=>{e.propertyType===r.Eu.KFTypeVolume&&e.keyframeList.forEach(e=>{e.values=[0]})})),u.audio.delayHandleKeyframe(i,m),u.audio.updateVolume(h.id,t)}void 0!==p.fade&&u.audio.updateAudioFade(h.id,h.fade),void 0!==p.realtimeDenoise&&u.audio.updateRealtimeDenoise(h.id,h.realtimeDenoise),void 0!==p.voiceChange&&u.audio.updateVoiceChange(h.id,h.voiceChange),(void 0!==p.targetTimerange||void 0!==p.commonKeyframes)&&u.audio.delayHandleKeyframe(h,m,p),void 0!==p.visible&&u.editor.updateVisible(h.id,h.visible)}),!1)}function u(){for(var e,t,i,s,d,u=arguments.length,c=Array(u),p=0;p<u;p++)c[p]=arguments[p];let[m,h,g,f]=c,y=f.getSegmentById(h);if(!!y&&!!(0,a.Y9)(y))if(g){if(!(0,a.Ex)(g))return;let{voiceChange:t,commonKeyframes:i}=g;if(t){let i=(null===(e=t[0])||void 0===e?void 0:e.subType)===r.xbm.AudioEffectTypeVCVoiceChange?t[0].productionPath:y.material.path,a=o.k.getInstance().pathRecords.get(i);if(a!==m.editor.getClipBase(h).data.res){(0,n.iB)(m,y.id,y);let e=y.clone();return e.voiceChange=t,l(m,e,f)}return m.editor.commit(()=>{m.audio.updateVoiceChange(y.id,t)})}if(i)return m.editor.commit(()=>{m.audio.delayHandleKeyframe(y,f,g)})}else{let e=(null===(i=y.voiceChange)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.subType)===r.xbm.AudioEffectTypeVCVoiceChange&&(null===(d=y.voiceChange)||void 0===d?void 0:null===(s=d[0])||void 0===s?void 0:s.productionPath)||y.material.path,a=o.k.getInstance().pathRecords.get(e);return a!==m.editor.getClipBase(h).data.res?((0,n.iB)(m,y.id,y),l(m,y,f)):m.editor.commit(()=>{m.audio.updateVoiceChange(y.id,y.voiceChange),m.audio.delayHandleKeyframe(y,f)})}}function c(){for(var e,t,i,s,d=arguments.length,u=Array(d),c=0;c<d;c++)u[c]=arguments[c];let[p,m,h,g]=u,f=g.getSegmentById(m);if(!f||!(0,a.Y9)(f)||!(0,a.Ex)(h))return;let{voiceChange:y,commonKeyframes:_}=h,v=(null===(t=f.voiceChange)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.subType)===r.xbm.AudioEffectTypeVCVoiceChange&&(null===(s=f.voiceChange)||void 0===s?void 0:null===(i=s[0])||void 0===i?void 0:i.productionPath)||f.material.path,I=o.k.getInstance().pathRecords.get(v);return I!==p.editor.getClipBase(m).data.res?((0,n.iB)(p,f.id,f),l(p,f,g)):p.editor.commit(()=>{y&&p.audio.updateVoiceChange(f.id,f.voiceChange),_&&p.audio.delayHandleKeyframe(f,g)})}},524208:function(e,t,i){"use strict";i.d(t,{F:function(){return h},T:function(){return g}});var r=i(59670),n=i(632634),a=i(396402),o=i(998179),s=i(300820),l=i(802195),d=i(481631),u=i(690613),c=i(285474),p=i(342040),m=i(438176);function h(e){var t;let i=null==e?void 0:null===(t=e.material)||void 0===t?void 0:t.version;return i&&i.length>0}class g extends r.D{add(e){var t;if(!(0,d.Q2)(e))return(0,u.wf)(n.FF.segmentInvalid,"not text-template segment");let{editor:i,config:r}=this._render;if(!i)return(0,u.wf)(n.FF.editorNotInit,"editor not init");let h=this.getRenderIndex(e),g=null===(t=this._render.editor)||void 0===t?void 0:t.addTrack(a.u2.EffectTrack,h);if(!g)return(0,u.wf)(n.FF.addTrackFail,"add text-template track fail");let f=(0,o.aB)(e,r);f.id=e.id,f.layer=BigInt(h),f.filter.filterLayer=BigInt(h),f.rid=BigInt(h);let y=e.targetTimerange.start,_=e.targetTimerange.duration+y,v=i.addClip(g,f,y,_);return m.R?i.infoSticker&&(0,c.iE)(e,i):v.then(()=>{i.infoSticker&&(0,c.iE)(e,i)}),l.y.isNewTextTemplateSegment(e.material)&&!i.hasBrokenPath(p.k.getInstance().pathRecords.get(e.material.path))&&(0,s.D)(e,!1,r),(0,u.ly)()}update(e){if(!(0,d.Q2)(e))return(0,u.wf)(n.FF.segmentInvalid,"not text-template segment");let{editor:t,config:i}=this._render;if(!t)return(0,u.wf)(n.FF.editorNotInit,"editor not init");let r=this.getRenderIndex(e),a=h(e)?(0,o.gg)(e,i):(0,o.fT)(e,i);return a.layer=BigInt(r),a.filter.filterLayer=BigInt(r),a.id=e.id,t.updateClip(a),l.y.isNewTextTemplateSegment(e.material)&&!t.hasBrokenPath(p.k.getInstance().pathRecords.get(e.material.path))&&(0,s.D)(e,!1,i),l.y.removeTextTemplateParamsCache(e.id),(0,u.ly)()}updateVideoTracking(e,t){if(!(0,d.Q2)(e)){console.error("segment is invalid");return}let{editor:i}=this._render;if(!(null==i?void 0:i.infoSticker))return(0,u.wf)(n.FF.editorNotInit,"infoSticker not init");(0,c.vT)(e,t,i).then(()=>{null==i||i.commit(()=>!0)})}refreshTextsWithDefaultFont(e){let t=(e,i)=>{let r=[];e.getAllSegments().forEach(e=>{(0,d.Q2)(e)?r.push(e):(0,d.du)(e)&&t(e.materialDraft.draft,[...i,e.id])}),i.forEach(e=>this._render.apis.draft.beginDraft(e)),r.forEach(e=>this.update(e)),i.reverse().forEach(e=>this._render.apis.draft.endDraft(e))};return t(e,[]),(0,u.ly)()}}},333781:function(e,t,i){"use strict";i.d(t,{_:function(){return P}});var r=i(59670),n=i(632634),a=i(378188),o=i(211561),s=i(396402),l=i(912224),d=i(340294),u=i(860846),c=i(773820),p=i(469997),m=i(239648),h=i(203447),g=i(342558),f=i(185400),y=i(733353),_=i(745609),v=i(229536),I=i(27574),T=i(481631),x=i(690613),k=i(342040),w=i(93735),A=i(239431),b=i(361708),S=i(242905),O=i(542240),C=i(298069),M=i(222298),F=i(438176),R=i(176791);function E(e){return k.k.getInstance().pathRecords.get(e)||e}class P extends r.D{add(e,t){let{editor:i}=this._render;if(!i)return(0,x.wf)(n.FF.editorNotInit,"editor not init");if(!(0,T.he)(e))return(0,x.wf)(n.FF.segmentInvalid,"no video segment");if(!e.material)return(0,x.wf)(n.FF.segmentInvalid,"no video material");if(e.targetTimerange.duration<=0)return(0,x.wf)(n.FF.segmentInvalid,"invalid target duration");i.removeDefaultVideoClip();let r=this.getRenderIndex(e),l=i.addTrack(s.u2.VideoTrack,r);if(!l)return(0,x.wf)(n.FF.addTrackFail,"add video track fail");let u=(0,a.Fp)(e),c=e.targetTimerange.start,p=c+e.targetTimerange.duration;b.b.isCombination(e)?i.addSubSequence(l,u,c,p):i.addClip(l,u,c,p),i.checkEditorRunningStatus()&&i&&(0,S.F)(i,e,t).then(()=>i.commit(()=>!0));let{matting:m}=e.material;if(F.H&&m&&m.path&&0!==m.path.indexOf("http")&&m.flag&o.R6k.aiMattingFlag){var h,g;!d.P4.instance.isExist(m.path)&&d.P4.instance.mkdir(m.path,{recursive:!0});let t=null!==(g=e.sourceTimerange)&&void 0!==g?g:{start:0n,duration:0n},i=k.k.getInstance().pathRecords.get(function(e){if(!(0,T.he)(e))return"";let{material:t}=e;if(t.type===o.cVg.MetaTypeVideo){if(e.reverse){if(e.intensifiesAudio&&!t.reverseIntensifiesPath)return t.reverseIntensifiesPath;if(t.reversePath)return t.reversePath}if(e.intensifiesAudio&&t.intensifiesAudioPath)return t.intensifiesPath}return t.path}(e)),r={taskType:O.JE.NONE,startTime:{"time.us":t.start},endTime:{"time.us":t.start+t.duration},currentTime:{"time.us":-1n},archerStrategy:0,avFilePath:i,curType:{mattingType:O.mA.MATTING_TYPE_NONE,workSpace:"",algorithmConfigPath:"",extInfoJson:""},baseType:{mattingType:O.mA.MATTING_TYPE_NONE,workSpace:"",algorithmConfigPath:"",extInfoJson:""},penParam:{},followParam:{},multiImageParam:{},avDecryptionKey:k.k.getInstance().decryptRecords.get(i)},n=k.k.getInstance().pathRecords.get(m.path),a=`${n}/${o.R6k.aiMattingFlag.toString()}`;!d.P4.instance.isExist(a)&&d.P4.instance.mkdir(a,{recursive:!0}),r.curType={mattingType:O.mA.MATTING_TYPE_PORTRAIT,workSpace:a,algorithmConfigPath:`${C.Q}/ai_matting/algorithmConfig.json`,extInfoJson:""},null===(h=this._render.editor)||void 0===h||h.mattingControl.addMattingTask(d.HH.stringify(r))}return(0,x.ly)()}remove(e){var t;return null===(t=this._render.editor)||void 0===t||t.removeClip(e),(0,x.ly)()}updateTransform(e,t,i,r,a,l){var d,u,c;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");if(!t)return(0,x.wf)(n.FF.segmentInvalid,"no video clip");let p=`${e}_${s.UO.Transform}`,m={id:p,type:s.UO.Transform,rotation_z:t.rotation,scale_x:t.scale.x*i,scale_y:t.scale.y*i,alpha:t.alpha,flip_x:t.flip.horizontal,flip_y:t.flip.vertical,blend_mode:(null==r?void 0:r.path)?k.k.getInstance().pathRecords.get(r.path):"",position_x:t.transform.x,position_y:-t.transform.y};return(null===(d=this._render.editor)||void 0===d?void 0:d.getFilterById(e,p))?null===(u=this._render.editor)||void 0===u||u.updateFilter(m):null===(c=this._render.editor)||void 0===c||c.addFilter(m,e),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:a,clipId:e,parentId:e,keyframeTypeList:[...f.Q0,o.Eu.KFTypeAlpha],delta:l}),(0,x.ly)()}updateCrop(e,t){var i,r,a;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");if(!t)return(0,x.wf)(n.FF.segmentInvalid,"no video crop");let o=`${e}_${s.UO.VideoCrop}`,l={id:o,type:s.UO.VideoCrop,top_left_x:t.upperLeftX,top_left_y:t.upperLeftY,top_right_x:t.upperRightX,top_right_y:t.upperRightY,bottom_left_x:t.lowerLeftX,bottom_left_y:t.lowerLeftY,bottom_right_x:t.lowerRightX,bottom_right_y:t.lowerRightY};return(null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e,o))?null===(r=this._render.editor)||void 0===r||r.updateFilter(l):null===(a=this._render.editor)||void 0===a||a.addFilter(l,e),(0,x.ly)()}updateVolume(e,t,i,r){var a,o,l;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let d=`${e}_${s.UO.AudioVolume}`,u={id:d,type:s.UO.AudioVolume,volume:t,sequence_in:0n,sequence_out:-1n};return(null===(a=this._render.editor)||void 0===a?void 0:a.getFilterById(e,d))?null===(o=this._render.editor)||void 0===o||o.updateFilter(u):null===(l=this._render.editor)||void 0===l||l.addFilter(u,e),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:i,clipId:e,parentId:d,keyframeTypeList:f.SM,delta:r}),(0,x.ly)()}updateAudioFade(e,t){var i,r,a;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");if(!t)return(0,x.wf)(n.FF.segmentInvalid,"no audio fade");let o=`${e}_${s.UO.AudioFade}`,l={id:o,type:s.UO.AudioFade,fade_in:{"time.us":t.fadeInDuration},fade_out:{"time.us":t.fadeOutDuration},curve_type:s.LW.Sine};return(null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e,o))?null===(r=this._render.editor)||void 0===r||r.updateFilter(l):null===(a=this._render.editor)||void 0===a||a.addFilter(l,e),(0,x.ly)()}updateTone(e,t){var i,r,a;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let o=null===(r=this._render.editor)||void 0===r?void 0:null===(i=r.getClipBase(e))||void 0===i?void 0:i.data;return o?(o.is_pitch_reserved=!t,0!==(null===(a=this._render.editor)||void 0===a?void 0:a.updateClip(o)))?(0,x.wf)(n.FF.updateClipFail,"update video tone fail"):(0,x.ly)():(0,x.wf)(n.FF.updateClipFail,"clip not exist")}updateVoiceChange(e,t,i,r){var a,l,d,u,c,p,m;if(!t||t.length<=0||t[0].subType===o.xbm.AudioEffectTypeVCVoiceChange){let t=`${e}_${s.UO.AudioSamiProcessorFilter}`;return(null===(a=this._render.editor)||void 0===a?void 0:a.getFilterById(e,t))&&(null===(l=this._render.editor)||void 0===l||l.removeFilter(t)),(0,x.ly)()}for(let a of t){if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let t=`${e}_${s.UO.AudioSamiProcessorFilter}`;if(!(null==a?void 0:a.path)){(null===(u=this._render.editor)||void 0===u?void 0:u.getFilterById(e,t))&&(null===(c=this._render.editor)||void 0===c||c.removeFilter(t));break}let o=k.k.getInstance().pathRecords.get(a.path),l=[],h=[];a.audioAdjustParams.forEach(e=>{l.push([e.portIndex,e.parameterIndex]),h.push(e.value)});let g={id:t,type:s.UO.AudioSamiProcessorFilter,resource_json_file_path:`${o}/mdsp_preset.json`,resource_find_path:o,param_index:l,params:h,bUseAutomation:!1};(null===(d=this._render.editor)||void 0===d?void 0:d.getFilterById(e,t))?null===(p=this._render.editor)||void 0===p||p.updateFilter(g):null===(m=this._render.editor)||void 0===m||m.addFilter(g,e),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:i,clipId:e,parentId:t,keyframeTypeList:f.gb,delta:r})}return(0,x.ly)()}updateRealtimeDenoise(e,t){var i,r,a,o,l;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let d=`${e}_${s.UO.AudioNoiseFilter}`;if(!t||!t.isDenoise)return(null===(r=this._render.editor)||void 0===r?void 0:r.getFilterById(e,d))&&(null===(a=this._render.editor)||void 0===a||a.removeFilter(d)),(0,x.ly)();let u={id:d,type:s.UO.AudioNoiseFilter,noiseMode:t.denoiseMode,denoiseRate:t.denoiseRate,modelPath:k.k.getInstance().pathRecords.get(t.path),openNoiseFilter:t.isDenoise};return(null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e,d))?null===(o=this._render.editor)||void 0===o||o.updateFilter(u):null===(l=this._render.editor)||void 0===l||l.addFilter(u,e),(0,x.ly)()}updateBackground(e,t){var i,r,a,l;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");if(!t)return(0,x.wf)(n.FF.segmentInvalid,"no video background");let d=`${e}_${s.UO.VideoCanvas}`;if(t.type===o.cVg.MetaTypeNone)return null===(i=this._render.editor)||void 0===i||i.removeFilter(d),(0,x.ly)();{let i={id:d,type:s.UO.VideoCanvas,blur:-1n};switch(t.type){case o.cVg.MetaTypeCanvasColor:i.color=t.color||this.render.config.videoDefaultBackgroundRGBA||"#000000ff";break;case o.cVg.MetaTypeCanvasImage:i.image=k.k.getInstance().pathRecords.get(t.image);break;case o.cVg.MetaTypeCanvasBlur:i.blur=BigInt(Math.floor(14*t.blur+.5))}return(null===(r=this._render.editor)||void 0===r?void 0:r.getFilterById(e,d))?null===(a=this._render.editor)||void 0===a||a.updateFilter(i):null===(l=this._render.editor)||void 0===l||l.addFilter(i,e),(0,x.ly)()}}updateMatting(e,t){var i,r,a,l,c,p,m;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");if(!t)return(0,x.wf)(n.FF.segmentInvalid,"no video matting");let h=null===(r=this._render.editor)||void 0===r?void 0:null===(i=r.getClipBase(e))||void 0===i?void 0:i.data;if(!h)return(0,x.wf)(n.FF.updateClipFail,"video clip not exits");let g=t.flag&o.R6k.aiMattingFlag,f=t.flag&o.R6k.cusMattingFlag,y=t.flag&o.R6k.webAiMattingFlag,_=null===(a=t.strokes)||void 0===a?void 0:a.filter(e=>e.path),v=(null==_?void 0:_.length)>0;if(g||y&&v||f&&t.blendMode!==o.txy.MattingBlendModeHide){let i={interactive_time:t.interactiveTime,base_workspace:"",base_algorithm_config_path:"",base_matting_type:0n,cur_workspace:"",cur_algorithm_config_path:"",cur_matting_type:0n,segment_id:e,blend_mode:t.blendMode===O.Zx.MATTING_BLEND_MODE_PREVIEW?O.Zx.MATTING_BLEND_MODE_PREVIEW:O.Zx.MATTING_BLEND_MODE_NORMAL,blend_rbga:t.blendColor,stroke_blend_path:E(`${C.Q}/editor/mattingBlend`),strokes:[]};if(g){let e=k.k.getInstance().pathRecords.get(t.path),r=`${e}/${o.R6k.aiMattingFlag.toString()}`;F.H&&!d.P4.instance.isExist(r)&&d.P4.instance.mkdir(r,{recursive:!0});let n=E(`${C.Q}/ai_matting/algorithmConfig.json`);f?(i.base_matting_type=o.R6k.aiMattingFlag,i.base_workspace=r,i.base_algorithm_config_path=n):(i.cur_matting_type=o.R6k.aiMattingFlag,i.cur_workspace=r,i.cur_algorithm_config_path=n)}if(f){let r=`${t.path}/${e}/${o.R6k.cusMattingFlag.toString()}`;F.H&&!d.P4.instance.isExist(r)&&d.P4.instance.mkdir(r,{recursive:!0}),i.cur_matting_type=o.R6k.cusMattingFlag,i.cur_workspace=r,i.cur_algorithm_config_path=E(`${C.Q}/custom_matting/algorithmConfig.json`)}if(Array.isArray(_)){for(let e of _){let t=[];if(Array.isArray(e.adjustParams))for(let i of e.adjustParams)t.push({[i.name]:i.value});i.strokes.push({feature_path:E(e.path),color:e.color,adjust_params:t})}let r={mattingType:(0,u.DF)(i.base_matting_type),algorithmConfigPath:i.base_algorithm_config_path,workSpace:i.base_workspace,extInfoJson:""},n={mattingType:(0,u.DF)(i.cur_matting_type),algorithmConfigPath:i.cur_algorithm_config_path,workSpace:i.cur_workspace,extInfoJson:""};t.flag&&_.length>0&&(n.mattingType=O.mA.MATTING_TYPE_PORTRAIT,n.algorithmConfigPath=E(`${C.Q}/ai_matting/algorithmConfig.json`),n.workSpace=E(`${C.Q}/editor/ai_matting`));let a={id:`${e}_${s.UO.AiCutOutClipFilter}_video_matting`,type:s.UO.AiCutOutClipFilter,archer_strategy:-1n,blendMode:i.blend_mode,rgba:i.blend_rbga,baseType:i.cur_matting_type&o.R6k.cusMattingFlag?r:{mattingType:O.mA.MATTING_TYPE_NONE,workSpace:"",algorithmConfigPath:"",extInfoJson:""},curType:n,followParam:{isReverse:!1,backupSpace:"",interactiveMaskPath:"",interactiveMaskInfoPath:""},strokeParamJson:(0,u.SB)(i.strokes,i.stroke_blend_path)};(null===(c=this._render.editor)||void 0===c?void 0:c.getFilterById(e,a.id))?null===(p=this._render.editor)||void 0===p||p.updateFilter(a):null===(m=this._render.editor)||void 0===m||m.addFilter(a,e)}}if(y&&t.path){let e=[],i=[];for(let r of t.path.split(";")){let t=k.k.getInstance().pathRecords.get(r);i.push(t),e.push(k.k.getInstance().decryptRecords.get(t))}h.is_matting=!0,h.attach_file_path=i.join(";"),h.attach_file_decrypt_key=e.join(";")}else h.is_matting=!1,h.attach_file_path="",h.attach_file_decrypt_key="";return 0!==(null===(l=this._render.editor)||void 0===l?void 0:l.updateClip(h))?(0,x.wf)(n.FF.updateClipFail,"update video matting fail"):(0,x.ly)()}updateAnimations(e,t){var i,r,a,l,d,u;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let c=`${e}_${s.UO.VideoAnimation}`;if(!t||t.animations.length<=0)return(null===(r=this._render.editor)||void 0===r?void 0:r.getFilterById(e,c))&&(null===(a=this._render.editor)||void 0===a||a.removeFilter(c)),(0,x.ly)();let p="",m=[0n,0n],h="",g=[0n,0n],f="",y=[0n,0n];for(let e of null!==(l=t.animations)&&void 0!==l?l:[]){let{type:t}=e;t===o.VAL.Anim_In?(p=k.k.getInstance().pathRecords.get(e.path),m=[e.start,e.duration]):t===o.VAL.Anim_Out?(h=k.k.getInstance().pathRecords.get(e.path),g=[e.start,e.duration]):t===o.VAL.Anim_Group&&(f=k.k.getInstance().pathRecords.get(e.path),y=[e.start,e.duration])}let _={id:c,useNewAnim:!0,type:s.UO.VideoAnimation,anim_in:{res:p,anim_start:{"time.us":m[0]},anim_end:{"time.us":m[0]+m[1]}},anim_out:{res:h,anim_start:{"time.us":g[0]},anim_end:{"time.us":g[0]+g[1]}},anim_combo:{res:f,anim_start:{"time.us":y[0]},anim_end:{"time.us":y[0]+y[1]}}};return(null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e,c))?null===(d=this._render.editor)||void 0===d||d.updateFilter(_):null===(u=this._render.editor)||void 0===u||u.addFilter(_,e),(0,x.ly)()}updateMask(e,t,i,r){var a,o,d,u,c;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let p=`${e}_${s.UO.AmazingEffect}_mask`,m=(0,R.P2)(t);if(!(null==m?void 0:m.path))return(null===(o=this._render.editor)||void 0===o?void 0:o.getFilterById(e,p))&&(null===(d=this._render.editor)||void 0===d||d.removeFilter(p)),(0,x.ly)();let h={width:m.config.width,height:m.config.height,centerX:m.config.centerX,centerY:m.config.centerY,feather:m.config.feather*m.config.feather,invert:m.config.invert,roundCorner:m.config.roundCorner,rotation:m.config.rotation},_=(0,g.j3)(t,[m.config.width,m.config.height]);_&&(h.width=_[0],h.height=_[1]);let v={id:p,type:s.UO.AmazingEffect,res:k.k.getInstance().pathRecords.get(m.path),param:JSON.stringify(h),render_index:BigInt(l.UJ.VideoMaskOrder),flag:0n};return this._render.config.layerMode===n.de.track&&(v.amazing_effect_algorithm_type=s.r0.STOP_MOTION),(null===(a=this._render.editor)||void 0===a?void 0:a.getFilterById(e,p))?null===(u=this._render.editor)||void 0===u||u.updateFilter(v):null===(c=this._render.editor)||void 0===c||c.addFilter(v,e),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:i,clipId:e,parentId:p,keyframeTypeList:f.oH,delta:r}),(0,x.ly)()}updateChroma(e,t,i,r){var a,o,u,c,p;if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let m=`${e}_${s.UO.AmazingEffect}_chroma`;if(!t)return(null===(o=this._render.editor)||void 0===o?void 0:o.getFilterById(e,m))&&(null===(u=this._render.editor)||void 0===u||u.removeFilter(m)),(0,x.ly)();let h=0,g=0,_=0,v=0;(null==t?void 0:t.color)&&(h=((0,d.ci)(t.color)||255)/255,g=(0,d.fZ)(t.color)/255,_=(0,d.R3)(t.color)/255,v=(0,d.VF)(t.color)/255);let I={color:[g,_,v,h],intensity:t.intensityValue.toString(),shadow:t.shadowValue.toString()};"v2"===t.version&&(I.edge_smooth=String(t.edgeSmoothValue),I.spill=String(t.spillValue));let T={id:m,type:s.UO.AmazingEffect,res:k.k.getInstance().pathRecords.get(t.path),param:JSON.stringify(I),render_index:BigInt(l.UJ.ChromaOrder),flag:0n};return(null===(a=this._render.editor)||void 0===a?void 0:a.getFilterById(e,m))?null===(c=this._render.editor)||void 0===c||c.updateFilter(T):null===(p=this._render.editor)||void 0===p||p.addFilter(T,e),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:i,clipId:e,parentId:m,keyframeTypeList:f.QR,delta:r}),(0,x.ly)()}setClipInfoForOverlapTransition(e,t,i){var r,a,o,s,l,u,c,p,g,f,y,_;let v=i.getSegmentById(t);if(!v)return;let I=v.sourceTimerange.start,T=v.sourceTimerange.duration,k=null===(r=this._render.editor)||void 0===r?void 0:r.getClipBase(t),w=null==k?void 0:k.data;if(!w)return;let A=null!==(c=null==w?void 0:w.curve_speed)&&void 0!==c?c:[],b=1,S=!1;0===A.length?b=null!==(p=w.speed)&&void 0!==p?p:1:(S=!0,b=A[A.length-1].y);let O=d.pM.plus(I+T,d.pM.times(e.duration,b/2),"bigint");if(w.trim_range["out.us"]=O,null===(a=this._render.editor)||void 0===a||a.updateClip(w),null===(o=this._render.editor)||void 0===o||o.updateClipSequenceTime(v.id,null==k?void 0:k.seqIn,v.targetTimerange.start+v.targetTimerange.duration+e.duration/2n),S){d.pM.times(e.duration,b/2,"bigint");let t=[],i=w.trim_range["out.us"]-w.trim_range["in.us"],r=I-w.trim_range["in.us"];for(let e of(r>0&&t.push({x:0,y:A[0].y}),A))t.push({x:(e.x*Number(T)+Number(r))/Number(i),y:e.y});t.push({x:1,y:A[A.length-1].y});let n=new h.C().getCurveAveSpeed(t);w.speed=n,w.curve_speed=t,null===(g=this._render.editor)||void 0===g||g.updateClip(w)}let C=i.getTrackBySegmentId(t);if(!C)return(0,x.wf)(n.FF.segmentInvalid,"segment not in track");let M=new m.Uo().findNextSegment(C,v);if(!M||M.targetTimerange.start-(v.targetTimerange.start+v.targetTimerange.duration)>1)return;let F=null===(s=this._render.editor)||void 0===s?void 0:s.getClipBase(M.id),R=null==F?void 0:F.data;if(!R)return;let E=M.sourceTimerange.start,P=null!==(f=R.curve_speed)&&void 0!==f?f:[],V=1,j=!1;0===P.length?V=null!==(y=R.speed)&&void 0!==y?y:1:(V=P[0].y,j=!0);let z=d.pM.minus(E,d.pM.times(e.duration,V/2),"bigint");if(R.trim_range["in.us"]=z,null===(l=this._render.editor)||void 0===l||l.updateClip(R),null===(u=this._render.editor)||void 0===u||u.updateClipSequenceTime(M.id,M.targetTimerange.start-e.duration/2n,null==F?void 0:F.seqOut),j){let t=d.pM.times(e.duration,V/2,"bigint"),i=[],r=M.sourceTimerange.duration,n=R.trim_range["out.us"]-R.trim_range["in.us"],a=R.trim_range["out.us"]-E-r;for(let e of(i.push({x:0,y:P[0].y}),P))i.push({x:(e.x*Number(r)+Number(t))/Number(n),y:e.y});a>0&&i.push({x:1,y:P[P.length-1].y});let o=new h.C().getCurveAveSpeed(i);R.speed=o,R.curve_speed=i,null===(_=this._render.editor)||void 0===_||_.updateClip(R)}}setClipInfoForRemoveOverlapTransition(e,t){var i,r,a,o,s,l,d,u;null===(i=this._render.editor)||void 0===i||i.updateClipSequenceTime(e.id,e.targetTimerange.start,e.targetTimerange.start+e.targetTimerange.duration);let c=null===(a=this._render.editor)||void 0===a?void 0:null===(r=a.getClipBase(e.id))||void 0===r?void 0:r.data;(null==c?void 0:c.trim_range)&&(c.trim_range["out.us"]=e.sourceTimerange.start+e.sourceTimerange.duration,null===(o=this._render.editor)||void 0===o||o.updateClip(c));let p=t.getTrackBySegmentId(e.id);if(!p)return(0,x.wf)(n.FF.segmentInvalid,"segment not in track");let h=new m.Uo().findNextSegment(p,e);if(!!h){if(h){null===(s=this._render.editor)||void 0===s||s.updateClipSequenceTime(h.id,h.targetTimerange.start,h.targetTimerange.start+h.targetTimerange.duration);let e=null===(d=this._render.editor)||void 0===d?void 0:null===(l=d.getClipBase(h.id))||void 0===l?void 0:l.data;(null==e?void 0:e.trim_range)&&(e.trim_range["in.us"]=h.sourceTimerange.start,null===(u=this._render.editor)||void 0===u||u.updateClip(e))}}}updateEffect(e,t,i){let r=i.getSegmentById(e);if(!e||!r)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let a=this._render.editor.getClipBase(e);if(!a)return(0,x.wf)(n.FF.segmentInvalid,"clip id empty");let o=i.getTrackBySegmentId(e),s=o.segments.indexOf(r)-1,l=s>=0?o.segments[s]:void 0,d=(0,u.p$)(a),c=[],p=[],m=[];for(let e of t){let t=(0,u.bi)(r,e);d.has(t)?(p.push(e),d.delete(t)):c.push(e)}for(let e of d)m.push(e);for(let e of m)this._removeVideoEffect(e);for(let e of p)this._updateVideoEffect(r,e,l);for(let e of c)this._addVideoEffect(r,e,l)}updateFilter(e,t,i){var r,a,d,c;let p=i.getSegmentById(e);if(!e||!p)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let m=this._render.editor.getClipBase(e);if(!m)return(0,x.wf)(n.FF.segmentInvalid,"clip id empty");if(!t){m.filters.has((0,u.u5)(p))&&(null===(r=this._render.editor)||void 0===r||r.removeFilter((0,u.u5)(p)));return}let h={id:(0,u.u5)(p),type:s.UO.AmazingEffect,video_id:`${p.id}`,render_index:BigInt(l.UJ.LocalFilterOrder),res:k.k.getInstance().pathRecords.get(t.path),param:JSON.stringify({intensity:t.value}),amazing_effect_algorithm_type:s.r0.STOP_MOTION};m.filters.has((0,u.u5)(p))?null===(a=this._render.editor)||void 0===a||a.updateFilter(h):null===(d=this._render.editor)||void 0===d||d.addFilter(h,e),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:i,clipId:p.id,parentId:null!==(c=null==h?void 0:h.id)&&void 0!==c?c:"",keyframeTypeList:[o.Eu.KFTypeFilter]})}_addVideoEffect(e,t,i){var r,a,o;let l={};for(let e of(l.intensity=t.value,t.adjustParams))l[e.name]=e.value;let c=e.targetTimerange.start+e.offset,{duration:p}=e.targetTimerange;t.timeRange&&(c+=t.timeRange.start,p=t.timeRange.duration);let m=c,h=p;t.applyTimeRange&&(m+=t.applyTimeRange.start,h=t.applyTimeRange.duration);let g={id:(0,u.bi)(e,t),type:s.UO.AmazingEffect,video_id:`${e.id}`,render_index:BigInt(null!==(o=t.renderIndex)&&void 0!==o?o:0),res:k.k.getInstance().pathRecords.get(t.path),param:JSON.stringify(l),effect_start_offset:d.pM.max([m-c,0n],"bigint"),effect_end_offset:d.pM.max([c+p-(m+h),0n],"bigint")};this._render.config.layerMode===n.de.track&&(g.amazing_effect_algorithm_type=s.r0.STOP_MOTION),(null==i?void 0:null===(r=i.transition)||void 0===r?void 0:r.isOverlap)&&(c+=i.transition.duration/2n),null===(a=this._render.editor)||void 0===a||a.addFilter(g,e.id,c-e.targetTimerange.start,c-e.targetTimerange.start+p)}_updateVideoEffect(e,t,i){var r,a,o;let l={};for(let e of(l.intensity=t.value,t.adjustParams))l[e.name]=e.value;let c=e.targetTimerange.start+e.offset,{duration:p}=e.targetTimerange;t.timeRange&&(c+=t.timeRange.start,p=t.timeRange.duration);let m=c,h=p;t.applyTimeRange&&(m+=t.applyTimeRange.start,h=t.applyTimeRange.duration);let g={id:(0,u.bi)(e,t),type:s.UO.AmazingEffect,video_id:`${e.id}`,render_index:BigInt(null!==(o=t.renderIndex)&&void 0!==o?o:0),res:k.k.getInstance().pathRecords.get(t.path),param:JSON.stringify(l),effect_start_offset:d.pM.max([m-c,0n],"bigint"),effect_end_offset:d.pM.max([c+p-(m+h),0n],"bigint")};this._render.config.layerMode===n.de.track&&(g.amazing_effect_algorithm_type=s.r0.STOP_MOTION),(null==i?void 0:null===(r=i.transition)||void 0===r?void 0:r.isOverlap)&&(c+=i.transition.duration/2n),null===(a=this._render.editor)||void 0===a||a.updateFilter(g)}_removeVideoEffect(e){var t;null===(t=this._render.editor)||void 0===t||t.removeFilter(e)}updateVideoAdjust(e,t,i){var r,a,s,l,d,u,c,m,h,g,f,y,_,v,I,T,w,b,S,O,C;let M=this._render.editor.getClipBase(e.id);if(!M)return(0,x.wf)(n.FF.segmentInvalid,"clip id empty");let F=i||e.adjust;if(!F){this._removeAllAdjust(e,M);return}let{enableAdjust:R}=e;if(void 0!==F.brightness&&this._addNormalAdjust(M,e,R?null===(u=e.adjust)||void 0===u?void 0:u.brightness:null,p.Ab.BRIGHTNESS,t,o.Eu.KFTypeBrightness),void 0!==F.contrast&&this._addNormalAdjust(M,e,R?null===(c=e.adjust)||void 0===c?void 0:c.contrast:null,p.Ab.CONTRAST,t,o.Eu.KFTypeContrast),void 0!==F.saturation&&this._addNormalAdjust(M,e,R?null===(m=e.adjust)||void 0===m?void 0:m.saturation:null,p.Ab.SATURATION,t,o.Eu.KFTypeSaturation),void 0!==F.sharpening&&this._addNormalAdjust(M,e,R?null===(h=e.adjust)||void 0===h?void 0:h.sharpening:null,p.Ab.SHARPENING,t,o.Eu.KFTypeSharpen),void 0!==F.fade&&this._addNormalAdjust(M,e,R?null===(g=e.adjust)||void 0===g?void 0:g.fade:null,p.Ab.COLOR_FADE,t,o.Eu.KFTypeFade),void 0!==F.lightSensation&&this._addNormalAdjust(M,e,R?null===(f=e.adjust)||void 0===f?void 0:f.lightSensation:null,p.Ab.LIGHT_SENSATION,t,o.Eu.KFTypeLightSensatione),void 0!==F.vignetting&&this._addNormalAdjust(M,e,R?null===(y=e.adjust)||void 0===y?void 0:y.vignetting:null,p.Ab.VIGNETTING,t,o.Eu.KFTypeVignetting),void 0!==F.particle&&this._addNormalAdjust(M,e,R?null===(_=e.adjust)||void 0===_?void 0:_.particle:null,p.Ab.PARTICLE,t,o.Eu.KFTypeParticle),R){let i=[],r=[];if(null===(v=e.adjust)||void 0===v?void 0:v.highlight){let{highlight:n}=e.adjust;n.version&&"v1"!==n.version?(this._removeAdjustFilter(e,p.Ab.HIGHLIGHT),!(0,A.o)(t,e,o.Eu.KFTypeHightLight)&&(i.push(n),r.push(o.Eu.KFTypeHightLight))):this._addNormalAdjust(M,e,n,p.Ab.HIGHLIGHT,t,o.Eu.KFTypeHightLight)}else this._removeAdjustFilter(e,p.Ab.HIGHLIGHT);if(null===(I=e.adjust)||void 0===I?void 0:I.shadow){let{shadow:n}=e.adjust;n.version&&"v1"!==n.version?(this._removeAdjustFilter(e,p.Ab.SHADOW),!(0,A.o)(t,e,o.Eu.KFTypeShadow)&&(i.push(n),r.push(o.Eu.KFTypeShadow))):this._addNormalAdjust(M,e,n,p.Ab.SHADOW,t,o.Eu.KFTypeShadow)}else this._removeAdjustFilter(e,p.Ab.SHADOW);this._executeMergedEffect(M,e,i,[o.cVg.MetaTypeShadow,o.cVg.MetaTypeHighlight],p.Ab.SHADOW_HIGHLIGHT,t,r)}if(R){let i=[],r=[];if(null===(T=e.adjust)||void 0===T?void 0:T.colorTemperature){let{colorTemperature:n}=e.adjust;n.version&&"v1"!==n.version?(this._removeAdjustFilter(e,p.Ab.COLOR_TEMPERATURE),!(0,A.o)(t,e,o.Eu.KFTypeTemperature)&&(i.push(n),r.push(o.Eu.KFTypeTemperature))):this._addNormalAdjust(M,e,n,p.Ab.COLOR_TEMPERATURE,t,o.Eu.KFTypeTemperature)}else this._removeAdjustFilter(e,p.Ab.COLOR_TEMPERATURE);if(null===(w=e.adjust)||void 0===w?void 0:w.hue){let{hue:n}=e.adjust;n.version&&"v1"!==n.version?(this._removeAdjustFilter(e,p.Ab.HUE),!(0,A.o)(t,e,o.Eu.KFTypeHue)&&(i.push(n),r.push(o.Eu.KFTypeHue))):this._addNormalAdjust(M,e,n,p.Ab.HUE,t,o.Eu.KFTypeHue)}else this._removeAdjustFilter(e,p.Ab.HUE);this._executeMergedEffect(M,e,i,[o.cVg.MetaTypeHue,o.cVg.MetaTypeTemperature],p.Ab.COLOR_TEMPERATURE_HUE,t,r)}if(F.lut&&(null===(r=e.adjust)||void 0===r?void 0:r.lut)){;this._addNormalAdjust(M,e,(null===(b=e.adjust)||void 0===b?void 0:b.enableLut)&&(C=k.k.getInstance().pathRecords.get(e.adjust.lut.path),1)?e.adjust.lut:null,p.Ab.LUT,t,o.Eu.KFTypeLUT)}void 0!==F.hsl&&((null===(S=e.adjust)||void 0===S?void 0:S.hsl)&&e.adjust.hsl.length?this._addHsl(e,e.adjust.hsl):this._removeAdjust(M,e,p.Ab.HSL)),(null===(a=e.adjust)||void 0===a?void 0:a.enableColorCurves)&&F.colorCurves&&(null===(s=e.adjust)||void 0===s?void 0:s.colorCurves)&&this._addColorCurves(M,e,e.adjust.colorCurves),(null===(l=e.adjust)||void 0===l?void 0:l.enableColorWheels)&&(null===(d=e.adjust)||void 0===d?void 0:d.primaryColorWheels)&&(F.primaryColorWheels&&this._addPrimaryColorWheels(M,e,e.adjust.primaryColorWheels,t),F.logColorWheels&&(null===(O=e.adjust)||void 0===O?void 0:O.logColorWheels)&&this._addLogColorWheels(M,e,e.adjust.logColorWheels,t))}updateVideoFigure(e,t,i){var r,n;let a=t.id,o=null===(r=this._render.editor)||void 0===r?void 0:r.getClipBase(a),s=null==o?void 0:o.data;if(!o||!s)return;let l=(0,u.bN)(o,"single_figure"),d=(0,u.bN)(o,"merge_figure"),c=new Set,m=new Set,h={},g={res_id:"",figureMap:{},catetory:_.a9.kMakeUp,effect_id:""};for(let r of e){if(i.isFigureDisabled(r))continue;let{intensityKey:e,resourceId:n,version:a}=r,o=(0,p.qR)(r);if("v2"===a&&"makeup"===r.categoryId&&!(0,M.W)(r)&&(g.figureMap[n]=o),e){let e=(0,u.cd)(t,o.path),i=h[o.path];if(i&&i.figureMap)i.figureMap[n]=o;else{let t={res_id:n,filter_id:e,figureMap:{[n]:o}};h[o.path]=t}}else{let e=(0,u.bh)(t,r);if((0,_.KL)(o))continue;l.has(e)?(l.delete(e),m.add({videoSegment:t,figureFilter:o,filterId:e,isMergeFigure:!1,resourceId:n})):c.add({videoSegment:t,figureFilter:o,filterId:e,isMergeFigure:!1,resourceId:n})}}for(let e of Object.keys(h)){let i=h[e],{filter_id:r=""}=i;if((0,_.dK)(i))continue;let a=v.R.getMergeFigureCache(r);if(a&&a.figureMap){let{figureMap:e={}}=a;for(let t in e){if(null===(n=i.figureMap)||void 0===n?void 0:n[t])continue;!i.figureMap&&(i.figureMap={});let r=e[t];i.figureMap[t]={...r,strength:0,extra_params:Object.keys(r.extra_params).reduce((e,t)=>({...e,[t]:0}),{}),face_adjust_params:Object.keys(r.face_adjust_params||{}).reduce((e,t)=>{let i=r.face_adjust_params[t],n={...i,adjust_params:Object.keys(i.adjust_params).reduce((e,t)=>({...e,[t]:0}),{})};return{...e,[t]:n}},{})}}}d.has(r)?(d.delete(r),m.add({videoSegment:t,figureFilter:i,filterId:r,isMergeFigure:!0,resourceId:i.res_id})):c.add({videoSegment:t,figureFilter:i,filterId:r,isMergeFigure:!0,resourceId:i.res_id})}for(let e of m){let{isMergeFigure:t,figureFilter:i,filterId:r,videoSegment:n,resourceId:a}=e,o=(0,_.qY)(a);t?this._updateMergeFigure(n,i,r,o):this._updateFigure(n,i,r,o)}for(let e of c){let{isMergeFigure:t,figureFilter:i,filterId:r,videoSegment:n,resourceId:a}=e,o=(0,_.qY)(a);t?this._addMergeFigure(n,i,r,o):this._addFigure(n,i,r,o)}for(let e of[...l||[],...d||[]])this._removeFigure(e);let{makeupRoot:f}=t,y=this.identifierMap[t.id];if(f&&f.path&&Object.keys(g.figureMap).length>0){let e=new _.Bc;e.path=f.path,e.resource_id=f.resourceId,e.sub_type=f.subType,e.algorithm_cache_folder=f.algorithmArtifactPath,e.intensity_key=f.intensityKey,e.catetory=_.a9.kMakeUp,y?(g.res_id=y.res_id,g.effect_id=y.effect_id,this._videoSetRootPack(a,g,e)):(g.res_id=f.resourceId,g.effect_id=this._videoAddRootPack(a,g,e),this.identifierMap[t.id]=g)}else y&&(this._removeFigure(y.effect_id),delete this.identifierMap[t.id]);return(0,x.ly)()}enableFaceQuery(e,t,i){var r,a;let o=i.getSegmentById(e);if(!o||!(0,T.he)(o))return(0,x.wf)(n.FF.segmentInvalid,"no video segment");let s=null===(r=this._render.editor)||void 0===r?void 0:r.getClipBase(e);if(!s)return(0,x.wf)(n.FF.segmentInvalid,"no videoClip");let l=(0,u.bN)(s,"face-query"),d=`${e}_face-query`;if(l.has(d))return;let c=(0,I.T)(t),m=(0,w.yK)(c),h=(0,p.qR)(m);(0,_.fA)(h);let g={...(0,_.HT)(0,h,d,o.visible),video_id:o.id};null===(a=this._render.editor)||void 0===a||a.addFilter(g,o.id)}disableFaceQuery(e,t){var i,r;let a=t.getSegmentById(e);if(!a||!(0,T.he)(a))return(0,x.wf)(n.FF.segmentInvalid,"no video segment");let o=null===(i=this._render.editor)||void 0===i?void 0:i.getClipBase(e);if(!o)return(0,x.wf)(n.FF.segmentInvalid,"no videoClip");let s=(0,u.bN)(o,"face-query"),l=`${a.id}_face-query`;s.has(l)&&(null===(r=this._render.editor)||void 0===r||r.removeFilter(l))}updateSmartCrop(e){var t,i,r,a,o,s;if(!(null===(t=this._render.editor)||void 0===t?void 0:t.getClipBase(e.id)))return(0,x.wf)(n.FF.segmentInvalid,"no videoClip");let{smartCrop:l}=e,d=(0,u.FI)(e.id);if(l){let t=(0,p.lA)(l),n=(0,u.fW)(d,t);(null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e.id,n.id))?null===(r=this._render.editor)||void 0===r||r.updateFilter(n):null===(a=this._render.editor)||void 0===a||a.addFilter(n,e.id)}else(null===(o=this._render.editor)||void 0===o?void 0:o.getFilterById(e.id,d))&&(null===(s=this._render.editor)||void 0===s||s.removeFilter(d))}updateDigitalHumanBackground(e,t,i){var r,a,l,d,u,c,p,m,h,g;let f=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let y=`${e}_${s.UO.VideoBackground}_${this._digitalHumanBackgroundFilterCount}`;if((null===(r=i.digitalHuman)||void 0===r?void 0:r.background)&&(null===(a=t.digitalHuman)||void 0===a?void 0:a.background)){let i={id:y,parent_id:e,type:s.UO.VideoBackground,visible:!0,video_file_path:t.digitalHuman.background.type===o.cVg.MetaTypeCanvasImage?k.k.getInstance().pathRecords.get(t.digitalHuman.background.value):"",color:t.digitalHuman.background.type===o.cVg.MetaTypeCanvasColor?t.digitalHuman.background.value:"",effect_clip_decode_type:t.digitalHuman.background.type===o.cVg.MetaTypeCanvasImage?"EFFECT_CLIP_DECODE_IMAGE":"EFFECT_CLIP_BACKGROUND_COLOR",trim_range:{"in.us":0n,"out.us":-1n}};(null===(c=this._render.editor)||void 0===c?void 0:c.getFilterById(e,y))?(null===(p=this._render.editor)||void 0===p||p.removeFilter(y),this._digitalHumanBackgroundFilterCount++,i.id=`${e}_${s.UO.VideoBackground}_${this._digitalHumanBackgroundFilterCount}`,null===(m=this._render.editor)||void 0===m||m.addFilter(i,e)):null===(h=this._render.editor)||void 0===h||h.addFilter(i,e)}else((null===(l=i.digitalHuman)||void 0===l?void 0:l.background)===null||f&&!(null===(d=t.digitalHuman)||void 0===d?void 0:d.background))&&(null===(u=this._render.editor)||void 0===u?void 0:u.getFilterById(e,y))&&(null===(g=this._render.editor)||void 0===g||g.removeFilter(y),this._digitalHumanBackgroundFilterCount++);return(0,x.ly)()}updateDigitalHumanMask(e,t,i){var r,a,o,d,u,c,p,m,h,g,f;let y=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e)return(0,x.wf)(n.FF.segmentInvalid,"video id empty");let _=`${e}_${s.UO.AmazingEffect}_digital_human_mask`;if((null===(r=i.digitalHuman)||void 0===r?void 0:r.mask)&&(null===(a=t.digitalHuman)||void 0===a?void 0:a.mask)){let{mask:i}=t.digitalHuman;if(!(null==i?void 0:i.path))return(null===(p=this._render.editor)||void 0===p?void 0:p.getFilterById(e,_))&&(null===(m=this._render.editor)||void 0===m||m.removeFilter(_)),(0,x.ly)();let r={width:i.config.width,height:i.config.height,centerX:i.config.centerX,centerY:i.config.centerY,feather:i.config.feather,invert:i.config.invert,roundCorner:i.config.roundCorner,rotation:i.config.rotation},a={id:_,type:s.UO.AmazingEffect,res:k.k.getInstance().pathRecords.get(i.path),param:i.positionInfo.length>0?i.positionInfo:JSON.stringify(r),render_index:BigInt(l.UJ.VideoMaskOrder),flag:0n};this._render.config.layerMode===n.de.track&&(a.amazing_effect_algorithm_type=s.r0.STOP_MOTION),(null===(c=this._render.editor)||void 0===c?void 0:c.getFilterById(e,_))?null===(h=this._render.editor)||void 0===h||h.updateFilter(a):null===(g=this._render.editor)||void 0===g||g.addFilter(a,e)}else((null===(o=i.digitalHuman)||void 0===o?void 0:o.mask)===null||y&&!(null===(d=t.digitalHuman)||void 0===d?void 0:d.mask))&&(null===(u=this._render.editor)||void 0===u?void 0:u.getFilterById(e,_))&&(null===(f=this._render.editor)||void 0===f||f.removeFilter(_));return(0,x.ly)()}updateObjectLock(e,t,i){return e?(y.Rj.updateLockKeyframes({render:this._render,videoDocument:t,videoId:e,delta:i}),(0,x.ly)()):(0,x.wf)(n.FF.segmentInvalid,"video id empty")}_removeAllAdjust(e,t){for(let i of[p.Ab.HSL,p.Ab.VIDEO_COLOR_CURVES,p.Ab.VIDEO_PRIMARY_COLOR_WHEELS,p.Ab.VIDEO_LOG_COLOR_WHEELS,p.Ab.SMART_COLOR_ADJUST,p.Ab.BRIGHTNESS,p.Ab.CONTRAST,p.Ab.SATURATION,p.Ab.SHARPENING,p.Ab.HIGHLIGHT,p.Ab.SHADOW,p.Ab.SHADOW_HIGHLIGHT,p.Ab.COLOR_TEMPERATURE,p.Ab.HUE,p.Ab.COLOR_TEMPERATURE_HUE,p.Ab.COLOR_FADE,p.Ab.LIGHT_SENSATION,p.Ab.VIGNETTING,p.Ab.PARTICLE,p.Ab.LUT])this._removeAdjust(t,e,i)}_addNormalAdjust(e,t,i,r,n,a){let o=!1;if(i?i&&(0,A.o)(n,t,a)&&(o=!0):o=!0,o)this._removeAdjustFilter(t,r);else{var s,l,d;let o=(0,c.Yn)(t,i,r);(0,u.$5)(e,t,r)?null===(s=this._render.editor)||void 0===s||s.updateFilter(o):null===(l=this._render.editor)||void 0===l||l.addFilter(o,t.id),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:n,clipId:t.id,parentId:null!==(d=null==o?void 0:o.id)&&void 0!==d?d:"",keyframeTypeList:[a]})}}_executeMergedEffect(e,t,i,r,n,a,o){if(i.length>0){var s,l,d;let p=(0,c.dw)(t,i,r,n);(0,u.$5)(e,t,n)?null===(s=this._render.editor)||void 0===s||s.updateFilter(p):null===(l=this._render.editor)||void 0===l||l.addFilter(p,t.id),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:a,clipId:t.id,parentId:null!==(d=null==p?void 0:p.id)&&void 0!==d?d:"",keyframeTypeList:o})}else this._removeAdjustFilter(t,n)}_removeAdjustFilter(e,t){var i,r;let n=(0,u.Nq)(e,t);(null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e.id,n))&&(null===(r=this._render.editor)||void 0===r||r.removeFilter(n))}_addHsl(e,t){var i,r,n;let a=(0,u.Nq)(e,p.Ab.HSL),o=null===(i=this._render.editor)||void 0===i?void 0:i.getFilterById(e.id,a),s=(0,c.z0)(e,t,o);o?null===(r=this._render.editor)||void 0===r||r.updateFilter(s):null===(n=this._render.editor)||void 0===n||n.addFilter(s,e.id)}_addColorCurves(e,t,i){var r,n;let a=(0,c.yN)(t,i);(0,u.$5)(e,t,p.Ab.VIDEO_COLOR_CURVES)?null===(r=this._render.editor)||void 0===r||r.updateFilter(a):null===(n=this._render.editor)||void 0===n||n.addFilter(a,t.id)}_addPrimaryColorWheels(e,t,i,r){var n,a,s;let l=(0,c.v7)(t,i);(0,u.$5)(e,t,p.Ab.VIDEO_PRIMARY_COLOR_WHEELS)?null===(n=this._render.editor)||void 0===n||n.updateFilter(l):null===(a=this._render.editor)||void 0===a||a.addFilter(l,t.id),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:r,clipId:t.id,parentId:null!==(s=null==l?void 0:l.id)&&void 0!==s?s:"",keyframeTypeList:[o.Eu.KFTypePrimaryColorWheelIntensity]})}_addLogColorWheels(e,t,i,r){var n,a,s;let l=(0,c.Mr)(t,i);(0,u.$5)(e,t,p.Ab.VIDEO_LOG_COLOR_WHEELS)?null===(n=this._render.editor)||void 0===n||n.updateFilter(l):null===(a=this._render.editor)||void 0===a||a.addFilter(l,t.id),y.Rj.executeUpdateByTypeList({render:this._render,videoDocument:r,clipId:t.id,parentId:null!==(s=null==l?void 0:l.id)&&void 0!==s?s:"",keyframeTypeList:[o.Eu.KFTypeLogColorWheelIntensity]})}_removeAdjust(e,t,i){if((0,u.$5)(e,t,i)){var r;null===(r=this._render.editor)||void 0===r||r.removeFilter((0,u.Nq)(t,i))}}_addFigure(e,t,i,r){var n;(0,_.fA)(t);let a={...(0,_.HT)(r,t,i,!0),video_id:e.id};null===(n=this._render.editor)||void 0===n||n.addFilter(a,e.id)}_updateFigure(e,t,i,r){var n;let a={...(0,_.HT)(r,t,i,!0),video_id:e.id};null===(n=this._render.editor)||void 0===n||n.updateFilter(a)}_removeFigure(e){var t;null===(t=this._render.editor)||void 0===t||t.removeFilter(e)}_addMergeFigure(e,t,i,r){var n;v.R.setMergeFigureCache(i,t);let{res_id:a,figureMap:o}=t;(0,_.fA)(null==o?void 0:o[a||""]);let s={...(0,_.a7)(i,t,r),video_id:e.id};null===(n=this._render.editor)||void 0===n||n.addFilter(s,e.id)}_updateMergeFigure(e,t,i,r){var n;v.R.setMergeFigureCache(i,t);let a={...(0,_.a7)(i,t,r),video_id:e.id};null===(n=this._render.editor)||void 0===n||n.updateFilter(a)}_videoAddRootPack(e,t,i){var r,n;if(null===(null===(r=this._render.editor)||void 0===r?void 0:r.getClipBase(e)))return"";let a=(0,_.qY)(t.res_id),o=(0,_.vD)(e),s=(0,_.a7)(o,t,a,i);return null===(n=this._render.editor)||void 0===n||n.addFilter(s,e),o}_setVideoMergeFigureRootPack(e,t,i,r){if(!i||!i.effect_id||!e)return"";let n=i.effect_id,a=e.filters.get(n);if(a){let e=(0,_.a7)(n,i,t,r);return this._render.editor.updateFilter(e),a.id}return""}_videoSetRootPack(e,t,i){let r=this._render.editor.getClipBase(e);if(!r)return"";let n=(0,_.qY)(t.res_id);return this._setVideoMergeFigureRootPack(r,n,t,i),""}constructor(...e){super(...e),this._digitalHumanBackgroundFilterCount=0}}},216917:function(e,t,i){"use strict";i.d(t,{w:function(){return r}});class r{}},39264:function(e,t,i){"use strict";i.d(t,{J:function(){return o}});var r=i(800788),n=i(216917),a=i(940105);class o extends n.w{getSpGlobalConfig(){return null}getMediaFileInfo(e,t){return Promise.resolve(this._utils.getMediaFileInfo(e,t))}getMediaFileInfoSync(e,t){return this._utils.getMediaFileInfo(e,t)}putAssetUrl(e,t,i,n,a,o,s,l,d){(0,r.ss)("no need")}startPreload(e,t){(0,r.ss)("no need")}clearResource(e){(0,r.ss)("no need")}checkIsQuickImportSupport(e,t){(0,r.ss)("no need")}getQuickImportInfo(e,t){(0,r.ss)("no need")}getTemplateParam(e){return Promise.resolve(this._utils.getTemplateParam(e))}setGlobalAllowedPaths(e){return Promise.resolve(this._utils.setGlobalAllowedPaths(e))}scriptSegmentPreload(e){return this._utils.scriptSegmentPreload(e)}scriptStandaloneInit(e,t){this._utils.scriptStandaloneInit(e,t)}scriptStandaloneRelease(e){this._utils.scriptStandaloneRelease(e)}scriptStandaloneGetParams(e){return this._utils.scriptStandaloneGetParams(e)}scriptStandaloneSetParams(e,t){return""}getLetterSegment(e){return Promise.resolve(this._utils.getLetterSegment(e))}peekEffectResource(e){return[]}getInfoStickerData(e){return"{}"}convertRichTextXml2Json(e){return a.Q.xmlToJson(e)}estimateExportGIFSize(e){return Promise.resolve(0)}convertCaptionSplitLinePage(e){return""}constructor(e){super(),this.createdPromise=Promise.resolve(void 0);let{utils:t}=e;this._utils=t}}},998179:function(e,t,i){"use strict";i.d(t,{BW:function(){return h},aB:function(){return m},fT:function(){return p},gg:function(){return c}});var r=i(211561),n=i(192131),a=i(660533),o=i(396402),s=i(340294),l=i(342040),d=i(524208);function u(e,t){let i=[],n=0,a=0,o=0,d=s.pM.div(t,1e6);for(let t of e){let e={};e.anim_type=t.type,e.anim_script_type="lua",e.anim_resource_id=t.resourceId,e.anim_resource_path=l.k.getInstance().pathRecords.get(t.path);let r=s.pM.div(t.duration,1e6);"loop"===t.type?n=r:"out"===t.type?a=r:o=r,e.loop_duration=0,e.duration=r,i.push(e)}for(let e of i){let t=e.anim_type;if("loop"===t)o>1e-4?e.anim_start_time=Number(o)+.001:e.anim_start_time=0,e.loop_duration=n,e.duration=d-o-a;else if("out"===t){let t=d-a;t>1e-4?e.anim_start_time=Number(t)+.001:e.anim_start_time=0}else e.anim_start_time=0}return[r.VAL.Anim_In,r.VAL.Anim_Out,r.VAL.Anim_Loop].forEach(e=>{if(!i.some(t=>t.anim_type===e))i.push({anim_type:e,anim_resource_path:""})}),i}function c(e){var t,i,r,a;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{path:c}=e.material,p=e.material.resources.map(e=>({path:e.path,resourceId:e.resourceId,type:"system-fonts"===e.panel?"fonts":e.panel})),m=0,h=0;m=1920,h=1080;let g={path:l.k.getInstance().pathRecords.get(c),depend_resource_list:p.map(e=>({type:e.type,resource_id:e.resourceId,path:l.k.getInstance().pathRecords.get(e.path)})),screen_size:{w:m,h},fallbackFontPathList:[]},f=[];for(let r of e.material.textInfoResources){let{textMaterial:a}=r,o=r.textEffectMaterials,l=r.textShapeMaterial,c={};c.text_params=(0,n.F)(a,l,o[0],!0,d),c.undo_redo_opt=!0,c.start_time=s.pM.div(r.attachInfo.startTime+e.targetTimerange.start,1e6),c.duration=s.pM.div(r.attachInfo.duration,1e6);let p=r.attachInfo.clip?r.attachInfo.clip.transform.x:0,m=r.attachInfo.clip?r.attachInfo.clip.transform.y:0;c.position=[p,m,0],c.rotation=r.attachInfo.clip?[0,0,-r.attachInfo.clip.rotation]:[0,0,0];let h=r.attachInfo.clip?r.attachInfo.clip.scale.x:1,g=r.attachInfo.clip?r.attachInfo.clip.scale.y:1;c.scale=[h,g,1],c.original_size=[r.attachInfo.originalSizeWidth,r.attachInfo.originalSizeHeight];let y=null!==(i=null===(t=r.textAnimateMaterial)||void 0===t?void 0:t.animations)&&void 0!==i?i:[];c.anims=u(y,r.attachInfo.duration),c.name=a.name,c.type="text",f.push(c)}for(let t of e.material.nonTextInfoResources){let i={};i.start_time=s.pM.div(t.attachInfo.startTime+e.targetTimerange.start,1e6),i.duration=s.pM.div(t.attachInfo.duration,1e6);let n=t.attachInfo.clip?t.attachInfo.clip.transform.x:0,o=t.attachInfo.clip?t.attachInfo.clip.transform.y:0;i.position=[n,o,0],i.rotation=t.attachInfo.clip?[0,0,-t.attachInfo.clip.rotation]:[0,0,0];let l=t.attachInfo.clip?t.attachInfo.clip.scale.x:1,d=t.attachInfo.clip?t.attachInfo.clip.scale.y:1;i.scale=[l,d,1],i.original_size=[t.attachInfo.originalSizeWidth,t.attachInfo.originalSizeHeight],"shape"===t.type&&t.shapeParam.points.length&&(i.shape_params={custom_points:{points:t.shapeParam.points},shape_type:t.shapeParam.shapeType});let c=null!==(a=null===(r=t.animateMaterialInfo)||void 0===r?void 0:r.animations)&&void 0!==a?a:[];i.anims=u(c,t.attachInfo.duration),i.name=t.name,i.type=t.type,f.push(i)}let y={};y.start_time=s.pM.div(e.offset+e.targetTimerange.start,1e6),y.duration=s.pM.div(e.targetTimerange.duration,1e6);let _=e.clip?e.clip.transform.x:0,v=e.clip?e.clip.transform.y:0;y.position=[_,v,0],y.rotation=e.clip?[0,0,-e.clip.rotation]:[0,0,0];let I=e.clip?e.clip.scale.x:1,T=e.clip?e.clip.scale.y:1;y.scale=[I,T,1];let x={depend_resource_list:e.material.resources.map(e=>({resource_id:e.resourceId,resource_path:l.k.getInstance().pathRecords.get(e.path),type:e.panel})),fallback_font_path_list:[],path:l.k.getInstance().pathRecords.get(e.material.path),screen_size:[864,486]},k=s.HH.stringify({root:y,type:"ScriptTemplate",children:f,childrenOperation:"mod"}),w={};w.filter={id:e.id,json:s.HH.stringify(g),update_param:k,rawJson:k,production_side:!1,visible:!0,type:o.UO.ScriptSticker},w.id=e.id,w.type=o.AM.Effect,w.stream_type=o.vG.AudioOnly,w.is_visible=!0,w.res=s.HH.stringify(x);let A=e.targetTimerange.start+e.offset,b=e.targetTimerange.duration+A;return w.trim_range={"in.us":A,"out.us":b},w.id=e.id,w.segment_id=e.id,w}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];for(let o=0;o<e.material.textInfoResources.length;o++){var r,n;let d=e.material.textInfoResources[o],{textMaterial:u}=d,c=d.textEffectMaterials,p=d.textShapeMaterial;i.push({index:o,text_params:(0,a.G)(u,p,c[0],t),anims:function(e){let t=[];for(let i of e){let e={};if(e.anim_type=i.type,e.anim_resource_id=i.resourceId,0!==i.resourceId.length)e.anim_resource_path=l.k.getInstance().pathRecords.get(i.path),e.anim_resource_path_abs=l.k.getInstance().pathRecords.get(i.path);else{let t=l.k.getInstance().pathRecords.get(i.path),r=l.k.getInstance().pathRecords.get(i.path);0!==t.length?e.anim_resource_path=t:e.anim_resource_path="",0!==r.length?e.anim_resource_path_abs=r:e.anim_resource_path_abs=""}e.duration=s.pM.div(i.duration,1e6),t.push(e)}return t}(null!==(n=null===(r=d.textAnimateMaterial)||void 0===r?void 0:r.animations)&&void 0!==n?n:[])})}let d=e.clip?e.clip.scale.x:1,u=e.clip?e.clip.scale.y:1,c=e.clip?e.clip.transform.x:0,p=e.clip?e.clip.transform.y:0,m={rotation:e.clip?-e.clip.rotation:0,scale:[d,u],position:[c,p],order_in_layer:e.renderIndex,start_time:s.pM.div(e.targetTimerange.start+e.offset,1e6),duration:s.pM.div(e.targetTimerange.duration,1e6),text_list:i},h={depend_resource_list:e.material.resources.map(e=>({resource_id:e.resourceId,path:l.k.getInstance().pathRecords.get(e.path)}))},g={id:e.id,segment_id:e.id,type:o.AM.Effect,stream_type:o.vG.AudioOnly,res:l.k.getInstance().pathRecords.get(e.material.path),is_visible:!0};g.filter={id:e.id,is_richtext:!1,is_resolution_design_height:!1,is_buffered:!1,json:s.HH.stringify(m),dependent_resource_param:s.HH.stringify(h),res:l.k.getInstance().pathRecords.get(e.material.path),type:o.UO.StickerTemplate,visible:!0,param:[]};let f=e.targetTimerange.start+e.offset,y=e.targetTimerange.duration+f;return g.trim_range={"in.us":f,"out.us":y},g}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,d.F)(e)?c(e,t):p(e,t)}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(e,t).filter.rawJson}},433188:function(e,t,i){"use strict";i.d(t,{WA:function(){return s},sm:function(){return c},u4:function(){return d},vU:function(){return u},wL:function(){return n}});var r=i(396402);let n=e=>{let t={pinAlgPath:"",pinMappingPath:""};return e?(e.enableVideoTracking&&!e.version&&(t.pinMappingPath=e.mapPath,t.pinAlgPath=e.resultPath),t):t},a=(e,t,i,r,n,a)=>({editRT_param:{iOpCode:0,iParam1:0,iParam2:0,iParam3:0,iParam4:0,pParam5:""},is_brushSticker:!1,is_buffered:!1,is_resolution_design_height:!1,is_richtext:!1,pinAlgPath:"",pinMappingPath:"",priv:{},visible:n,type:a,id:e,res:t,param:i,filterLayer:r}),o=(e,t,i,n)=>{let a={};switch(t.type){case r.UO.AmazingEffect:case r.UO.InfoSticker:case r.UO.EmojiSticker:case r.UO.VideoAnimation:a.res=t.res}return a.filter=t,a.id=e,a.type=r.AM.Effect,a.is_visible=t.visible,a.trim_range={"in.us":i.start,"out.us":i.start+i.duration},a.segment_id=n,a},s=e=>{let t={isText:!1,unicode:e.utf8code,timeRange:e.timerange,stickerFilter:a(`${e.segmentId}_${r.UO.EmojiSticker}`,e.utf8code,[],0n,!0,r.UO.EmojiSticker)};return o(e.segmentId,t.stickerFilter,e.timerange,e.segmentId)},l=(e,t)=>{let i=[];return e>=0&&t>=0&&(i=["0","0","0","0",JSON.stringify({info_sticker_default_params:{alpha:1,normalized_width:e,normalized_height:t}})]),i},d=e=>{let t={isText:!1,material:e.material.replaceAll("\\","/"),timeRange:e.timerange},i=l(e.width,e.height),n=a(`${e.segmentId}_${r.UO.InfoSticker}`,t.material,i,0n,e.visible,r.UO.InfoSticker);return e.isHandwirte&&(n.is_brushSticker=!0),t.stickerFilter=n,o(e.segmentId,n,e.timerange,e.segmentId)},u=e=>d(e),c=e=>{if(!e.animAdjustParams||""===e.animAdjustParams.animMode&&""===e.animAdjustParams.direction)return"";let t={};return e.animAdjustParams.direction&&(t.animation_adjust_direction=e.animAdjustParams.direction),e.animAdjustParams.animMode&&(t.animation_adjust_content_mode=e.animAdjustParams.animMode),JSON.stringify(t)}},266302:function(e,t,i){"use strict";i.d(t,{q:function(){return s},s:function(){return l}});var r=i(211561);let n=(e,t)=>{let i=0,r=Array(t.length+1).fill(0).map(()=>Array(e.length+1).fill(0)),n=Array(t.length+1).fill("").map(()=>Array(e.length+1).fill("")),a=Array(t.length+1).fill(0).map(()=>Array(e.length+1).fill(0));for(let o=1;o<t.length+1;o++){let s=t.substr(0,o);for(let t=1;t<e.length+1;t++){let l=e[t-1];i=a[o-1][t-1];let d=s.indexOf(l,i),u=l.length+r[o-1][t-1],c=s.indexOf(l),p=l.length;(d>=0&&p>u||d<0)&&c>=0&&p>r[o][t-1]&&p>r[o-1][t]?(r[o][t]=p,n[o][t]=`${"0".repeat(t-1)}1`,a[o][t]=l.length):d>=0&&u>r[o][t-1]&&u>r[o-1][t]?(r[o][t]=u,n[o][t]=`${n[o-1][t-1]}1`,a[o][t]=d+l.length):r[o-1][t]>r[o][t-1]?(r[o][t]=r[o-1][t],n[o][t]=n[o-1][t],a[o][t]=a[o-1][t]):(r[o][t]=r[o][t-1],n[o][t]=`${n[o][t-1]}0`,a[o][t]=a[o][t-1])}}return n[t.length][e.length]},a=(e,t)=>{let{text:i,startTime:a,endTime:o}=e,s=Array(i.length).fill(""),l=Array(i.length).fill(-1n),d=Array(i.length).fill(-1n),u=n(i,t),c=0,p=Array(i.length).fill(-1),m=Array(i.length).fill(-1);for(let e=0;e<u.length;e++){if("0"===u[e])continue;let r=t.indexOf(i[e],c);c=r+i[e].length,p[e]=r,m[e]=c-1,s[e]=i[e],l[e]=a[e],d[e]=o[e]}c=-2;let h=-1;for(let e=0;e<p.length;e++)if(p[e]<0){if(h<0&&(h=e),e===p.length-1){if(t.length===c)continue;s[h]+=t.substring(Math.max(c,0)),l[h]=a[h],d[h]=o[e]}}else h>=0?(0===h?p[e]>0&&(s[0]=t.substring(0,p[e]),l[0]=a[0],d[0]=o[e-1]):p[e]>m[h-1]+1&&(s[h]=t.substring(c,c+(p[e]-m[h-1]-1)),l[h]=a[h],d[h]=o[e-1]),h=-1):(c<0||p[e]===c?(c<0&&(s[e]=t.substring(0,p[e])+s[e]),c=m[e]+1):p[e]>Math.max(c,0)&&(s[e]=t.substring(c,p[e])+s[e]),e===p.length-1&&(s[e]+=t.substring(m[e]+1))),c=m[e]+1;return new r.H1R({text:s.filter((e,t)=>l[t]>=0),startTime:l.filter((e,t)=>l[t]>=0),endTime:d.filter((e,t)=>l[t]>=0)})},o=(e,t)=>[{text:e,start_time:0,end_time:Number(t)}],s=(e,t,i)=>{let r=e.clone();if(!r)return o(t,i);let n="";for(let e of r.text)n+=e;let s=n===t;if(0===r.text.length)return o(t,i);r.text.length,!s&&(r=a(r,t));let l=r.startTime[0];return l>0&&i>0&&r.endTime[r.text.length-1]>i&&r.text.forEach((e,t)=>{r.startTime[t]>=l&&(r.startTime[t]=r.startTime[t]-l,r.endTime[t]=r.endTime[t]-l)}),r.text.map((e,t)=>({start_time:Number(r.startTime[t]),end_time:Number(r.endTime[t]),text:r.text[t]}))},l=(e,t)=>{let i=t.range;if(!(null==i?void 0:i.length))return e;let r=[],n=0,a=0,o=0,s=0;for(let t of e){let l=t.text.length;if(0===l){a++;continue}let d=i[n],{text:u,start_time:c,end_time:p}=t,m=(p-c)/l;if(d.location<=o&&d.location+d.length>=o+l)t.is_key=!0,r.push(t);else if(d.location<=o&&d.location+d.length<o+l){let e=d.location+d.length-o;r.push({text:u.slice(0,e),start_time:c+0*m,end_time:c+(0+e)*m,is_key:!0}),s=e}else if(d.location>o&&d.location+d.length<=o+l){let e=d.length,t=d.location-o,i=t-s;i>0&&r.push({text:u.slice(s,i),start_time:c+s*m,end_time:c+(s+i)*m}),r.push({text:u.slice(t,e),start_time:c+t*m,end_time:c+(t+e)*m,is_key:!0}),s=t+e}else if(d.location>o&&d.location<o+l&&d.location+d.length>o+l){let e=o+l-d.location,t=d.location-o,i=t-s;i>0&&r.push({text:u.slice(s,i),start_time:c+s*m,end_time:c+(s+i)*m}),r.push({text:u.slice(t,e),start_time:c+t*m,end_time:c+(t+e)*m,is_key:!0})}else{let e=l-s;s>0&&e>0?r.push({text:u.slice(s,e),start_time:c+s*m,end_time:c+(s+e)*m}):r.push(t)}if(o+l>=d.location+d.length&&n++,o+l<=d.location+d.length&&(s=0,a++,o+=l),n>=i.length){let t=l-s;for(s>0&&t>0&&(r.push({text:u.slice(s,t),start_time:c+s*m,end_time:c+(s+t)*m}),a++,o+=l);a<e.length;){let t=e[a];r.push(t),a++}break}}return r}},524392:function(e,t,i){"use strict";i.d(t,{x:function(){return o}});var r=i(340294),n=i(337609),a=i(805794);class o{async destroy(){var e,t;this._callbackHandle&&(0,n.aS)(this._callbackHandle),this._multiErrorCallbackHandle&&(0,n.aS)(this._multiErrorCallbackHandle),this._objectLockAlgorithm&&(await (0,n.kB)(null===(e=this._objectLockAlgorithm)||void 0===e?void 0:e.destroy(),-1,"destroy"),null===(t=this._objectLockAlgorithm)||void 0===t||t.delete(),this._objectLockAlgorithm=null)}getVideoObjectLockResult(e){return new Promise(async(t,i)=>{var o,s;this._objectLockAlgorithm&&await this.destroy(),this._objectLockAlgorithm=this._utilWrapper.createAlgorithm(Module.VEAlgorithmType.VEAlgorithmTypeObjectLock),!this._objectLockAlgorithm&&(a.B.error("[render]createAlgorithm fail!!",JSON.stringify(e)),i()),0!==await (0,n.kB)(null===(s=this._objectLockAlgorithm)||void 0===s?void 0:null===(o=s.initObjectLock)||void 0===o?void 0:o.call(s,{type:Module.VEAlgorithmType.VEAlgorithmTypeObjectLock,selectedObjectID:0,lockState:Module.VEObjectLockState.LOCK_STATE_SCAN_OBJECT,lockProperty:{bDeleteBlackBorder:!1,bFixedAreaFactor:!1,fRotationStrength:.5,fShiftThresh:.1,fScaleThresh:.05,fRotateThresh:.1,strObjectBox:""},strWorkSpace:"",...e}),-1,"initObjectLock")&&(await this.destroy(),i());let l=(0,n.r7)(),d=(0,n.r7)();this._callbackHandle=(0,n.O3)({className:"VEAlgorithmBind",funcName:"Callback",listenerId:l,cb:async e=>{let{process:i}=e;if(1===i){var r,a;let e=await (0,n.kB)(null===(a=this._objectLockAlgorithm)||void 0===a?void 0:null===(r=a.getObjectLockResult)||void 0===r?void 0:r.call(a),[],"getObjectLockResult");return await this.destroy(),t(e)}}}),this._multiErrorCallbackHandle=(0,n.O3)({className:"VEAlgorithmBind",funcName:"MultiErrorCallback",listenerId:d,cb:async e=>{let{errorInfos:t}=e;a.B.error("[render] MultiErrorCallback, errorInfos:",r.HH.stringify(t)),await this.destroy(),i(t)}});let u=await (0,n.kB)(this._objectLockAlgorithm.setCallback(l),-1,"setCallback");0!==u&&(a.B.error("[render] setCallback failed, ret:",u.toString()),await this.destroy(),i()),0!==await (0,n.kB)(this._objectLockAlgorithm.setMultiErrorCallback(d),-1,"setMultiErrorCallback")&&a.B.warn("[render] setCallback failed, ret:",u.toString());let c=await (0,n.kB)(this._objectLockAlgorithm.start(),-1,"start");0!==c&&(a.B.error("[render] algorithm start failed, ret:",c.toString()),await this.destroy(),i())})}constructor({utilWrapper:e}){this._objectLockAlgorithm=null,this._callbackHandle="",this._multiErrorCallbackHandle="",this._utilWrapper=e}}},401597:function(e,t,i){"use strict";i.d(t,{X:function(){return n}});var r=i(287165);class n{reverse(){let{operateId:e,undoCommand:t,redoCommand:i,canUndoRedo:r,operateType:a,executeCommand:o}=this;return new n({operateId:e,undoCommand:i,redoCommand:t,canUndoRedo:r,operateType:a,executeCommand:o})}execute(e){this.executeCommand(this.undoCommand,e)}constructor(e){this.operateId=e.operateId||(0,r.p)(),this.redoCommand=e.redoCommand,this.undoCommand=e.undoCommand,this.canUndoRedo=!1!==e.canUndoRedo,this.operateType=e.operateType,this.executeCommand=e.executeCommand}}},408059:function(e,t,i){"use strict";i.d(t,{Pv:function(){return a}});let r=(e,t)=>{let[i,r]=e;return[i*Math.cos(t)-r*Math.sin(t),r*Math.cos(t)+i*Math.sin(t)]},n=(e,t,i)=>{let n=i*Math.PI/180,[a,o]=e,[s,l]=t,[d,u]=r([s-a,l-o],n);return[d+a,u+o]},a=(e,t)=>{if(!t)return e;let{width:i,height:r,x:a,y:o,rotate:s}=t,{width:l,height:d,x:u,y:c,rotate:p}=e,[m,h]=n([a+i/2,o+r/2],[u+a+l/2,c+o+d/2],s),[g,f]=[m-l/2,h-d/2];return{...e,originalX:(i-l)/2,originalY:(r-d)/2,x:g,y:f,rotate:p+s}}},956151:function(e,t,i){"use strict";function r(e){let t=["F","F","F","F","F","F","F","F"];if(null===e||e.length<6)return[0,0,0,0];if("#"===e[0])for(let i=1;i<e.length;++i)t[i-1]=e[i];else if("0"===e[0]&&("X"===e[1]||"x"===e[1]))for(let i=2;i<e.length;++i)t[i-2]=e[i];else for(let i=0;i<e.length;++i)t[i]=e[i];let i=parseInt(t.join(""),16);return[i>>24&255,i>>16&255,i>>8&255,255&i]}function n(e){if(e<0||e>15)throw Error("Hex number must be in [0, 15]");return e.toString(16).toUpperCase()}function a(e,t){if(e.length<=6)return"";let i=t;t<0&&(i=0),t>1&&(i=1);let r=Math.floor(255*i),a=[];a[0]=n(r>>4),a[1]=n(15&r);let o=6;"#"===e[0]&&(o+=1),"0"===e[0]&&"x"===e[1]&&(o+=2);let s=e.substring(0,o);return s+=a[0],s+=a[1]}function o(e){return`#${e.map(e=>Math.floor(255*e).toString(16).padStart(2,"0")).join("")}`}function s(e){let t=6;return"#"===e[0]&&(t+=1),parseInt(e.substring(t,t+2),16)}function l(e){let t=0;return"#"===e[0]&&(t+=1),parseInt(e.substring(t,t+2),16)}function d(e){let t=2;return"#"===e[0]&&(t+=1),parseInt(e.substring(t,t+2),16)}function u(e){let t=4;return"#"===e[0]&&(t+=1),parseInt(e.substring(t,t+2),16)}i.d(t,{EO:function(){return a},R3:function(){return d},VF:function(){return u},ci:function(){return s},fZ:function(){return l},jg:function(){return o},rW:function(){return r}})},153021:function(e,t,i){"use strict";i.d(t,{p:function(){return r}});class r{static threeWayMax(e,t,i){return Math.max(e,Math.max(t,i))}static threeWayMin(e,t,i){return Math.min(e,Math.min(t,i))}static rgbToHsv(e,t,i){let r=e/255,n=t/255,a=i/255,o=this.threeWayMax(r,n,a),s=this.threeWayMin(r,n,a),l=0,d=0,u=o-s;return d=0===o?0:u/o,o===s?l=0:(o===r?l=(n-a)/u+(n<a?6:0):o===n?l=(a-r)/u+2:o===a&&(l=(r-n)/u+4),l/=6),[l,d,o]}static hsvToRgb(e,t,i){let r=0,n=0,a=0,o=Math.floor(6*e),s=6*e-o,l=i*(1-t),d=i*(1-s*t),u=i*(1-(1-s)*t);switch(o%6){case 0:r=i,n=u,a=l;break;case 1:r=d,n=i,a=l;break;case 2:r=l,n=i,a=u;break;case 3:r=l,n=d,a=i;break;case 4:r=u,n=l,a=i;break;case 5:r=i,n=l,a=d}return[Math.round(255*r),Math.round(255*n),Math.round(255*a)]}}},6342:function(e,t,i){"use strict";i.d(t,{W:function(){return s},e:function(){return o}});var r,n=i(211561),a=i(481631);var o=((r={})[r.subtitleRecognition=0]="subtitleRecognition",r[r.matting=1]="matting",r[r.denoise=2]="denoise",r[r.complementFrame=3]="complementFrame",r[r.smartColorAdjust=4]="smartColorAdjust",r[r.stable=5]="stable",r[r.smartCrop=6]="smartCrop",r[r.chroma=7]="chroma",r[r.textToSpeech=8]="textToSpeech",r[r.voiceChange=9]="voiceChange",r[r.cloneVoice=10]="cloneVoice",r[r.digitalHuman=11]="digitalHuman",r);let s=[{ability:0,check:e=>(0,a.Ft)(e)&&e.material.addType===n.RZH.RecognizeAdd},{ability:1,check:e=>{var t;return(0,a.he)(e)&&!!(0n!==e.material.matting.flag&&e.material.matting.path)&&!(null===(t=e.digitalHuman)||void 0===t?void 0:t.digitalHumanId)}},{ability:2,check:e=>{var t;return((0,a.he)(e)||(0,a.Y9)(e))&&!!(null===(t=e.realtimeDenoise)||void 0===t?void 0:t.isDenoise)}},{ability:3,check:e=>(0,a.he)(e)&&!!e.material.videoAlgorithm.complementFrameConfig},{ability:4,check:e=>{var t;return(0,a.he)(e)&&!!(null===(t=e.adjust)||void 0===t?void 0:t.enableSmartColorAdjust)}},{ability:5,check:e=>{var t;return(0,a.he)(e)&&(null===(t=e.material.stable)||void 0===t?void 0:t.stableLevel)>0}},{ability:6,check:e=>(0,a.he)(e)&&!!e.smartCrop},{ability:7,check:e=>{var t;return(0,a.he)(e)&&!!(null===(t=e.chroma)||void 0===t?void 0:t.color)}},{ability:8,check:e=>(0,a.Y9)(e)&&e.material.type===n.cVg.MetaTypeTextToAudio},{ability:9,check:e=>{var t;return((0,a.he)(e)||(0,a.Y9)(e))&&!!(null===(t=e.voiceChange)||void 0===t?void 0:t.length)}},{ability:10,check:e=>(0,a.Y9)(e)&&!!e.material.isAiCloneTone},{ability:11,check:e=>{var t,i,r;if((0,a.he)(e)&&(null===(i=e.digitalHuman)||void 0===i?void 0:null===(t=i.ttsMetas)||void 0===t?void 0:t.length)){for(let t of null===(r=e.digitalHuman)||void 0===r?void 0:r.ttsMetas)if(t.ttsPath)return!0}return!1}}]},347043:function(e,t,i){"use strict";i.d(t,{u:function(){return c}});var r=i(211561),n=i(98819),a=i(176791),o=i(280700),s=i(842079),l=i(683598),d=i(687522),u=i(507194);function c(e,t,i,c){var p,m,h,g,f;let{segmentId:y}=t,{segmentIndex:_,trackIndex:v}=(0,o.Cm)(e.getAllTracks(),y),I=e.getAllTracks()[v],T=I.segments[_],x=new r.tnv({start:0n,duration:T.targetTimerange.duration});("SegmentVideo"===T.__segment_struct_type||"SegmentAudio"===T.__segment_struct_type)&&(x=new r.tnv({start:T.sourceTimerange.start,duration:T.sourceTimerange.duration}));let k={...T.targetTimerange};switch(I.type){case r.pNd.TrackTypeVideo:(0,s.I)(e,t,i,c);break;case r.pNd.TrackTypeAudio:(0,l.e)(e,t,i);break;case r.pNd.TrackTypeText:case r.pNd.TrackTypeSticker:(0,d.h)(e,t,i);break;default:(0,u.X)(e,t,i)}let w=T.clone();if("SegmentVideo"===T.__segment_struct_type){if((null===(p=w.material)||void 0===p?void 0:p.type)===r.cVg.MetaTypePhoto){let e=x.start-w.sourceTimerange.start;for(let t of w.commonKeyframes)for(let i of t.keyframeList){let t=i.timeOffset-e;i.timeOffset=t}}n._.deleteKeyframesByTimeRange(e,w,t.clipType,x,k,(null===(m=w.material)||void 0===m?void 0:m.type)!==r.cVg.MetaTypeVideo,null!==(h=t.record)&&void 0!==h&&h,i),new a.wK().updateVideoAnimationsWithTimeRange(e,w,x,i)}else"SegmentAudio"===w.__segment_struct_type?n._.deleteKeyframesByTimeRange(e,w,t.clipType,x,k,!1,null!==(g=t.record)&&void 0!==g&&g,i):n._.deleteKeyframesByTimeRange(e,w,t.clipType,x,k,!0,null!==(f=t.record)&&void 0!==f&&f,i)}},612441:function(e,t,i){"use strict";i.d(t,{ty:function(){return s},yJ:function(){return d}});var r=i(392742),n=i(587892),a=i(340294);let o=new n.Q,s={event:o.event,execute(e){o.fire(e)}};function l(e,t){if(![r.x.InsertSegment,r.x.UpdateSegment].includes(e.type))return;let{identifier:i,substitute:n}=t;if(e.type===r.x.InsertSegment){let{segment:t}=e;(0,a.nr)(t,i)&&(0,a.pc)(t,n,!0)}else if(e.type===r.x.UpdateSegment){let{segmentId:t,segmentDelta:r}=e,o={...r,id:t};(0,a.nr)(o,i)&&(0,a.pc)(r,n)}}function d(e,t){e.undoStack.forEach(e=>{e.undoCommand.mutations.forEach(e=>{l(e,t)}),e.redoCommand.mutations.forEach(e=>{l(e,t)})}),e.redoStack.forEach(e=>{e.undoCommand.mutations.forEach(e=>{l(e,t)}),e.redoCommand.mutations.forEach(e=>{l(e,t)})})}},239431:function(e,t,i){"use strict";i.d(t,{o:function(){return o}});var r=i(211561),n=i(931608),a=i(13242);let o=(e,t,i)=>(!!(0,n.py)(i)||i===r.Eu.KFTypeFilter)&&!a.U.isValidValue(e,t,i,[0])},35276:function(e,t,i){"use strict";i.d(t,{b:function(){return u},j:function(){return d}});var r=i(211561),n=i(508278),a=i(481631),o=i(211890),s=i(540261),l=i(340294);class d{static calCubicValue(e,t,i,r,n,a,o,s,l){return this.interpolationCubicBezier(e,t,i,r,n,a,o,s,l)}static interpolationCubicBezier(e,t,i,r,n,a,l,d,u){let c=new o.Sh((i-e)/(l-e),0),p=new o.Sh((n-e)/(l-e),1),m=new s.A(c,p).solveCurveX(u);return s.A.bezier3(m,t,r,a,d)}static calcCubicPropertyValuesForRender(e,t,i){let r=Array.isArray(e.v)?e.v:[e.v],n=Array.isArray(e.vo)?e.vo:[e.vo],a=Array.isArray(t.v)?t.v:[t.v],o=Array.isArray(t.vi)?t.vi:[t.vi],s=a.length;if(r.length!==s)return t.v;let d=[];for(let u=0;u<s;u++){let s=Number(e.t),c=Number(r[u]),p=l.pM.plus(s,e.vto),m=l.pM.plus(c,n[u]),h=Number(t.t),g=Number(a[u]),f=l.pM.plus(h,t.vti),y=l.pM.plus(g,o[u]),_=this.calCubicValue(s,c,p,m,f,y,h,g,i);d.push(_)}return 1===d.length?d[0]:d}static calCubicPropertyValues(e,t,i){let r=e.datas,n=t.datas,a=n.length;if(r.length!==a)return n;let o=[];for(let s=0;s<a;s++){let a={x:0,y:0};e.rightGraphDataControlValue.length>s?(a.y=e.rightGraphDataControlValue[s],a.x=Number(e.rightGraphDataTimeOffset)):(a.x=e.rightControl.x,a.y=e.rightControl.y);let l={x:0,y:0};t.leftGraphDataControlValue.length>s?(l.y=t.leftGraphDataControlValue[s],l.x=Number(t.leftGraphDataTimeOffset)):(l.x=t.leftControl.x,l.y=t.leftControl.y);let d=Number(e.timeOffset),u=r[s],c=d+a.x,p=u+a.y,m=Number(t.timeOffset),h=n[s],g=m+l.x,f=h+l.y,y=this.calCubicValue(d,u,c,p,g,f,m,h,i);o.push(y)}return o}}class u{createCurveSpeed(e,t){let i=[],r=[];for(let t of e)i.push(t.x),r.push(t.y);let n=new l.Hr;return n.setCurveSpeed(i,r),n.setSeqDuration(t),n}getKeyframeTimeOffsetByTimeline(e,t,i){return(0,a.he)(t)||(0,a.Y9)(t)?this.getKeyframeTimeOffsetByTimelineWithSpeed(e,t,i):this.absSeqTimeToRelativeSeqTime(e,t,i)}getKeyframeTimeOffsetByTimelineWithSpeed(e,t,i){var a,o,s,d,u,c;let p=t.speed,m=t.sourceTimerange,h=t.targetTimerange,g=this.absSeqTimeToRelativeSeqTime(e,t,i);if(!p)return g+(null!==(a=null==m?void 0:m.start)&&void 0!==a?a:0n);if(p.mode===r.yY$.SpeedModeNormal)return l.pM.plus(l.pM.times(g,p.speed),null!==(o=null==m?void 0:m.start)&&void 0!==o?o:0n,"bigint");if(p.mode===r.yY$.SpeedModeCurve){if((0,n.H8)(g,0n))return null!==(s=null==m?void 0:m.start)&&void 0!==s?s:0n;if((0,n.H8)(g,h.duration))return(null!==(d=null==m?void 0:m.start)&&void 0!==d?d:0n)+(null!==(u=null==m?void 0:m.duration)&&void 0!==u?u:0n);if(p.curveSpeed){let e=this.createCurveSpeed(p.curveSpeed.speedPoints,h.duration).mapSeqDeltaToTrimDelta(g);if(e>=0)return BigInt(e)+(null!==(c=null==m?void 0:m.start)&&void 0!==c?c:0n)}}return-1n}getPreSegmentTimeRangeSum(e,t){let i=0n,r=e.getSegmentPath(t.id),n=[];return r.length>1&&r.slice(0,-1).forEach(t=>{var r,a,o;let s=e.getSegmentById(t);s&&n.push(s),i+=null!==(a=null==s?void 0:s.targetTimerange.start)&&void 0!==a?a:0n,i-=null!==(o=null==s?void 0:null===(r=s.sourceTimerange)||void 0===r?void 0:r.start)&&void 0!==o?o:0n}),{preSegmentTimeRangeSum:i,parentSegments:n}}absSeqTimeToRelativeSeqTime(e,t,i){let{parentSegments:r}=this.getPreSegmentTimeRangeSum(e,t),n=t.targetTimerange.start,o=i;return r.forEach(t=>{((0,a.he)(t)||(0,a.Y9)(t))&&(o=this.getKeyframeTimeOffsetByTimelineWithSpeed(e,t,o))}),o-n-t.offset}relativeSeqTimeToAbsSeqTime(e,t){return t+e.targetTimerange.start+e.offset}getTimelineByKeyframeTimeOffsetWithSpeed(e,t,i){var a;let o=t.sourceTimerange,s=t.targetTimerange,d=t.speed,c=i-(null!==(a=null==o?void 0:o.start)&&void 0!==a?a:0n),{preSegmentTimeRangeSum:p}=this.getPreSegmentTimeRangeSum(e,t),m=s.start+p;if(!d)return c+m;if(d.mode===r.yY$.SpeedModeNormal)return l.pM.plus(l.pM.div(c,d.speed),l.pM.plus(m,.5),"bigint");if(d.mode===r.yY$.SpeedModeCurve){if((0,n.H8)(c,0n))return m;if((null==o?void 0:o.duration)&&(0,n.H8)(c,null==o?void 0:o.duration))return m+s.duration;else if(d.curveSpeed){let e=this.createCurveSpeed(d.curveSpeed.speedPoints,s.duration).mapTrimDeltaToSeqDelta(c);if(e>=0)return new u().relativeSeqTimeToAbsSeqTime(t,e)}}return-1n}getTimelineByKeyframeTimeOffset(e,t,i){if((0,a.he)(t)||(0,a.Y9)(t))return this.getTimelineByKeyframeTimeOffsetWithSpeed(e,t,i);let r=this.relativeSeqTimeToAbsSeqTime(t,i);return r<0?-1n:r}getRelativeSeqTimeByKeyframeTimeOffset(e,t,i){let r=this.getTimelineByKeyframeTimeOffset(e,t,i);return this.absSeqTimeToRelativeSeqTime(e,t,r)}}},837832:function(e,t,i){"use strict";i.d(t,{r:function(){return n},w:function(){return a}});var r=i(527730);let n={setSegmentProperty(e,t,i){let n=r.s.setBaseProperty(e,t,i);if(n)return n},getSegmentProperty:(e,t)=>r.s.getBaseProperty(e,t)},a={setSegmentProperty(e,t,i){let n=r.s.setBaseProperty(e,t,i);if(n)return n},getSegmentProperty:(e,t)=>r.s.getBaseProperty(e,t)}},93735:function(e,t,i){"use strict";i.d(t,{PD:function(){return o},UN:function(){return l},yK:function(){return s}});var r=i(211561),n=i(487108),a=i(287165);let o=e=>{if(e.type===r.cVg.MetaTypeFigure&&(e.subType===r.DeX.MetaSubTypeAutoBeauty||e.subType===r.DeX.MetaSubTypeExclusionFace)&&!e.algorithmArtifactPath)throw Error("");let t=new r.eAb;if(t.platform=e.platform,t.resourceId=e.resId,t.thirdResourceId=e.thirdResourceId,t.path=(0,n.Z0)(e.path),t.name=e.name,t.effectId=e.effectId,t.categoryId=e.categoryId,t.categoryName=e.categoryName,t.value=e.value,t.type=e.type,t.subType=e.subType,t.id=(0,a.p)(),t.version=e.version,t.sourcePlatform=e.sourcePlatform,t.formulaId=e.formulaId,t.enableSkinToneCorrection=e.enableSkinToneCorrection,t.algorithmArtifactPath=e.algorithmArtifactPath,t.intensityKey=e.intensityKey,e.exclusionGroup.length>0){let i=[...e.exclusionGroup];t.exclusionGroup=i}if(e.adjustParams.length>0){let i=e.adjustParams.map(e=>{let t=new r.VBR;return t.name=e.adjustKey,t.value=e.adjustValue,t.defaultValue=e.defaultValue,t});t.adjustParams=i}if(e.faceAdjustParams.length>0){let i=[];for(let t of e.faceAdjustParams){let e=new r.m4H;e.faceId=t.faceId,e.enable=t.enable;let n=[];for(let e of t.adjustParams){let t=new r.VBR;t.name=e.adjustKey,t.value=e.adjustValue,t.defaultValue=e.defaultValue,n.push(t)}e.adjustParams=n,e.disablePart=t.disablePart,i.push(e)}t.faceAdjustParams=i}return t},s=e=>{if(e.type===r.cVg.MetaTypeFigure&&(e.subType===r.DeX.MetaSubTypeAutoBeauty||e.subType===r.DeX.MetaSubTypeExclusionFace)&&!e.algorithmArtifactPath)throw Error("Please create artifact folder!");let t=new r.eAb;t.platform=e.platform,t.resourceId=e.resId,t.thirdResourceId=e.thirdResourceId,t.path=(0,n.Z0)(e.path),t.name=e.name,t.effectId=e.effectId,t.categoryId=e.categoryId,t.categoryName=e.categoryName,t.value=e.value,t.type=e.type,t.subType=e.subType,t.id=(0,a.p)(),t.version=e.version,t.sourcePlatform=e.sourcePlatform,t.formulaId=e.formulaId,t.enableSkinToneCorrection=e.enableSkinToneCorrection,t.algorithmArtifactPath=e.algorithmArtifactPath,t.intensityKey=e.intensityKey,t.requestId=e.requestId;let{exclusionGroup:i}=e;if(i&&i.length>0){let e=[];i.forEach(t=>{e.push(t)}),t.exclusionGroup=e}let o=e.adjustParams;if(o&&o.length>0){let e=[];for(let t of o){let i=new r.VBR;i.name=t.adjustKey,i.value=t.adjustValue,i.defaultValue=t.defaultValue,e.push(i)}t.adjustParams=e}let s=e.faceAdjustParams;if(s&&s.length>0){let e=[];for(let t of s){let i=new r.m4H;i.faceId=t.faceId,i.enable=t.enable;let n=[];for(let e of t.adjustParams){let t=new r.VBR;t.name=e.adjustKey,t.value=e.adjustValue,t.defaultValue=e.defaultValue,n.push(t)}i.adjustParams=n,i.disablePart=t.disablePart,e.push(i)}t.faceAdjustParams=e}return t},l=(e,t)=>{var i,n;let a=null!==(i=e.resourceId)&&void 0!==i?i:e.resId,o=null!==(n=t.resourceId)&&void 0!==n?n:t.resId;return e.sourcePlatform===t.sourcePlatform?a===o:e.sourcePlatform===r.nj7.EffectPlatformArtist&&e.thirdResourceId?e.thirdResourceId===o:t.sourcePlatform===r.nj7.EffectPlatformArtist&&!!t.thirdResourceId&&t.thirdResourceId===a}},912224:function(e,t,i){"use strict";i.d(t,{AG:function(){return c},UJ:function(){return p},eK:function(){return y},nW:function(){return m}});var r,n,a=i(211561),o=i(268468),s=i(392742),l=i(481631),d=i(217201),u=i(698159);let c=0;var p=((r={})[r.SubVideoBasic=2e3]="SubVideoBasic",r[r.FigureOrder=4e3]="FigureOrder",r[r.StretchLegOrder=4e3]="StretchLegOrder",r[r.ReshapeOrder=5e3]="ReshapeOrder",r[r.ChromaOrder=5500]="ChromaOrder",r[r.LocalAdjustOrder=6e3]="LocalAdjustOrder",r[r.GlobalAdjustOrder=7e3]="GlobalAdjustOrder",r[r.BeautyOrder=8e3]="BeautyOrder",r[r.LocalFilterOrder=9e3]="LocalFilterOrder",r[r.GlobalFilterOrder=1e4]="GlobalFilterOrder",r[r.VideoEffectOrder=11e3]="VideoEffectOrder",r[r.VideoMaskOrder=12e3]="VideoMaskOrder",r[r.StickerOrder=13e3]="StickerOrder",r[r.TextOrder=14e3]="TextOrder",r[r.PluginEffectOrder=15e3]="PluginEffectOrder",r[r.CustomPostFilterOrder=99e3]="CustomPostFilterOrder",r[r.LockObjectOrder=1e5]="LockObjectOrder",r);var m=((n={})[n.SmartColorAdjustOrder=0]="SmartColorAdjustOrder",n[n.ColorCurvesOrder=1]="ColorCurvesOrder",n[n.PrimaryColorWheels=2]="PrimaryColorWheels",n[n.LogColorWheels=3]="LogColorWheels",n[n.HslOrder=4]="HslOrder",n[n.BrightnessOrder=5]="BrightnessOrder",n[n.ContrastOrder=6]="ContrastOrder",n[n.SaturationOrder=7]="SaturationOrder",n[n.SharpeningOrder=8]="SharpeningOrder",n[n.HighlightOrder=9]="HighlightOrder",n[n.ShadowOrder=10]="ShadowOrder",n[n.ColorTemperatureOrder=11]="ColorTemperatureOrder",n[n.HueOrder=12]="HueOrder",n[n.FadeOrder=13]="FadeOrder",n[n.LightSensationOrder=14]="LightSensationOrder",n[n.VignettingOrder=15]="VignettingOrder",n[n.ParticleOrder=16]="ParticleOrder",n[n.LUTOrder=17]="LUTOrder",n[n.AdjustOrderCount=18]="AdjustOrderCount",n);function h(e){return{trackType:a.pNd.TrackTypeNone,trackFlag:a.w9k.FlagNone,...e}}function g(e){return{trackType:a.pNd.TrackTypeNone,trackFlag:a.w9k.FlagNone,...e}}function f(e,t,i){let r=e.get(t);!r&&(r=[],e.set(t,r)),r.push(i)}class y{isTimeRangeOverlap(e,t){if(!e||!t)return!1;let i=e.start<t.start+t.duration,r=t.start<e.start+e.duration;return i&&r}getSegmentByIdIndexInTrack(e,t){if(!e||!t)return -1;let{segments:i}=e;for(let e=0;e<i.length;++e)if(i[e]&&i[e].id===t.id)return e;return -1}spanSegmentToChain(e,t,i,r,n){if(!e||!t||!i)return!1;let a=t.targetTimerange,o=i.targetTimerange;if(!a||!o||this.isTimeRangeOverlap(a,o))return!1;let s=e.getTrackBySegmentId(t.id,[]),d=e.getTrackBySegmentId(i.id,[]);if(!s||!d||s.id!==d.id)return!1;let u=a.start<o.start?t:i,c=a.start<o.start?i:t,p=this.getSegmentByIdIndexInTrack(s,u),m=this.getSegmentByIdIndexInTrack(s,c);if(p<0||m<0)return!1;let{segments:h}=s;for(r=[u],n=[c];p>0&&h[p-1];){;let e=h[p-1];if(!e||!(0,l.he)(e)||!e.transition||!e.targetTimerange)break;r.push(e),--p}for(;m<h.length-1;){let e=n[n.length-1];if(!(0,l.he)(e)||!e.transition)break;let t=null;if(m+1<h.length&&(t=h[m+1]),!t||!(0,l.he)(t)||!t.targetTimerange)break;n.push(t),++m}return r.reverse(),!0}sortVideoLayer(e){e.sort((e,t)=>(0,l.he)(e)&&(0,l.he)(t)&&e.targetTimerange&&t.targetTimerange?Number(e.targetTimerange.start-t.targetTimerange.start):0)}buildRenderLayers(e){let t=new Map;for(let r of(t.set(c,[]),e.getAllSegments()))if((0,l.he)(r)){var i;t.has(r.renderIndex)||t.set(r.renderIndex,[]),null===(i=t.get(r.renderIndex))||void 0===i||i.push(r)}else if((0,l.kj)(r))for(let[e,i]of this.buildRenderLayers(r.material.draft).entries()){t.has(e)||t.set(e,[]);let r=t.get(e);r.push(r[r.length-1],i[0],i[i.length-1])}for(let e of t.entries())this.sortVideoLayer(e[1]);return t}buildRenderLayersWithSegments(e){let t=new Map;for(let r of e)if(r){var i;t.has(r.renderIndex)||t.set(r.renderIndex,[]),null===(i=t.get(r.renderIndex))||void 0===i||i.push(r)}for(let e of t.entries())this.sortVideoLayer(e[1]);return t}layerCanMerge(e,t){if(!e.length||!t.length)return!0;let i=0,r=0;for(;i<e.length&&r<t.length;){let n=e[i].targetTimerange;if(!n){i++;continue}let a=t[r].targetTimerange;if(!a){r++;continue}if(this.isTimeRangeOverlap(n,a))return!1;n.start<a.start?i++:r++}return!0}layerHasEnoughSpace(e,t){if(!t)return!0;for(let i of e){if(!(null==i?void 0:i.targetTimerange))continue;let e=i.targetTimerange;if(!!e){if(this.isTimeRangeOverlap(t,e))return!1}}return!0}setSegmentsRenderIndex(e,t,i){let r=[];for(let n of t){let t=new a.NOn;t.renderIndex=i,r.push((0,u.l)(e,n.id,t))}return r}ensureInSameRenderLayer(e,t,i){if(!e||!t||!i)return!1;if(t.renderIndex===i.renderIndex)return!0;let r=[],n=[];if(this.spanSegmentToChain(e,t,i,r,n),0===r.length||0===n.length)return!1;let a=r[0],o=r[r.length-1],s=n[0],l=n[n.length-1];if(!a.targetTimerange||!o.targetTimerange||!s.targetTimerange||!l.targetTimerange)return!1;let d=a.targetTimerange.clone(!0),u=s.targetTimerange.clone(!0);d.duration=o.targetTimerange.start+o.targetTimerange.duration-a.targetTimerange.start,u.duration=l.targetTimerange.start+l.targetTimerange.duration-s.targetTimerange.start;let c=this.buildRenderLayers(e);if(c.size<a.renderIndex||c.size<s.renderIndex)return!1;let p=[];if(a.renderIndex>s.renderIndex&&this.layerHasEnoughSpace(c.get(a.renderIndex)||[],u))p=this.setSegmentsRenderIndex(e,n,a.renderIndex);else if(s.renderIndex>a.renderIndex&&this.layerHasEnoughSpace(c.get(s.renderIndex)||[],d))p=this.setSegmentsRenderIndex(e,r,s.renderIndex);else{let t=Math.max(a.renderIndex,s.renderIndex);for(let i=t;i<c.size;++i){var m;p.push(...this.setSegmentsRenderIndex(e,null!==(m=c.get(i))&&void 0!==m?m:[],i+1))}p.push(...this.setSegmentsRenderIndex(e,r,t)),p.push(...this.setSegmentsRenderIndex(e,n,t))}return p.push(...this.removeEmptyLayer(e)),p}removeEmptyLayer(e){let t=this.buildRenderLayers(e),i=0,r=[];for(let o=1;o<t.size;++o){var n,a;if(!t.has(o)||(null===(n=t.get(o))||void 0===n?void 0:n.length)===0){++i;continue}if(0!==i)r.push(...this.setSegmentsRenderIndex(e,null!==(a=t.get(o))&&void 0!==a?a:[],o-i))}return r}renderIndexMode(e){return e.getDraftProperty().renderIndexTrackModeOn?a.IDM.RenderIndexModeSyncTrack:e.getDraftProperty().freeRenderIndexModeOn?a.IDM.RenderIndexModeFree:a.IDM.RenderIndexModeDefault}getMaxVideoRenderIndex(e){let t=e.getAllSegments(),i=0,r=-1;for(let e of t){if((0,l.he)(e))r=e.renderIndex;else if((0,l.kj)(e)){let t=e.material.draft;r=this.getMaxVideoRenderIndex(t)}else{if(!(0,l.Um)(e))continue;let t=e.material.draft;r=this.getMaxVideoRenderIndex(t)}r>i&&(i=r)}return i}nextVideoRenderIndex(e,t){if(e===d.fm)return c;{let e=-1;return e=t.getDraftProperty().freeRenderIndexModeOn?2e3+this.getVideoCount(t,!0)+2:this.getMaxVideoRenderIndex(t)+1}}nextVideoRenderIndexWithTimeRange(e,t,i){if(e===d.fm)return c;let r=this.buildRenderLayers(i),n=0;if(0===r.size)n=1;else{let e=r.entries(),t=0;for(let i of e)i[0]>t&&([t]=i);n=t+1}for(;n>1&&this.layerHasEnoughSpace(r.get(n-1)||[],t);)--n;return n}getMaxFilterRenderIndex(e){let t=e.getAllSegments(),i=0,r=-1;for(let e of t){if((0,l.Si)(e))r=e.renderIndex;else if((0,l.kj)(e)){let t=e.material.draft;r=this.getMaxFilterRenderIndex(t)}else{if(!(0,l.Um)(e))continue;let t=e.material.draft;r=this.getMaxFilterRenderIndex(t)}r>i&&(i=r)}return i}nextFilterRenderIndex(e){let t=this.getMaxFilterRenderIndex(e);return 0===t?1e4:t+1}getMaxAdjustRenderIndex(e){let t=e.getAllSegments(),i=-1,r=-1;for(let e of t){if((0,l.E6)(e))r=e.renderIndex;else if((0,l.kj)(e)){let t=e.material.draft;r=this.getMaxAdjustRenderIndex(t)}else{if(!(0,l.Um)(e))continue;let t=e.material.draft;r=this.getMaxAdjustRenderIndex(t)}r>i&&(i=r)}return i}nextAdjustRenderIndex(e){let t=-1;return t=e.property.freeRenderIndexModeOn?7e3+this.getAdjustCount(e,!0)+2:this.getMaxAdjustRenderIndex(e)+1}getMaxVideoEffectRenderIndex(e){let t=e.getAllSegments(),i=0,r=-1;for(let e of t){if((0,l.w5)(e))r=e.renderIndex;else if((0,l.kj)(e)){let t=e.material.draft;r=this.getMaxAdjustRenderIndex(t)}else{if(!(0,l.Um)(e))continue;let t=e.material.draft;r=this.getMaxAdjustRenderIndex(t)}r>i&&(i=r)}return i}nextVideoEffectRenderIndex(e){let t=-1;if(e.getDraftProperty().freeRenderIndexModeOn)t=11e3+this.getVideoEffectCount(e,!0)+2;else{let i=this.getMaxVideoEffectRenderIndex(e);t=0===i?11e3:i+1}return t}getMaxPluginEffectRenderIndex(e){let t=e.getAllSegments(),i=0,r=-1;for(let e of t){if(!!(0,l.Kj)(e)){r=e.renderIndex;r>i&&(i=r)}}return i}nextPluginEffectRenderIndex(e){let t=this.getMaxPluginEffectRenderIndex(e);return 0===t?15e3:t+1}getVideoCount(e,t){let i=e.getAllSegments(),r=-1;for(let e of i)if((0,l.he)(e))r++;else{if(!(0,l.kj)(e))continue;let i=e.material.draft;r+=this.getVideoCount(i,!1)+(t?1:0)}return r}getVideoEffectCount(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.getAllSegments(),r=-1;for(let e of i)if((0,l.w5)(e))r++;else{if(!(0,l.kj)(e))continue;let i=e.material.draft;r+=this.getAdjustCount(i)+(t?1:0)}return r}getAdjustCount(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.getAllSegments(),r=-1;for(let e of i)if((0,l.E6)(e))r++;else{if(!(0,l.kj)(e))continue;let i=e.material.draft;r+=this.getAdjustCount(i)+(t?1:0)}return r}raiseAdjustRenderIndexBase(e,t){let i=[],r=[],n=(e,t,n)=>{for(let o of e.tracks){let e=o.type;if(!!(e===a.pNd.TrackTypeAdjust||e===a.pNd.TrackTypeFilter||e===a.pNd.TrackTypeComposition))for(let e of o.segments)(0,l.E6)(e)&&i.push({segment:e,renderIndex:e.renderIndex,parentSegment:null!=t?t:e,isFromSegmentComposition:n}),(0,l.Si)(e)?i.push({segment:e,renderIndex:e.renderIndex,parentSegment:null!=t?t:e,isFromSegmentComposition:n}):(0,l.kj)(e)&&!n&&r.push(e)}};n(e,void 0,!1);let o={};for(let e of r)if((0,l.kj)(e)){let i=e.material.draft;if(!t){let t=e.material.draft.clone();o[e.id]=t,i=t}n(i,e,!0)}i.sort((e,t)=>e.renderIndex-t.renderIndex);let s=1e4,d=[];for(let r of i){if(r.isFromSegmentComposition)r.segment.renderIndex=s;else if(t)r.segment.renderIndex=s;else{let t=new a.NOn;t.renderIndex=s,d.push((0,u.l)(e,r.segment.id,t))}s++}return!t&&Object.entries(o).forEach(t=>{let[i,r]=t,n=new a.$u6;n.material=new a.rdD({draft:r}),d.push((0,u.l)(e,i,n))}),d}changeDraftRenderIndexMode(e,t,i){if(!e)return[];let r=[],n=this.renderIndexMode(e);if(n===a.IDM.RenderIndexModeDefault&&t===a.IDM.RenderIndexModeSyncTrack)this._renderIndexModeSet(e,r,!0,!1,i),this.rebuildTrackFromRenderIndex(e,i);else if(n===a.IDM.RenderIndexModeDefault&&t===a.IDM.RenderIndexModeFree)this._renderIndexModeSet(e,r,!1,!0,i),r.push(...this.removeEmptyTracks(e,i)),r.push(...this.raiseAdjustRenderIndexBase(e,i)),this.ensureDraftRenderIndexUniqueUnderFreeMode(e);else if(n===a.IDM.RenderIndexModeSyncTrack&&t===a.IDM.RenderIndexModeFree)this._renderIndexModeSet(e,r,!1,!0,i),r.push(...this.removeEmptyTracks(e,i)),this.buildUniqueRenderIndex(e,0,!0);else if(n===a.IDM.RenderIndexModeFree&&t===a.IDM.RenderIndexModeSyncTrack)this._renderIndexModeSet(e,r,!0,!1,i),this.buildTrackRenderIndexFromUniqueRenderIndex(e);else if(n===t)return;for(let n of e.getAllSegments()){var o;if((null===(o=n.material)||void 0===o?void 0:o.type)===a.cVg.MetaTypeVideo&&(0,l.he)(n)&&n.materialDraft){let o=n.materialDraft.draft.clone();if(this.changeDraftRenderIndexMode(o,t,!0),!i){let t=new a.NOn,i=new a.rdD({draft:e});t.materialDraft=i,r.push((0,u.l)(e,n.id,t))}}}return i?[]:r}removeEmptyTracks(e,t){let i=!1,r=[],n=[];for(let t of e.tracks){if(t.type===a.pNd.TrackTypeVideo&&!i){i=!0;continue}0===t.segments.length?r.push(t):n.push(t)}return r.map(t=>({type:s.x.DeleteTrack,draftId:e.getDraftId(),params:{trackId:t.id}}))}ensureDraftRenderIndexUniqueUnderFreeMode(e){this.buildUniqueRenderIndex(e,0,!1)}buildTrackRenderIndexFromUniqueRenderIndex(e){let t;let i=new Map,r=[],n=[],s=[],d=(e,o)=>{for(let d of e.tracks){let e=d.type;if(e===a.pNd.TrackTypeAudio||e===a.pNd.TrackTypeTextToVideoTextAudio||e===a.pNd.TrackTypeAdCube)continue;let u=d.flag;if(e===a.pNd.TrackTypeVideo&&u===a.w9k.FlagNone&&!t){t=d;continue}for(let t of(s.push(d),d.segments))if((0,l.he)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.E6)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.Si)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.w5)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.Ft)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.P2)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.P7)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.WX)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.Q2)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.Kj)(t))r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:t.renderIndex,trackRenderIndexSetter:e=>{t.trackRenderIndex=e},skipIndexIncrement:!1,notAsPartOfTrack:o})),i.set(t.id,t.renderIndex);else if((0,l.kj)(t)){if(o)throw Error("false");r.push(g({segment:t,trackType:e,trackFlag:u,renderIndex:0,trackRenderIndexSetter:e=>{},skipIndexIncrement:!0,notAsPartOfTrack:!1})),n.push(t.material.draft)}else throw Error("false")}};for(let t of(d(e,!1),n))d(t,!0);r.sort((e,t)=>e.renderIndex-t.renderIndex);let u=e.tracks;for(let e of s){let t=u.findIndex(t=>t===e);-1!==t&&u.splice(t,1)}if(t)for(let e of t.segments)(0,l.he)(e)?(e.renderIndex=0,e.trackRenderIndex=0):(0,l.MR)(e)||console.error("should not have other type of segment in main track!");else{let e=new o.wO({type:a.pNd.TrackTypeVideo});u.unshift(e)}let c=1;for(let t of r){let r,n=0,a=t.segment.targetTimerange.start,s=a+t.segment.targetTimerange.duration;for(let e=0;e<u.length;++e){let r=u[e];if(r.attribute===t.segment.trackAttribute&&r.type===t.trackType&&r.flag===t.trackFlag)for(let o of r.segments){let{start:r}=o.targetTimerange;if(a>r+o.targetTimerange.duration||s<r)continue;if(!!(i.has(o.id)&&i.has(t.segment.id)&&i.get(t.segment.id)>=i.get(o.id))){n=e+1;break}}}let l=-1;for(let i=n;i<u.length;++i)if(-1!==(l=e.findSegmentInsertIndexByTimeRange(u[i].segments,t.segment.targetTimerange))&&u[i].attribute===t.segment.trackAttribute&&u[i].type===t.trackType&&u[i].flag===t.trackFlag){r=u[i];break}if(r&&-1!==l){if(t.notAsPartOfTrack||r.segments.splice(l,0,t.segment),t.trackRenderIndexSetter(c),r.flag!==t.trackFlag)throw Error("assert(insertableTrack.flag === info.trackFlag)");continue}if(c+=t.skipIndexIncrement?0:1,t.notAsPartOfTrack)t.trackRenderIndexSetter(c);else{let e=new o.wO({type:t.trackType,flag:t.trackFlag,attribute:t.segment.trackAttribute,segments:[t.segment]});t.trackRenderIndexSetter(c),u.push(e)}}for(let t of(e.property.cover&&y.prototype.rebuildTrackRenderIndexOfCover(e.property.cover,Math.max(c+1,100)),e.getAllSubDraft()))t.property.renderIndexTrackModeOn=!0,t.property.freeRenderIndexModeOn=!1,y.prototype.buildTrackRenderIndexFromUniqueRenderIndex(t)}buildUniqueRenderIndex(e,t,i){}rebuildTrackFromRenderIndex(e,t){let i=new Map,r=new Map,n=new Map,s=new Map,d=new Map,u=new Map,c=new Map,p=(t,i)=>{let r=new Map;for(let l of[...t.keys()].sort((e,t)=>e-t)){var n,s;for(let d of null!==(n=t.get(l))&&void 0!==n?n:[]){let t=null!==(s=r.get(d.trackType))&&void 0!==s?s:[],n=-1,l=-1;for(let i=t.length-1;i>=0;--i){let r=e.findSegmentInsertIndexByTimeRange(t[i].segments,d.segment.targetTimerange);if(-1===r||t[i].attribute!==d.segment.trackAttribute||t[i].flag!==d.trackFlag)break;l=r,n=i}if(-1!==n){let o,s=t[n];d.trackType===a.pNd.TrackTypeSticker?o=r.get(a.pNd.TrackTypeText):d.trackType===a.pNd.TrackTypeText&&(o=r.get(a.pNd.TrackTypeSticker)),!o&&(o=[]);for(let r=o.length-1;r>=0;--r){let a=o[r],u=i.findIndex(e=>e===s);if(i.findIndex(e=>e===a)<u)break;if(-1===e.findSegmentInsertIndexByTimeRange(a.segments,d.segment.targetTimerange))if(n<t.length-1)++n,l=e.findSegmentInsertIndexByTimeRange(t[n].segments,d.segment.targetTimerange),s=t[n],r=o.length;else{n=-1,l=-1;break}}}if(-1!==n){if(t[n].segments.splice(l,0,d.segment),t[n].flag!==d.trackFlag)throw Error("assert(trackList[targetTrackIndex].flag === sortInfo.trackFlag)");continue}let u=new o.wO({type:d.trackType,flag:d.trackFlag,attribute:d.segment.trackAttribute,segments:[d.segment]}),c=r.get(d.trackType);!c&&(c=[],r.set(d.trackType,c)),c.push(u),i.push(u)}}},m=!1,g=[],{tracks:_}=e;for(let e of _){let t=e.type;if(t===a.pNd.TrackTypeAudio||t===a.pNd.TrackTypeTextToVideoTextAudio)continue;if(t===a.pNd.TrackTypeVideo&&!m){m=!0;continue}let o=e.flag;for(let p of(g.push(e),e.segments))if((0,l.he)(p)){if(f(i,p.renderIndex,h({segment:p,trackFlag:o,trackType:t})),t!==a.pNd.TrackTypeVideo)throw Error("assert(trackType === PersistLVVETrackType.TrackTypeVideo)")}else if((0,l.E6)(p)){if(f(r,p.renderIndex,h({segment:p,trackFlag:o,trackType:t})),!(t===a.pNd.TrackTypeAdjust||t===a.pNd.TrackTypeFilter))throw Error("assert(trackType === PersistLVVETrackType.TrackTypeAdjust || trackType === PersistLVVETrackType.TrackTypeFilter)")}else if((0,l.Si)(p)){if(t===a.pNd.TrackTypeFilter?f(n,p.renderIndex,h({segment:p,trackFlag:o,trackType:t})):f(s,p.renderIndex,h({segment:p,trackFlag:o,trackType:t})),!(t===a.pNd.TrackTypeFilter||t===a.pNd.TrackTypeVideoEffect))throw Error("assert(trackType === PersistLVVETrackType.TrackTypeFilter || trackType === PersistLVVETrackType.TrackTypeVideoEffect)")}else if((0,l.w5)(p))f(s,p.renderIndex,{segment:p,trackFlag:o,trackType:t});else if((0,l.Ft)(p))f(d,p.renderIndex,h({segment:p,trackType:t,trackFlag:o}));else if((0,l.P2)(p))f(u,p.renderIndex,h({segment:p,trackType:t,trackFlag:o}));else if((0,l.P7)(p))f(u,p.renderIndex,h({segment:p,trackType:t,trackFlag:o}));else if((0,l.WX)(p))f(u,p.renderIndex,h({segment:p,trackType:t,trackFlag:o}));else if((0,l.Q2)(p))f(d,p.renderIndex,h({segment:p,trackType:t,trackFlag:o}));else if((0,l.Kj)(p))f(c,p.renderIndex,h({segment:p,trackType:t,trackFlag:o}));else throw Error("false")}let v=e.tracks;for(let e of g){let t=v.findIndex(t=>t===e);-1!==t&&v.splice(t,1)}if(!m){let e=new o.wO({type:a.pNd.TrackTypeVideo});v.unshift(e)}for(let t of(((e,t)=>{var i,r;let n=[],s=new Map;for(let t of[...e.keys()].sort((e,t)=>e-t))for(let r of null!==(i=e.get(t))&&void 0!==i?i:[])(0,l.he)(r.segment)&&(n.push(r.segment),!s.has(t)&&s.set(t,r.trackFlag));for(let[e,i]of y.prototype.buildRenderLayersWithSegments(n)){let n=new o.wO({type:a.pNd.TrackTypeVideo}),{segments:l}=n;if(!!l){for(let e of i)l.push(e.clone());n.flag=null!==(r=s.get(e))&&void 0!==r?r:a.w9k.FlagNone,t.push(n)}}})(i,v),p(r,v),p(n,v),p(s,v),p(d,v),p(u,v),p(c,v),y.prototype.rebuildRenderIndexFromTrack(e,0),e.getAllSubDraft()))t.property.renderIndexTrackModeOn=!0,t.property.freeRenderIndexModeOn=!1,this.rebuildTrackFromRenderIndex(t)}rebuildRenderIndexFromTrack(e,t){let{tracks:i}=e,r=t+1,n=!1;for(let o of i){let i=o.type;if(i===a.pNd.TrackTypeAudio||i===a.pNd.TrackTypeTextToVideoTextAudio)continue;let s=o.segments;if(!s.length)continue;let d=!1;for(let i of(!n&&e.isMainTrack(o)&&(d=!0,n=!0),s))if((0,l.he)(i)){if(d&&0===t){if(!(1===r||0===r))throw Error("assert(index === 1 || index === 0)");r=0,i.trackRenderIndex=0;continue}if(0===i.renderIndex)throw Error("assert(segment.renderIndex === 0)");i.trackRenderIndex=r}else if((0,l.E6)(i))i.trackRenderIndex=r;else if((0,l.Si)(i))i.trackRenderIndex=r;else if((0,l.w5)(i))i.trackRenderIndex=r;else if((0,l.Ft)(i))i.trackRenderIndex=r;else if((0,l.P2)(i))i.trackRenderIndex=r;else if((0,l.P7)(i))i.trackRenderIndex=r;else if((0,l.WX)(i))i.trackRenderIndex=r;else if((0,l.Q2)(i))i.trackRenderIndex=r;else if((0,l.MR)(i))i.trackRenderIndex=r;else throw Error("false");++r}e.property.cover&&y.prototype.rebuildTrackRenderIndexOfCover(e.property.cover,Math.max(r+1,100))}rebuildTrackRenderIndexOfCover(e,t){let{coverDraft:i}=e;if(!i)return;let{tracks:r}=i.draft,n=new Map;for(let i of r)if(e.type===a._6S.CoverTypeImage&&i.type===a.pNd.TrackTypeVideo&&i.flag===a.w9k.FlagNone)for(let e of i.segments)e.trackRenderIndex=++t,e.renderIndex=t;else for(let e of i.segments){if(!!(0,l.Ft)(e))f(n,e.renderIndex,e)}if(!(t<14e3))throw Error("assert(mainMaxTrackRenderIndex < FeatureRenderOrder.TextOrder)");for(let e of[...n.keys()].sort((e,t)=>e-t)){var o;for(let i of null!==(o=n.get(e))&&void 0!==o?o:[])i.trackRenderIndex=++t}}nextTextAndStickerRenderIndex(e){let t=-1;if(e.getDraftProperty().freeRenderIndexModeOn)t=14e3+this.getStickerCount(e)+2;else{let i=this.getMaxStickerRenderIndex(e);t=0===i?14e3:i+2}return t}getStickerCount(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.getAllSegments(),r=-1;for(let e of i)if((0,l.Ft)(e))r++;else if((0,l.P2)(e))r++;else if((0,l.P7)(e))r++;else if((0,l.WX)(e))r++;else if((0,l.Q2)(e))r++;else{if(!(0,l.kj)(e))continue;r+=this.getStickerCount(e.material.draft)+(t?1:0)}return r}getMaxStickerRenderIndex(e){let t=e.getAllSegments(),i=0,r=-1;for(let e of t){if((0,l.Ft)(e)||(0,l.P2)(e)||(0,l.P7)(e)||(0,l.WX)(e)||(0,l.Q2)(e))r=e.renderIndex;else{if(!((0,l.kj)(e)||(0,l.Um)(e)))continue;let t=e.material.draft;r=this.getMaxStickerRenderIndex(t)}r>i&&(i=r)}return i}eraseFromLayer(e,t){let i=e.findIndex(e=>e.id===t.id);i>=0&&e.splice(i,1)}_renderIndexModeSet(e,t,i,r,n){if(n)e.property.renderIndexTrackModeOn=i,e.property.freeRenderIndexModeOn=r;else{let n=new o.ry;n.renderIndexTrackModeOn=i,n.freeRenderIndexModeOn=r,t.push({type:s.x.SetDocumentProperty,params:{draftId:e.getDraftId(),propertyDelta:n}})}}}},81649:function(e,t,i){"use strict";i.d(t,{ME:function(){return o},O1:function(){return s}});var r=i(340294);class n{get head(){let e=r.pM.times(Math.floor(this._framePrecise),this._interval,"bigint","round");return r.pM.plus(this._secTime,e,"bigint")}get headAlign(){let e=r.pM.times(Math.floor(this._framePrecise),this._interval,"bigint","round");return r.pM.plus(this._secTime,e,"bigint")}get tail(){let e=r.pM.times(Math.ceil(this._framePrecise),this._interval,"bigint","round");return r.pM.plus(this._secTime,e,"bigint")}get round(){let e=r.pM.times(Math.round(this._framePrecise),this._interval,"bigint","round");return r.pM.plus(this._secTime,e,"bigint")}get next(){let e=r.pM.times(Math.floor(this._framePrecise+1),this._interval,"bigint","round");return r.pM.plus(this._secTime,e,"bigint")}get previous(){let e=r.pM.times(Math.floor(this._framePrecise-1),this._interval,"bigint","round");return r.pM.plus(this._secTime,e,"bigint")}get innerNum(){return Math.floor(this._framePrecise)}static IntervalSeconds(e){return BigInt(1e6)}constructor(e,t){this._framePrecise=0,this._secTime=0n,this._interval=t;let i=r.pM.mod(e,n.IntervalSeconds(t));this._framePrecise=i/this._interval,Math.abs(this._framePrecise-Math.round(this._framePrecise))<800/t&&(this._framePrecise=Math.round(this._framePrecise)),this._secTime=r.pM.minus(e,i,"bigint")}}class a extends n{get head(){return this._origTime}get headAlign(){return this._origTime}get tail(){return this._origTime}get round(){return this._origTime}constructor(e,t){super(e,t),this._origTime=e}}class o{static create(e,t){return 0!==o.autoAlignment?new n(e,t):new a(e,t)}static createAlignTime(e,t){return new n(e,t)}static compareAlignTime(e,t,i){return(0!==o.autoAlignment&&(e=o.create(e,i).round,t=o.create(t,i).round),e===t)?0:e>t?1:-1}static getRoundAlignTime(e,t){return 0!==o.autoAlignment?new n(e,1e6/t).round:e}static getTailAlignTime(e,t){return 0!==o.autoAlignment?new n(e,1e6/t).tail:e}}o.autoAlignment=0;class s{gen(e){return o.create(e,this._interval)}constructor(e){this._interval=1e6/e}}},802195:function(e,t,i){"use strict";i.d(t,{y:function(){return J}});var r=i(211561),n=i(602777),a=i(881337),o=i(49667),s=i(805794),l=i(131805),d=i(287165),u=i(712616),c=i(223729),p=i(90844),m=i(879566),h=i(556784),g=i(109671),f=i(320149),y=i(956151),_=i(459892),v=i(312473),I=i(340294);let T="children",x="name",k="start_time",w="duration",A="text_params",b="richText",S="original_size",O="shape_params",C="shape_type",M="custom_points",F="points",R="typeSettingKind",E="typeSettingAlign",P="canvasColor",V="canvasRoundRadius",j="canvasRoundRadiusScale",z="canvasWHCustomized",D="canvasOffsetCustomized",N="boldValue",B="italicDegree",L="lineSpacing",U="letterSpacing",H="ktvColor",W="globalAlpha",$="anims",Z="anim_resource_id",K="anim_resource_path",q="type",G="childrenOperation";function X(e,t){return void 0!==e[t]}let Y=new l.z(50),J={createImpliment(e,t,i,n,a,o){let s=new r.pVX;s.id=e,s.renderIndex=a;let l=new r.WQq;return l.type=n,l.formulaId=t.formulaId,l.resources=J.presetResourceEffect(i),l.textInfoResources=J.presetResourceTexts(t),J.resetCommonBasicInfo(l,t),s.clip=J.setClip(t),s.material=l,t.version?J.setMaterialNew(s,t,i,!0):J.setMaterialOld(l,t,o),s.targetTimerange=new r.tnv(t.timeRange),s},presetResourceEffect:e=>e.map(e=>new r.r8x({path:e.path,panel:e.panel,resourceId:e.resourceId,sourcePlatform:e.sourcePlatform})),presetResourceTexts:e=>e.resourceTexts.map(t=>{let i=new r.jG3({type:n.cV.MetaTypeText,content:t,text:t,ttsAutoUpdate:e.ttsAutoUpdate});return new r.P$b({textMaterial:i})}),resetCommonBasicInfo(e,t){e.id=(0,d.p)(),e.version=t.version,e.effectId=t.effectId,e.path=t.path,e.resourceId=t.resourceId,e.name=t.name,e.platform=t.platform,e.categoryId=t.categoryId,e.categoryName=t.categoryName,e.sourcePlatform=t.sourcePlatform,e.is3d=t.is3d,e.requestId=t.requestId},setClip(e){let{clip:t}=e;return new r.bXy({transform:new r.wx7({x:t.transformX,y:t.transformY}),scale:new r.Ciz({x:t.scaleX,y:t.scaleY}),rotation:t.rotation})},setMaterialOld(e,t,i){let a;try{a=JSON.parse(i)}catch(t){s.B.error("add old text template error",`json parse fail: ${e.resourceId}`,t);return}let o=a.text_list,{textInfoResources:l}=e;if(o.length===l.length)for(let i=0;i<l.length;++i){var d,c,p,m;let a=l[i],s=a.textMaterial,h=o[i],g=h.text_params;if(h.font_resource_id&&(s.fontResourceId=h.font_resource_id,s.fontPath=null!==(c=null===(d=e.resources.find(e=>e.resourceId===s.fontResourceId))||void 0===d?void 0:d.path)&&void 0!==c?c:""),h.effect_text_resource_id){let t=e.resources.find(e=>e.resourceId===h.effect_text_resource_id);if(t){let e=new r.eAb({resourceId:t.resourceId,path:t.path,sourcePlatform:t.sourcePlatform,type:n.cV.MetaTypeTextEffect});a.textEffectMaterials=[e]}}else if(h.effect_text_resource_path){let e=new r.eAb({path:`${t.path}/${h.effect_text_resource_path}`,resourceId:"",type:n.cV.MetaTypeTextEffect});a.textEffectMaterials=[e]}if(h.text_shape_resource_id){let t=e.resources.find(e=>e.resourceId===h.text_shape_resource_id);if(t){let e=new r.eAb({resourceId:t.resourceId,path:t.path,sourcePlatform:t.sourcePlatform,type:n.cV.MetaTypeTextShape});a.textShapeMaterial=e}}else if(h.text_shape_resource_path){let e=new r.eAb({path:`${t.path}/${h.text_shape_resource_path}`,resourceId:"",type:n.cV.MetaTypeTextShape});a.textShapeMaterial=e}if(g.useEffectDefaultColor&&(s.useEffectDefaultColor=g.useEffectDefaultColor),g.boldWidth&&(s.boldWidth=g.boldWidth),g.italicDegree&&(s.italicDegree=g.italicDegree),g.fontSize&&(s.fontSize=g.fontSize),g.typeSettingKind&&(s.typesetting=g.typeSettingKind),g.alignType&&(s.alignment=g.alignType),s.lineSpacing=g.lineGap,s.letterSpacing=g.charSpacing,g.textColor){let e=(0,y.jg)(g.textColor);s.textColor=e,s.textAlpha=null!==(p=g.textColor[3])&&void 0!==p?p:1}if(g.ktvColor){let e=(0,y.jg)(g.ktvColor);s.ktvColor=e}if(g.background&&(s.checkFlag|=Number(n.Pb.FrameFlag),s.backgroundStyle=g.backgroundWrapped?n.M4.TextBackgroundStyleWrap:n.M4.TextBackgroundStyleSquare,s.backgroundColor=(0,y.jg)(g.backgroundColor),s.backgroundAlpha=null!==(m=g.backgroundColor[3])&&void 0!==m?m:1),g.outline&&(s.checkFlag|=Number(n.Pb.BorderFlag),g.outlineColor&&(s.borderColor=(0,y.jg)(g.outlineColor)),s.borderWidth=g.outlineWidth),g.shadow){s.checkFlag|=Number(n.Pb.ShadowFlag),s.hasShadow=!0;let{shadowColor:e}=g;s.shadowColor=(0,y.jg)(e),s.shadowSmoothing=18*g.shadowSmoothing;let t=g.shadowOffset;t&&2===t.length&&(s.shadowPoint=new r._OS({x:18*t[0],y:18*t[1]})),e.length>=4&&(s.shadowAlpha=e[4])}let _=h.anims;if(!_||0===_.length)continue;let v=new r.ZPj,I=[];for(let i of _){if(!f.q.matchAnimType(i.anim_type))continue;let r=i.anim_type,a=i.anim_resource_id,o=i.anim_resource_path,s=i.duration,l="",d="",c=n.nj.EffectPlatformLoki;if(a){let t=e.resources.find(e=>e.resourceId===a);t&&(l=t.resourceId,d=t.path,c=t.sourcePlatform)}else o&&(d=`${t.path}/${o}`);let p={effectId:"",resourceId:l,thirdResourceId:"",sourcePlatform:c,path:d,name:"",type:f.q.animType(r),platform:"all",duration:BigInt(Math.floor(1e6*s)),start:0n,categoryId:"",categoryName:""},m=u.i.makeStickerAnim(p);I.push(m)}v.animations=I,v.type=n.cV.MetaTypeAnimation,a.textAnimateMaterial=v}},makeDependResource:e=>e.map(e=>({path:e.path,resourceId:e.resourceId,type:e.panel})),setMaterialNew(e,t,i,r){let n=J.makeDependResource(i),a=h.I.getCur();if(!!a){if(a.remove(e.id),a.ensureInit(e.id,t.resourceId,t.path,n)){if(r){let[t,i]=a.getCanvasSize(),r={root:J.fillTransformForScriptStandalone(e.clip,t,i),[q]:"ScriptTemplate",[G]:"mod"};if(!a.executeCmd(e.id,JSON.stringify(r)))return}J.setMaterialWithContent(e,t,a.getFullContent(e.id))}}},setMaterialWithContent(e,t,i){if(!!J.probeContent(i))J.setChildrenAll(e,t,null==i?void 0:i.children,!0)},probeContent:e=>e&&"object"==typeof e.root&&Array.isArray(e.children),probeChildren:e=>!!((null==e?void 0:e.name)&&e.type),probeAnimation:e=>e&&Array.isArray(e[$]),probeTextParam:e=>e&&"object"==typeof e[A],setChildrenAll(e,t,i,n){let a=e.material;if(!i||!a||!a.nonTextInfoResources)return;a.nonTextInfoResources=[];let o=[],s=a.textInfoResources,l=[];for(let a of i){if(!!J.probeChildren(a))if("text"!==a.type){let i=new r.MmU({type:a.type});J.setChildrenNonTextSingle(e,i,t.path,a),o.push(i)}else n&&l.push(a)}a.nonTextInfoResources=o,l.forEach((i,r)=>{J.setChildrenTextSingle(e,s[r],t,i)})},setChildrenNonTextSingle(e,t,i,n){if(!!(null==n?void 0:n[x])&&!!X(n,k)&&!!X(n,w)){if(t.name=n[x],!t.attachInfo&&(t.attachInfo=new r.aw1),J.setChildrenSingleBindEffectAttachInfo(t.attachInfo,n,!0),(0,g.VV)(t.type)){let e=t.shapeParam;!e&&(e=new r.ebT),J.setShapeEffectInfo(e,n),t.shapeParam=e}J.probeAnimation(n)&&(t.animateMaterialInfo=J.makeChildrenAnimation(e,i,n[$]))}},setChildrenTextSingle(e,t,i,n){if(!!n[x])t.textMaterial.name=n[x],!t.attachInfo&&(t.attachInfo=new r.aw1),J.setChildrenSingleBindEffectAttachInfo(t.attachInfo,n,!0),J.probeTextParam(n)&&(J.setChildrenTextParam(e,t,n[A],i.draftPath),J.setRichTextFontAndEffect(t,i.path,e.material.resources)),J.probeAnimation(n)&&(t.textAnimateMaterial=J.makeChildrenAnimation(e,i.path,n[$]))},setChildrenSingleBindEffectAttachInfo(e,t,i){if(i){var r,n;let i=null!==(r=t[k])&&void 0!==r?r:0,a=null!==(n=t[w])&&void 0!==n?n:0;e.startTime=BigInt(Math.floor(1e6*i)),e.duration=BigInt(Math.floor(1e6*a))}let a=0,o=0;Array.isArray(t[S])&&2===t[S].length&&([a,o]=t[S]),e.originalSizeWidth=a,e.originalSizeHeight=o,e.clip=J.getClipWithContent(t)},setShapeEffectInfo(e,t){if(!e||!t[O])return;let i=t[O];if(!X(i,C)||!i[M])return;let r=i[M];if(!!Array.isArray(r[F]))e.shapeType=i[C],e.points=r[F]},makeChildrenAnimation(e,t,i){let a=new r.ZPj,o=i.map(i=>{let r=f.q.animType(i.anim_type);return u.i.makeStickerAnim({effectId:"",name:"",type:r,...J.getAnimationParamResource(e.material,t,i),thirdResourceId:"",platform:"all",duration:J.getAnimationParamDuration(i,r),start:(0,I.k3)(i.anim_start_time,1000000n,"bigint"),categoryId:"",categoryName:""})});return a.animations=o,a.type=n.cV.MetaTypeAnimation,a},getAnimationParamResource(e,t,i){if(!i[Z])return{resourceId:"",path:i[K]?`${t}/${i[K]}`:"",sourcePlatform:n.nj.EffectPlatformLoki};{var r,a,o;let t=e.resources.find(e=>e.resourceId===i[Z]);return{resourceId:null!==(r=null==t?void 0:t.resourceId)&&void 0!==r?r:"",path:null!==(a=null==t?void 0:t.path)&&void 0!==a?a:"",sourcePlatform:null!==(o=null==t?void 0:t.sourcePlatform)&&void 0!==o?o:n.nj.EffectPlatformLoki}}},getAnimationParamDuration(e,t){var i;return BigInt(Math.floor(1e6*(null!==(i=e[t===n.VA.Anim_Loop?"loop_duration":"duration"])&&void 0!==i?i:0)))},getClipWithContent(e){var t,i,n,a;let o=null!==(i=e.scale)&&void 0!==i?i:[1,1],s=null!==(n=e.position)&&void 0!==n?n:[0,0],l=null!==(a=null===(t=e.rotation)||void 0===t?void 0:t[2])&&void 0!==a?a:0;return new r.bXy({scale:new r.Ciz({x:o[0],y:o[1]}),transform:new r.wx7({x:s[0],y:s[1]}),rotation:-l})},setChildrenTextParam(e,t,i,r){if("string"!=typeof i[b])return;let n=J.makeCommandConvert(t.textMaterial.text,i[b]),a=J.makeScriptCommand(n,t.textMaterial.name);J.setRichTextWithCommand(e,t,a,!0)},makeCommandConvert(e,t){let i=new c.B;return i.iOpCode=p.wI.CT_EDIT_TEMPLATE_TEXT_STYLE,i.iParam1=1,i.iParam5=JSON.stringify({text:e,templateStyle:t}),i},makeScriptCommand(e,t){let i={op_code:e.iOpCode,fparam1:e.iParam1,fparam2:e.iParam2,fparam3:e.iParam3,fparam4:e.iParam4,sparam:e.iParam5};return JSON.stringify({children:[{name:t,[q]:"text",rich_text_edit:i}],[G]:"mod"})},setRichTextWithCommand(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=J.invokeScriptInterface(e,i);if(!!n)J.setRichTextImpliment(e,t.textMaterial,n,r)},invokeScriptInterface(e,t){let i=h.I.getCur();if(!!i&&!!(null==e?void 0:e.material))return i.executeCmd(e.id,t)},setRichTextImpliment(e,t,i,r){if(!t)return;let n=JSON.parse(i);if(!J.probeContent(n))return;J.setChildrenAllBindEffectAttachAndShapeInfo(e,n,!1);let a=J.childrenFindWithName(t.name,n);if("object"!=typeof a)return;let o=a[A];if(!!o)r&&(J.setRichTextBasic(t,o),J.setRichTextCanvas(t,o)),J.setRichTextContent(t,o)},setChildrenAllBindEffectAttachAndShapeInfo(e,t,i){let n=t[T];if(!Array.isArray(n))return;let a={},o={};for(let t of e.material.textInfoResources)t.textMaterial&&t.attachInfo&&(a[t.textMaterial.name]=t.attachInfo);for(let t of e.material.nonTextInfoResources){if(!!t)t.attachInfo&&(a[t.name]=t.attachInfo),(0,g.VV)(t.type)&&(!t.shapeParam&&(t.shapeParam=new r.ebT),o[t.name]=t.shapeParam)}for(let e of n)if(J.probeChildren(e)){let t=e[x];a[t]&&J.setChildrenSingleBindEffectAttachInfo(a[t],e,i),o[t]&&J.setShapeEffectInfo(o[t],e)}},childrenFindWithName(e,t){if(!!Array.isArray(null==t?void 0:t[T]))return t[T].find(t=>J.probeChildren(t)&&t[x]===e)},setRichTextBasic(e,t){X(t,R)&&"number"==typeof t[R]&&(e.typesetting=t[R]),X(t,E)&&"number"==typeof t[E]&&(e.alignment=t[E]),X(t,N)&&"number"==typeof t[N]&&(e.boldWidth=t[N]),X(t,B)&&"number"==typeof t[B]&&(e.italicDegree=t[B]),X(t,L)&&"number"==typeof t[L]&&(e.lineSpacing=t[L]),X(t,U)&&"number"==typeof t[U]&&(e.letterSpacing=t[U]),X(t,W)&&"number"==typeof t[W]&&(e.globalAlpha=t[W]),X(t,H)&&Array.isArray(t[H])&&(e.ktvColor=(0,y.jg)(t[H]))},setRichTextCanvas(e,t){let i=e.checkFlag;if(t.canvas?(e.backgroundStyle=t.canvasWrapped?n.M4.TextBackgroundStyleWrap:n.M4.TextBackgroundStyleSquare,i|=Number(n.Pb.FrameFlag)):i&=~Number(n.Pb.FrameFlag),(i&Number(n.Pb.FrameFlag))!=0){if(Array.isArray(t[P])){var r;e.backgroundColor=(0,y.jg)(t[P]),e.backgroundAlpha=null!==(r=t[P][3])&&void 0!==r?r:1}t.canvasRoundCorner&&("number"==typeof t[V]&&(e.backgroundRoundRadius=t[V]),"number"==typeof t[j]&&(e.backgroundRoundRadius=t[j])),t.canvasCustomized&&(Array.isArray(t[z])&&2===t[z].length&&([e.backgroundWidth,e.backgroundHeight]=t[z]),Array.isArray(t[D])&&2===t[D].length&&([e.backgroundHorizontalOffset,e.backgroundVerticalOffset]=t[D]))}},setRichTextContent(e,t){let i=t[b];if("string"!=typeof i)return;let r=m.hM.VEUtils.convertRichTextXml2Json(i);e.content=JSON.stringify(r),e.text=m.hM.getPlainContent(r.text)},setRichTextFontAndEffect(e,t,i){let r=e.textMaterial;if(!r)return;let{fontIdPathsOut:n,effectIdPathsOut:a}=m.hM.getAllFontAndEffectIdsFromText(r.content);r.fonts=J.makeRichTextFonts(n,i),e.textEffectMaterials=J.makeRichTextEffects(a,i,t)},makeRichTextFonts:(e,t)=>e.filter(e=>e.id).map(e=>{let i=t.find(t=>t.resourceId===e.id);if(!!i){if("system-fonts"===i.panel&&!o.NG.has(i.resourceId)){s.B.error("[text-template] makeRichTextFonts error",`system font - ${i.resourceId} not configured`);return}return new r.LhI({id:(0,d.p)(),resourceId:i.resourceId,path:i.path,sourcePlatform:i.sourcePlatform})}}).filter(Boolean),makeRichTextEffects:(e,t,i)=>e.map(e=>{if(e.id){let i=t.find(t=>t.resourceId===e.id);if(!i)return;return new r.eAb({type:n.cV.MetaTypeTextEffect,resourceId:i.resourceId,path:i.path,sourcePlatform:i.sourcePlatform})}if(e.path)return new r.eAb({type:n.cV.MetaTypeTextEffect,resourceId:"",path:`${i}/${e.path}`})}).filter(Boolean),updateTextTemplateText(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{index:n,content:a}=t.textInfo;if(n<0)return;let o=e.material.clone(),s=o.textInfoResources.map(e=>e.textMaterial);if(n<s.length){let e=s[n];e.content=a,e.text=i?m.hM.getOriginContentFromContent(a):a}let l=new r.kph;return l.material=new r._0h,l.material.textInfoResources=o.textInfoResources,l},getDefaultRichTexts:e=>h.I.getDefaultRichTexts(e),getTextBindInfo:(e,t)=>e.material.textInfoResources.find(e=>e.textMaterial.id===t),cloneTextInfoResourcesAndTextBindInfo(e,t){let i=e.material.textInfoResources.concat(),r=i.findIndex(e=>e.textMaterial.id===t);return -1===r?{}:(i[r]=i[r].clone(),{textInfoResources:i,textBindInfo:i[r]})},updateTextMaterial(e,t,i,r){if(!this.isNewTextTemplateSegment(e.material)){let n=this.getTextBindInfo(e,i);if(!n)return;u.i.setTextMaterial(n.textMaterial,t,r);return}let n=e.material.textInfoResources.find(e=>e.textMaterial.id===i);if(!!n)u.i.setRichTextMaterialForTextTemplate(n.textMaterial,t,(0,a.ABm)({}),(t,i)=>{if(!!t&&!!i)J.setRichTextWithCommand(e,n,J.makeScriptCommand(i,t.name))},(e,t)=>{if(!e||!t||!t.iParam5||t.iOpCode!==p.wI.CT_EDIT_TEXT_PARAM)return},r)},isNewTextTemplateSegment:e=>!!(null==e?void 0:e.version),isNewTextTemplate:e=>!!(null==e?void 0:e.version),updateApplyTextStyle(e,t,i,r){if(!this.isNewTextTemplateSegment(e.material)){let n=this.getTextBindInfo(e,i);if(!n)return;u.i.setTextMaterial(n.textMaterial,t,r),!t.effectPath&&(n.textEffectMaterials=[]);return}let n=e.material.textInfoResources.find(e=>e.textMaterial.id===i);if(!n)return;let o=(0,a.ABm)({});u.i.updateRichTextStyleForTextTemplate(e.id,n.textMaterial,t,o,(t,i,r)=>{if(!!i&&!!r)J.setRichTextWithCommand(e,n,J.makeScriptCommand(r,i.name))},r),n.textEffectMaterials=u.i.getUpdatedRichTextEffects(n.textMaterial.content,n.textEffectMaterials)},updateTextAnimation(e,t,i,r,n,a){let o=J.getTextBindInfo(e,t);if(!o)return;let s=J.ensureMaterialAnimation(o);if(J.setMaterialAnimation(s,i,r),n){let e=u.i.getTextUpdatedKtvColor(o.textMaterial,null!=a?a:"");o.textMaterial.ktvColor=e}},ensureMaterialAnimation(e){let t=e.textAnimateMaterial;return!t&&(t=new r.ZPj,e.textAnimateMaterial=t),t},setMaterialAnimation:(e,t,i)=>(e.animations=i.concat(e.animations.filter(t)),e),async getTextTemplateParams(e,t,i){if(t){let t=h.I.getCur();return t?t.getBoundingBoxWithOldFormat(e):""}let r=v.p.CreateVEInfoSticker();return r?await r.getStickerTemplateParam(e,i):""},async getTextTemplateParamsWithCache(e,t,i){let r=Y.get(e);if(r)return r;let n=await this.getTextTemplateParams(e,t,i);return n&&Y.put(e,n),n},removeTextTemplateParamsCache(e){Y.remove(e)},fillTransformForScriptStandalone(e,t,i){let r=(0,_.D)(e);return r.translation.x*=.5*t,r.translation.y*=.5*i,{position:[r.translation.x,r.translation.y,0],scale:[r.scale.x,r.scale.y,1],rotation:[0,0,-r.rotation]}}}},441021:function(e,t,i){"use strict";i.d(t,{o:function(){return r.o},v:function(){return n.v}});var r=i(290719),n=i(166392)},454588:function(e,t,i){"use strict";i.d(t,{L:function(){return s}});var r=i(581592),n=i(321895),a=i(90844),o=i(464314);class s extends o.${static create(e){let t=new s;return t._init(e),r.f.Instance().setEditorForKey(t,"default_text_editor"),t}async getCurrentCursorPos(){let e=await this.getCursorRect(),t=new n.Yw(1,1);return Math.abs(e.w)>1e-6&&Math.abs(e.h)>1e-6&&(t.x=e.x,t.y=e.y),t}getPrecedingCommand(e){switch(e.iOpCode){case a.wI.CT_EDIT_OUTLINE_ALPHA:case a.wI.CT_EDIT_OUTLINE_WIDTH:let t=new a.kT;return t.iOpCode=a.wI.CT_EDIT_OUTLINE,t.iParam1=1,t;case a.wI.CT_EDIT_SHADOW_ALPHA:case a.wI.CT_EDIT_SHADOW_SMOOTH:case a.wI.CT_EDIT_SHADOW_OFFSET:let i=new a.kT;return i.iOpCode=a.wI.CT_EDIT_SHADOW,i.iParam1=1,i;default:return}}convertRichText(e,t,i){let n=[],a=r.f.Instance().getLastEditId()!==e,o=this.getPrecedingCommand(t);return o&&n.push(o),n.push(t),this.onExecuteConvertCmd(e,a,!1,n,i)}async onExecuteConvertCmd(e,t,i,n,o){t&&r.f.Instance().setLastEditId(e);try{return await this._convertExecutor(e,t,i,n,o)}catch{return r.f.Instance().setLastEditId(""),new a.kT}}hasEnterEdit(e){return!!e&&this._activeIds.has(e)}async isTextInEditState(e){let t=o.$.CmdForCode(a.wI.CT_GET_EDIT_CONTEXT_INFO);return 1e-6>Math.abs((await this._getExecutor(e,t)).iParam1-1)}syncEditStateWithCmd(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new a.kT;return this.onExecuteConvertCmd(e,i,i,[t],r)}async executeCmd(e,t){await this._handler([this._editingId],e),await this.syncEditStateWithCmd(this._editingId,e,t)}getRichTextCmd(e){return this.getRichTextCmdEx(this._editingId,e)}async getRichTextCmdEx(e,t){let i=[],n=r.f.Instance().getLastEditId()!==e;if(n&&this.hasEnterEdit(e)){let e=await this.getCursorRect(),t=new a.kT;t.iOpCode=a.wI.CT_ENTER_EDIT_STATE,t.iParam1=e.x,t.iParam2=e.y,i.push(t)}return this.onExecuteConvertCmd(e,n,n,i,t)}getRichTextParam(e){return this._getExecutor(this._editingId,e)}async beginEdit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new n.Yw(1,-1);this._editingId=e;let i=o.$.CmdForCode(a.wI.CT_ENTER_EDIT_STATE);i.iParam1=t.x,i.iParam2=t.y,await this.executeCmd(i,!0),this._activeIds.add(e),r.f.Instance().setEditorForKey(this,e)}async endEdit(e){if(!this.hasEnterEdit(e))return;let t=o.$.CmdForCode(a.wI.CT_EXIT_EDIT_STATE),i=this.executeCmd(t);this._editingId="",this._activeIds.delete(e),await i,r.f.Instance().removeEditorForKey(e)}isActive(){return!!this._editingId}setCmdExecuteHandler(e){this._handler=e}setGetCmdExecutor(e){this._getExecutor=e}setConvertCmdExecutor(e){this._convertExecutor=e}setCmdExecuteCompletion(e){this._completion=e}onCmdExecuteCompletion(e,t){var i;null===(i=this._completion)||void 0===i||i.call(this,t)}_removeKeywordConfig(e){if(!e.includes("keyword_ranges"))return e;try{let t=JSON.parse(e);return JSON.stringify({...t,keyword_rich_text:void 0,keyword_ranges:void 0})}catch{return e}}_init(e){this.setCmdExecuteHandler((t,i)=>{if(!e.executor)return;let{editor:r,draft:n}=e.executor;r.commit(()=>{for(let e of t){let t=r.getAncestorIds(e),a=r.getClipBaseByPath([...t,e]),o=null==a?void 0:a.data.filter;if(o){let e={...o,editRT_param:i},a=t[t.length-1];a?(n.beginDraft(a),r.updateFilter(e),n.endDraft(a)):r.updateFilter(e)}}}),this.onCmdExecuteCompletion(t[0],i.iOpCode)}),this.setGetCmdExecutor(async(t,i)=>{var r;let{editor:n}=e;if(!n)return new a.kT;let o=n.getAncestorIds(t),s=o[o.length-1],l=await (null===(r=n.infoSticker)||void 0===r?void 0:r.getStickerRichText(t,i,s));return null!=l?l:new a.kT}),this.setConvertCmdExecutor(async(t,i,r,n,o)=>{var s,l,d;let{editor:u}=e;if(!u)return new a.kT;let c=[...n],p=u.getAncestorIds(t);if(i){let e=null===(l=u.getClipBaseByPath([...p,t]))||void 0===l?void 0:l.data.filter;if(e){let t=new a.kT;t.iOpCode=a.wI.CT_EDIT_TEXT_PARAM,t.iParam1=1,t.pParam5=this._removeKeywordConfig(null!==(d=e.rich_text)&&void 0!==d?d:""),c.unshift(t)}}let m=p[p.length-1],h=await (null===(s=u.infoSticker)||void 0===s?void 0:s.convertRichText(c,o,m));return null!=h?h:new a.kT})}constructor(...e){super(...e),this._activeIds=new Set,this._handler=()=>Promise.resolve(),this._getExecutor=()=>Promise.resolve(new a.kT),this._convertExecutor=()=>Promise.resolve(new a.kT),this._completion=()=>{}}}},666652:function(e,t,i){"use strict";i.d(t,{J:function(){return n},y:function(){return a}});var r,n=((r={})[r.TEXT_COLOR=0]="TEXT_COLOR",r[r.STOKE_COLOR=1]="STOKE_COLOR",r[r.BACKGROUND_COLOR=2]="BACKGROUND_COLOR",r[r.SHADOW_COLOR=3]="SHADOW_COLOR",r);class a{constructor(){this.fonts=[],this.fontSizes=[],this.boldStyles=[],this.italicStyles=[],this.underlineStyles=[],this.textColors=[],this.outlineEnabled=!1,this.outlineColors=[],this.outlineWidths=[],this.shadowEnabled=!1,this.shadowColors=[],this.shadowAlphas=[],this.shadowSmooths=[],this.shadowDistances=[],this.shadowAngles=[]}}},635434:function(e,t,i){"use strict";i.d(t,{X:()=>u,q:()=>r.q});var r=i("628390"),n=i("211561"),a=i("340294"),o=i("879566"),s=i("351603"),l=i("320271"),d=i("49667");class u{parseAssets(){let{textChild:e}=this;return e?this._parseAssetsFromTextChild(e):this._genDefaultSubtitleTemplateAssets()}parseKeywordsConfig(){var e,t,i;let{textChild:r,originalFontSize:s,subtitleTemplate:u}=this;if(!r)return;let c=null===(e=r.caption_params)||void 0===e?void 0:e.keyword_rich_text;if(!c)return;let p=(0,a.$F)(c);u.resources.forEach(e=>{if(e.panel===l.U_.Fonts){let t=d.NG.has(e.resourceId);o.hM.replaceFontPath(p,e,t)}else e.panel===l.U_.Flower&&o.hM.replaceEffectStylePath(p,e)});let m=null!==(i=null===(t=r.text_params)||void 0===t?void 0:t.richText)&&void 0!==i?i:"",h=(0,a.$F)(m),g=o.hM.getMixedStyles(p,{begin:0,end:p.text.length}),f=o.hM.getMixedStyles(h,{begin:0,end:p.text.length}),y=f.fontSizes.length>0?f.fontSizes[0]:0,_=g.fontSizes.length>0?g.fontSizes[0]:y,v=y&&_&&_>y?_/y:1;if(s>0&&g.fontSizes.length>0){let e=Math.round(s*v);o.hM.replaceFontSize(p,e)}return new n.FdM({styles:JSON.stringify(p),fontSizeRatio:v,subtitleTemplateOriginalFontSize:y,subtitleTemplateKeywordsOriginalFontSize:_})}isNewSubtitleTemplate(e){var t,i;let r=!!e.keyframe_params,n=(null===(t=e.caption_params)||void 0===t?void 0:t.max_units_per_line)!==void 0&&(null===(i=e.caption_params)||void 0===i?void 0:i.max_lines_per_page)!==void 0;return r||n}containsAnimation(e){return Array.isArray(e.anims)&&e.anims.length>0}_getFirstTextChild(){try{let e=JSON.parse(this.subtitleTemplate.styleJson);if(!(0,a.Uk)(e)||"ScriptTemplate"!==e.type||!Array.isArray(e.children))return;return e.children.find(e=>"text"===e.type)}catch{return}}_parseAssetsFromTextChild(e){var t;if(!e.text_params)return this._genDefaultSubtitleTemplateAssets();let i=e.text_params;if("2"!==i.version)return this._genDefaultSubtitleTemplateAssets();let r=new n.jG3({type:n.cVg.MetaTypeText,globalAlpha:i.globalAlpha,backgroundRoundRadius:i.canvasRoundRadiusScale,shapeClipX:i.shapeFlipX,shapeClipY:i.shapeFlipY,alignment:i.typeSettingAlign,typesetting:i.typeSettingKind,lineMaxWidth:i.lineMaxWidth,lineSpacing:i.lineSpacing,letterSpacing:i.letterSpacing,boldWidth:i.boldValue,italicDegree:i.italicDegree,underlineWidth:i.decorationWidth,underlineOffset:i.decorationOffset});if(i.canvas){if(r.backgroundStyle=i.canvasWrapped?n.M4l.TextBackgroundStyleWrap:n.M4l.TextBackgroundStyleSquare,r.checkFlag|=Number(n.PbZ.FrameFlag),void 0!==i.canvasColor){let{canvasColor:e}=i;r.backgroundColor=(0,a.jg)(e),4===e.length&&(r.backgroundAlpha=e[3])}if(i.canvasCustomized){let e=i.canvasWHCustomized;2===e.length&&(r.backgroundWidth=e[0],r.backgroundHeight=e[1]);let t=i.canvasOffsetCustomized;2===t.length&&(r.backgroundHorizontalOffset=t[0],r.backgroundVerticalOffset=t[1])}}else r.checkFlag&=~Number(n.PbZ.FrameFlag);let l=(0,a.$F)(i.richText),d=o.hM.getMixedStyles(l,{begin:0,end:l.text.length});1===d.fontSizes.length&&(r.subtitleTemplateOriginalFontsize=d.fontSizes[0]);let{originalFontSize:u}=this;if(u>0?(r.fontSize=u,o.hM.replaceFontSize(l,u)):r.subtitleTemplateOriginalFontsize>0&&(r.fontSize=r.subtitleTemplateOriginalFontsize),d.textColors.length){let[e]=d.textColors;r.textColor=e,r.textAlpha=(0,a.ci)(e)/255}if((null===(t=i.ktvColor)||void 0===t?void 0:t.length)&&(r.ktvColor=(0,a.jg)(i.ktvColor)),d.outlineColors.length){let[e]=d.outlineColors;r.borderColor=e,r.borderAlpha=(0,a.ci)(e)/255,r.checkFlag|=Number(n.PbZ.BorderFlag)}else r.checkFlag&=~Number(n.PbZ.BorderFlag);if(d.outlineWidths.length&&(r.borderWidth=d.outlineWidths[0]),d.shadowColors.length){let[e]=d.shadowColors;r.shadowColor=e,r.shadowAlpha=(0,a.ci)(e)/255,r.hasShadow=!0,r.checkFlag|=Number(n.PbZ.ShadowFlag)}else r.checkFlag&=~Number(n.PbZ.ShadowFlag);d.shadowAlphas.length&&(r.shadowAlpha=d.shadowAlphas[0]),d.shadowSmooths.length&&(r.shadowSmoothing=d.shadowSmooths[0]),d.shadowDistances.length&&(r.shadowDistance=d.shadowDistances[0]),d.shadowAngles.length&&(r.shadowAngle=d.shadowAngles[0]),r.shadowPoint=(0,s.IN)(r.shadowDistance,r.shadowAngle);let{effects:c}=this._replaceRichTextPathsByResources(r,l),p=this.isNewSubtitleTemplate(e);this._updateCaptionTemplateInfo(r,p);let m=this.containsAnimation(e),h=p&&!m?new n.ZPj:this._parseAnimationsFromTextChild(e);return r.content=JSON.stringify(l),r.text=l.text,{material:r,effects:c,animations:h}}_replaceRichTextPathsByResources(e,t){let{resources:i}=this.subtitleTemplate,r=[];for(let a of i)if(a.panel===l.U_.Fonts){let i=d.NG.has(a.resourceId);!i&&e.fonts.push(new n.LhI({id:a.id,resourceId:a.resourceId,categoryId:a.categoryId,categoryName:a.categoryName,sourcePlatform:a.sourcePlatform,path:a.path,effectId:a.effectId,title:a.title})),o.hM.replaceFontPath(t,a,i)}else a.panel===l.U_.Flower&&(r.push(new n.eAb({id:a.id,resourceId:a.resourceId,name:a.title,categoryId:a.categoryId,categoryName:a.categoryName,path:a.path,sourcePlatform:a.sourcePlatform,effectId:a.effectId,type:n.cVg.MetaTypeTextEffect})),o.hM.replaceEffectStylePath(t,a));return{effects:r}}_updateCaptionTemplateInfo(e,t){let{resourceItemParam:i}=this.subtitleTemplate,r=e.captionTemplateInfo;r.resourceId=i.resourceId,r.resourceName=i.title,r.categoryId=i.categoryId,r.categoryName=i.categoryName,r.effectId=i.effectId,r.sourcePlatform=i.sourcePlatform,r.path=i.path,r.isNew=t}_parseAnimationsFromTextChild(e){let{resources:t}=this.subtitleTemplate,i=new n.ZPj;return Array.isArray(e.anims)?(e.anims.forEach(e=>{var r,o;let s=e.anim_resource_id,l=t.find(e=>e.resourceId===s);if(!!l)i.animations.push(new n.FJA({resourceId:s,start:(0,a.k3)(null!==(r=e.anim_start_time)&&void 0!==r?r:0,1e6,"bigint"),duration:(0,a.k3)(null!==(o=e.duration)&&void 0!==o?o:0,1e6,"bigint"),type:n.VAL.Anim_Caption,path:l.path,panel:l.panel}))}),i):i}_genDefaultSubtitleTemplateAssets(){return{material:new n.jG3,effects:[]}}constructor(e,t=0){this.subtitleTemplate=e,this.originalFontSize=t,this.textChild=this._getFirstTextChild()}}},544393:function(e,t,i){"use strict";i.d(t,{A:function(){return o}});var r=i(211561),n=i(361708),a=i(800788);class o{isMainTrack(e){return e.type===r.pNd.TrackTypeVideo&&e.flag===r.w9k.FlagNone}isSubVideoTrack(e){return e.type===r.pNd.TrackTypeVideo&&e.flag===r.w9k.FlagSubVideo}getAllTracks(){return this._videoDocument.tracks}getMainTrack(){return this.getTracksByTypeAndFlag(r.pNd.TrackTypeVideo,r.w9k.FlagNone)[0]}getTrackById(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this.getTrackByIdAndTracks(e,this._videoDocument.tracks,t)}getTrackByIdAndTracks(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.find(t=>t.id===e);if(r||!i)return r;for(let o of t)for(let t of o.segments){var a;if(!n.b.isCombination(t))continue;let o=null===(a=t.materialDraft)||void 0===a?void 0:a.draft;if(!!o){if(r=this.getTrackByIdAndTracks(e,o.tracks,i))return r}}}getTrackByIndex(e){return this._videoDocument.tracks[e]}getTrackBySegmentId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;for(let a of(null!=i?i:this).getTracksByTypes(t))for(let i of a.segments){var r;if(i.id===e)return a;if(!n.b.isCombination(i))continue;let o=null===(r=i.materialDraft)||void 0===r?void 0:r.draft;if(!o)return;let s=this.getTrackBySegmentId(e,t,o);if(s)return s}}getTracksByType(e){return e?this._videoDocument.tracks.filter(t=>t.type===e):this._videoDocument.tracks}getTracksByTypes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0===e.length?this.getAllTracks():this._videoDocument.tracks.filter(t=>e.includes(t.type))}getTracksByTypeAndFlag(e,t){return this._videoDocument.tracks.filter(i=>i.flag===t&&i.type===e)}getTracksByTypesAndFlag(e,t){return this.getTracksByTypes(e).filter(e=>e.flag===t)}getTrackNodeBySegmentId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let r=0;r<this._videoDocument.tracks.length;r++){let n=this._videoDocument.tracks[r];if((0===t.length||!!t.includes(n.type))&&(0===i.length||!!i.includes(n.flag))){for(let t of n.segments)if(t.id===e)return{track:n,trackIndex:r}}}}getTrackIndexBySegmentId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this.getTrackNodeBySegmentId(e,t);return i?i.trackIndex:-1}getTrackIndexById(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{tracks:i}=this._videoDocument;for(let r=0;r<i.length;r++){let n=i[r];if(0===t.length||!!t.includes(n.type)){if(n.id===e)return r}}return -1}getFirstTrackIndexByTrackType(e){let{tracks:t}=this._videoDocument;for(let i=0;i<t.length;i++)if(e===t[i].type)return i}getLastTrackIndexExcludeTrackType(e){let{tracks:t}=this._videoDocument;for(let i=t.length-1;i>=0;i--)if(e!==t[i].type)return i}getTrackDuration(e){let{segments:t}=e;if(0===t.length)return 0n;let i=t[t.length-1];return i.targetTimerange.start+i.targetTimerange.duration}getTrackStartTime(e){let{segments:t}=e;return 0===t.length?0n:t[0].targetTimerange.start}findTargetTrackIndexByTimeRange(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=this.getTracksByTypes(e);for(let e=n;e<o.length;e++){let n=o[e];if((n.attribute&Number(r.$SW.LockFlag))!=0||0!==t.length&&!t.includes(n.flag))continue;let s=n.segments.filter(e=>!a.includes(e.id));if(this._videoDocument.findSegmentInsertIndexByTimeRange(s,i)>-1)return e}return o.length}findTargetTrackIndex(e,t,i,n,a,o){let s=[],l=[];a&&(s=[]),o&&(l=[]);let d=0,u=new r.tnv;u.start=t,u.duration=i;let c=this.getTracksByTypes(e);for(let e of c){if(d<n||(e.attribute&Number(r.$SW.LockFlag))!=0||(null==s?void 0:s.length)&&s.find(t=>t===e.flag)===s[s.length-1]){d++;continue}let t=e.segments.slice();for(let e of l){let i=t.find(t=>t.id===e);i&&i!==t[t.length-1]&&t.splice(t.indexOf(i),1)}if(this._videoDocument.findSegmentIndex(t,u)>=0)return d;d++}return c.length}findTargetTrackIndexWithExclude(e,t,i,r){return this.findTargetTrackIndexWithFlags(e,[],t,i,r)}findTargetTrackIndexWithFlags(e,t,i,n,a){let o=0,s=this.getTracksByTypes(e);for(let e of s){if(o<n||(e.attribute&Number(r.$SW.LockFlag))!=0||t.length&&!t.includes(e.flag)){o++;continue}let{segments:s}=e,l=[];for(let e of s)!a.includes(e.id)&&l.push(e);if(this._videoDocument.findSegmentIndex(l,i)>=0)return o;o++}return s.length}getTrackNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.getTracksByTypes(t);for(let t=0;t<r.length;t++){let n=r[t];if(!i.length||-1!==r.findIndex(e=>i.includes(e.flag))){for(let i of n.segments)if(i.id===e)return{track:n,idx:t}}}return null}getTrackTypesBySegment(e){switch(e.__segment_struct_type){case"SegmentVideo":case"SegmentTailLeader":return[r.pNd.TrackTypeVideo];case"SegmentAudio":return[r.pNd.TrackTypeAudio,r.pNd.TrackTypeTextToVideoTextAudio];case"SegmentSticker":case"SegmentImageSticker":case"SegmentHandwrite":return[r.pNd.TrackTypeSticker];case"SegmentText":case"SegmentTextTemplate":return[r.pNd.TrackTypeText,r.pNd.TrackTypeTextToVideoText];case"SegmentVideoEffect":return[r.pNd.TrackTypeVideoEffect];case"SegmentFilter":return[r.pNd.TrackTypeFilter];case"SegmentPictureAdjust":return[r.pNd.TrackTypeAdjust];case"SegmentComposition":return[r.pNd.TrackTypeComposition];case"SegmentAdcube":return[r.pNd.TrackTypeAdCube];case"SegmentPluginEffect":return[r.pNd.TrackTypePluginEffect];default:return[r.pNd.TrackTypeNone]}}findAboveTrackIndexToInsert(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(r<0||r>=this._videoDocument.tracks.length)&&(0,a.ss)("aboveIndex is illegal");let o=this.findTrackIndexToInsert(e,t,i,n);return o.trackIndex<=r?o:{trackIndex:r,needToInsert:!0}}findTrackIndexToInsert(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(let a=0;a<this._videoDocument.tracks.length;a++){if(!(n&&this.isMainTrack(this._videoDocument.tracks[a]))){if(this._videoDocument.tracks[a].type===e&&this._videoDocument.findSegmentInsertIndexByTimeRange(this._videoDocument.tracks[a].segments,new r.tnv({start:t,duration:i}))>=0)return{trackIndex:a,needToInsert:!1}}}if(e===r.pNd.TrackTypeAudio)return{trackIndex:Math.max(this._videoDocument.tracks.length,1),needToInsert:!0};if(!n&&e===r.pNd.TrackTypeVideo&&!this._videoDocument.getMainTrack())return{trackIndex:0,needToInsert:!0};{let e=-1;for(let t=this._videoDocument.tracks.length-1;t>=0;t--)if(this._videoDocument.tracks[t].type!==r.pNd.TrackTypeAudio){e=t;break}return{trackIndex:Math.max(e+1,1),needToInsert:!0}}}findVectIndex(e,t){if(0===t.length)return e;let{tracks:i}=this._videoDocument,r=0,n=-1;for(let a=0;a<i.length;a++){let o=i[a];if(t.includes(o.type)&&r++===e){n=a;break}}return n}constructor(e){this._videoDocument=e}}},671922:function(e,t,i){"use strict";i.d(t,{I:function(){return d}});var r=i(280700),n=i(176791),a=i(211561),o=i(448218),s=i(481631),l=i(508278);let d=(e,t,i)=>{var d,u,c;let p=(0,r.Cm)(e.getAllTracks(),t.segId);if(!p)return;let{segmentIndex:m,trackIndex:h}=p,g=e.getAllTracks()[h].segments[m],f=g.clone(),y=f.material;if(!(0,s.he)(g)||!(null==g?void 0:g.sourceTimerange)||!y)return;let _=new a.NOn;if(_.material=new a.K2q,t.isReverse?t.reversePath&&(f.intensifiesAudio?_.material.reverseIntensifiesPath=t.reversePath:_.material.reversePath=t.reversePath):_.material.reversePath="",new n.wK().reApplyGlobalVideoEffects(e,f),g.reverse!==t.isReverse){let e=y.duration-f.sourceTimerange.start-f.sourceTimerange.duration,t=Object.assign({},f.sourceTimerange,{start:e<0n?0n:e});_.sourceTimerange=new a.zel(t);let{targetTimerange:i}=f;for(let e of null!==(c=f.videoEffects)&&void 0!==c?c:[]){let{timeRange:t}=e;if(!t)continue;let{applyTimeRange:r}=e,n=r?r.start:0n,a=r?r.duration:t.duration,o=t.start+n+a,s=i.duration-o;t.start=s-n}let r=y.duration;for(let e of f.commonKeyframes){let t=[],{keyframeList:i}=e;for(let e of i){let i=r-e.timeOffset;e.timeOffset=i;let{leftControl:n}=e,{rightControl:a}=e;if(n){let t=(0,l.aq)(0-n.x,n.y);e.rightControl=t}if(a){let t=(0,l.aq)(0-a.x,a.y);e.leftControl=t}t.unshift(e)}e.keyframeList=t}let n=y.objectLocked;if(n){let e=n.keyframes,t=[];for(let i of e){let e=y.duration-i.timeOffset;i.timeOffset=e,t.unshift(i)}n.keyframes=t}let{curveSpeed:o}=f.speed;if(o){let{speedPoints:e=[]}=o;o.speedPoints=e.map(e=>new a.nR_({x:1-e.x,y:e.y})).sort((e,t)=>e.x-t.x)}}(null===(u=g.voiceChange)||void 0===u?void 0:null===(d=u[0])||void 0===d?void 0:d.subType)===a.xbm.AudioEffectTypeVCVoiceChange&&(_.voiceChange=[]),f.material.objectLocked&&(_.material.objectLocked=new a.BnV(f.material.objectLocked)),_.reverse=t.isReverse,_.commonKeyframes=f.commonKeyframes,_.videoEffects=f.videoEffects,_.speed=new a.Zk4({...g.speed,curveSpeed:f.speed.curveSpeed}),(0,o.W)((0,o.l)(e,t.segId,_),i)}}}]);