(globalThis.__LOADABLE_LOADED_CHUNKS__=globalThis.__LOADABLE_LOADED_CHUNKS__||[]).push([["9012"],{289208:function(e,t,i){let r=i(218907),n=e.exports;!function(){"use strict";let e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t,i,a={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},s;function o(t){return e.lastIndex=0,e.test(t)?`"${t.replace(e,function(e){let t=a[e];return"string"==typeof t?t:`\\u${`0000${e.charCodeAt(0).toString(16)}`.slice(-4)}`})}"`:`"${t}"`}"function"!=typeof n.stringify&&(n.stringify=function(e,n,a){let l;if(t="",i="","number"==typeof a)for(l=0;l<a;l+=1)i+=" ";else"string"==typeof a&&(i=a);if(s=n,n&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw Error("JSON.stringify");return function e(n,a){let l,u,d,c,h=t,p,m=a[n],f=null!=m&&(m instanceof r||r.isBigNumber(m));switch(m&&"object"==typeof m&&"function"==typeof m.toJSON&&(m=m.toJSON(n)),"function"==typeof s&&(m=s.call(a,n,m)),typeof m){case"string":if(f)return m;return o(m);case"number":return isFinite(m)?String(m):"null";case"boolean":case"null":case"bigint":return String(m);case"object":if(!m)return"null";if(t+=i,p=[],"[object Array]"===Object.prototype.toString.apply(m)){for(l=0,c=m.length;l<c;l+=1)p[l]=e(l,m)||"null";return d=0===p.length?"[]":t?`[
${t}${p.join(`,
${t}`)}
${h}]`:`[${p.join(",")}]`,t=h,d}if(s&&"object"==typeof s)for(l=0,c=s.length;l<c;l+=1)"string"==typeof s[l]&&(d=e(u=s[l],m))&&p.push(o(u)+(t?": ":":")+d);else Object.keys(m).forEach(function(i){let r=e(i,m);r&&p.push(o(i)+(t?": ":":")+r)});return d=0===p.length?"{}":t?`{
${t}${p.join(`,
${t}`)}
${h}}`:`{${p.join(",")}}`,t=h,d}}("",{"":e})})}()},49705:function(e,t,i){"use strict";e.exports=i.p+"static/assets/vesdk-lvapi.04410569.js"},983516:function(e,t,i){"use strict";i.d(t,{f:function(){return p}});var r=i(653322),n=i(150002),a=i(862213),s=i(331509),o=i(475028),l=i(690613),u=i(419537),d=i(211561);let c=(0,o.i)(r.H.AttachmentDeleteAiStoryAlternativeMaterialNotExist,""),h=(0,o.i)(r.H.AttachmentDeleteAiStoryAlternativeMaterialMaterialNotExist,"");class p extends n.a{get type(){return a.Us.ATTACHMENT_DELETE_AI_STORY_ALTERNATIVE_MATERIALS}check(e){if(!e.getAiStoryAlternativeMaterialBySegmentId(this.options.segmentId))return c(`delete ai story alternative material not exist: ${this.options.segmentId}`);for(let t of this.options.alternativeIds)if(!e.getAiStoryAlternativeMaterialBySegmentIdAndAlternativeId(this.options.segmentId,t))return h(`delete ai story alternative material material not exist: ${this.options.segmentId} ${t}`);return(0,l.ly)()}do(e,t,i){let r=t.getAiStoryAlternativeMaterialBySegmentId(this.options.segmentId),n=new d.mNK({alternatives:r.alternatives.filter(e=>{let{id:t}=e;return this.options.alternativeIds.includes(t)}).map(e=>e.clone())});e(new u.K({attachmentKey:s.d3.AiStoryAlternativeMaterial,key:this.options.segmentId,delta:n,type:s.be.DELETE,index:r.alternatives.findIndex(e=>e.id===n.alternatives[0].id),draftId:t.getDraftId(),trackIndex:t.getTrackIndexBySegmentId(this.options.segmentId)}))}}},607260:function(e,t,i){"use strict";i.d(t,{D:function(){return m}});var r=i(862213),n=i(268468),a=i(700857),s=i(698159),o=i(160849),l=i(399835),u=i(217201),d=i(81649),c=i(690613),h=i(211561),p=i(150002);class m extends p.a{get type(){return m.type}check(){return(0,c.ly)()}do(e,t,i){let{subDraftVideoDocument:r,subDraft:d,materialDraft:c,isHolder:p}=this.options,m=[];if(this.options.type===h.pNd.TrackTypeVideo){let r=BigInt(d.duration?d.duration:this.options.duration),n=o.bV.addIntegratedVideo(t,c,{...this.options,duration:r},e,i);if(n){let e={};p&&n.material&&(e.materialId=this.options.templateId,e.path=l.nP.kPlaceHolderMaterialPath),this.options.material&&(e.categoryId=this.options.material.categoryId,e.categoryName=this.options.material.categoryName,e.materialName=this.options.material.materialName);let i=new h.NOn;i.templateId=this.options.templateId,i.templateScene=this.options.templateScene,i.material=new h.K2q(e),m.push((0,s.l)(t,n.id,i,t.getAllTracks()[this.options.trackIndex].id))}}let f=new n.ry;f.combinationMaxIndex=t.getDraftProperty().combinationMaxIndex+1,e(new a.W({propertyDelta:f}));let g=r.getTracksByTypes([h.pNd.TrackTypeVideo])[0];if(null==g?void 0:g.segments.length){let t=u.c8.adjustTrackTargetStartTime(r,g,!0);t.forEach(e=>{let{params:t}=e;t.draftId=r.getDraftId()}),(0,s.W)(t,e);let i=u.c8.updateDraftDurationIfNeeded(r);i.forEach(e=>{let{params:t}=e;t.draftId=r.getDraftId()}),(0,s.W)(i,e)}(0,s.W)(m,e)}constructor(e,t){var i;super(e);let r=new d.O1(t.getDraftProperty().fps);this.options.subDraft.duration=r.gen(e.subDraft.duration).tail,this.options.startTime=r.gen(null!==(i=e.startTime)&&void 0!==i?i:0n).tail,this.options.duration=r.gen(e.duration).tail}}m.type=r.Us.ADD_TEMPLATE_COMBINATION_ACTION},601463:function(e,t,i){"use strict";i.d(t,{z:function(){return m}});var r=i(211561),n=i(150002),a=i(853277),s=i(475028),o=i(690613),l=i(653322),u=i(160849),d=i(481631),c=i(129862),h=i(283751);let p=(0,s.i)(l.H.UpdateCombinationSubDraftIdError,"");class m extends n.a{get type(){return m.type}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i&&(0,d.du)(i)?(0,o.ly)():p(`subDraft: ${t}`)}do(e,t,i){let n,a,s,o,{segmentId:l,subDraftPtr:p,templateId:m}=this.options,{segment:f,trackIndex:g}=t.getSegmentAtPositionById(this.options.segmentId);u.bV.updateCombination(t,f,p,e);let y=new r.NOn({templateId:m}),_=new r.K2q;_.width=p.property.canvasConfig.width,_.width=_.width?_.width:720,_.height=p.property.canvasConfig.height,_.height=_.height?_.height:1280;_.width=(n=_.width,(n+(a=2)-1)/a*a);_.height=(s=_.height,(s+(o=2)-1)/o*o),y.material=_;let v=(0,d.xX)({__segment_struct_type:f.__segment_struct_type});h.T.pick(f,y,v),e(new c.F({trackIndex:g,trackId:t.getTrackBySegmentId(l,[]).id,segmentId:l,segmentDelta:y,sourceSegmentDelta:v}))}}m.type=a.U.UPDATE_COMBINATION_ACTION},846778:function(e,t,i){"use strict";i.d(t,{A:function(){return d}});var r=i(150002),n=i(853277),a=i(700857),s=i(744207),o=i(211561),l=i(690613),u=i(268468);class d extends r.a{get type(){return d.type}check(e){return(0,l.ly)()}do(e,t,i){let r=new u.ry;r.retouchCover=new o.Dqu(new o.__d),r.cover=new s.k(new s.q),r.staticCoverImagePath="",e(new a.W({propertyDelta:r}))}}d.type=n.U.CLEAR_COVER},650387:function(e,t,i){"use strict";i.d(t,{J:function(){return c}});var r=i(150002),n=i(853277),a=i(363397),s=i(211561),o=i(475028),l=i(690613),u=i(653322);let d=(0,o.i)(u.H.CanvasSizeContainerParamsNotValid,"");class c extends r.a{get type(){return c.type}check(e){return e.getDraftById(this.options.draftId)?(0,l.ly)():d(`draftId is wrong: ${this.options.draftId}`)}do(e,t){let i=this.options.draftId?t.getDraftById(this.options.draftId):t;(0,a.fr)(this.options,i,e)}constructor(e){var t,i,r,n,a,o,l,u,d;super(Object.assign({},{containerWidth:null!==(t=e.containerWidth)&&void 0!==t?t:0,containerHeight:null!==(i=e.containerHeight)&&void 0!==i?i:0,customWidth:null!==(r=e.customWidth)&&void 0!==r?r:0,customHeight:null!==(n=e.customHeight)&&void 0!==n?n:0,ratio:null!==(a=e.ratio)&&void 0!==a?a:s.rxY.CanvasRatioOriginal,minSize:null!==(o=e.minSize)&&void 0!==o?o:0,maxSize:null!==(l=e.maxSize)&&void 0!==l?l:0,domWidth:null!==(u=e.domWidth)&&void 0!==u?u:-1,domHeight:null!==(d=e.domHeight)&&void 0!==d?d:-1,draftId:e.draftId}))}}c.type=n.U.SET_CANVAS_CONFIG},502257:function(e,t,i){"use strict";i.d(t,{R:function(){return g}});var r=i(211561),n=i(280700),a=i(129862),s=i(150002),o=i(853277),l=i(475028),u=i(690613),d=i(653322),c=i(35276),h=i(127926),p=i(481631),m=i(283751);let f=(0,l.i)(d.H.KeyframeSegmentNotExist,"");class g extends s.a{get type(){return g.type}check(e){let{segmentId:t}=this.options;return(0,n.Cm)(e.getAllTracks(),t)?(0,u.ly)():f(`segment is not exist id:${t}`)}do(e,t){let i,s;let{segmentId:o,keyframeId:l,keyframeType:u,dataParam:d}=this.options,{segmentIndex:f,trackIndex:g,trackId:y}=(0,n.Cm)(t.getAllTracks(),o),_=t.getAllTracks()[g].segments[f],v=_.clone();if(u!==r.Eu.KFTypeNone&&(i=h.OL.findKeyframes(v,u),s=h.OL.findKeyframe(i,l)),!s){let e=h.OL.findKeyframeByIdFromSegment(v,l);if(!e)return;s=e.keyframe,i=e.parent}let k=-1n;d.playHead>=0&&(k=new c.b().getKeyframeTimeOffsetByTimeline(t,v,d.playHead));let I=s.curveType;if(h.OL.updateKeyframeParams(s,d,k),s&&I!==s.curveType){h.OL.updateDefaultControlPointById(i,s.id);let e=s.curveType===r.wHM.KeyframeCurveTypeCurveOut||s.curveType===r.wHM.KeyframeCurveTypeCurveIn||s.curveType===r.wHM.KeyframeCurveTypeCurveInOut,t=I===r.wHM.KeyframeFreeCurveTypeCurveOut||I===r.wHM.KeyframeFreeCurveTypeCurveIn||I===r.wHM.KeyframeFreeCurveTypeCurveInOut;e&&t&&h.OL.resetControlPoints(i,s.id)}let S=(0,p.xX)({__segment_struct_type:_.__segment_struct_type});S.commonKeyframes=v.commonKeyframes;let w=(0,p.xX)({__segment_struct_type:_.__segment_struct_type});m.T.pick(_,S,w),e(new a.F({segmentId:o,trackId:y,trackIndex:g,segmentDelta:S,sourceSegmentDelta:w}))}}g.type=o.U.UPDATE_KEYFRAME},20889:function(e,t,i){"use strict";i.d(t,{h:function(){return u}});var r=i(211561),n=i(392742),a=i(448218),s=i(361708),o=i(217201),l=i(187198);class u{addMovedSegments(e){this._movedSegments.push(...e),this._needHandleSegments.push(...e)}clearMovedSegments(){this._movedSegments=[],this._needHandleSegments=[]}moveOneFinished(e){let t=this._needHandleSegments.findIndex(t=>t.id===e.id);-1!==t&&this._needHandleSegments.splice(t,1)}getSegmentByIdSourceIndex(e,t){if(!e)return -1;let i=-1,r=e.segments;for(let e=0;e<r.length;e++)if(r[e].id===t){i=e;break}return i}findSegmentIndex(e,t,i){if(e.length<=0)return 0;let r=-1,n=-1n,a=t.start,s=a+t.duration,o=!0;for(let t of e){r++;let e=t.targetTimerange,{start:l}=e,u=e.duration+l,d=!!(this._movedSegments.find(e=>e.id===t.id)&&i);if(l>=a&&l<s&&!d||u>a&&u<=s&&!d)return -1;if((n<=a||o)&&l>=s)return r;n=u,o=d}return n<=a||o?r+1:-1}findTargetIndexToInsert(e,t){let{segments:i}=e,n=[];for(let e of i){if(!!e)!this._needHandleSegments.find(t=>t===e)&&n.push(e)}if(0===n.length)return 0;let a=n[0],s=n[n.length-1];if(a.targetTimerange&&s.targetTimerange){let e=t.start,i=e+t.duration,r=a.targetTimerange.start,o=s.targetTimerange.start+s.targetTimerange.duration;if(i<=r)return 0;if(e>=o)return n.length}return this.findSegmentIndex(n,t,e.type===r.pNd.TrackTypeVideo)}getInsertTrack(e,t,i,n){if(!e.getMainTrack()&&!(t.trackType===r.pNd.TrackTypeVideo&&t.targetIndex===o.fm)){let t=new o.vp(r.pNd.TrackTypeVideo,o.fm,r.w9k.FlagNone);this.getInsertTrack(e,t,[r.pNd.TrackTypeVideo],n)}let s=[],l=o.c8.addEmptyTrackIfNeeded(e,t,i,s,n);return!l&&(l=e.getTracksByTypes(i)[t.targetIndex]),(0,a.W)(s,n),l}insertSegment(e,t,i,u){let d=e.getAllTracks()[i],c=t.targetTimerange,h=this.findTargetIndexToInsert(d,c);return h===s.P?s.P:(t.trackAttribute=d.attribute,(0,a.W)({type:n.x.InsertSegment,params:{trackId:d.id,segment:t,trackIndex:i}},u),i===o.fm&&new l.Tn().findEditDraftRuleConfig(i,r.pNd.TrackTypeVideo,r.pNd.TrackTypeVideo,r.b2c.SegmentJoint)===r.hsW.JointInOrder&&(0,a.W)(o.c8.adjustTrackTargetStartTime(e,d),u),h)}constructor(){this._needHandleSegments=[],this._movedSegments=[]}}},569818:function(e,t,i){"use strict";i.d(t,{b:function(){return p}});var r=i(150002),n=i(853277),a=i(475028),s=i(690613),o=i(653322),l=i(129862),u=i(481631),d=i(283751);let c=(0,a.i)(o.H.SegmentVisibleDraftNotExist,""),h=(0,a.i)(o.H.SegmentVisibleSegmentNotExist,"");class p extends r.a{get type(){return p.type}check(e){let t=e.getDraftById(this.options.draftId);return t?t.getSegmentById(this.options.segmentId,t,!1)?(0,s.ly)():h(`segment is not exist, segment id: ${this.options.segmentId}`):c(`draft is not exist, draft id: ${this.options.draftId}`)}do(e,t,i){let r=t.getDraftById(this.options.draftId),n=r.getTrackBySegmentId(this.options.segmentId),a=r.getSegmentById(this.options.segmentId),s=(0,u.xX)({__segment_struct_type:a.__segment_struct_type});s.visible=this.options.visible;let o=(0,u.xX)({__segment_struct_type:a.__segment_struct_type});d.T.pick(a,s,o),e(new l.F({draftId:this.options.draftId,trackId:n.id,trackIndex:r.getTrackIndexBySegmentId(this.options.segmentId),segmentId:this.options.segmentId,segmentDelta:s,sourceSegmentDelta:o}))}}p.type=n.U.SEGMENT_VISIBLE},418474:function(e,t,i){"use strict";i.d(t,{L:function(){return g}});var r=i(150002),n=i(853277),a=i(211561),s=i(712616),o=i(879388),l=i(475028),u=i(690613),d=i(653322),c=i(217201),h=i(912224),p=i(711999),m=i(81649);let f=(0,l.i)(d.H.AddTargetIndexNotValid,"");class g extends r.a{get type(){return n.U.STICKER_ADD}check(e){let t=e.getFirstTrackIndexByTrackType(a.pNd.TrackTypeAudio);return t&&this.options.trackIndex>t?f(`targetIndex > minAudioTrack:${t}`):(0,u.ly)()}do(e,t,i){let r={targetStartTime:this.options.segInfo.timeRange.start,targetDuration:this.options.segInfo.timeRange.duration,targetTrackIndex:this.options.trackIndex,type:a.pNd.TrackTypeSticker,targetSegmentId:""};new o.W().moveConflictSegment(t,r,t.getAllTracks(),e,i);let{segInfo:n,adaptionModel:l}=this.options,{clip:u}=n;(0,p.F)([0,0],a.rxY.CanvasRatio16To9,!1,t,e);let d=new a.S8D;d.id=n.segId,d.renderIndex=new h.eK().nextTextAndStickerRenderIndex(t),l&&(d.adaptionModel=l),u&&(d.clip=new a.bXy({flip:new a.BWs({vertical:u.flipVertical,horizontal:u.flipHorizontal}),scale:new a.Ciz({x:u.scaleX,y:u.scaleY}),rotation:u.rotation,transform:new a.wx7({x:u.transformX,y:u.transformY})}));let m=new a.cJv;if(m.categoryId=n.material.categoryId,m.categoryName=n.material.categoryName,m.name=n.material.name,m.path=n.material.path,m.resourceId=n.material.resourceId,m.stickerId=n.material.stickerId,m.unicode=n.material.unicode,m.iconUrl=n.material.iconUrl,m.previewCoverUrl=n.material.previewCoverUrl,m.platform=n.material.platform,m.sourcePlatform=n.material.sourcePlatform,m.formulaId=n.material.formulaId,m.teamId=n.material.teamId,m.requestId=n.material.requestId,d.material=m,d.material.type=a.cVg.MetaTypeSticker,d.targetTimerange=new a.tnv(n.timeRange),n.animations)for(let i of n.animations)s.i.updateTextAnim(d,i,e,t);let f=new c.vp(a.pNd.TrackTypeSticker,this.options.trackIndex,a.w9k.FlagNone);c.c8.insertSegmentHelper(t,d,f,e)}constructor(e,t){super(e);let i=new m.O1(t.getDraftProperty().fps),r=i.gen(e.segInfo.timeRange.start).tail,n=i.gen(e.segInfo.timeRange.start+e.segInfo.timeRange.duration).tail;this.options.segInfo.timeRange={start:r,duration:n-r}}}g.type=n.U.STICKER_ADD},261133:function(e,t,i){"use strict";i.d(t,{k:function(){return p}});var r=i(475028),n=i(690613),a=i(150002),s=i(853277),o=i(653322),l=i(129862),u=i(211561),d=i(283751),c=i(481631);let h=(0,r.i)(o.H.RemoveTextAudiosActionIdEmpty,"");class p extends a.a{get type(){return s.U.REMOVE_TEXT_AUDIOS}check(e){let{segmentIds:t}=this.options;return 0===t.length?h("segmentIds length is 0"):(0,n.ly)()}do(e,t,i){let{segmentIds:r}=this.options;r.forEach(i=>{let r=t.getSegmentById(i);if(!r)return;let n=new u.xKN;n.material=new u.edz,n.material.textToAudioIds=[];let a=(0,c.xX)({__segment_struct_type:r.__segment_struct_type});d.T.pick(r,n,a),e(new l.F({trackId:t.getTrackBySegmentId(r.id).id,trackIndex:t.getTrackIndexBySegmentId(r.id),segmentId:i,segmentDelta:n,sourceSegmentDelta:a}))})}}p.type=s.U.REMOVE_TEXT_AUDIOS},291509:function(e,t,i){"use strict";i.d(t,{Y:function(){return g}});var r=i(129862),n=i(150002),a=i(853277),s=i(475028),o=i(690613),l=i(481631),u=i(211561),d=i(653322),c=i(223729),h=i(90844),p=i(501452),m=i(283751);let f=(0,s.i)(d.H.TextSetFixedSizeActionSegmentNotValid,"");class g extends n.a{get type(){return g.type}check(e){let t=e.getSegmentById(this.options.segmentId);return t&&(0,l.Ft)(t)?(0,o.ly)():f(`segment is not valid, segment 
      id is ${this.options.segmentId},
      type is ${null==t?void 0:t.__segment_struct_type}`)}do(e,t,i){let{segmentId:n,fixedWidth:a,fixedHeight:s,x:o,y:d,isKeyframe:f,draftId:g}=this.options,y=t.getDraftById(g);if(!y)return;let _=y.getSegmentById(n);if(!_||!(0,l.Ft)(_))return;let v=new c.B;v.iOpCode=h.wI.CT_EDIT_TEXT_PARAM,v.iParam5=JSON.stringify({canvasWHFixed:[null!=a?a:-1,null!=s?s:-1]});let k=new u.xKN;k.clip=new u.tLq,k.clip.transform=new u.jPZ(new u.wx7({x:o,y:d})),k.material=new u.edz({fixedWidth:a,fixedHeight:s,richTextCommand:v});let I=(0,l.xX)({__segment_struct_type:_.__segment_struct_type});m.T.pick(_,k,I),e(new r.F({draftId:g,trackId:y.getTrackBySegmentId(n).id,trackIndex:y.getTrackIndexBySegmentId(n),segmentId:n,segmentDelta:k,sourceSegmentDelta:I})),f&&[{keyframeType:u.Eu.KFTypePositionX,values:[null!=o?o:0]},{keyframeType:u.Eu.KFTypePositionY,values:[null!=d?d:0]}].forEach(t=>{let{keyframeType:i,values:n}=t,a=p.y.execute({draftView:y,segment:_,keyframeType:i,values:n});a&&e(new r.F({draftId:g,...a}))})}}g.type=a.U.ADJUST_TEXT_FIXED_SIZE_ACTION},779166:function(e,t,i){"use strict";i.d(t,{d:function(){return m}});var r=i(211561),n=i(481631),a=i(129862),s=i(879566),o=i(432641),l=i(475028),u=i(690613),d=i(150002),c=i(653322),h=i(853277);let p=(0,l.i)(c.H.TextSetMaterialsActionUpdatesEmpty,"");class m extends d.a{get type(){return m.type}check(e){let{updates:t}=this.options;return 0===t.length?p("updates is empty"):(0,u.ly)()}do(e,t,i){let{skipCalcWords:l,updates:u}=this.options;for(let i of u){let{segmentId:u,segmentDelta:d}=i,c=t.getSegmentById(u);if(c&&(0,n.Ft)(c)){let t=c.targetTimerange.duration,n=s.hM.getOriginContentFromContent(c.material.content);e(new a.F(i));let u=c.targetTimerange.duration,h=s.hM.getOriginContentFromContent(c.material.content);if(l)continue;if(c.material.addType===r.RZH.ManualAdd&&(h!==n||u!==t)){let t=o.L.generateTextMaterialWords(h,u);d.material.words=new r.JQY(t),e(new a.F(i))}}}}}m.type=h.U.UPDATE_TEXT_MATERIAL_ACTION},689711:function(e,t,i){"use strict";i.d(t,{l:function(){return r.l}});var r=i(37858)},745337:function(e,t,i){"use strict";i.d(t,{B:function(){return m}});var r=i(150002),n=i(853277),a=i(129862),s=i(211561),o=i(475028),l=i(690613),u=i(481631),d=i(653322),c=i(283751);let h=(0,o.i)(d.H.SegmentNotExist,""),p=(0,o.i)(d.H.SegmentTypeNotValid,"");class m extends r.a{get type(){return m.type}check(e){let{segId:t}=this.options,i=e.getSegmentById(t);return i?(0,u.he)(i)?(0,l.ly)():p(`segment type not valid: ${t}`):h(`segment not exist: ${t}`)}do(e,t,i){let{segId:r}=this.options,n=t.getSegmentById(r),o=t.getTrackBySegmentId(n.id),l=new s.NOn;l.smartCrop=null;let d=(0,u.xX)({__segment_struct_type:n.__segment_struct_type});c.T.pick(n,l,d),e(new a.F({trackId:o.id,trackIndex:t.getTrackIndexBySegmentId(n.id),segmentId:n.id,segmentDelta:l,sourceSegmentDelta:d}))}}m.type=n.U.VIDEO_REMOVE_SMART_CROP},179247:function(e,t,i){"use strict";i.d(t,{O:function(){return c}});var r=i(150002),n=i(853277),a=i(176791),s=i(475028),o=i(690613),l=i(653322),u=i(481631);let d=(0,s.i)(l.H.AddAnimationSegmentNotExist,"");class c extends r.a{get type(){return n.U.ADD_ANIMATION}check(e){return e.getSegmentById(this.options.segId)?(0,o.ly)():d(`segment not exist:${this.options.segId}`)}do(e,t,i){let{segId:r,animation:n}=this.options,s=t.getSegmentById(r);if(!!s&&!!(0,u.he)(s))new a.wK().addVideoAnimations(t,s,n,e)}}c.type=n.U.ADD_ANIMATION},128324:function(e,t,i){"use strict";i.d(t,{U:function(){return p}});var r=i(211561),n=i(150002),a=i(853277),s=i(475028),o=i(690613),l=i(653322),u=i(481631),d=i(129862);let c=(0,s.i)(l.H.SetVideoObjectLockedNotExist,""),h=(0,s.i)(l.H.SetVideoObjectLockedTypeNotValid,"");class p extends n.a{get type(){return a.U.VIDEO_ADD_OBJECT_LOCKED}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,u.he)(i)?i.material.type!==r.cVg.MetaTypeVideo?h(`segment material type not valid: ${i.material.type}`):(0,o.ly)():h(`segment type not valid: ${i.__segment_struct_type}`):c(`segment not exist: ${t}`)}do(e,t){let{segment:i,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,u.he)(i)){let a=new r.NOn;a.material=new r.K2q,a.material.objectLocked=new r.BnV(this.options);let s=(0,u.xX)({__segment_struct_type:i.__segment_struct_type});e(new d.F({trackId:t.getTrackByIndex(n).id,trackIndex:t.getTrackIndexBySegmentId(i.id),segmentId:i.id,segmentDelta:a,sourceSegmentDelta:s}))}}}},393409:function(e,t,i){"use strict";i.d(t,{k:function(){return _}});var r=i(150002),n=i(853277),a=i(211561),s=i(448218),o=i(239648),l=i(676177),u=i(475028),d=i(690613),c=i(481631),h=i(653322),p=i(217201),m=i(81649);let f=(0,u.i)(h.H.AddVideoTrackIndexError,""),g=(0,u.i)(h.H.AddVideoVideoLengthNotValid,""),y=(0,u.i)(h.H.AddVideoVideoDurationNotValid,"");class _ extends r.a{get type(){return _.type}check(e){if(this.options.trackIndex<0||this.options.trackIndex>e.getAllTracks().length)return f(`track index not valid, trackindex: ${this.options.trackIndex}`);if(0===this.options.videos.length)return g("video lengths can not be 0");for(let e of this.options.videos)if(e.duration<0)return y(`video duration is < 0, id:${e.segmentId}`);return(0,d.ly)()}do(e,t,i){var r;l.M.beforeAddHelper(this.options,t,e,i);let n=[];return n=this._add(t,e),l.M.setFastImportPathHelper(t,n),null===(r=n[0])||void 0===r?void 0:r.id}_add(e,t){let i=l.M.insertVideoSegmentsHelper(this.options,e,t),r=this.options.trackIndex===p.fm&&e.getDraftProperty().videoMute,n=[];for(let t of i)if(r){let i=new a.NOn;i.volume=0,n.push((0,s.l)(e,t.id,i))}if((0,s.W)(n,t),this.options.trackIndex===p.fm){let r=e.getMainTrack(),n=!1;for(let a of i)if(a){let i=0n,l=o.Uo.prototype.findPrevSegment(r,a);if(l&&(0,c.he)(l)&&l.transition){i=a.targetTimerange.duration;let[,r]=o.Uo.prototype.adjustVideoTransitionByDuration(e,l,i);r&&(0,s.W)(r,t),n=!0}}if(n){let i=p.c8.adjustTrackTargetStartTime(e,r);(0,s.W)(i,t)}}return i}constructor(e,t){super(e);let i=new m.O1(t.getDraftProperty().fps);this.options.videos=this.options.videos.map(e=>{var t,r,n,a,s,o;let l=i.gen(null!==(t=e.sourceStartTime)&&void 0!==t?t:0n).tail,u=i.gen((null!==(r=e.sourceStartTime)&&void 0!==r?r:0n)+(null!==(n=e.sourceDuration)&&void 0!==n?n:0n)).tail,d=i.gen(null!==(a=e.startTime)&&void 0!==a?a:0n).tail,c=i.gen((null!==(s=e.startTime)&&void 0!==s?s:0n)+(null!==(o=e.duration)&&void 0!==o?o:0n)).tail;return{...e,sourceStartTime:l,sourceDuration:u-l,startTime:d,duration:c-d}})}}_.type=n.U.VIDEO_ADD},350052:function(e,t,i){"use strict";i.d(t,{H:function(){return f}});var r=i(150002),n=i(853277),a=i(211561),s=i(129862),o=i(653322),l=i(475028),u=i(690613),d=i(481631),c=i(274092),h=i(283751);let p=(0,l.i)(o.H.ClearVideoFigureSegmentNotExist,""),m=(0,l.i)(o.H.ClearVideoFigureTypeNotValid,"");class f extends r.a{get type(){return f.type}check(e){let t=e.getSegmentById(this.options.segmentId);return t?(0,d.he)(t)?(0,u.ly)():m(`segment type is not valid, type is ${t.__segment_struct_type}`):p("segment is not exist")}do(e,t,i){let{segmentId:r,faceIds:n,resourceIds:o}=this.options,l=t.getTrackBySegmentId(r),u=t.getSegmentById(r);if(!u||!(0,d.he)(u))return;let{figures:p}=u,m=(0,c.A)({faceIds:n,resourceIds:o,figures:p}),f=new a.NOn;f.figures=m;let g=(0,d.xX)({__segment_struct_type:u.__segment_struct_type});h.T.pick(u,f,g),e(new s.F({trackId:l.id,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:f,sourceSegmentDelta:g}))}}f.type=n.U.VIDEO_REMOVE_FIGURE},323326:function(e,t,i){"use strict";i.d(t,{E:function(){return m}});var r=i(150002),n=i(853277),a=i(211561),s=i(176791),o=i(448218),l=i(475028),u=i(690613),d=i(481631),c=i(653322);let h=e=>!e.some(e=>e<0),p=(0,l.i)(c.H.CropPositionNotValid,"");class m extends r.a{get type(){return m.type}check(e){var t,i,r,n,a,s,o,l;return h([null!==(t=this.options.upperLeftX)&&void 0!==t?t:0,null!==(i=this.options.upperLeftY)&&void 0!==i?i:0,null!==(r=this.options.upperRightX)&&void 0!==r?r:1,null!==(n=this.options.upperRightY)&&void 0!==n?n:0,null!==(a=this.options.lowerLeftX)&&void 0!==a?a:0,null!==(s=this.options.lowerLeftY)&&void 0!==s?s:1,null!==(o=this.options.lowerRightX)&&void 0!==o?o:1,null!==(l=this.options.lowerRightY)&&void 0!==l?l:1])?(0,u.ly)():p(`crop position is not valid: ${this.options}`)}do(e,t,i){var r,n,l,u,c,h,p,m;let{draftId:f}=this.options,g=t.getDraftById(f);if(!g)return;let y=g.getSegmentById(this.options.segId);if(!y||!(0,d.he)(y))return;let _=y.material;if(!_)return;let v=new a.NOn;v.material=new a.K2q;let{crop:k}=_,I=k.clone();if(v.material.cropRatio=this.options.cropRatio,I.upperLeftX=null!==(r=this.options.upperLeftX)&&void 0!==r?r:0,I.upperLeftY=null!==(n=this.options.upperLeftY)&&void 0!==n?n:0,I.upperRightX=null!==(l=this.options.upperRightX)&&void 0!==l?l:1,I.upperRightY=null!==(u=this.options.upperRightY)&&void 0!==u?u:0,I.lowerLeftX=null!==(c=this.options.lowerLeftX)&&void 0!==c?c:0,I.lowerLeftY=null!==(h=this.options.lowerLeftY)&&void 0!==h?h:1,I.lowerRightX=null!==(p=this.options.lowerRightX)&&void 0!==p?p:1,I.lowerRightY=null!==(m=this.options.lowerRightY)&&void 0!==m?m:1,this.options.enableCropScale){let e=g.getDraftProperty().canvasConfig,t={width:_.width,height:_.height},i=new s.wK().calculateCropScale(e,t,I);v.material.cropScale=i}v.material.crop=new a.V_m(I),(0,o.W)((0,o.l)(g,this.options.segId,v),e)}}m.type=n.U.VIDEO_CROP},64653:function(e,t,i){"use strict";i.d(t,{m:function(){return u}});var r=i(150002),n=i(853277),a=i(211561),s=i(448218),o=i(690613),l=i(481631);class u extends r.a{get type(){return u.type}check(e){return(0,o.ly)()}do(e,t,i){for(let i of this.options.segIds){var r,n,o;let u=t.getSegmentById(i);if(!u||!(0,l.he)(u))continue;let{realtimeDenoise:d}=u;if(!this.options.isDenoise){let r=new a.NOn;r.intensifiesAudio=!1,r.realtimeDenoise=new a.tpe(new a.jU8({...d,isDenoise:!1})),(0,s.W)((0,s.l)(t,i,r),e)}let c=Object.assign({},d),h=this.options;c.path=h.path,c.isDenoise=h.isDenoise,c.denoiseMode=h.denoiseMode,c.denoiseRate=h.denoiseRate,c.samiName=null!==(r=h.samiName)&&void 0!==r?r:"denoise_v2",c.samiVersion=null!==(n=h.samiVersion)&&void 0!==n?n:"1.0",c.samiType=null!==(o=h.samiType)&&void 0!==o?o:1;let p=new a.NOn;p.intensifiesAudio=!1,p.realtimeDenoise=new a.tpe(new a.jU8(c)),p.material=new a.K2q,(0,s.W)((0,s.l)(t,i,p),e)}}}u.type=n.U.VIDEO_DENOISE},60680:function(e,t,i){"use strict";i.d(t,{Q:function(){return c}});var r=i(150002),n=i(853277),a=i(211561),s=i(448218),o=i(690613),l=i(481631),u=i(81289),d=i(247306);class c extends r.a{get type(){return c.type}check(e){return(0,o.ly)()}do(e,t,i){var r;let n=t.getSegmentById(this.options.segId);if(!n||!(0,l.he)(n))return;let o=t.getMainTrack(),c=null!==(r=null==o?void 0:o.segments)&&void 0!==r?r:[];if(this.options.background)for(let i of c){if(i.id===n.id||!(0,l.he)(i))continue;let r=n.background.clone(!0);r.albumImage=i.background.albumImage;let o=new a.NOn;o.background=new a.Fq$(r),(0,s.W)((0,s.l)(t,i.id,o),e)}if(this.options.transition){(0,u.m)(t,this.options.segId,e);return}if(this.options.adjust){(0,d.d)(t,this.options.segId,e);return}}}c.type=n.U.VIDEO_BACKGROUND_ALL},999642:function(e,t,i){"use strict";i.d(t,{n:function(){return y}});var r=i(150002),n=i(853277),a=i(129862),s=i(211561),o=i(987061),l=i(475028),u=i(690613),d=i(481631),c=i(280700),h=i(783959),p=i(653322),m=i(283751);let f=(0,l.i)(p.H.PitchOnVideoSegmentNotExist,""),g=(0,l.i)(p.H.PitchOnVideoSegmentTypeNotValid,"");class y extends r.a{get type(){return y.type}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,d.Y9)(i)||(0,d.he)(i)?(0,u.ly)():g(`segmentType not valid: ${i.__segment_struct_type}`):f(`segment not exist: ${t}`)}do(e,t,i){var r;let{segmentId:n,modifyTone:l}=this.options,u=(0,c.Cm)(t.getAllTracks(),n);if(!u)return;let p=t.getAllTracks()[u.trackIndex].segments[u.segmentIndex],f=(0,d.Y9)(p)?new s.CCx:new s.NOn;f.isToneModify=l;let g=(0,d.xX)({__segment_struct_type:p.__segment_struct_type});m.T.pick(p,f,g),e(new a.F({trackId:u.trackId,trackIndex:u.trackIndex,segmentId:n,segmentDelta:f,sourceSegmentDelta:g})),l&&(null===(r=f.speed)||void 0===r?void 0:r.mode)===s.yY$.SpeedModeCurve&&((0,d.Y9)(p)?(0,h.$)(t,{segmentId:n,value:1},e,i):(0,d.he)(p)&&(0,o.tv)(t,{segId:n,mode:s.yY$.SpeedModeNormal,value:1},e))}}y.type=n.U.VIDEO_PITCH_ON},84260:function(e,t,i){"use strict";i.d(t,{K:function(){return _}});var r=i(475028),n=i(690613),a=i(211561),s=i(280700),o=i(129862),l=i(448218),u=i(176791),d=i(150002),c=i(853277),h=i(653322),p=i(217201),m=i(283751),f=i(481631);let g=(0,r.i)(h.H.ClearVideoTransitionSegmentNotExist,""),y=(0,r.i)(h.H.ClearAudioVoiceEffectSegmentTypeNotValid,"");class _ extends d.a{get type(){return _.type}check(e){let{segIds:t}=this.options;for(let i of t){let t=(0,s.Cm)(e.getAllTracks(),i);if(!t)return g(`segment not exist, id: ${i}`);let{segmentIndex:r,trackIndex:n}=t,a=e.getAllTracks()[n].segments[r];if("SegmentVideo"!==a.__segment_struct_type)return y(`type is not valid, type is ${a.__segment_struct_type}`)}return(0,n.ly)()}do(e,t,i){let{segIds:r}=this.options;for(let i of r){let r;let{segmentIndex:n,trackIndex:d,trackId:c}=(0,s.Cm)(t.getAllTracks(),i),h=t.getAllTracks()[d],g=h.segments[n];n+1<h.segments.length&&(r=h.segments[n+1]),r&&new u.wK().updateVideoAnimationsWithTrans(g,r,0n,e,t);let{transition:y}=g;if(!y)return;let _=new a.NOn;_.transition=null;let v=(0,f.xX)({__segment_struct_type:g.__segment_struct_type});m.T.pick(g,_,v);let k=new o.F({segmentId:i,trackId:c,trackIndex:d,segmentDelta:_,sourceSegmentDelta:v});(0,l.W)(p.c8.adjustTrackTargetStartTime(t,h),e),e(k)}}}_.type=c.U.VIDEO_CLEAR_TRANSITION},30540:function(e,t,i){"use strict";i.d(t,{k:function(){return g}});var r=i(150002),n=i(853277),a=i(211561),s=i(280700),o=i(387232),l=i(361708),u=i(448218),d=i(268468),c=i(392742),h=i(690613),p=i(481631),m=i(217201);let f=(e,t,i,r)=>m.c8.insertSegmentHelper(e,t,i,r);class g extends r.a{get type(){return g.type}check(e){return(0,h.ly)()}do(e,t,i){let r=(0,s.Cm)(t.getAllTracks(),this.options.segId);if(!r)return;let{trackIndex:n,segmentIndex:h}=r,g=t.getAllTracks()[n].segments[h];if(!(0,p.he)(g))return;let y=g.material;if(!y)return;let _=null==y?void 0:y.extraTypeOption;if(this.options.isSeparate){let i=new a.NOn;i.material=new a.K2q,i.material.extraTypeOption=_|a.Yzk.HasSeparatedAudio,i.volume=g.volume,(0,u.W)((0,u.l)(t,g.id,i),e);let r=(0,o.xM)(g,this.options.audioSegId);if(!r||!(0,p.Y9)(r))return;let n=r.material;if(this.options.audioPath&&(n.path=this.options.audioPath),this.options.audioName&&(n.name=this.options.audioName),l.b.isCombinationVideo(g)){let e=l.b.videoCombinationToAudio(g.materialDraft);r.materialDraft=null!=e?e:void 0}let s=new m.vp(a.pNd.TrackTypeAudio,this.options.audioTargetTrackIndex,a.w9k.FlagNone);if(this.options.needInsertTargetTrack){let t=new d.wO;t.type=a.pNd.TrackTypeAudio,t.flag=a.w9k.FlagNone,(0,u.W)({type:c.x.InsertTrack,params:{trackIndex:this.options.audioTargetTrackIndex,trackProperty:t}},e)}f(t,r,s,e);let h=t.getDraftProperty().originalSoundLastIndex+1,y=new d.ry;y.originalSoundLastIndex=h,(0,u.W)({type:c.x.SetDocumentProperty,params:{propertyDelta:y}},e)}else{let i=new a.NOn;i.material=new a.K2q,i.material.extraTypeOption=_&~a.Yzk.HasSeparatedAudio,i.volume=g.volume,(0,u.W)((0,u.l)(t,this.options.segId,i),e)}}}g.type=n.U.VIDEO_SEPARATE_AUDIO},268501:function(e,t,i){"use strict";i.d(t,{O:function(){return p}});var r=i(150002),n=i(853277),a=i(211561),s=i(448218),o=i(475028),l=i(690613),u=i(481631),d=i(653322);let c=(0,o.i)(d.H.SetVideoBackgroundBlurSegmentNotExist,""),h=(0,o.i)(d.H.SetVideoBackgroundBlurTypeNotValid,"");class p extends r.a{get type(){return p.type}check(e){let t=e.getSegmentById(this.options.segId);return t?(0,u.he)(t)?(0,l.ly)():h(`segment type is not valid, type is ${t.__segment_struct_type}`):c("segment is not exist")}do(e,t,i){let r=new a.fln;r.blur=this.options.blur,r.type=a.cVg.MetaTypeCanvasBlur;let n=new a.NOn;n.background=new a.Fq$(r),(0,s.W)((0,s.l)(t,this.options.segId,n),e)}}p.type=n.U.VIDEO_BACKGROUND_BLUR},335378:function(e,t,i){"use strict";i.d(t,{Y:function(){return f}});var r=i(853277),n=i(150002),a=i(475028),s=i(690613),o=i(653322),l=i(481631),u=i(211561),d=i(129862),c=i(93735),h=i(283751);let p=(0,a.i)(o.H.SegmentNotExist,""),m=(0,a.i)(o.H.SegmentTypeNotValid,"");class f extends n.a{get type(){return f.type}check(e){let t=e.getSegmentById(this.options.segmentId);return t?(0,l.he)(t)?(0,s.ly)():m(`segment type is not valid, type is ${t.__segment_struct_type}`):p("segment is not exist")}do(e,t,i){let{segmentId:r,figure:n}=this.options,a=t.getTrackBySegmentId(r),s=t.getSegmentById(r);if(!s||!(0,l.he)(s))return;let o=new u.NOn;o.makeupRoot=new u.W9x((0,c.yK)(n));let p=(0,l.xX)({__segment_struct_type:s.__segment_struct_type});h.T.pick(s,o,p),e(new d.F({trackId:a.id,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:o,sourceSegmentDelta:p}))}}f.type=r.U.VIDEO_SET_FIGURE},429262:function(e,t,i){"use strict";i.d(t,{S:function(){return u}});var r=i(789786),n=i(201483),a=i(915359),s=i(399815),o=i(575534),l=i(340294);class u extends o.e{add(e){return this._mixApplyLocal({action:new n.r(e)})}setBasicColor(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this._mixApplyLocal({action:new s.r(e)},{canUndoRedo:t})}resetBasicColor(e){return this._mixApplyLocal({action:new a.P(e)})}}(0,r.gn)([(0,l.cM)("adjustmentApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddAdjustmentActionOptions?Object:IAddAdjustmentActionOptions]),(0,r.w6)("design:returntype",void 0)],u.prototype,"add",null),(0,r.gn)([(0,l.cM)("adjustmentApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetBasicColorActionOptions?Object:ISetBasicColorActionOptions,void 0]),(0,r.w6)("design:returntype",void 0)],u.prototype,"setBasicColor",null),(0,r.gn)([(0,l.cM)("adjustmentApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IResetBasicColorActionOptions?Object:IResetBasicColorActionOptions]),(0,r.w6)("design:returntype",void 0)],u.prototype,"resetBasicColor",null)},599855:function(e,t,i){"use strict";i.d(t,{M:()=>ee});var r=i("789786"),n=i("178399"),a=i("759137"),s=i("150002"),o=i("853277"),l=i("20315"),u=i("211561"),d=i("313934"),c=i("129862"),h=i("783959"),p=i("117840"),m=i("481631"),f=i("475028"),g=i("690613"),y=i("653322"),_=i("217201"),v=i("521987"),k=i("711999"),I=i("81649"),S=i("283751");let w=(0,f.i)(y.H.AddTextAudioActionDurationNotValid,"");class b extends s.a{get type(){return b.type}check(e){var t;let{duration:i}=null!==(t=this.options)&&void 0!==t?t:{};return i<=0?w():(0,g.ly)()}do(e,t,i){var r,n,a,s,o,p,f,g;(0,k.F)([0,0],u.rxY.CanvasRatio16To9,!1,t,e);let y=[],I=[],w="",b=t.getSegmentById(null!==(p=null===(r=this.options.text)||void 0===r?void 0:r.textSegmentId)&&void 0!==p?p:"");if(!b)return;if(!((0,m.Ft)(b)||(0,m.Q2)(b)))return;y=[...b.material.textToAudioIds],I=(null===(g=this.options.text)||void 0===g?void 0:null===(f=g.replaceAudioSegmentIds)||void 0===f?void 0:f.length)?this.options.text.replaceAudioSegmentIds:y,w=b.material.id;(null===(n=this.options.text)||void 0===n?void 0:n.shouldReplace)&&I.length&&I.forEach(i=>{let r=t.getTrackBySegmentId(i,[u.pNd.TrackTypeAudio]);if(r){let{segment:n,trackIndex:a}=t.getSegmentAtPositionById(i);e(new d.j({segmentId:i,trackId:null==r?void 0:r.id,trackIndex:a,targetTimerange:n.targetTimerange}))}});let F=l.Ry.createSegmentAudio({...this.options,textId:w});F.id=this.options.segmentId,(null===(a=this.options.text)||void 0===a?void 0:a.volume)&&(F.volume=this.options.text.volume);let C=t.getTrackIndexById(this.options.trackId),A=new _.vp(u.pNd.TrackTypeAudio,C);if(_.c8.insertSegmentHelper(t,F,A,e),(0,h.$)(t,{segmentId:F.id,value:null===(s=this.options.text)||void 0===s?void 0:s.speed,targetStartTime:F.targetTimerange.start},e,i),null===(o=this.options.text)||void 0===o?void 0:o.shouldReplace){if(I.length)for(let e of I){let t=y.findIndex(t=>t===e);y.splice(t,1)}let i=t.getTrackBySegmentId(b.id);if(i){let r=new u.xKN;r.material=new u.edz,r.material.textToAudioIds=y;let n=(0,m.xX)({__segment_struct_type:F.__segment_struct_type});S.T.pick(F,r,n),e(new c.F({trackId:i.id,trackIndex:t.getTrackIndexBySegmentId(b.id),segmentId:b.id,segmentDelta:r,sourceSegmentDelta:n}))}}let x=(0,v.qQ)(t,F);x&&e(x),t.isTTSAutoUpdate(w)&&_.c8.syncAudioToText(t,F,e,i)}constructor(e,t){var i,r,n,a,s,o,l,d,c,h,m,f,g,y,_,v,k,S,w,b,F,C,A,x,E,D,M,K,P,B,O,z,V,j;let N=new I.O1(t.getDraftProperty().fps),R=N.gen(null!==(n=e.sourceStartTime)&&void 0!==n?n:0n).tail,L=N.gen((null!==(a=e.sourceStartTime)&&void 0!==a?a:0n)+(null!==(s=e.sourceDuration)&&void 0!==s?s:0n)).tail,H=N.gen(null!==(o=e.startTime)&&void 0!==o?o:0n).tail,W=N.gen((null!==(l=e.startTime)&&void 0!==l?l:0n)+(null!==(d=e.duration)&&void 0!==d?d:0n)).tail;super(Object.assign({},{audioId:null!==(c=e.audioId)&&void 0!==c?c:"",appId:null!==(h=e.appId)&&void 0!==h?h:0n,audioPath:null!==(m=e.audioPath)&&void 0!==m?m:"",audioTitle:null!==(f=e.audioTitle)&&void 0!==f?f:"",audioCategoryTitle:null!==(g=e.audioCategoryTitle)&&void 0!==g?g:"",audioCategoryId:null!==(y=e.audioCategoryId)&&void 0!==y?y:"",startTime:H,sourceStartTime:R,sourceDuration:L-R,duration:W-H,type:null!==(_=e.type)&&void 0!==_?_:u.cVg.MetaTypeNone,trackId:e.trackId,segmentId:e.segmentId,extrackMusic:null!==(v=e.extrackMusic)&&void 0!==v&&v,durationLimit:N.gen(null!==(k=e.durationLimit)&&void 0!==k?k:0n).tail,gear:null!==(S=e.gear)&&void 0!==S?S:p.np.AUDIO_BEAT_GEAR_NONE,mode:null!==(w=e.mode)&&void 0!==w?w:u.seH.AUDIO_BEAT_MODE_NONE,melodyUrl:null!==(b=e.melodyUrl)&&void 0!==b?b:"",melodyPath:null!==(F=e.melodyPath)&&void 0!==F?F:"",beatUrl:null!==(C=e.beatUrl)&&void 0!==C?C:"",beatPath:null!==(A=e.beatPath)&&void 0!==A?A:"",musicBeatPercent:null!==(x=e.musicBeatPercent)&&void 0!==x?x:.6,wavePoints:null!==(E=e.wavePoints)&&void 0!==E?E:[],sourcePlatformType:null!==(D=e.sourcePlatformType)&&void 0!==D?D:u.QZ3.AudioPlatformLibrary,formulaId:null!==(M=e.formulaId)&&void 0!==M?M:"",teamId:null!==(K=e.teamId)&&void 0!==K?K:"",localMaterialId:null!==(P=e.localMaterialId)&&void 0!==P?P:"",requestId:null!==(B=e.requestId)&&void 0!==B?B:"",text:{textSegmentId:e.text.textSegmentId,shouldReplace:e.text.shouldReplace,replaceAudioSegmentIds:null!==(O=null===(i=e.text)||void 0===i?void 0:i.replaceAudioSegmentIds)&&void 0!==O?O:[],resourceId:null!==(z=null===(r=e.text)||void 0===r?void 0:r.resourceId)&&void 0!==z?z:"",toneType:e.text.toneType,toneSpeaker:e.text.toneSpeaker,speed:e.text.speed,toneEffectId:e.text.toneEffectId,toneEffectName:e.text.toneEffectName,toneCategoryId:e.text.toneCategoryId,toneCategoryName:e.text.toneCategoryName,isAiCloneTone:null!==(V=e.text.isAiCloneTone)&&void 0!==V&&V,tonePlatform:null!==(j=e.text.tonePlatform)&&void 0!==j?j:"",volume:e.text.volume}}))}}b.type=o.U.ADD_TEXT_AUDIO;let F=(0,f.i)(y.H.ClearAudioVoiceEffectSegmentNotExist,""),C=(0,f.i)(y.H.ClearAudioVoiceEffectSegmentTypeNotValid,"");class A extends s.a{get type(){return o.U.CLEAR_AUDIO_VOICE_EFFECT}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,m.Y9)(i)||(0,m.he)(i)?(0,g.ly)():C(`segmentType not valid: ${i.__segment_struct_type}`):F(`segment not exist: ${t}`)}do(e,t,i){let{segmentId:r}=this.options,n=t.getSegmentNodeById(r,[]),a=n.segment,s=n.trackNode.track.id,o=(0,m.Y9)(a)?new u.CCx:new u.NOn;o.voiceChange=null;let{newCommonKeyframes:l,isChange:d}=this._getNewCommonKeyframes(a,[u.Eu.KFTypeEffectAdjustParam1,u.Eu.KFTypeEffectAdjustParam2,u.Eu.KFTypeEffectAdjustParam3]);d&&(o.commonKeyframes=l);let h=(0,m.xX)({__segment_struct_type:a.__segment_struct_type});S.T.pick(a,o,h),e(new c.F({trackId:s,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:o,sourceSegmentDelta:h}))}_getNewCommonKeyframes(e,t){let i=[],r=!1;for(let n of e.commonKeyframes){if(t.includes(n.propertyType)){r=!0;continue}i.push(n)}return{newCommonKeyframes:i,isChange:r}}}var x=i("505735"),E=i("53836"),D=i("862213");let M=(0,f.i)(y.H.RemoveAudioVocalSeparationSegmentNotExist,""),K=(0,f.i)(y.H.RemoveAudioVocalSeparationSegmentTypeNotValid,"");class P extends s.a{get type(){return D.Us.REMOVE_AUDIO_VOCAL_SEPARATION}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,m.Y9)(i)||(0,m.he)(i)?(0,g.ly)():K(`segmentType not valid: ${i.__segment_struct_type}`):M(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,m.he)(r)||(0,m.Y9)(r)){let i=(0,m.xX)({__segment_struct_type:r.__segment_struct_type,vocalSeparation:new u.JcE}),a=(0,m.xX)({__segment_struct_type:r.__segment_struct_type});S.T.pick(r,i,a),e(new c.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:a}))}}}var B=i("838971"),O=i("664543");let z=(0,f.i)(y.H.SetAudioFadeSegmentNotExist,""),V=(0,f.i)(y.H.SetAudioFadeSegmentTypeNotValid,""),j=(0,f.i)(y.H.SetAudioFadeDurationNotValid,"");class N extends s.a{get type(){return o.U.SET_AUDIO_FADE}check(e){let{segmentIds:t,fadeInDuration:i,fadeOutDuration:r}=this.options;for(let i of t){let t=e.getSegmentById(i);if(!t)return z(`segment not exist: ${i}`);if(!(0,m.Y9)(t))return V(`segmentType not valid: ${t.__segment_struct_type}`)}return i>=0n||r>=0n?(0,g.ly)():j(`segment not exist: ${i},  ${r}`)}do(e,t,i){let{segmentIds:r,fadeInDuration:n,fadeOutDuration:a}=this.options,s=r[0],o=t.getSegmentByTrackType(s,u.pNd.TrackTypeAudio).targetTimerange.duration;for(let i of r){let r=t.getSegmentByTrackType(i,u.pNd.TrackTypeAudio),s=r.targetTimerange.duration,l=n>=0?n*s/o:-1n,d=a>=0?a*s/o:-1n;e(this._generateUpdateSegmentMutation(t,r,l,d))}}_generateUpdateSegmentMutation(e,t,i,r){let n=new u.CCx,a=new u.lMN;n.fade=a;let s=e.getSegmentNodeById(t.id,[]).trackNode.track.id,o=t.targetTimerange.duration;i>=0&&(a.fadeInDuration=i>o?o:i),r>=0&&(a.fadeOutDuration=r>o?o:r);let l=(0,m.xX)({__segment_struct_type:t.__segment_struct_type});return S.T.pick(t,n,l),new c.F({trackId:s,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:n,sourceSegmentDelta:l})}constructor(e){super({segmentIds:e.segmentIds,fadeInDuration:void 0!==e.fadeInDuration?e.fadeInDuration:-1n,fadeOutDuration:void 0!==e.fadeOutDuration?e.fadeOutDuration:-1n})}}var R=i("198702"),L=i("284947"),H=i("267026"),W=i("817292"),q=i("892504"),U=i("300093"),Z=i("103610"),G=i("660141"),$=i("871806"),X=i("999642"),J=i("604277"),Y=i("529628"),Q=i("575534");class ee extends Q.e{add(e){return e.text?this._mixApplyLocal({action:new b(e,this._videoDocument)},{redoSelectedSegIds:[e.text.textSegmentId],undoSelectedSegIds:[e.text.textSegmentId]}):this._mixApplyLocal({action:new n.w(e,this._videoDocument)})}setFade(e){return this._mixApplyLocal({action:new N(e)})}denoiseOn(e){return this._mixApplyLocal({action:new O.B({...e,isDenoise:!0})})}denoiseOff(e){return this._mixApplyLocal({action:new O.B({...e,isDenoise:!1})})}setVoiceEffect(e){return this._mixApplyLocal({action:new q.M(e)})}setVoiceEffectParams(e){return this._mixApplyLocal({action:new U.V(e)})}clearVoiceEffect(e){return this._mixApplyLocal({action:new A(e)})}setVoiceEffectToAll(e){return this._mixApplyLocal({action:new Z.Y(e)})}setVocalSeparation(e){return this._mixApplyLocal({action:new W.v(e)})}updateVocalSeparation(e){return this._mixApplyLocal({action:new $.G(e)})}removeVocalSeparation(e){return this._mixApplyLocal({action:new P(e)})}setVocalBeautify(e){return this._mixApplyLocal({action:new H.M(e)})}updateVocalBeautify(e){return this._mixApplyLocal({action:new G.N(e)})}resetVocalBeautify(e){return this._mixApplyLocal({action:new B.s(e)})}removeVocalBeautify(e){return this._mixApplyLocal({action:new E.Q(e)})}setSpeed(e){return this._mixApplyLocal({action:new h.T(e)})}modifiedToneOn(e){return this._mixApplyLocal({action:new L.E({...e,modifyTone:!0})})}modifiedToneOff(e){return this._mixApplyLocal({action:new L.E({...e,modifyTone:!1})})}setMaterial(e){return this._mixApplyLocal({action:new R.P(e,this._videoDocument)})}addBeat(e){return this._mixApplyLocal({action:new a.o(e,this._videoDocument)})}removeBeat(e){return this._mixApplyLocal({action:new x.s(e)})}pitchOn(e){return this._mixApplyLocal({action:new X.n({...e,modifyTone:!0})})}pitchOff(e){return this._mixApplyLocal({action:new X.n({...e,modifyTone:!1})})}setVolume(e){return this._mixApplyLocal({action:new J.U(e)})}}(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddAudioActionOptions?Object:IAddAudioActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"add",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioFadeActionOptions?Object:ISetAudioFadeActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setFade",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioDenoiseActionOptions?Object:ISetAudioDenoiseActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"denoiseOn",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioDenoiseActionOptions?Object:ISetAudioDenoiseActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"denoiseOff",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioVoiceEffectActionOptions?Object:ISetAudioVoiceEffectActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setVoiceEffect",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioVoiceEffectParamsActionOptions?Object:ISetAudioVoiceEffectParamsActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setVoiceEffectParams",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IClearAudioVoiceEffectActionOptions?Object:IClearAudioVoiceEffectActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"clearVoiceEffect",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioVoiceEffectToAllActionOptions?Object:ISetAudioVoiceEffectToAllActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setVoiceEffectToAll",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioVocalSeparation?Object:ISetAudioVocalSeparation]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setVocalSeparation",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateAudioVocalSeparation?Object:IUpdateAudioVocalSeparation]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"updateVocalSeparation",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveAudioVocalSeparation?Object:IRemoveAudioVocalSeparation]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"removeVocalSeparation",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioVocalBeautify?Object:ISetAudioVocalBeautify]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setVocalBeautify",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateAudioVocalBeautify?Object:IUpdateAudioVocalBeautify]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"updateVocalBeautify",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IResetAudioVocalBeautify?Object:IResetAudioVocalBeautify]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"resetVocalBeautify",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveAudioVocalBeautify?Object:IRemoveAudioVocalBeautify]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"removeVocalBeautify",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioSpeedActionOptions?Object:ISetAudioSpeedActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setSpeed",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioModifiedToneOptions?Object:ISetAudioModifiedToneOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"modifiedToneOn",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioModifiedToneOptions?Object:ISetAudioModifiedToneOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"modifiedToneOff",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetAudioMaterialActionOptions?Object:ISetAudioMaterialActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setMaterial",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddAudioBeatActionOptions?Object:IAddAudioBeatActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"addBeat",null),(0,r.gn)([(0,Y.cM)("audioApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveAudioBeatActionOptions?Object:IRemoveAudioBeatActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"removeBeat",null),(0,r.gn)([(0,Y.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"pitchOn",null),(0,r.gn)([(0,Y.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"pitchOff",null),(0,r.gn)([(0,Y.cM)("videoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IVideoSetVolumeActionOptions?Object:IVideoSetVolumeActionOptions]),(0,r.w6)("design:returntype",void 0)],ee.prototype,"setVolume",null)},575534:function(e,t,i){"use strict";i.d(t,{e:function(){return r}});class r{_mixApplyLocal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._batchContext?this._behavior.applyLocalInBatchContext({action:e.action,batchContext:this._batchContext}):this._behavior.applyLocal({...e,commit:t.commit,canUndoRedo:t.canUndoRedo,clearRedoStack:t.clearRedoStack,undoSelectedSegIds:t.undoSelectedSegIds,redoSelectedSegIds:t.redoSelectedSegIds,operateIdToCompose:t.operateIdToCompose})}constructor(e,t,i=null){this._videoDocument=e,this._behavior=t,this._batchContext=i}}},938069:function(e,t,i){"use strict";i.d(t,{Q:function(){return l}});var r=i(789786),n=i(196734),a=i(529628),s=i(994603),o=i(575534);class l extends o.e{add(e){return this._mixApplyLocal({action:new s.c(e,this._videoDocument)})}update(e){return this._mixApplyLocal({action:new n.c(e)})}}(0,r.gn)([(0,a.cM)("filterApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddFilterActionOptions?Object:IAddFilterActionOptions]),(0,r.w6)("design:returntype",void 0)],l.prototype,"add",null),(0,r.gn)([(0,a.cM)("filterApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateFilterActionOptions?Object:IUpdateFilterActionOptions]),(0,r.w6)("design:returntype",void 0)],l.prototype,"update",null)},160568:function(e,t,i){"use strict";i.d(t,{P:function(){return p}});var r=i(789786),n=i(836092),a=i(549269),s=i(542023),o=i(369895),l=i(611769),u=i(187613),d=i(251692),c=i(575534),h=i(529628);class p extends c.e{add(e){return this._mixApplyLocal({action:new o._(e,this._videoDocument)})}setMaterial(e,t,i){return this._mixApplyLocal({action:new u.S(e)},{canUndoRedo:t,commit:i})}addAnimation(e){return this._mixApplyLocal({action:new d.T(e)})}updateAnimation(e){return this._mixApplyLocal({action:new d.T(e)})}deleteAnimation(e){return this._mixApplyLocal({action:new l.Y(e)})}addVideoTracker(e){return this._mixApplyLocal({action:new n.V({...e})})}updateVideoTracker(e){return this._mixApplyLocal({action:new s.V({...e})},{undoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0,redoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0})}removeVideoTracker(e){return this._mixApplyLocal({action:new a.$({...e})},{undoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0,redoSelectedSegIds:e.selectedSegIds?e.selectedSegIds:void 0})}}(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddTextTemplateActionOptions?Object:IAddTextTemplateActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"add",null),(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof ISetTextTemplateMaterialActionOptions?Object:ISetTextTemplateMaterialActionOptions,Boolean,Boolean]),(0,r.w6)("design:returntype",void 0)],p.prototype,"setMaterial",null),(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateTextTemplateTextAnimActionOptions?Object:IUpdateTextTemplateTextAnimActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"addAnimation",null),(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateTextTemplateTextAnimActionOptions?Object:IUpdateTextTemplateTextAnimActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"updateAnimation",null),(0,r.gn)([(0,h.cM)("textApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveTextTemplateTextAnimActionOptions?Object:IRemoveTextTemplateTextAnimActionOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"deleteAnimation",null),(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddVideoTrackerOptions?Object:IAddVideoTrackerOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"addVideoTracker",null),(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateVideoTrackerOptions?Object:IUpdateVideoTrackerOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"updateVideoTracker",null),(0,r.gn)([(0,h.cM)("textTemplateApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IRemoveVideoTrackerOptions?Object:IRemoveVideoTrackerOptions]),(0,r.w6)("design:returntype",void 0)],p.prototype,"removeVideoTracker",null)},657278:function(e,t,i){"use strict";i.d(t,{R:function(){return s}});var r=i(789786),n=i(529628),a=i(575534);class s extends a.e{undo(){this._behavior.applyUndo()}redo(){this._behavior.applyRedo()}canUndo(){return this._behavior.canUndo()}canRedo(){return this._behavior.canRedo()}getTopItemId(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this._behavior.getTopItemId(e)}resetUndoRedo(){return this._behavior.resetUndoRedo()}}(0,r.gn)([(0,n.cM)("undoRedoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",void 0)],s.prototype,"undo",null),(0,r.gn)([(0,n.cM)("undoRedoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",void 0)],s.prototype,"redo",null),(0,r.gn)([(0,n.cM)("undoRedoApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[void 0]),(0,r.w6)("design:returntype","undefined"==typeof T?Object:T)],s.prototype,"getTopItemId",null)},32546:function(e,t,i){"use strict";i.d(t,{c:function(){return K}});var r=i(789786),n=i(438176),a=i(76592),s=i(381119),o=i(419537),l=i(553197),u=i(129862),d=i(54488),c=i(340294),h=i(52386),p=i(587892),m=i(690613),f=i(805794),g=i(426336),y=i(438369),_=i(853277),v=i(646290),k=i(700857),I=i(529628),S=i(330902),w=i(481890),b=i(287165),F=i(417927),C=i(873223),A=i(391889),x=i(307510),E=i(508355),D=i(754079),M=i(623490);class K{enableDiffEvent(){}disableDiffEvent(){}batchStart(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,b.p)();return this._batch.batchFireImmediately=e,this._batch.batchIds.push(t),this._changeData.actionList=[],(0,I.PN)({apiNamespace:"batchStart",apiName:"batchStart"},{fireImediately:e,taskId:t}),t}batchEnd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{canUndoRedo:!0,clearRedoStack:!0,isRecovery:!1,needRefresh:!1},{canUndoRedo:i=!0,clearRedoStack:r=!0,isRecovery:n=!1,needRefresh:a=!1}=t;if(!this._batch.isInMode)return;if(this._batch.batchIds[this._batch.batchIds.length-1]!==e)throw f.B.reportError("batch_end_error",`the task ${e} is not the latest task`,void 0,{type:"lyra_sdk_event",apiType:"data"}),Error(`the task ${e} is not the latest task, task stack ${JSON.stringify(this._batch.batchIds)}`);if(this._batch.batchIds.pop(),this._changeData.isRecovery=n,this._changeData.needRefresh=a,this._batch.batchIds.length>0)return;let s=(0,b.p)(),{redoMutations:o,undoMutations:l,undoSelectedSegIds:u,redoSelectedSegIds:d}=this._batch.stack;this._record(o,l,_.U.BATCH_API,s,i,r,w.A.Local,u,d,a),this._fire(),this._onAfterActionRun.fire(new F.dx({acType:_.U.BATCH_API,opType:n?y.a.History:y.a.Local,muts:o,commitId:s,dataVersion:this._draftVersionManager.getVersion()})),this._resetBatchStack()}applyLocal(e){let{action:t}=e,i=t.check(this._videoDocument);return i.ok?(0,m.oW)(this._applyLocalAction(e)):(f.B.reportError("check_action_error",JSON.stringify(i),void 0,{type:"lyra_sdk_event",apiType:"data",actionType:t.type}),(0,m.wf)(i.code,i.msg||""))}applyUndo(){if(this._batch.isInMode){f.B.log("undo can not run in batch Mode");return}try{let[e]=this._undoredoStack.undo();this._onAfterActionRun.fire(new F.dx({acType:e.undoCommand.actionType,opType:y.a.Undo,muts:e.undoCommand.mutations,commitId:e.undoCommand.actionKey,dataVersion:this._draftVersionManager.getVersion()}))}catch(e){this._onAbort.fire(e)}}reportDraft(e){f.B.cgiReport(new F._m({draftId:this._videoDocument.getDraftId(),apiNamespace:"draft",apiName:"recovery",args:c.HH.stringify(e)}))}recoveryDraftSideEffect(){var e,t;this._undoredoStack.reset();let i=(null!==(t=null===(e=this._videoDocument.getMainTrack())||void 0===e?void 0:e.segments)&&void 0!==t?t:[]).map(e=>({id:e.id,targetTimerange:{start:e.targetTimerange.start,duration:e.targetTimerange.duration}}));M.C.initPrevMainTrackSegmentsTargetTime(i)}resetUndoRedo(){this._undoredoStack.reset()}getTopItemId(e){if(e){let e=this._undoredoStack.undoStack;for(let t=0;t<e.length;t++){let i=e[t];if(i.canUndoRedo)return i.operateId}}else{var t,i;return null!==(i=null===(t=this._undoredoStack.getTopItem())||void 0===t?void 0:t.operateId)&&void 0!==i?i:""}return""}canUndo(){return!this._batch.isInMode&&this._undoredoStack.canUndo()}applyRedo(){if(this._batch.isInMode){f.B.log("redo can not run in batch Mode");return}try{let[e]=this._undoredoStack.redo();this._onAfterActionRun.fire(new F.dx({acType:e.undoCommand.actionType,opType:y.a.Redo,muts:e.undoCommand.mutations,commitId:e.undoCommand.actionKey,dataVersion:this._draftVersionManager.getVersion()}))}catch(e){this._onAbort.fire(e)}}canRedo(){return this._undoredoStack.canRedo()}reset(){this._resetBatchStack(),this._resetChangeData()}_setMutationDelta(e,t){e instanceof u.F?e.segmentDelta=t:e instanceof k.W?e.propertyDelta=t:e instanceof v.e&&(e.metadataDelta=t)}applyAction(e,t){var i,r;let{mutations:n,operateType:a,actionType:s}=e.actionInfo,o=[];n.forEach(t=>{this._collectChangeData([t],a,e.commit),o.unshift(...t.invert(this._videoDocument)),this._mutationApi.applyMutation(this._videoDocument,t,{mutationSource:e.mutationSource,actionType:s})}),this._record(n,o,s,t,null===(i=e.canUndoRedo)||void 0===i||i,null===(r=e.clearRedoStack)||void 0===r||r,this._actionOperateType2UndoRedoOperateType(a)),this._fire()}applyLocalNew(e){let{commit:t,action:i,canUndoRedo:r=!0,clearRedoStack:n=!0,undoSelectedSegIds:a,redoSelectedSegIds:s,operateIdToCompose:o}=e,l=[],u=[];if(o){let e=this._checkOperateIdExist(o);if(!e.ok)return e}let d=this._doApplyLocal({action:i,commit:t,redoMutations:l,undoMutations:u}),c=this._record(l,u,i.type,i.actionKey,r,n,w.A.Local,a,s,!1,o);return this._fire(),this._onAfterActionRun.fire(new F.dx({acType:e.action.type,opType:y.a.Local,muts:l,commitId:i.actionKey,dataVersion:this._draftVersionManager.getVersion()})),(0,m.oW)({operateId:c,actionResult:d})}applyLocalInBatchContext(e){let{action:t,batchContext:i}=e,{options:{commit:r},stack:{undoMutations:n,redoMutations:a}}=i,s=this._doApplyLocal({action:t,commit:r,redoMutations:a,undoMutations:n});return(0,m.oW)(s)}invokeBatch(e,t){try{let{operateIdToCompose:i}=t.options;if(i){let e=this._checkOperateIdExist(i);if(!e.ok)return e}e();let r=this._submitBatchTask(t);return(0,m.oW)({operateId:r})}catch(e){throw f.B.reportError("invoke_batch_error","the invoke batch task error",e,{type:"lyra_sdk_event",apiType:"data"}),this._onAbort.fire(e),e}}_checkOperateIdExist(e){return this._undoredoStack.getItemByOperateId(e)?(0,m.ly)():(0,m.wf)(C.D.OperateIdNotExist,"")}_submitBatchTask(e){let{options:t,stack:i}=e,{canUndoRedo:r=!0,clearRedoStack:n=!0,isRecovery:a=!1,needRefresh:s=!1,commit:o=!0,undoSelectedSegIds:l,redoSelectedSegIds:u,operateIdToCompose:d}=t,{redoMutations:c,undoMutations:h}=i,p=(0,b.p)(),m=this._record(c,h,_.U.BATCH_API,p,r,n,w.A.Local,l,u,s,d);return this._changeData.commit=o,this._changeData.isRecovery=a,this._changeData.needRefresh=s,this._fire(),this._onAfterActionRun.fire(new F.dx({acType:_.U.BATCH_API,opType:a?y.a.History:y.a.Local,muts:c,commitId:p,dataVersion:this._draftVersionManager.getVersion()})),m}_doApplyLocal(e){let{action:t,commit:i,redoMutations:r,undoMutations:n}=e,a=t.check(this._videoDocument);return a.ok?this._applyLocalActionNew({action:t,commit:i,redoMutations:r,undoMutations:n}):(f.B.reportError("check_action_error",JSON.stringify(a),void 0,{type:"lyra_sdk_event",apiType:"data",actionType:t.type}),a)}_applyLocalActionNew(e){try{return this._applyLocalActionToModelNew({action:e.action,commit:e.commit,undoMutations:e.undoMutations,redoMutations:e.redoMutations})}catch(t){return f.B.reportError("apply_action_error",t.message,t,{type:"lyra_sdk_event",apiType:"data",actionType:e.action.type}),console.error(`apply local action error, actionType=${e.action.type}, error:`,t),this._onAbort.fire(t),e.action.actionKey}}_applyLocalActionToModelNew(e){let{action:t,commit:i=!0,undoMutations:r,redoMutations:n}=e,a=this._mutationApi.applyMutationGenerator(this._videoDocument,e=>(this._changeData.actionList.push(t.type),t.run(t=>{!l.a.includes(t.type)&&this._collectChangeData([t],y.a.Local,i),n.push(t);let r=e(t,n.length);if(r&&l.a.includes(t.type)){let e=t.clone();this._setMutationDelta(e,r),this._collectChangeData([e],y.a.Local,i)}},this._videoDocument,this._config)),r,!0,{mutationSource:S.J.Local});return void 0!==a?a:e.action.actionKey}_actionOperateType2UndoRedoOperateType(e){return({[y.a.Collab]:w.A.Collab,[y.a.History]:w.A.Local,[y.a.Local]:w.A.Local,[y.a.Redo]:w.A.Local,[y.a.Undo]:w.A.Local})[e]}_applyLocalAction(e){try{return this._applyLocalActionToModel(e)}catch(t){return f.B.reportError("apply_action_error",t.message,t,{type:"lyra_sdk_event",apiType:"data",actionType:e.action.type}),console.error(`apply local action error, actionType=${e.action.type}, error:`,t),this._onAbort.fire(t),e.action.actionKey}}_applyLocalActionToModel(e){let{action:t,canUndoRedo:i=!0,clearRedoStack:r=!0,undoSelectedSegIds:n,redoSelectedSegIds:a,commit:s=!0}=e,o=[],u=[],d=this._mutationApi.applyMutationGenerator(this._videoDocument,e=>(this._changeData.actionList.push(t.type),t.run(t=>{!l.a.includes(t.type)&&this._collectChangeData([t],y.a.Local,s),this._batch.isInMode?this._batch.stack.redoMutations.push(t):o.push(t);let i=e(t,o.length);if(i&&l.a.includes(t.type)){let e=t.clone();this._setMutationDelta(e,i),this._collectChangeData([e],y.a.Local,s)}},this._videoDocument,this._config)),u,!0,{mutationSource:S.J.Local});if(this._batch.isInMode){var c,h;this._batch.stack.undoMutations.unshift(...u),!(null===(c=this._batch.stack.undoSelectedSegIds)||void 0===c?void 0:c.length)&&(this._batch.stack.undoSelectedSegIds=n),!(null===(h=this._batch.stack.redoSelectedSegIds)||void 0===h?void 0:h.length)&&(this._batch.stack.redoSelectedSegIds=a)}else this._record(o,u,t.type,t.actionKey,i,r,w.A.Local,n,a);return(!this._batch.isInMode||this._batch.batchFireImmediately)&&this._fire(),!this._batch.isInMode&&this._onAfterActionRun.fire(new F.dx({acType:e.action.type,opType:y.a.Local,muts:o,commitId:t.actionKey,dataVersion:this._draftVersionManager.getVersion()})),void 0!==d?d:e.action.actionKey}_record(e,t,i,r,n,a,s,o,l,u,c){if(c)return this._undoredoStack.pushWithOperateId(c,{redoCommand:{mutations:e,actionType:i,actionKey:r,undoSelectedSegIds:l,needRefresh:u},undoCommand:{mutations:t,actionType:i,actionKey:r,undoSelectedSegIds:o,needRefresh:u}}).operateId;{var h=this;let c=new d.Z({redoCommand:{mutations:e,actionType:i,actionKey:r,undoSelectedSegIds:l,needRefresh:u},undoCommand:{mutations:t,actionType:i,actionKey:r,undoSelectedSegIds:o,needRefresh:u},canUndoRedo:n,operateType:s,executeCommand:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t===w.z.Undo?y.a.Undo:y.a.Redo,a=[];return h._mutationApi.applyMutationGenerator(h._videoDocument,t=>{e.mutations.forEach((e,i)=>{h._collectChangeData([e],n,!0,u),t(e,i)})},a,r,{mutationSource:S.J.Local,actionType:i,actionOperateType:n}),h._collectChangeDataWithSelection(e.undoSelectedSegIds),h._fire(),{...e,mutations:a}}});return this._undoredoStack.push(c,a&&n),c.operateId}}_fire(){D.Z.frameHasChange((0,x.TU)(this._changeData[A.u4.SEGMENT]),this._videoDocument)&&this._onChangeFrame.fire(),(0,E.o)(this._changeData,this._videoDocument,{canvasChange:this._onChangeCanvasSize,draftIdChange:this._onChangeDraftId}),this._changeData[A.u4.SEGMENT]=(0,x.xv)(this._changeData[A.u4.SEGMENT],this._videoDocument),(0,x.HD)(this._changeData[A.u4.SEGMENT],this._videoDocument),n.H&&console.log("=== change diff:",this._changeData);let e={...this._changeData};this._resetChangeData(),this._onChangeDiff.fire({...e,videoDocument:this._videoDocument,isInBatchMode:this._batch.isInMode,hasMainTrackSegmentTargetTimeChange:M.C.mainTrackSegmentSourceTimeHasChange(this._videoDocument)})}_resetBatchStack(){this._batch={get isInMode(){return this.batchIds.length>0},batchFireImmediately:!1,batchIds:[],stack:{redoMutations:[],undoMutations:[],undoSelectedSegIds:void 0,redoSelectedSegIds:void 0}}}_collectChangeData(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._changeData.actionOperateType=t,this._changeData.commit=i,this._changeData.needRefresh=r,e.forEach(e=>{let i=this._changeData[A.u4.SEGMENT].length+this._changeData[A.u4.TRACK].length+this._changeData[A.u4.CONFIG].length+this._changeData[A.u4.ATTACHMENT].length;if((0,x.vr)(e))this._changeData[A.u4.TRACK].push((0,x.Hj)(e,i,this._videoDocument));else if((0,x.mf)(e)){let r=this._getMutationVideoDocument(e);this._changeData[A.u4.SEGMENT].push(...(0,x.bX)(e,i,r).map(i=>(0,x.Xd)((0,x.HV)(i,this._videoDocument,e),t)))}else if((0,x.M6)(e)){let t=e instanceof v.e?{metadata:e.metadataDelta}:{property:e.propertyDelta};this._changeData[A.u4.CONFIG].push({item:t,type:A.C8.UPDATE,order:i})}else(0,x.Eg)(e)&&(e instanceof s.Q?this._changeData[A.u4.ATTACHMENT].push({item:{attachmentKey:e.options.attachmentKey,key:e.options.key,value:e.options.value},type:A.C8.ADD,order:i}):e instanceof o.K?this._changeData[A.u4.ATTACHMENT].push(this._collectUpdateAttachmentChangeData(e,i)):e instanceof a.h&&this._changeData[A.u4.ATTACHMENT].push({item:{attachmentKey:e.options.attachmentKey,key:e.options.key},type:A.C8.DELETE,order:i}))})}_collectUpdateAttachmentChangeData(e,t){switch(e.options.attachmentKey){case g.d3H.AiStoryAlternativeMaterial:return{item:e.options,type:A.C8.UPDATE,order:t};case g.d3H.AiStoryGlobalId:case g.d3H.AiWriter:case g.d3H.AsyncTask:case g.d3H.VideoAlgorithm:case g.d3H.AiCreator:default:return{item:{attachmentKey:e.options.attachmentKey,delta:e.options.delta,key:e.options.key},type:A.C8.UPDATE,order:t}}}_getMutationVideoDocument(e){if((0,h.u)(e)){var t;return null!==(t=this._videoDocument.getDraftById(e.draftId))&&void 0!==t?t:this._videoDocument}return this._videoDocument}_collectChangeDataWithSelection(e){if(!!e)this._changeData[A.u4.SELECTION]=e}_resetChangeData(){this._changeData={[A.u4.SEGMENT]:[],[A.u4.TRACK]:[],[A.u4.CONFIG]:[],[A.u4.ATTACHMENT]:[],[A.u4.SELECTION]:void 0,actionList:[],videoDocument:this._videoDocument,actionOperateType:y.a.Local,isRecovery:!1,commit:!0,hasMainTrackSegmentTargetTimeChange:!1}}constructor(e,t,i,r,n){this._onChangeDiff=new p.Q,this._onBatchStart=new p.Q,this._onBatchEnd=new p.Q,this._onAfterActionRun=new p.Q,this._onChangeFrame=new p.Q,this._onChangeCanvasSize=new p.Q,this._onChangeDraftId=new p.Q,this._onAbort=new p.Q,this._batch={get isInMode(){return this.batchIds.length>0},batchIds:[],batchFireImmediately:!1,stack:{redoMutations:[],undoMutations:[],undoSelectedSegIds:void 0,redoSelectedSegIds:void 0}},this._changeData={[A.u4.SEGMENT]:[],[A.u4.CONFIG]:[],[A.u4.TRACK]:[],[A.u4.ATTACHMENT]:[],videoDocument:null,actionOperateType:y.a.Local,isRecovery:!1,commit:!0,hasMainTrackSegmentTargetTimeChange:!1,needRefresh:!1,actionList:[]},this.onChangeDiff=this._onChangeDiff.event,this.onChangeFrame=this._onChangeFrame.event,this.onChangeCanvasSize=this._onChangeCanvasSize.event,this.onChangeDraftId=this._onChangeDraftId.event,this.onAbort=this._onAbort.event,this.onBatchStart=this._onBatchStart.event,this.onBatchEnd=this._onBatchEnd.event,this.onAfterActionRun=this._onAfterActionRun.event,this._videoDocument=e,this._mutationApi=t,this._undoredoStack=i,this._draftVersionManager=r,this._config=n}}(0,r.gn)([(0,I.cM)("batchEnd"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[String,"undefined"==typeof BatchConfig?Object:BatchConfig]),(0,r.w6)("design:returntype",void 0)],K.prototype,"batchEnd",null)},391889:function(e,t,i){"use strict";i.d(t,{C8:function(){return s},u4:function(){return a}});var r,n,a=((r={}).SEGMENT="segment",r.CONFIG="config",r.TRACK="track",r.SELECTION="selection",r.ATTACHMENT="attachment",r);var s=((n={}).ADD="add",n.UPDATE="update",n.DELETE="delete",n.MOVE="move",n)},453463:function(e,t,i){"use strict";i.d(t,{v:function(){return n}});var r=i(391889);let n=e=>e[r.u4.CONFIG].find(e=>{var t;return null===(t=e.item.property)||void 0===t?void 0:t.canvasConfig})},552261:function(e,t,i){"use strict";i.d(t,{G8:function(){return r},_E:function(){return a},ni:function(){return n}});let r=1000000n/30n,n=9999999,a={keepEmptyTracks:!1}},909543:function(e,t,i){"use strict";i.d(t,{M_:function(){return k},XC:function(){return _},Zn:function(){return v}});var r,n=i(602777),a=i(211561),s=i(481631),o=i(247559),l=i(729955),u=i(642366),d=i(671006),c=i(82288),h=i(716854),p=i(667688),m=i(677408),f=i(805794),g=i(391889),y=i(114854);var _=((r={})[r.APPLY_DIFF=0]="APPLY_DIFF",r[r.PREVIEW=1]="PREVIEW",r[r.RESET_PREVIEW=2]="RESET_PREVIEW",r);let v={[g.C8.ADD]:{SegmentVideo:p.E,SegmentAudio:o.LA,SegmentText:c.dK,SegmentTextTemplate:h.nz,SegmentSticker:d.M,SegmentImageSticker:d.M,SegmentVideoEffect:m.ZT,SegmentFilter:l.fd,SegmentPictureAdjust:u.Jm}};class k{collectSegmentChangeOnTrackChange(e,t){let i=[];return t.forEach(t=>{let{trackIndex:r,trackId:s}=t.item,{order:o}=t,l=e.getTrackById(s);if(!l||![a.pNd.TrackTypeVideo,a.pNd.TrackTypeAudio].includes(null==l?void 0:l.type))return;let u=(null==l?void 0:l.type)===a.pNd.TrackTypeVideo?n.Oc.SegmentVideo:n.Oc.SegmentAudio;if(t.type===g.C8.UPDATE){let{attribute:e}=t.item.track;if(null!=e){var d;let t=u===n.Oc.SegmentVideo?new a.NOn:new a.CCx;t.trackAttribute=e,null==l||null===(d=l.segments)||void 0===d||d.forEach(e=>{i.push({type:g.C8.UPDATE,order:o,item:{id:e.id,segment:t,segmentType:u,trackIndex:r}})})}}}),i}changeSegmentOnAddSegment(e,t,i){let r=[];return t.forEach(t=>{if(t.type===g.C8.ADD){let{segment:o}=t.item||{},l=e.getTrackBySegmentId(o.id);if(!l||![a.pNd.TrackTypeVideo,a.pNd.TrackTypeAudio].includes(null==l?void 0:l.type))return;let u=null==l?void 0:l.attribute,d=(null==l?void 0:l.type)===a.pNd.TrackTypeVideo?n.Oc.SegmentVideo:n.Oc.SegmentAudio,c=(0,s.xX)({__segment_struct_type:o.__segment_struct_type});c.trackAttribute=u,r.push({type:g.C8.UPDATE,order:++i,item:{id:t.item.segment.id,segment:c,trackIndex:e.getTrackIndexById(l.id,[]),segmentType:d}})}}),r}applyDiff(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.executor[t];this.setMaterialChangeIfNeed(!1,!0);try{var r;let{config:t=[],track:n=[],segment:a=[],videoDocument:s,hasMainTrackSegmentTargetTimeChange:o}=e;if(0===t.length&&0===a.length&&0===n.length)return;let l=[...n],u=this.collectSegmentChangeOnTrackChange(s,n),d=(null==a?void 0:null===(r=a[0])||void 0===r?void 0:r.order)||0;a.forEach(e=>{d<e.order&&(d=e.order)});let c=this.changeSegmentOnAddSegment(s,a,d),h=[...a,...u,...c];for(let e of(this._apis.editor.setMaxDuration(s.getDraftMetadata().duration),t.sort((e,t)=>e.order-t.order),t)){let{item:{metadata:t,property:i},type:r}=e;r===g.C8.UPDATE&&(t&&this._apis.base.draftMetaUpdate(t),i&&this._apis.base.draftPropertyUpdate(i,s))}o&&this._extraSegmentChanges(h,s,this._apis),h.sort((e,t)=>e.order-t.order),this._apis.editor.commit(()=>{if(l.length){let e=Number.MAX_SAFE_INTEGER;for(let t of l){let i=Number.MAX_SAFE_INTEGER;t.type===g.C8.ADD?i=t.item.trackIndex+1:t.type===g.C8.DELETE&&(i=t.item.trackIndex),e=Math.min(e,i)}this._apis.base.renderIndexUpdate(e,s)}for(let t of h)if(t.type===g.C8.ADD){let{segment:e,path:r}=t.item,n=e.__segment_struct_type,a=i[g.C8.ADD][n];if(!a)continue;this._apis.draft.run(r,s,t=>{let i=a(e,t);this.setMaterialChangeIfNeed(i)})}else if([g.C8.UPDATE,g.C8.MOVE].includes(t.type)){let{id:e,segment:r,segmentType:n,path:a}=t.item;if(!s.getSegmentById(e)||!e||!n)continue;let o=i[g.C8.UPDATE][n];if(!o)continue;this._apis.draft.run(a,s,t=>{let i=o(e,r,t);this.setMaterialChangeIfNeed(i)})}else if(t.type===g.C8.DELETE){var e;let{id:r,segmentType:n,path:a}=t.item;if(!n||!r)continue;let o=null!==(e=i[g.C8.DELETE][n])&&void 0!==e?e:this._apis.base.segmentRemove,l=t.item.segment;this._apis.draft.run(a,s,e=>{let t=o(r,e,l);this.setMaterialChangeIfNeed(t)})}return this.isNeedForceRefresh})}catch(e){f.B.reportError("[render]applyDiff","apply diff fail",e,{type:"lyra_sdk_event",apiType:"render"})}}setMaterialChangeIfNeed(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){this.isNeedForceRefresh=e;return}e&&(this.isNeedForceRefresh=e)}_extraSegmentChanges(e,t,i){let r=[],n=e=>{r.unshift(e)},a=e=>{r.push(e)},s=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e.splice(t,i)};i.editor.render.config.enableTrackClipOpt?(0,y.J)(e,t,{unshift:n,push:a,remove:s},i):(0,y.D)(e,t,{unshift:n,push:a,remove:s},i),e.push(...r)}constructor(e){this.isNeedForceRefresh=!1,this._apis=e;let{audio:t,filter:i,pictureAdjust:r,sticker:n,text:a,textTemplate:s,video:o,videoEffect:l}=this._apis;this.executor={0:{[g.C8.ADD]:{SegmentVideo:o.add,SegmentAudio:t.add,SegmentText:a.add,SegmentTextTemplate:s.add,SegmentSticker:n.add,SegmentImageSticker:n.add,SegmentVideoEffect:l.add,SegmentFilter:i.add,SegmentPictureAdjust:r.add},[g.C8.UPDATE]:{SegmentVideo:o.update,SegmentAudio:t.update,SegmentText:a.update,SegmentTextTemplate:s.update,SegmentSticker:n.update,SegmentImageSticker:n.update,SegmentVideoEffect:l.update,SegmentFilter:i.update,SegmentPictureAdjust:r.update},[g.C8.DELETE]:{SegmentTextTemplate:s.remove,SegmentPictureAdjust:r.remove}},1:{[g.C8.ADD]:{SegmentVideo:o.add,SegmentAudio:t.add,SegmentText:a.add,SegmentTextTemplate:s.add,SegmentSticker:n.add,SegmentImageSticker:n.add,SegmentVideoEffect:l.add,SegmentFilter:i.add,SegmentPictureAdjust:r.add},[g.C8.UPDATE]:{SegmentText:a.updatePreview,SegmentFilter:i.updatePreview,SegmentVideoEffect:l.updatePreview,SegmentVideo:o.updatePreview,SegmentTextTemplate:s.updatePreview,SegmentAudio:t.updatePreview},[g.C8.DELETE]:{SegmentVideo:o.remove,SegmentTextTemplate:s.remove,SegmentFilter:i.remove}},2:{[g.C8.ADD]:{SegmentVideo:o.add,SegmentAudio:t.add,SegmentText:a.add,SegmentTextTemplate:s.add,SegmentSticker:n.add,SegmentImageSticker:n.add,SegmentVideoEffect:l.add,SegmentFilter:i.add,SegmentPictureAdjust:r.add},[g.C8.UPDATE]:{SegmentText:a.resetUpdatePreview,SegmentFilter:i.resetUpdatePreview,SegmentVideoEffect:l.resetUpdatePreview,SegmentVideo:o.resetUpdatePreview,SegmentTextTemplate:s.resetUpdatePreview,SegmentAudio:t.resetUpdatePreview},[g.C8.DELETE]:{SegmentVideo:o.remove,SegmentTextTemplate:s.remove,SegmentFilter:i.remove,SegmentPictureAdjust:r.remove}}}}}},558254:function(e,t,i){"use strict";i.d(t,{a:function(){return n}});var r=i(602777);function n(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{audioId:void 0!==t.audioId?t.audioId:"",appId:void 0!==t.appId?BigInt(t.appId):0n,audioPath:void 0!==t.audioPath?t.audioPath:"",audioTitle:void 0!==t.audioTitle?t.audioTitle:"",audioCategoryTitle:void 0!==t.audioCategoryTitle?t.audioCategoryTitle:"",audioCategoryId:void 0!==t.audioCategoryId?t.audioCategoryId:"",startTime:void 0!==t.startTime?BigInt(t.startTime):0n,sourceStartTime:void 0!==t.sourceStartTime?BigInt(t.sourceStartTime):0n,sourceDuration:void 0!==t.sourceDuration?BigInt(t.sourceDuration):0n,duration:void 0!==t.duration?BigInt(t.duration):0n,type:void 0!==t.type?t.type:r.cV.MetaTypeNone,targetTrackIndex:void 0!==t.targetTrackIndex?t.targetTrackIndex:-1,extrackMusic:void 0!==t.extrackMusic&&t.extrackMusic,needInsertTargetTrack:void 0!==t.needInsertTargetTrack&&t.needInsertTargetTrack,durationLimit:void 0!==t.durationLimit?BigInt(t.durationLimit):0n,gear:void 0!==t.gear?t.gear:0,gearCount:void 0!==t.gearCount?t.gearCount:0,mode:void 0!==t.mode?t.mode:r.se.AUDIO_BEAT_MODE_NONE,melodyUrl:void 0!==t.melodyUrl?t.melodyUrl:"",melodyPath:void 0!==t.melodyPath?t.melodyPath:"",beatUrl:void 0!==t.beatUrl?t.beatUrl:"",beatPath:void 0!==t.beatPath?t.beatPath:"",musicBeatPercent:void 0!==t.musicBeatPercent?t.musicBeatPercent:.6,wavePoints:(null!==(e=null==t?void 0:t.wavePoints)&&void 0!==e?e:[]).map(e=>e),sourcePlatformType:void 0!==t.sourcePlatformType?t.sourcePlatformType:r.QZ.AudioPlatformLibrary,formulaId:void 0!==t.formulaId?t.formulaId:"",teamId:void 0!==t.teamId?t.teamId:"",localMaterialId:void 0!==t.localMaterialId?t.localMaterialId:"",requestId:void 0!==t.requestId?t.requestId:""}}},159981:function(e,t,i){"use strict";i(881337)},888656:function(e,t,i){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{adjustKey:void 0!==e.adjustKey?e.adjustKey:"",adjustValue:void 0!==e.adjustValue?e.adjustValue:0,defaultValue:void 0!==e.defaultValue?e.defaultValue:0,flags:void 0!==e.flags?BigInt(e.flags):-1n}}i.d(t,{Q:function(){return r}})},566590:function(e,t,i){"use strict";i(881337)},344730:function(e,t,i){"use strict";i(881337)},27059:function(e,t,i){"use strict";i(881337)},1925:function(e,t,i){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{color:void 0!==e.color?e.color:"",strength:void 0!==e.strength?e.strength:0,range:void 0!==e.range?e.range:1,dirX:void 0!==e.dirX?e.dirX:0,dirY:void 0!==e.dirY?e.dirY:0}}i.d(t,{v:function(){return r}})},987635:function(e,t,i){"use strict";i.d(t,{T:function(){return a}});var r=i(881337),n=i(602777);function a(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{flags:void 0!==t.flags?BigInt(t.flags):-1n,playHead:void 0!==t.playHead?BigInt(t.playHead):-1n,curveType:void 0!==t.curveType?t.curveType:n.wH.KeyframeCurveTypeLine,datas:(null!==(e=null==t?void 0:t.datas)&&void 0!==e?e:[]).map(e=>e),leftControl:void 0!==t.leftControl?(0,r.mpE)(t.leftControl):(0,r.mpE)({}),rightControl:void 0!==t.rightControl?(0,r.mpE)(t.rightControl):(0,r.mpE)({}),graphData:void 0!==t.graphData?(0,r.Mvo)(t.graphData):(0,r.Mvo)({})}}},584413:function(e,t,i){"use strict";i(881337)},747550:function(e,t,i){"use strict";i(881337)},39802:function(e,t,i){"use strict";i(881337)},186655:function(e,t,i){"use strict";i(881337)},567470:function(e,t,i){"use strict";i.d(t,{f:function(){return a}});var r=i(881337),n=i(602777);function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:void 0!==e.type?e.type:n.BZ.Control,pointParam:void 0!==e.pointParam?(0,r.ZoZ)(e.pointParam):(0,r.ZoZ)({})}}},556990:function(e,t,i){"use strict";i(881337)},159638:function(e,t,i){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{x:void 0!==e.x?e.x:0,y:void 0!==e.y?e.y:0}}i.d(t,{z:function(){return r}})},515605:function(e,t,i){"use strict";i.d(t,{F:function(){return n}});var r=i(602777);function n(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:void 0!==t.id?t.id:"",sourceStart:void 0!==t.sourceStart?BigInt(t.sourceStart):0n,sourcePlatform:void 0!==t.sourcePlatform?t.sourcePlatform:r.cv.MaterialPlatformDefault,materialId:void 0!==t.materialId?t.materialId:"",source:void 0!==t.source?t.source:r.CH.MaterialSourceDefault,originMaterialId:void 0!==t.originMaterialId?t.originMaterialId:"",materialName:void 0!==t.materialName?t.materialName:"",path:void 0!==t.path?t.path:"",crop:(null!==(e=null==t?void 0:t.crop)&&void 0!==e?e:[]).map(e=>e),assetMd5:void 0!==t.assetMd5?t.assetMd5:"",isMutable:void 0===t.isMutable||t.isMutable,initialSpeed:void 0!==t.initialSpeed?t.initialSpeed:0,volume:void 0!==t.volume?t.volume:0,extraJsonParams:void 0!==t.extraJsonParams?t.extraJsonParams:""}}},524335:function(e,t,i){"use strict";i(881337)},402025:function(e,t,i){"use strict";i(881337)},796543:function(e,t,i){"use strict";i(881337)},379742:function(e,t,i){"use strict";i(881337)},608020:function(e,t,i){"use strict";i(881337)},100516:function(e,t,i){"use strict";i(881337)},814812:function(e,t,i){"use strict";i(881337)},164191:function(e,t,i){"use strict";i(881337)},832248:function(e,t,i){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{x:void 0!==e.x?e.x:0,y:void 0!==e.y?e.y:0}}i.d(t,{m:function(){return r}})},923938:function(e,t,i){"use strict";i(881337)},324890:function(e,t,i){"use strict";i(881337)},358878:function(e,t,i){"use strict";i(881337)},565866:function(e,t,i){"use strict";i.d(t,{Q:function(){return a}});var r=i(911838),n=i(690613);class a{taskBeforeUpgrade(e,t){let i=(0,n.ly)();for(let r of this._getAllAttachment())if(!(i=r.taskBeforeUpgrade(e,t)).ok)break;return i}taskAfterUpgrade(e,t){let i=(0,n.ly)();for(let r of this._getAllAttachment())if(!(i=r.taskAfterUpgrade(e,t)).ok)break;return i}taskFinishedUpgrade(e,t,i){for(let n of this._getAllAttachment())(!i||r.l.getInstance().needExtraUpgrade(n.constructor.name))&&n.taskFinishedUpgrade(e,t,i);this._allAttachment.length=0}registerDowngradeTasks(){for(let e of this._getAllAttachment())e.registerDowngradeTasks()}taskBeforeDowngrade(e,t){let i=(0,n.ly)();for(let r of this._getAllAttachment())if(!(i=r.taskBeforeDowngrade(e,t)).ok)break;return i}taskAfterDowngrade(e,t){let i=(0,n.ly)();for(let r of this._getAllAttachment())if(!(i=r.taskAfterDowngrade(e,t)).ok)break;return i}taskFinishedDowngrade(e,t){for(let i of this._getAllAttachment())i.taskFinishedDowngrade(e,t);this._allAttachment.length=0}needExtraUpgrade(){return r.l.getInstance().needExtraUpgrade()}_getAllAttachment(){return 0===this._allAttachment.length&&(this._allAttachment=Object.values(r.l.getInstance().getAll())),this._allAttachment}constructor(){this._allAttachment=[],this._getAllAttachment()}}},535006:function(e,t,i){"use strict";i.d(t,{Q:function(){return s}});var r=i(211561),n=i(553836),a=i(52757);class s extends n.H{collect(e){let t={},{materials:i,canvas_config:n}=e,{canvases:s}=i;if(Array.isArray(s))for(let e of s){let i=e.id,n=void 0!==e.source_platform?e.source_platform:r.nj7.EffectPlatformLoki,s="string"==typeof e.image_id?e.image_id:"",o="string"==typeof e.type?e.type:"";(0,a.LM)(t,e,[],"image","","image_name","image_id",i,s,"canvas",o,n)}let o=null==n?void 0:n.background;if(o&&o.type===r.cVg.MetaTypeCanvasImage){let e=void 0!==o.source_platform?o.source_platform:r.nj7.EffectPlatformLoki,i="string"==typeof o.image_id?o.image_id:"";(0,a.LM)(t,o,[],"image","","image_name","image_id","",i,"canvas",r.cVg.MetaTypeCanvasImage,e)}return t}}},989856:function(e,t,i){"use strict";i(211561)},855871:function(e,t,i){"use strict";i.d(t,{S:function(){return o}});var r=i(288907),n=i(626956),a=i(633141),s=i(800788);function o(e,t){switch(t){case r.JF.AttachmentAiStory:return function(e){let t=[new a.V],i=new n.h(t).repair(e);return(0,s.Y2)(i.ok),i.value}(e);case r.JF.AttachmentAiWriter:case r.JF.AttachmentAsyncTask:case r.JF.AttachmentVideoAlgorithm:default:return e}}},129384:function(e,t,i){"use strict";i.d(t,{S:function(){return n}});var r=i(987733);class n{getAttachmentFileName(){return this.attachmentFileName}getStringVersion(){return this.version}getNumberVersion(){return(0,r.R0)(this.getStringVersion())}migrate(e,t){let i=this.migrateInner(e,t);return i.ok&&(i.value.version=this.getStringVersion()),i}}},973627:function(e,t,i){"use strict";i.d(t,{g:function(){return o}});var r=i(690613),n=i(341360),a=i(879566),s=i(929576);class o extends n.k{_migratePlatformInfo(e){let{platform:t,last_modified_platform:i}=e;(null==t?void 0:t.os)==="web"&&(t.app_id=348188),(null==i?void 0:i.os)==="web"&&(i.app_id=348188)}migrateInner(e,t){var i,n,o,l;let{materials:u,config:d}=e,{texts:c}=u;if(this._migratePlatformInfo(e),!(null==c?void 0:c.length)||!d)return(0,r.oW)(e);let h=!1,p="",m=0,f="",g=0;for(let e of c)if(null===(n=e.subtitle_keywords)||void 0===n?void 0:null===(i=n.range)||void 0===i?void 0:i.length){e.base_content=e.content;let t=a.hM.getOriginContentFromContent(e.content),i=e.subtitle_keywords.range.find(e=>e.location<t.length);if(i){h=!0,p=e.content,m=i.location;break}}if(!h)return(0,r.oW)(e);for(let e of c)if(null===(l=e.subtitle_keywords)||void 0===l?void 0:null===(o=l.range)||void 0===o?void 0:o.length){let t=s.O.getFirstNoKeywordLocation(e.content,e.subtitle_keywords.range);if(-1!==t){f=e.content,g=t;break}}else{f=e.content,g=0;break}!f&&(f=c[0].content,g=0);let y=a.hM.getLetterStyle(p,m),_=a.hM.getLetterStyle(f,g);if(!y||!_)return(0,r.oW)(e);let v=y.size&&_.size&&y.size>_.size?y.size/_.size:1;return d.subtitle_keywords_config={font_size_ratio:v,styles:a.hM.buildRichTextFromStyle(y,"placeholder"),subtitle_template_keywords_original_font_size:0,subtitle_template_original_font_size:0},(0,r.oW)(e)}constructor(...e){super(...e),this.version="109.0.0",this.needEnumerateSubDrafts=!0}}},973588:function(e,t,i){"use strict";i.d(t,{S:function(){return s}});var r=i(690613),n=i(211561),a=i(341360);class s extends a.k{migrateInner(e){let{materials:t}=e,{audios:i}=t;if(!i||0===i.length)return(0,r.oW)(e);for(let e of i)Number(e.source_platform)===n.QZ3.AudioPlatformAIMusic&&(e.ai_music_type=n.QSZ.AIMusicTypeBackground);return(0,r.oW)(e)}constructor(...e){super(...e),this.version="118.0.0",this.needEnumerateSubDrafts=!0}}},967101:function(e,t,i){"use strict";i.d(t,{V:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e){let{materials:t}=e,{videos:i}=t;if(!i||0===i.length)return(0,r.oW)(e);for(let e of i)e.check_flag+=0x2000000;return(0,r.oW)(e)}constructor(...e){super(...e),this.version="123.0.0",this.needEnumerateSubDrafts=!0}}},886250:function(e,t,i){"use strict";i.d(t,{N:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e){let{materials:t}=e,{videos:i}=t;if(!i||0===i.length)return(0,r.oW)(e);for(let e of i){if(!e.reverse_path||!e.video_algorithm)continue;let t=e.video_algorithm;if(!Array.isArray(t.algorithms)||1!==t.algorithms.length)continue;let i=t.algorithms[0];if("AlgorithmDefault"===i.type)i.type="Reverse",t.path&&(t.path=e.reverse_path)}return(0,r.oW)(e)}constructor(...e){super(...e),this.version="126.0.0",this.needEnumerateSubDrafts=!0}}},495423:function(e,t,i){"use strict";i.d(t,{z:function(){return s}});var r=i(690613),n=i(341360),a=i(283395);class s extends n.k{migrateInner(e){var t;if(e.duration&&(e.duration=1000n*BigInt(e.duration)),!("tracks"in e)||!Array.isArray(e.tracks))return(0,r.wf)(a.D.kDeserializeJsonFailed,"no tracks in json");for(let t of e.tracks){let e=t.type,i=0===t.flag&&"video"===e;for(let e of t.segments)e.source_timerange&&(e.source_timerange={duration:1000n*BigInt(e.source_timerange.duration),start:1000n*BigInt(e.source_timerange.start)}),e.target_timerange&&(e.target_timerange={duration:1000n*BigInt(e.target_timerange.duration),start:1000n*BigInt(e.target_timerange.start)}),i&&e.render_index&&(e.render_index=0)}let{videos:i,audios:n,animations:s,material_animations:o,audio_fades:l,effects:u,transitions:d,speeds:c}=e.materials;if(i)for(let e of i)e.duration=1000n*BigInt(e.duration);if(n)for(let e of n)e.duration=1000n*BigInt(e.duration);if(s)for(let e of s)e.duration=1000n*BigInt(e.duration);if(o)for(let e of o)for(let t of e.animations)t.duration=1000n*BigInt(t.duration);if(l)for(let e of l)e.fade_in_duration=1000n*BigInt(e.fade_in_duration),e.fade_out_duration=1000n*BigInt(e.fade_out_duration);if(u)for(let e of u)"video_animation"===e.type&&(e.value=1e3*e.value);if(d)for(let e of d)e.duration=1000n*BigInt(e.duration);if(c){for(let e of c)if(e.mode&&1===e.mode&&e.curve_speed){if(!e.curve_speed)continue;let{speed_points:t}=e.curve_speed||{};if(!t)continue;let i=[],r=[];for(let e of t)i.push(e.x),r.push(e.y)}}for(let[i,r]of Object.entries(null!==(t=e.keyframes)&&void 0!==t?t:{}))if("adjusts"===i||"audios"===i||"filters"===i||"stickers"===i||"texts"===i||"videos"===i)for(let e of r)e.time_offset<0?e.time_offset=0:e.time_offset=1e3*e.time_offset;return(0,r.oW)(e)}constructor(...e){super(...e),this.version="29.0.0"}}},568155:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});var r=i(690613),n=i(341360),a=i(602777);class s extends n.k{migrateInner(e,t){if("tracks"in e&&"materials"in e&&"videos"in e.materials){let t=e.materials.videos,{tracks:i}=e;for(let e of i){if("type"in e&&"video"===e.type&&"segments"in e)for(let i of e.segments){let e;if(!("material_id"in i))continue;let r=i.material_id;for(let[,i]of Object.entries(t))if("id"in i&&i.id===r){e=i;break}if(!e||!("path"in e))continue;let n="check_flag"in e?e.check_flag:511;e.check_flag=n|Number(a.FC.HDRSettingsFlag)}}}return(0,r.oW)(e)}constructor(...e){super(...e),this.version="46.0.0"}}},591118:function(e,t,i){"use strict";i.d(t,{r:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){return(0,r.oW)(e)}constructor(...e){super(...e),this.version="58.0.1"}}},609894:function(e,t,i){"use strict";i.d(t,{T:function(){return d}});var r=i(690613),n=i(341360),a=i(340294),s=i(81649),o=i(283395),l=i(203447),u=i(211561);class d extends n.k{migrateInner(e,t){let i=this.upgradeOverlapTransition(e);return i.ok?(0,r.oW)(e):i}upgradeOverlapTransition(e){if(!("materials"in e))return(0,r.ly)();let t=e.materials;if("drafts"in t&&Array.isArray(t.drafts))for(let e of t.drafts){if(!("draft"in e))continue;let t=this.upgradeOverlapTransition(e.draft);if(!t.ok)return t}if(!("transitions"in t)||!Array.isArray(t.transitions))return(0,r.ly)();let i={},{transitions:n}=t;for(let e of n){if("type"in e&&"duration"in e&&"path"in e&&"is_overlap"in e&&"id"in e&&"duration"in e)!0===e.is_overlap&&(i[e.id]=e.duration)}if(0===Object.keys(i).length||!("tracks"in e))return(0,r.ly)();let a=30;null!==e.fps&&(a=e.fps);let s=[...e.tracks];for(let e of s){let r=this.upgradeTrack(e,a,i,t);if(!r.ok)return r}return e.tracks=s,(0,r.ly)()}upgradeCurveSpeedSegment(e,t,i,r,n,a){let o=new l.C,d=-1;if(!("start"in t)||!("duration"in t)||!("start"in i)||!("duration"in i)||!("speed_points"in n))return d;let c=new u.yP4,h=[];for(let e of n.speed_points){if(!("x"in e)||!("y"in e))return d;let t=new u.nR_({x:e.x,y:e.y});h.push(t)}c.speedPoints=h;let p=new s.O1(a),m=BigInt(t.start),f=BigInt(t.duration),g=p.gen(m+f).round,y=BigInt(i.start),_=BigInt(i.duration),v=p.gen(y+_).round,k=m,I=(k=e?p.gen(g-r/2n).round:p.gen(m+r/2n).round)-m,S=o.splitCurveSpeedPoints(I,_,f,c,a),w=S[0],b=S[1],F=BigInt(o.mapSeqDeltaToTrimDelta(I,f,c.speedPoints)),C=o.getCurveAveSpeed(w),A=I,x=p.gen(F).round;A=p.gen(A).round,_===x?(x=p.gen(F).previous,A=p.gen(A).previous):0n===x&&(x=p.gen(F).next,A=p.gen(A).next);let E=x,D=m+A,M=y+E;if(e){d=C;let e=[];for(let t of w)e.push({x:t.x,y:t.y});n.speed_points=e,t.duration=A,i.duration=E}else{d=o.getCurveAveSpeed(b);let e=[];for(let t of b)e.push({x:t.x,y:t.y});n.speed_points=e,t.start=D,t.duration=g-D,i.start=M,i.duration=v-M}return d}upgradeSegment(e,t,i,n,l){let u=t.target_timerange;if(!u||null===u||"object"!=typeof u||!("start"in u)||!("duration"in u))return(0,r.wf)(o.D.kSerializeJsonFailed,"target_timerange not valid");let d=t.source_timerange;if(!d||null===d||"object"!=typeof d||!("start"in d)||!("duration"in d))return(0,r.wf)(o.D.kSerializeJsonFailed,"source_timerange not valid");let c=t.extra_material_refs;if(!c)return(0,r.wf)(o.D.kSerializeJsonFailed,"extra_materials not valid");let h=!1,p=1,m=t.speed;if(m){let e=Number(m);!isNaN(e)&&(p=e)}do{let a=l.speeds;if(!a||!Array.isArray(a))break;for(let s of c){let l=a.find(e=>{let t=e.id;return!!t&&"string"==typeof t&&t===s});if(!l)continue;let c=l.speed;if(void 0===c)break;let m=Number(c);if(isNaN(m))break;if(p=m,!l.mode||!l.curve_speed||1!==Number(l.mode))break;let f=l.curve_speed;if(!f||null===f||"object"!=typeof f)break;let g=f.speed_points;if(!g||null===g||"object"!=typeof g)break;let y=this.upgradeCurveSpeedSegment(e,u,d,n,f,i);if(y<=0)return(0,r.wf)(o.D.kSerializeJsonFailed,"speed not valid");t.speed=y,l.speed=y,h=!0;break}}while(!1);if(!h){let t=new s.O1(i),r=BigInt(u.duration),o=["number","bigint"];if(e){if(!o.includes(typeof r))throw Error("Invalid value for target_duration");u.duration=t.gen(r-n/2n).round,d.duration=t.gen(a.pM.times(BigInt(u.duration),p,"bigint")).round}else{let e=u.start;if(!o.includes(typeof e)||!o.includes(typeof r))throw Error("Invalid value for target_start or target_duration");u.start=t.gen(a.pM.plus(e,a.pM.div(n,2n),"bigint")).round,u.duration=t.gen(r-n/2n).round,d.start=t.gen(a.pM.plus(d.start,a.pM.times(n,p/2),"bigint")).round,d.duration=t.gen(a.pM.times(BigInt(u.duration),p,"bigint")).round}}return(0,r.ly)()}upgradeTrack(e,t,i,n){if(!e.type||"string"!=typeof e.type||"video"!==e.type||!e.segments||!Array.isArray(e.segments))return(0,r.ly)();let a=e=>{for(let t of e){let e=i[t];if(e)return BigInt(e)}return-1n},{segments:s}=e;for(let e=0;e<s.length;e++){let i=s[e];if(!i.extra_material_refs||!i.source_timerange||null===i.source_timerange)continue;let r=a(i.extra_material_refs);if(r<=0n)continue;if(e+1>=s.length)break;let o=this.upgradeSegment(!0,i,t,r,n);if(!o.ok)return o;let l=s[e+1],u=this.upgradeSegment(!1,l,t,r,n);if(!u.ok)return u}return(0,r.ly)()}constructor(...e){super(...e),this.version="70.0.0"}}},508263:function(e,t,i){"use strict";i.d(t,{d:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){if("materials"in e){let t=e.materials;if("beats"in t&&Array.isArray(t.beats))for(let e of t.beats)"enable_ai_beats"in e&&"boolean"==typeof e.enable_ai_beats&&e.enable_ai_beats&&(e.gear_count=2)}return(0,r.oW)(e)}constructor(...e){super(...e),this.version="80.0.0",this.needEnumerateSubDrafts=!0}}},447747:function(e,t,i){"use strict";i.d(t,{E:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){var i;if(!("materials"in e)||!("tracks"in e))return(0,r.oW)(e);let n=null!==(i=e.materials)&&void 0!==i?i:{};if(!("video"in n))return(0,r.oW)(e);for(let e of n.videos)"stable"in e&&(e.stable.time_range={start:0,duration:e.duration});return(0,r.oW)(e)}constructor(...e){super(...e),this.version="86.0.0",this.needEnumerateSubDrafts=!0}}},899286:function(e,t,i){"use strict";i.d(t,{w:function(){return a}});var r=i(690613),n=i(341360);class a extends n.k{migrateInner(e,t){let{materials:i}=e,{videos:n}=i;for(let e=0;e<n.length;e++){let t=n[e].object_locked;if(t){let{keyframes:e}=t;e&&(t.locked_enable=!0)}}return(0,r.oW)(e)}constructor(...e){super(...e),this.version="95.0.0",this.needEnumerateSubDrafts=!0}}},661936:function(e,t,i){"use strict";i.d(t,{$8:function(){return u},F5:function(){return k},Hw:function(){return o},N4:function(){return c},WX:function(){return h},eY:function(){return _},q1:function(){return g},qz:function(){return p},sZ:function(){return v},v0:function(){return y},wc:function(){return d},wq:function(){return I},zn:function(){return m},zq:function(){return l}});var r=i(602777),n=i(155235),a=i(351603),s=i(340294);let o=[{keyframeFlag:r.FD.SKFFScale,keyframeType:r.Eu.KFTypeScale,fieldKey:"scale"},{keyframeFlag:r.FD.SKFFPosition,keyframeType:r.Eu.KFTypePositionX,fieldKey:"position"},{keyframeFlag:r.FD.SKFFRotation,keyframeType:r.Eu.KFTypeRotation,fieldKey:"rotation"}],l=[{keyframeFlag:r.w8.ADKFFBrightness,keyframeType:r.Eu.KFTypeBrightness,fieldKey:"brightness_value"},{keyframeFlag:r.w8.ADKFFContrast,keyframeType:r.Eu.KFTypeContrast,fieldKey:"contrast_value"},{keyframeFlag:r.w8.ADKFFSaturation,keyframeType:r.Eu.KFTypeSaturation,fieldKey:"saturation_value"},{keyframeFlag:r.w8.ADKFFSharpen,keyframeType:r.Eu.KFTypeSharpen,fieldKey:"sharpen_value"},{keyframeFlag:r.w8.ADKFFHightLight,keyframeType:r.Eu.KFTypeHightLight,fieldKey:"highlight_value"},{keyframeFlag:r.w8.ADKFFShadow,keyframeType:r.Eu.KFTypeShadow,fieldKey:"shadow_value"},{keyframeFlag:r.w8.ADKFFTemperature,keyframeType:r.Eu.KFTypeTemperature,fieldKey:"temperature_value"},{keyframeFlag:r.w8.ADKFFTone,keyframeType:r.Eu.KFTypeHue,fieldKey:"tone_value"},{keyframeFlag:r.w8.ADKFFFade,keyframeType:r.Eu.KFTypeFade,fieldKey:"fade_value"},{keyframeFlag:r.w8.ADKFFLightSensation,keyframeType:r.Eu.KFTypeLightSensatione,fieldKey:"light_sensation_value"},{keyframeFlag:r.w8.ADKFFVignetting,keyframeType:r.Eu.KFTypeVignetting,fieldKey:"vignetting_value"},{keyframeFlag:r.w8.ADKFFParticle,keyframeType:r.Eu.KFTypeParticle,fieldKey:"particle_value"},{keyframeFlag:r.w8.ADKFFLUT,keyframeType:r.Eu.KFTypeLUT,fieldKey:"lut_value"},{keyframeFlag:r.w8.ADKFFPrimaryColorWheelsIntensity,keyframeType:r.Eu.KFTypePrimaryColorWheelIntensity,fieldKey:"primary_color_wheels_intensity"},{keyframeFlag:r.w8.ADKFFLogColorWheelsIntensity,keyframeType:r.Eu.KFTypeLogColorWheelIntensity,fieldKey:"log_color_wheels_intensity"},{keyframeFlag:r.w8.ADKFFFilter,keyframeType:r.Eu.KFTypeFilter,fieldKey:"filter_value"},{keyframeFlag:r.w8.ADKFFSmartColorAdjust,keyframeType:r.Eu.KFTypeSmartColorAdjust,fieldKey:"smart_color_adjust_value"}],u=[{adjustType:"filter",keyframeFlag:r.w8.ADKFFFilter},{adjustType:"brightness",keyframeFlag:r.w8.ADKFFBrightness},{adjustType:"contrast",keyframeFlag:r.w8.ADKFFContrast},{adjustType:"saturation",keyframeFlag:r.w8.ADKFFSaturation},{adjustType:"sharpen",keyframeFlag:r.w8.ADKFFSharpen},{adjustType:"highlight",keyframeFlag:r.w8.ADKFFHightLight},{adjustType:"shadow",keyframeFlag:r.w8.ADKFFShadow},{adjustType:"temperature",keyframeFlag:r.w8.ADKFFTemperature},{adjustType:"tone",keyframeFlag:r.w8.ADKFFTone},{adjustType:"fade",keyframeFlag:r.w8.ADKFFFade},{adjustType:"light_sensation",keyframeFlag:r.w8.ADKFFLightSensation},{adjustType:"vignetting",keyframeFlag:r.w8.ADKFFVignetting},{adjustType:"particle",keyframeFlag:r.w8.ADKFFParticle},{adjustType:"lut",keyframeFlag:r.w8.ADKFFLUT},{adjustType:"primary_color_wheels",keyframeFlag:r.w8.ADKFFPrimaryColorWheelsIntensity},{adjustType:"log_color_wheels",keyframeFlag:r.w8.ADKFFLogColorWheelsIntensity},{adjustType:"smart_color_adjust",keyframeFlag:r.w8.ADKFFSmartColorAdjust}],d=[{adjustType:"filter",keyframeFlag:r.n1.VKFFFilter},{adjustType:"brightness",keyframeFlag:r.n1.VKFFBrightness},{adjustType:"contrast",keyframeFlag:r.n1.VKFFContrast},{adjustType:"saturation",keyframeFlag:r.n1.VKFFSaturation},{adjustType:"sharpen",keyframeFlag:r.n1.VKFFSharpen},{adjustType:"highlight",keyframeFlag:r.n1.VKFFHightLight},{adjustType:"shadow",keyframeFlag:r.n1.VKFFShadow},{adjustType:"temperature",keyframeFlag:r.n1.VKFFTemperature},{adjustType:"tone",keyframeFlag:r.n1.VKFFTone},{adjustType:"fade",keyframeFlag:r.n1.VKFFFade},{adjustType:"light_sensation",keyframeFlag:r.n1.VKFFLightSensatione},{adjustType:"vignetting",keyframeFlag:r.n1.VKFFVignetting},{adjustType:"particle",keyframeFlag:r.n1.VKFFParticle},{adjustType:"lut",keyframeFlag:r.n1.VKFFLUT},{adjustType:"primary_color_wheels",keyframeFlag:r.n1.VKFFPrimaryColorWheelIntensity},{adjustType:"log_color_wheels",keyframeFlag:r.n1.VKFFLogColorWheelIntensity},{adjustType:"smart_color_adjust",keyframeFlag:r.n1.VKFFSmartColorAdjust}],c=[{keyframeFlag:r.ND.TKFFPosition,keyframeType:r.Eu.KFTypePositionX,fieldKey:"position"},{keyframeFlag:r.ND.TKFFScale,keyframeType:r.Eu.KFTypeScale,fieldKey:"scale"},{keyframeFlag:r.ND.TKFFRotation,keyframeType:r.Eu.KFTypeRotation,fieldKey:"rotation"},{keyframeFlag:r.ND.TKFFBorderWidth,keyframeType:r.Eu.KFTypeBorderWidth,fieldKey:"border_width"},{keyframeFlag:r.ND.TKFFTextAlpha,keyframeType:r.Eu.KFTypeTextAlpha,fieldKey:"text_alpha"},{keyframeFlag:r.ND.TKFFBackgroundAlpha,keyframeType:r.Eu.KFTypeBackgroundAlpha,fieldKey:"background_alpha"},{keyframeFlag:r.ND.TKFFShadowAlpha,keyframeType:r.Eu.KFTypeShadowAlpha,fieldKey:"shadow_alpha"},{keyframeFlag:r.ND.TKFFShadowSmoothing,keyframeType:r.Eu.KFTypeShadowSmoothing,fieldKey:"shadow_smoothing"},{keyframeFlag:r.ND.TKFFShadowAngle,keyframeType:r.Eu.KFTypeShadowAngle,fieldKey:"shadow_angle"},{keyframeFlag:r.ND.TKFFBorderColor,keyframeType:r.Eu.KFTypeBorderColor,fieldKey:"border_color"},{keyframeFlag:r.ND.TKFFTextColor,keyframeType:r.Eu.KFTypeTextColor,fieldKey:"text_color"},{keyframeFlag:r.ND.TKFFShadowColor,keyframeType:r.Eu.KFTypeShadowColor,fieldKey:"shadow_color"},{keyframeFlag:r.ND.TKFFBackgroundColor,keyframeType:r.Eu.KFTypeBackgroundColor,fieldKey:"background_color"},{keyframeFlag:r.ND.TKFFGlobalAlpha,keyframeType:r.Eu.KFTypeGlobalAlpha,fieldKey:"global_alpha"},{keyframeFlag:r.ND.TKFFBloomColor,keyframeType:r.Eu.KFTypeBorderColor,fieldKey:"bloom_color"},{keyframeFlag:r.ND.TKFFBloomStrength,keyframeType:r.Eu.KFTypeBloomStrength,fieldKey:"bloom_strength"},{keyframeFlag:r.ND.TKFFBloomRange,keyframeType:r.Eu.KFTypeBloomRange,fieldKey:"bloom_range"},{keyframeFlag:r.ND.TKFFBloomDirX,keyframeType:r.Eu.KFTypeBloomDirX,fieldKey:"bloom_dir_x"},{keyframeFlag:r.ND.TKFFBloomDirY,keyframeType:r.Eu.KFTypeBloomDirY,fieldKey:"bloom_dir_y"}],h=[{keyframeFlag:r.k6.FKFFValue,keyframeType:r.Eu.KFTypeFilter,fieldKey:"value"}],p=[{keyframeFlag:r.cw.AUKFFVolume,keyframeType:r.Eu.KFTypeVolume,fieldKey:"volume"},{keyframeFlag:r.cw.AUKFFEffectAdjustParam1,keyframeType:r.Eu.KFTypeEffectAdjustParam1,fieldKey:"effect_adjust_param_1"},{keyframeFlag:r.cw.AUKFFEffectAdjustParam2,keyframeType:r.Eu.KFTypeEffectAdjustParam2,fieldKey:"effect_adjust_param_2"},{keyframeFlag:r.cw.AUKFFEffectAdjustParam3,keyframeType:r.Eu.KFTypeEffectAdjustParam3,fieldKey:"effect_adjust_param_3"}],m=[{keyframeFlag:r.n1.VKFFPosition,keyframeType:r.Eu.KFTypePositionX,fieldKey:"position"},{keyframeFlag:r.n1.VKFFScale,keyframeType:r.Eu.KFTypeScale,fieldKey:"scale"},{keyframeFlag:r.n1.VKFFRotation,keyframeType:r.Eu.KFTypeRotation,fieldKey:"rotation"},{keyframeFlag:r.n1.VKFFAlpha,keyframeType:r.Eu.KFTypeAlpha,fieldKey:"alpha"},{keyframeFlag:r.n1.VKFFVolume,keyframeType:r.Eu.KFTypeVolume,fieldKey:"volume"},{keyframeFlag:r.n1.VKFFLastVolume,keyframeType:r.Eu.KFTypeLastVolume,fieldKey:"last_volume"},{keyframeFlag:r.n1.VKFFFilter,keyframeType:r.Eu.KFTypeFilter,fieldKey:"filter_value"},{keyframeFlag:r.n1.VKFFBrightness,keyframeType:r.Eu.KFTypeBrightness,fieldKey:"brightness_value"},{keyframeFlag:r.n1.VKFFContrast,keyframeType:r.Eu.KFTypeContrast,fieldKey:"contrast_value"},{keyframeFlag:r.n1.VKFFSaturation,keyframeType:r.Eu.KFTypeSaturation,fieldKey:"saturation_value"},{keyframeFlag:r.n1.VKFFSharpen,keyframeType:r.Eu.KFTypeSharpen,fieldKey:"sharpen_value"},{keyframeFlag:r.n1.VKFFHightLight,keyframeType:r.Eu.KFTypeHightLight,fieldKey:"highlight_value"},{keyframeFlag:r.n1.VKFFShadow,keyframeType:r.Eu.KFTypeShadow,fieldKey:"shadow_value"},{keyframeFlag:r.n1.VKFFTemperature,keyframeType:r.Eu.KFTypeTemperature,fieldKey:"temperature_value"},{keyframeFlag:r.n1.VKFFTone,keyframeType:r.Eu.KFTypeHue,fieldKey:"tone_value"},{keyframeFlag:r.n1.VKFFFade,keyframeType:r.Eu.KFTypeFade,fieldKey:"fade_value"},{keyframeFlag:r.n1.VKFFLightSensatione,keyframeType:r.Eu.KFTypeLightSensatione,fieldKey:"light_sensation_value"},{keyframeFlag:r.n1.VKFFVignetting,keyframeType:r.Eu.KFTypeVignetting,fieldKey:"vignetting_value"},{keyframeFlag:r.n1.VKFFParticle,keyframeType:r.Eu.KFTypeParticle,fieldKey:"particle_value"},{keyframeFlag:r.n1.VKFFLUT,keyframeType:r.Eu.KFTypeLUT,fieldKey:"lut_value"},{keyframeFlag:r.n1.VKFFChromaIntensity,keyframeType:r.Eu.KFTypeChromaIntensity,fieldKey:"chroma_intensity"},{keyframeFlag:r.n1.VKFFChromaShadow,keyframeType:r.Eu.KFTypeChromaShadow,fieldKey:"chroma_shadow"},{keyframeFlag:r.n1.VKFFCommonMaskPosition,keyframeType:r.Eu.KFTypeMaskPostion,fieldKey:"mask_config"},{keyframeFlag:r.n1.VKFFCommonMaskSize,keyframeType:r.Eu.KFTypeMaskSize,fieldKey:"mask_config"},{keyframeFlag:r.n1.VKFFCommonMaskRotation,keyframeType:r.Eu.KFTypeMaskRotation,fieldKey:"mask_config"},{keyframeFlag:r.n1.VKFFCommonMaskFeather,keyframeType:r.Eu.KFTypeMaskFeather,fieldKey:"mask_config"},{keyframeFlag:r.n1.VKFFCommonMaskRoundCorner,keyframeType:r.Eu.KFTypeMaskRoundCorner,fieldKey:"mask_config"},{keyframeFlag:r.n1.VKFFStretch,keyframeType:r.Eu.KFTypeStretch,fieldKey:"figure_stretch"},{keyframeFlag:r.n1.VKFFSlim,keyframeType:r.Eu.KFTypeSlim,fieldKey:"figure_slim"},{keyframeFlag:r.n1.VKFFZoom,keyframeType:r.Eu.KFTypeZoom,fieldKey:"figure_zoom"},{keyframeFlag:r.n1.VKFFPrimaryColorWheelIntensity,keyframeType:r.Eu.KFTypePrimaryColorWheelIntensity,fieldKey:"primary_color_wheels_intensity"},{keyframeFlag:r.n1.VKFFLogColorWheelIntensity,keyframeType:r.Eu.KFTypeLogColorWheelIntensity,fieldKey:"log_color_wheels_intensity"},{keyframeFlag:r.n1.VKFFSmartColorAdjust,keyframeType:r.Eu.KFTypeSmartColorAdjust,fieldKey:"smart_color_adjust_value"},{keyframeFlag:r.n1.VKFFEffectAdjustParam1,keyframeType:r.Eu.KFTypeEffectAdjustParam1,fieldKey:"effect_adjust_param_1"},{keyframeFlag:r.n1.VKFFEffectAdjustParam2,keyframeType:r.Eu.KFTypeEffectAdjustParam2,fieldKey:"effect_adjust_param_2"},{keyframeFlag:r.n1.VKFFEffectAdjustParam3,keyframeType:r.Eu.KFTypeEffectAdjustParam3,fieldKey:"effect_adjust_param_3"}],f=(e,t,i)=>{let r=[];for(let a of t)if(a.keyframeType===e){let e=i[a.fieldKey];if(null==e)continue;if("string"==typeof e){let t=(0,n.P)(e);r.push(...t)}else if("number"==typeof e)r.push(i[a.fieldKey]);else throw Error("Unexpected value type");break}return r},g=(e,t)=>{let i=f(e,l,t);if(0===i.length)throw Error("Result is empty");return i},y=(e,t)=>{let i=f(e,p,t);if(0===i.length)throw Error("Result is empty");return i},_=(e,t)=>{let i=f(e,h,t);if(0===i.length)throw Error("Result is empty");return i},v=(e,t)=>{let i=[];if(e===r.Eu.KFTypePositionX)i.push(t.position.x);else if(e===r.Eu.KFTypePositionY)i.push(t.position.y);else if(e===r.Eu.KFTypeScale)i.push(t.scale.x),i.push(t.scale.y);else if(e===r.Eu.KFTypeRotation){let e=t.rotation;i.push(-e)}if(0===i.length)throw Error("Values array is empty");return i},k=(e,t)=>{let i=[];if(e===r.Eu.KFTypePositionX)i.push(t.position.x);else if(e===r.Eu.KFTypePositionY)i.push(t.position.y);else if(e===r.Eu.KFTypeScale)i.push(t.scale.x),i.push(t.scale.y);else if(e===r.Eu.KFTypeBorderColor)i=(0,n.P)(t.border_color);else if(e===r.Eu.KFTypeBorderAlpha){let e=(0,n.P)(t.border_color);e.length>=4&&i.push(e[3])}else if(e===r.Eu.KFTypeBackgroundAlpha){if(0===t.background_color.length)i.push(0);else{let e=t.background_alpha;i.push(e)}}else if(e===r.Eu.KFTypeShadowAngle||e===r.Eu.KFTypeShadowDistance){let n=t.shadow_point.x,s=t.shadow_point.y,o=(0,a.iL)(n,s),l=(0,a.EW)(o);e===r.Eu.KFTypeShadowDistance?i.push(l[0]):i.push(l[1])}else i=f(e,c,t);return i},I=(e,t)=>{let i=[],n=t.mask_config,a=(0,s.Fz)(n);if(e===r.Eu.KFTypePositionX)i.push(t.position.x);else if(e===r.Eu.KFTypePositionY)i.push(t.position.y);else if(e===r.Eu.KFTypeScale)i.push(t.scale.x),i.push(t.scale.y);else if(a&&e===r.Eu.KFTypeMaskPostion)i.push(n.centerX),i.push(n.centerY);else if(a&&e===r.Eu.KFTypeMaskSize)i.push(n.width),i.push(n.height);else if(a&&e===r.Eu.KFTypeMaskRotation)i.push(n.rotation);else if(a&&e===r.Eu.KFTypeMaskFeather)i.push(n.feather);else if(a&&e===r.Eu.KFTypeMaskRoundCorner)i.push(n.roundCorner);else if(e===r.Eu.KFTypeZoom){let e=t.figure_zoom;(0,s.Fz)(e)&&(i.push(e.intensity),i.push(e.x),i.push(e.y),i.push(e.radius))}else if(e===r.Eu.KFTypeSlim){let e=t.figure_slim;(0,s.Fz)(e)&&(i.push(e.intensity),i.push(e.x),i.push(e.y),i.push(e.width),i.push(e.height),i.push(e.rotation))}else if(e===r.Eu.KFTypeStretch){let e=t.figure_stretch;(0,s.Fz)(e)&&(i.push(e.intensity),i.push(e.upper),i.push(e.bottom))}else i=f(e,m,t);return i}},800428:function(e,t,i){"use strict";i.d(t,{g:function(){return l}});var r=i(690613),n=i(211561),a=i(987733),s=i(12826),o=i(576040);class l extends s.j{repair(e){var t,i,s,l,u,d,c;let{draft:h}=e,p=h.new_version;if(!p)return(0,r.oW)(e);let m=null===(t=h.platform)||void 0===t?void 0:t.app_id;if(m&&Number(m)===o.y.CapCutBusiness)return(0,r.oW)(e);let f=(null!==(d=null===(i=h.platform)||void 0===i?void 0:i.os)&&void 0!==d?d:"pc").toLowerCase(),g=(null!==(c=null===(s=h.last_modified_platform)||void 0===s?void 0:s.os)&&void 0!==c?c:"").toLowerCase(),y=(0,a.R0)("87.0.0"),_=(0,a.R0)("115.0.0"),v=(0,a.R0)(p);if(!((g?"web"===g:"web"===f)&&v>=y&&v<=_))return(0,r.oW)(e);null==h||null===(l=h.tracks)||void 0===l||l.filter(e=>e.type===n.pNd.TrackTypeVideo).forEach(e=>{var t;null===(t=e.segments)||void 0===t||t.forEach(e=>{var t;(null===(t=e.clip)||void 0===t?void 0:t.transform.y)&&(e.clip.transform.y*=-1)})});let k=null===(u=h.materials)||void 0===u?void 0:u.drafts;return k&&k.forEach(e=>this.repair({draft:e.draft})),(0,r.oW)(e)}}},776072:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var r=i(690613),n=i(234396);class a extends n.K{repair(e){let{draft:t}=e;for(let e of t.tracks)for(let t of e.segments)for(let e of t.commonKeyframes)e.keyframeList=e.keyframeList.filter(e=>e.values.every(e=>"number"==typeof e&&isFinite(e)));return(0,r.oW)(e)}}},355664:function(e,t,i){"use strict";i.d(t,{y:function(){return c}});var r=i(690613),n=i(234396),a=i(481631),s=i(347311),o=i(231163),l=i(584665),u=i(189777),d=i(700845);class c extends n.K{repair(e){let{draft:t}=e,{os:i}=t.property.platform,{os:n}=t.property.lastModifiedPlatform;return n&&(0,d.Ro)(n)?this._setDefaultFromPC(e):n&&!(0,d.$L)(n)||i&&(0,d.N0)(i)?this._setDefaultFromApp(e):(0,r.oW)(e)}_setDefaultFromPC(e){var t;let{draft:i}=e,{tracks:n}=i;for(let e of n)for(let t of e.segments)this._setDefaultFromPCBySegment(t);let{cover:a}=i.property;if(null==a?void 0:null===(t=a.coverDraft)||void 0===t?void 0:t.draft){let e=this._setDefaultFromPC({draft:a.coverDraft.draft});if(!e.ok)return e}return(0,r.oW)(e)}_setDefaultFromApp(e){let{draft:t}=e,{tracks:i}=t;for(let e of i)for(let t of e.segments)this._setDefaultFromAppBySegment(t);return(0,r.oW)(e)}_setDefaultFromPCBySegment(e){(0,a.Q2)(e)?(0,s.zD)(e):(0,a.Ft)(e)?(0,s.ix)(e):(0,a.P2)(e)||(0,a.P7)(e)||(0,a.WX)(e)?(0,u.X)(e):(0,a.Y9)(e)?(0,l.y)(e):(0,a.he)(e)&&(0,o.j)(e)}_setDefaultFromAppBySegment(e){(0,a.Ft)(e)&&(0,s.NG)(e)}}},806869:function(e,t,i){"use strict";i.d(t,{T:function(){return o}});var r=i(602777),n=i(481631),a=i(234396),s=i(690613);class o extends a.K{repair(e){let{draft:t}=e;for(let e of t.tracks){if(!![r.pN.TrackTypeVideo].includes(e.type))for(let t of e.segments){if(!!(0,n.du)(t))!t.materialDraft&&(t.material.extraTypeOption=0)}}return(0,s.oW)(e)}}},444211:function(e,t,i){"use strict";i.d(t,{Fu:function(){return c},kr:function(){return l}});var r=i(669686),n=i(150251),a=i(232729);let s={common:["ad_template_tag_keys","ad_template_tags","audio_edited"],bigint:{version:{}},array:{parts:{type:"object",clsName:()=>a.Lz}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.version=0n,this.adTemplateTagKeys="",this.adTemplateTags="",this.parts=[],this.audioEdited=!1,(0,r.tZ)(this,e,o)}}let u={common:["ad_template_tag_keys","ad_template_tags","audio_edited"],bigint:{version:{}},array:{parts:{type:"object",clsName:()=>a.Lz}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},63285:function(e,t,i){"use strict";var r=i(669686);i(150251);var n=i(26195),a=i(223438);(0,r.I2)({array:{ai_packaging_infos:{type:"object",clsName:()=>n.SL}},object:{ai_packaging_report_info:{type:()=>a.Cn}}},[]);(0,r.I2)({array:{ai_packaging_infos:{type:"object",clsName:()=>n.SL}},object:{ai_packaging_report_info:{type:()=>a.sX}}},[])},223438:function(e,t,i){"use strict";i.d(t,{Cn:function(){return o},sX:function(){return d}});var r=i(669686),n=i(150251);let a={common:["text_style","video_category","task_id","tos_id","method","style","material_source","commercial_material","page_from"],array:{caption_id_list:{type:"common"}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.captionIdList=[],this.textStyle="",this.videoCategory="",this.taskId="",this.tosId="",this.method="",this.style="",this.materialSource="",this.commercialMaterial="",this.pageFrom="",(0,r.tZ)(this,e,s)}}let l={common:["text_style","video_category","task_id","tos_id","method","style","material_source","commercial_material","page_from"],array:{caption_id_list:{type:"common"}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},268932:function(e,t,i){"use strict";i.d(t,{Wr:function(){return d},z4:function(){return o}});var r=i(669686),n=i(150251);let a={common:["story_id"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.storyId="",(0,r.tZ)(this,e,s)}}let l={common:["story_id"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},642853:function(e,t,i){"use strict";i.d(t,{Kr:function(){return o},o_:function(){return d}});var r=i(669686),n=i(150251);let a={bigint:{first_router:{},second_router:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.firstRouter=-1n,this.secondRouter=-1n,(0,r.tZ)(this,e,s)}}let l={bigint:{first_router:{},second_router:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},840961:function(e,t,i){"use strict";i.d(t,{R2:function(){return o},y4:function(){return d}});var r=i(669686),n=i(150251);let a={common:["aigc_generate_enable","aigc_generate_id","aigc_generate_item_id","restore_path"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.aigcGenerateEnable=!1,this.aigcGenerateId="",this.aigcGenerateItemId="",this.restorePath="",(0,r.tZ)(this,e,s)}}let l={common:["aigc_generate_enable","aigc_generate_id","aigc_generate_item_id","restore_path"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},68187:function(e,t,i){"use strict";i.d(t,{tw:function(){return o}});var r=i(669686),n=i(150251);let a={common:["index"],array:{segment_ids:{type:"common"}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.index=0,this.segmentIds=[],(0,r.tZ)(this,e,s)}}let l={common:["index"],array:{segment_ids:{type:"common"}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},93613:function(e,t,i){"use strict";i.d(t,{w1:function(){return c},xD:function(){return l}});var r=i(669686),n=i(150251),a=i(569566);let s={common:["is_global"],object:{backup_motion_blur:{type:()=>a.a8,nullable:!0}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.isGlobal=!0,(0,r.tZ)(this,e,o)}}let u={common:["is_global"],object:{backup_motion_blur:{type:()=>a.UJ,nullable:!0}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},901262:function(e,t,i){"use strict";i.d(t,{VJ:function(){return u},jh:function(){return h}});var r=i(602777),n=i(669686),a=i(150251),s=i(6467);let o={common:["dom_width","dom_height","ratio","width","height"],object:{background:{type:()=>s.fl,nullable:!0}}},l=(0,n.I2)(o,["domWidth","domHeight"]);class u extends a.w8{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,o,e),t.domWidth=this.domWidth,t.domHeight=this.domHeight,t}constructor(e={}){super(),this[a.I9]=h,this.domWidth=0,this.domHeight=0,this.ratio=r.rx.CanvasRatioOriginal,this.width=1920,this.height=1080,(0,n.tZ)(this,e,l)}}let d={common:["dom_width","dom_height","ratio","width","height"],object:{background:{type:()=>s.Fq,nullable:!0}}},c=(0,n.I2)(d,["domWidth","domHeight"]);class h extends a.u2{static deserialize(e){let t=new h;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,n.he)(this,t,d,e,!1,!0),null!==this.domWidth&&void 0!==this.domWidth&&(t.domWidth=this.domWidth),null!==this.domHeight&&void 0!==this.domHeight&&(t.domHeight=this.domHeight),t}constructor(e={}){super(),this[a._n]=u,(0,n.fZ)(this,e,c)}}},303745:function(e,t,i){"use strict";i.d(t,{oR:function(){return o},pc:function(){return d}});var r=i(669686),n=i(150251);let a={common:["word_count","line_count"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.wordCount=0,this.lineCount=0,(0,r.tZ)(this,e,s)}}let l={common:["word_count","line_count"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},415360:function(e,t,i){"use strict";i.d(t,{iI:function(){return c},q6:function(){return l}});var r=i(669686),n=i(150251),a=i(323776);let s={common:["from"],array:{value:{type:"object",clsName:()=>a.t0}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.value=[],this.from="",(0,r.tZ)(this,e,o)}}let u={common:["from"],array:{value:{type:"object",clsName:()=>a.t0}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},760554:function(e,t,i){"use strict";i.d(t,{KS:function(){return o},Ly:function(){return d}});var r=i(669686),n=i(150251);let a={common:["x","y"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.x=0,this.y=0,(0,r.tZ)(this,e,s)}}let l={common:["x","y"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},640233:function(e,t,i){"use strict";i.d(t,{Aw:function(){return d},W6:function(){return o}});var r=i(669686),n=i(150251);let a={common:["longitude","latitude","shoot_time"],bigint:{width:{},height:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.width=0n,this.height=0n,this.longitude=0,this.latitude=0,this.shootTime="",(0,r.tZ)(this,e,s)}}let l={common:["longitude","latitude","shoot_time"],bigint:{width:{},height:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},728193:function(e,t,i){"use strict";i.d(t,{CA:function(){return l},_C:function(){return c}});var r=i(602777),n=i(669686),a=i(150251);let s={common:["mode"]},o=(0,n.I2)(s,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=c,this.mode=r.zA.Origin,(0,n.tZ)(this,e,o)}}let u={common:["mode"]},d=(0,n.I2)(u,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,d)}}},738402:function(e,t,i){"use strict";i.d(t,{Kt:function(){return l},R5:function(){return c}});var r=i(602777),n=i(669686),a=i(150251);let s={common:["video_path","type"],bigint:{source_time_start:{}}},o=(0,n.I2)(s,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=c,this.videoPath="",this.type=r.cV.MetaTypeNone,this.sourceTimeStart=0n,(0,n.tZ)(this,e,o)}}let u={common:["video_path","type"],bigint:{source_time_start:{}}},d=(0,n.I2)(u,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,d)}}},77401:function(e,t,i){"use strict";i.d(t,{Fl:function(){return l},k_:function(){return c}});var r=i(669686),n=i(150251),a=i(987706);let s={array:{groups:{type:"object",clsName:()=>a.ZA}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.groups=[],(0,r.tZ)(this,e,o)}}let u={array:{groups:{type:"object",clsName:()=>a.ZA}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},532652:function(e,t,i){"use strict";i.d(t,{Gm:function(){return c},bE:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let s={common:["mode","intensity","nits"]},o=(0,n.I2)(s,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=c,this.mode=r.bZ.HDRDisplayModeNone,this.intensity=1,this.nits=1e3,(0,n.tZ)(this,e,o)}}let u={common:["mode","intensity","nits"]},d=(0,n.I2)(u,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,d)}}},372149:function(e,t,i){"use strict";i.d(t,{as:function(){return o}});var r=i(669686),n=i(150251);let a={common:["id","type","volume","effect_adjust_param_1","effect_adjust_param_2","effect_adjust_param_3"],bigint:{time_offset:{},flags:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.id="",this.type="audio",this.timeOffset=0n,this.flags=-1n,this.volume=1,this.effectAdjustParam1=1,this.effectAdjustParam2=1,this.effectAdjustParam3=1,(0,r.tZ)(this,e,s)}}let l={common:["id","type","volume","effect_adjust_param_1","effect_adjust_param_2","effect_adjust_param_3"],bigint:{time_offset:{},flags:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},177611:function(e,t,i){"use strict";i.d(t,{Hf:function(){return l}});var r=i(669686),n=i(150251),a=i(640999);let s={common:["id","type"],bigint:{time_offset:{},flags:{}},array:{values:{type:"object",clsName:()=>a.Xl}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.type="effect",this.timeOffset=0n,this.flags=-1n,this.values=[],(0,r.tZ)(this,e,o)}}let u={common:["id","type"],bigint:{time_offset:{},flags:{}},array:{values:{type:"object",clsName:()=>a.Xl}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},182673:function(e,t,i){"use strict";i.d(t,{E4:function(){return f},VN:function(){return _}});var r=i(669686),n=i(150251),a=i(838051),s=i(372149),o=i(827174),l=i(579399),u=i(445180),d=i(206653),c=i(595506),h=i(177611);let p={array:{videos:{type:"object",clsName:()=>a.tm},audios:{type:"object",clsName:()=>s.as},texts:{type:"object",clsName:()=>o.ye},stickers:{type:"object",clsName:()=>l.QC},filters:{type:"object",clsName:()=>u.Nl},adjusts:{type:"object",clsName:()=>d.eH},handwrites:{type:"object",clsName:()=>c.OM},effects:{type:"object",clsName:()=>h.Hf}}},m=(0,r.I2)(p,[]);class f extends n.w8{static deserialize(e){let t=new f;return(0,r.Tz)(t,e,p),t}static serialize(e){return(0,r.o8)(e,p)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,r.he)(this,t,p,e),t}constructor(e={}){super(),this[n.I9]=_,this.videos=[],this.audios=[],this.texts=[],this.stickers=[],this.filters=[],this.adjusts=[],this.handwrites=[],this.effects=[],(0,r.tZ)(this,e,m)}}let g={array:{videos:{type:"object",clsName:()=>a.tm},audios:{type:"object",clsName:()=>s.as},texts:{type:"object",clsName:()=>o.ye},stickers:{type:"object",clsName:()=>l.QC},filters:{type:"object",clsName:()=>u.Nl},adjusts:{type:"object",clsName:()=>d.eH},handwrites:{type:"object",clsName:()=>c.OM},effects:{type:"object",clsName:()=>h.Hf}}},y=(0,r.I2)(g,[]);class _ extends n.u2{static deserialize(e){let t=new _;return(0,r.Tz)(t,e,g,!0),t}static serialize(e){return(0,r.o8)(e,g,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new _;return(0,r.he)(this,t,g,e,!1,!0),t}constructor(e={}){super(),this[n._n]=f,(0,r.fZ)(this,e,y)}}},519348:function(e,t,i){"use strict";i.d(t,{BJ:function(){return p},TA:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251),o=i(180942);let l={common:["id","type","enable","is_from_ai_translate_tool","is_contain_ai_translate_result","mouth_shape_modify","production_path","source_language","target_language","is_auto_detect","enter_from"],object:{time_range:{type:()=>o.tn,nullable:!0},actual_time_range:{type:()=>o.tn,nullable:!0}}},u=(0,a.I2)(l,[]);class d extends s.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[s.I9]=p,this.id=(0,n.p)(),this.type=r.cV.MetaTypeAITranslate,this.enable=!1,this.isFromAiTranslateTool=!1,this.isContainAiTranslateResult=!1,this.mouthShapeModify=!0,this.productionPath="",this.sourceLanguage="",this.targetLanguage="",this.isAutoDetect=!0,this.enterFrom="",(0,a.tZ)(this,e,u)}}let c={common:["id","type","enable","is_from_ai_translate_tool","is_contain_ai_translate_result","mouth_shape_modify","production_path","source_language","target_language","is_auto_detect","enter_from"],object:{time_range:{type:()=>o.ze,nullable:!0},actual_time_range:{type:()=>o.ze,nullable:!0}}},h=(0,a.I2)(c,[]);class p extends s.u2{static deserialize(e){let t=new p;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[s._n]=d,(0,a.fZ)(this,e,h)}}},67792:function(e,t,i){"use strict";i.d(t,{Be:function(){return u},l:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251);let o={common:["id","type","audio_track_index","default_audio_track_index"]},l=(0,a.I2)(o,[]);class u extends s.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,o),t}static serialize(e){return(0,a.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,o,e,["id"]),t}constructor(e={}){super(),this[s.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeAudioTrackIndex,this.audioTrackIndex=-1,this.defaultAudioTrackIndex=-1,(0,a.tZ)(this,e,l)}}let d={common:["id","type","audio_track_index","default_audio_track_index"]},c=(0,a.I2)(d,[]);class h extends s.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,d,!0),t}static serialize(e){return(0,a.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,d,e,["id"],!0),t}constructor(e={}){super(),this[s._n]=u,(0,a.fZ)(this,e,c)}}},345768:function(e,t,i){"use strict";i.d(t,{MK:function(){return c},VB:function(){return l}});var r=i(287165),n=i(669686),a=i(150251);let s={common:["id","is_color_clip","is_gradient","solid_color","gradient_angle","width","height"],array:{gradient_colors:{type:"common"},gradient_percents:{type:"common"}}},o=(0,n.I2)(s,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[a.I9]=c,this.id=(0,r.p)(),this.isColorClip=!1,this.isGradient=!1,this.solidColor="",this.gradientColors=[],this.gradientPercents=[],this.gradientAngle=90,this.width=0,this.height=0,(0,n.tZ)(this,e,o)}}let u={common:["id","is_color_clip","is_gradient","solid_color","gradient_angle","width","height"],array:{gradient_colors:{type:"common"},gradient_percents:{type:"common"}}},d=(0,n.I2)(u,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,d)}}},143743:function(e,t,i){"use strict";i.d(t,{YN:function(){return _},Zg:function(){return I}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251),o=i(589416),l=i(64144),u=i(674413),d=i(541537),c=i(182248),h=i(871011),p=i(647117),m=i(794239),f=i(639208);let g={common:["id","category_id","type","entrance","digital_human_id","resource_id","digital_human_source","local_task_id","sub_type","has_real_scene","model"],array:{tts_metas:{type:"object",clsName:()=>d.yU}},object:{voice_info:{type:()=>o.re,nullable:!0},mask:{type:()=>l.Q$,nullable:!0},background:{type:()=>u.zG,nullable:!0},video_meta:{type:()=>c.H$,nullable:!0},audio_meta:{type:()=>h.FA,nullable:!0},benefit_info:{type:()=>p.fA,nullable:!0},bs_info:{type:()=>m.Gb,nullable:!0},figure_effect:{type:()=>f.lU,nullable:!0}}},y=(0,a.I2)(g,[]);class _ extends s.w8{static deserialize(e){let t=new _;return(0,a.Tz)(t,e,g),t}static serialize(e){return(0,a.o8)(e,g)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new _;return(0,a.he)(this,t,g,e,["id"]),t}constructor(e={}){super(),this[s.I9]=I,this.id=(0,n.p)(),this.categoryId="",this.type=r.cV.MetaTypeDigitalHuman,this.entrance="",this.digitalHumanId="",this.resourceId="",this.digitalHumanSource=r.O_.DigitalHumanSourcePGC,this.localTaskId="",this.subType=r.Jb.DigitalHumanSubTypeVideo,this.hasRealScene=!1,this.model=r.X4.DigitalHumanModelNormal,(0,a.tZ)(this,e,y)}}let v={common:["id","category_id","type","entrance","digital_human_id","resource_id","digital_human_source","local_task_id","sub_type","has_real_scene","model"],array:{tts_metas:{type:"object",clsName:()=>d.yU}},object:{voice_info:{type:()=>o.mJ,nullable:!0},mask:{type:()=>l.zZ,nullable:!0},background:{type:()=>u.P2,nullable:!0},video_meta:{type:()=>c.$m,nullable:!0},audio_meta:{type:()=>h.q1,nullable:!0},benefit_info:{type:()=>p.Bz,nullable:!0},bs_info:{type:()=>m.B1,nullable:!0},figure_effect:{type:()=>f.N,nullable:!0}}},k=(0,a.I2)(v,[]);class I extends s.u2{static deserialize(e){let t=new I;return(0,a.Tz)(t,e,v,!0),t}static serialize(e){return(0,a.o8)(e,v,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new I;return(0,a.he)(this,t,v,e,["id"],!0),t}constructor(e={}){super(),this[s._n]=_,(0,a.fZ)(this,e,k)}}},1841:function(e,t,i){"use strict";i.d(t,{Td:function(){return u},y9:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251);let o={common:["id","type","path","resource_path","initial_scale","width","height","brush_count","check_flag"],array:{resource_ids:{type:"common"}}},l=(0,a.I2)(o,[]);class u extends s.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,o),t}static serialize(e){return(0,a.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,o,e,["id"]),t}constructor(e={}){super(),this[s.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeNone,this.path="",this.resourcePath="",this.initialScale=0,this.width=0,this.height=0,this.brushCount=0,this.checkFlag=1,this.resourceIds=[],(0,a.tZ)(this,e,l)}}let d={common:["id","type","path","resource_path","initial_scale","width","height","brush_count","check_flag"],array:{resource_ids:{type:"common"}}},c=(0,a.I2)(d,[]);class h extends s.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,d,!0),t}static serialize(e){return(0,a.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,d,e,["id"],!0),t}constructor(e={}){super(),this[s._n]=u,(0,a.fZ)(this,e,c)}}},684372:function(e,t,i){"use strict";i.d(t,{p4:function(){return d},q1:function(){return p}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251),o=i(908099);let l={common:["id","type","panel","resource_id","path","intensity","lumi_hub_path","source_platform"],object:{shadow:{type:()=>o.P8},midtone:{type:()=>o.P8},highlight:{type:()=>o.P8},offset:{type:()=>o.P8}}},u=(0,a.I2)(l,[]);class d extends s.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[s.I9]=p,this.id=(0,n.p)(),this.type=r.cV.MetaTypeLogColorWheels,this.panel="",this.resourceId="",this.path="",this.shadow=new o.P8,this.midtone=new o.P8,this.highlight=new o.P8,this.offset=new o.P8,this.intensity=1,this.lumiHubPath="",this.sourcePlatform=r.nj.EffectPlatformLoki,(0,a.tZ)(this,e,u)}}let c={common:["id","type","panel","resource_id","path","intensity","lumi_hub_path","source_platform"],object:{shadow:{type:()=>o.an},midtone:{type:()=>o.an},highlight:{type:()=>o.an},offset:{type:()=>o.an}}},h=(0,a.I2)(c,[]);class p extends s.u2{static deserialize(e){let t=new p;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[s._n]=d,(0,a.fZ)(this,e,h)}}},461203:function(e,t,i){"use strict";i.d(t,{EF:function(){return u},TB:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251);let o={common:["id","type","name","effect_id","resource_id","third_resource_id","source_platform","path","is_overlap","platform","category_id","category_name","request_id"],bigint:{duration:{}}},l=(0,a.I2)(o,[]);class u extends s.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,o),t}static serialize(e){return(0,a.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,o,e,["id"]),t}constructor(e={}){super(),this[s.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeTransition,this.name="",this.effectId="",this.resourceId="",this.thirdResourceId="",this.sourcePlatform=0,this.path="",this.duration=500n,this.isOverlap=!1,this.platform="all",this.categoryId="",this.categoryName="",this.requestId="",(0,a.tZ)(this,e,l)}}let d={common:["id","type","name","effect_id","resource_id","third_resource_id","source_platform","path","is_overlap","platform","category_id","category_name","request_id"],bigint:{duration:{}}},c=(0,a.I2)(d,[]);class h extends s.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,d,!0),t}static serialize(e){return(0,a.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,d,e,["id"],!0),t}constructor(e={}){super(),this[s._n]=u,(0,a.fZ)(this,e,c)}}},128263:function(e,t,i){"use strict";i.d(t,{Hs:function(){return d},Mu:function(){return p}});var r=i(669686),n=i(150251),a=i(730174),s=i(289109),o=i(382068);let l={array:{common_keyframes:{type:"object",clsName:()=>o.ko}},object:{matting:{type:()=>a.v5},chroma:{type:()=>s.VJ}}},u=(0,r.I2)(l,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=p,this.matting=new a.v5,this.chroma=new s.VJ,this.commonKeyframes=[],(0,r.tZ)(this,e,u)}}let c={array:{common_keyframes:{type:"object",clsName:()=>o.ko}},object:{matting:{type:()=>a.zh},chroma:{type:()=>s.Xk}}},h=(0,r.I2)(c,[]);class p extends n.u2{static deserialize(e){let t=new p;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,h)}}},730174:function(e,t,i){"use strict";i.d(t,{v5:function(){return l},zh:function(){return c}});var r=i(669686),n=i(150251),a=i(380009);let s={common:["path","has_use_quick_brush","has_use_quick_eraser","reverse","custom_matting_id","blendMode","blendColor"],bigint:{flag:{},expansion:{},feather:{}},array:{interactiveTime:{type:"bigint"},strokes:{type:"object",clsName:()=>a.Ax}}},o=(0,r.I2)(s,["blendMode","blendColor"]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t.blendMode=this.blendMode,t.blendColor=this.blendColor,t}constructor(e={}){super(),this[n.I9]=c,this.flag=0n,this.path="",this.interactiveTime=[],this.hasUseQuickBrush=!1,this.strokes=[],this.hasUseQuickEraser=!1,this.expansion=0n,this.feather=0n,this.reverse=!1,this.customMattingId="",this.blendMode=0,this.blendColor="",(0,r.tZ)(this,e,o)}}let u={common:["path","has_use_quick_brush","has_use_quick_eraser","reverse","custom_matting_id","blendMode","blendColor"],bigint:{flag:{},expansion:{},feather:{}},array:{interactiveTime:{type:"bigint"},strokes:{type:"object",clsName:()=>a.Ax}}},d=(0,r.I2)(u,["blendMode","blendColor"]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),null!==this.blendMode&&void 0!==this.blendMode&&(t.blendMode=this.blendMode),null!==this.blendColor&&void 0!==this.blendColor&&(t.blendColor=this.blendColor),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},724776:function(e,t,i){"use strict";i.d(t,{U$:function(){return o}});var r=i(669686),n=i(150251);let a={common:["material_id","vid","is_new"],bigint:{duration:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.materialId="",this.vid="",this.duration=0n,this.isNew=!1,(0,r.tZ)(this,e,s)}}let l={common:["material_id","vid","is_new"],bigint:{duration:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},852500:function(e,t,i){"use strict";i.d(t,{to:function(){return o},zF:function(){return d}});var r=i(669686),n=i(150251);let a={common:["audio_name"],bigint:{start:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.start=0n,this.audioName="",(0,r.tZ)(this,e,s)}}let l={common:["audio_name"],bigint:{start:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},585149:function(e,t,i){"use strict";var r=i(669686);i(150251);(0,r.I2)({bigint:{pc_feature_flag:{}}},[]);(0,r.I2)({bigint:{pc_feature_flag:{}}},[])},85025:function(e,t,i){"use strict";i.d(t,{XI:function(){return d},t4:function(){return o}});var r=i(669686),n=i(150251);let a={common:["os","os_version","app_version","app_source","device_id","hard_disk_id","mac_address"],bigint:{app_id:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.os="",this.osVersion="",this.appId=0n,this.appVersion="",this.appSource="",this.deviceId="",this.hardDiskId="",this.macAddress="",(0,r.tZ)(this,e,s)}}let l={common:["os","os_version","app_version","app_source","device_id","hard_disk_id","mac_address"],bigint:{app_id:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},368372:function(e,t,i){"use strict";var r=i(669686);i(150251);var n=i(316976);(0,r.I2)({common:["version"],array:{plugin_segments:{type:"object",clsName:()=>n.QK}}},[]);(0,r.I2)({common:["version"],array:{plugin_segments:{type:"object",clsName:()=>n.QK}}},[])},879662:function(e,t,i){"use strict";i.d(t,{PR:function(){return d},t0:function(){return o}});var r=i(669686),n=i(150251);let a={common:["plugin_id","plugin_version","entrance_params"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.pluginId="",this.pluginVersion="0.0.0",this.entranceParams="",(0,r.tZ)(this,e,s)}}let l={common:["plugin_id","plugin_version","entrance_params"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},286524:function(e,t,i){"use strict";i.d(t,{xs:function(){return l}});var r=i(669686),n=i(150251),a=i(45793);let s={common:["task_id","scene","recognize_type","language"],array:{items:{type:"object",clsName:()=>a.ZK}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.taskId="",this.scene="",this.recognizeType="",this.language="",this.items=[],(0,r.tZ)(this,e,o)}}let u={common:["task_id","scene","recognize_type","language"],array:{items:{type:"object",clsName:()=>a.ZK}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},602432:function(e,t,i){"use strict";i.d(t,{WX:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let s={common:["type"],array:{id_to_id:{type:"common"}}},o=(0,n.I2)(s,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=c,this.idToId=[],this.type=r.jv.RelationshipUnknown,(0,n.tZ)(this,e,o)}}let u={common:["type"],array:{id_to_id:{type:"common"}}},d=(0,n.I2)(u,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,d)}}},889803:function(e,t,i){"use strict";i.d(t,{Ci:function(){return o},o_:function(){return d}});var r=i(669686),n=i(150251);let a={common:["x","y"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.x=1,this.y=1,(0,r.tZ)(this,e,s)}}let l={common:["x","y"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},350990:function(e,t,i){"use strict";i.d(t,{xs:function(){return u}});var r=i(669686),n=i(150251),a=i(728592),s=i(107001);let o={common:["metaphrase","type","sub_type","scene_tags","scene_tags_keys","sub_draft_id","edited","apply_segment_record","scene_tips","user_metaphrase"],array:{segments:{type:"object",clsName:()=>a.G4},default_style_segments:{type:"object",clsName:()=>s.am}}},l=(0,r.I2)(o,[]);class u extends n.w8{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=h,this.metaphrase="",this.segments=[],this.type="",this.subType="",this.sceneTags="",this.sceneTagsKeys="",this.subDraftId="",this.edited=!1,this.defaultStyleSegments=[],this.applySegmentRecord="",this.sceneTips="",this.userMetaphrase="",(0,r.tZ)(this,e,l)}}let d={common:["metaphrase","type","sub_type","scene_tags","scene_tags_keys","sub_draft_id","edited","apply_segment_record","scene_tips","user_metaphrase"],array:{segments:{type:"object",clsName:()=>a.G4},default_style_segments:{type:"object",clsName:()=>s.am}}},c=(0,r.I2)(d,[]);class h extends n.u2{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=u,(0,r.fZ)(this,e,c)}}},706731:function(e,t,i){"use strict";i.d(t,{kn:function(){return o}});var r=i(669686),n=i(150251);let a={common:["type","path"],bigint:{start_time:{},duration:{},total_duration:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.type="",this.path="",this.startTime=0n,this.duration=0n,this.totalDuration=0n,(0,r.tZ)(this,e,s)}}let l={common:["type","path"],bigint:{start_time:{},duration:{},total_duration:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},697444:function(e,t,i){"use strict";i.d(t,{UL:function(){return l}});var r=i(669686),n=i(150251),a=i(180942);let s={common:["segment_id","material_path"],bigint:{start_time:{},duration:{},group_id:{}},object:{target_time_range:{type:()=>a.tn},source_time_range:{type:()=>a.tn}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.segmentId="",this.startTime=0n,this.duration=0n,this.groupId=0n,this.materialPath="",this.targetTimeRange=new a.tn,this.sourceTimeRange=new a.tn,(0,r.tZ)(this,e,o)}}let u={common:["segment_id","material_path"],bigint:{start_time:{},duration:{},group_id:{}},object:{target_time_range:{type:()=>a.ze},source_time_range:{type:()=>a.ze}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},267693:function(e,t,i){"use strict";i.d(t,{j:function(){return l}});var r=i(669686),n=i(150251),a=i(180942);let s={common:["id","text","tag","origin_text"],object:{time_range:{type:()=>a.tn}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.text="",this.tag="",this.timeRange=new a.tn,this.originText="",(0,r.tZ)(this,e,o)}}let u={common:["id","text","tag","origin_text"],object:{time_range:{type:()=>a.ze}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},808402:function(e,t,i){"use strict";i.d(t,{Zl:function(){return p},wI:function(){return d}});var r=i(602777),n=i(669686),a=i(150251),s=i(518938),o=i(53823);let l={extend:o.xV,object:{material:{type:()=>s.W9}}},u=(0,n.I2)(l,[]);class d extends o.XX{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,l),t}static serialize(e){return(0,n.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,l,e,!0),t}constructor(e={}){super(e),this[a.I9]=p,this.__segment_struct_type=r.Oc.SegmentTailLeader,this.material=new s.W9,(0,n.tZ)(this,e,u)}}let c={extend:o.FX,object:{material:{type:()=>s.f9}}},h=(0,n.I2)(c,[]);class p extends o.Ev{static deserialize(e){let t=new p;return(0,n.Tz)(t,e,c,!0),t}static serialize(e){return(0,n.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,n.he)(this,t,c,e,!0,!0),t}constructor(e={}){super(),this[a._n]=d,this.__segment_struct_type=r.Oc.SegmentTailLeader,(0,n.fZ)(this,e,h)}}},195834:function(e,t,i){"use strict";i.d(t,{NO:function(){return J},_6:function(){return G}});var r=i(602777),n=i(669686),a=i(150251),s=i(180942),o=i(238830),l=i(468634),u=i(563091),d=i(379012),c=i(280283),h=i(247795),p=i(289109),m=i(686513),f=i(569566),g=i(414516),y=i(461203),_=i(64144),v=i(6467),k=i(528156),I=i(838051),S=i(984736),w=i(213030),b=i(156447),F=i(487253),C=i(217381),A=i(557599),x=i(29709),E=i(730174),D=i(908301),M=i(956156),K=i(583109),P=i(468699),B=i(345768),O=i(365013),z=i(143743),V=i(907350),j=i(519348),N=i(67792),R=i(137234),L=i(132392),H=i(232524),W=i(959026),q=i(53823);let U={extend:q.xV,common:["need_crossfade_in","need_crossfade_out","has_left_source_neighbour","has_right_source_neighbour","alpha","crop_ratio","crop_scale","ai_matting","is_unified_beauty_mode"],bigint:{smart_crop_version:{},digital_human_local_render_version:{},vocal_separation_version:{},vocal_beauty_version:{}},array:{video_effects:{type:"object",clsName:()=>f.a8},video_mask:{type:"object",clsName:()=>_.Q$},voice_change:{type:"object",clsName:()=>k.Yy},keyframes:{type:"object",clsName:()=>I.tm},figures:{type:"object",clsName:()=>m.eA},plugin_effects:{type:"object",clsName:()=>x.r0}},object:{source_timerange:{type:()=>s.tn},clip:{type:()=>o.bX},uniform_scale:{type:()=>l._p},material:{type:()=>u.Ub},material_draft:{type:()=>d.Wu,nullable:!0},speed:{type:()=>c.Ug},placeholder_info:{type:()=>h.yu},chroma:{type:()=>p.VJ,nullable:!0},filter:{type:()=>m.eA,nullable:!0},beauty:{type:()=>m.eA,nullable:!0},reshape:{type:()=>m.eA,nullable:!0},adjust:{type:()=>g.sq,nullable:!0},anim:{type:()=>m.eA,nullable:!0},mix_mode:{type:()=>m.eA,nullable:!0},transition:{type:()=>y.EF,nullable:!0},background:{type:()=>v.fl},crop:{type:()=>S.oI},realtime_denoise:{type:()=>w.jU,nullable:!0},stable:{type:()=>b.IB},video_algorithm:{type:()=>F.PO},stretch_leg:{type:()=>m.eA,nullable:!0},makeup_root:{type:()=>m.eA,nullable:!0},video_tracking:{type:()=>C.FM,nullable:!0},manual_deformation:{type:()=>A.RR,nullable:!0},matting:{type:()=>E.v5},animations:{type:()=>D.ZP,nullable:!0},sound_channel_mapping:{type:()=>M.tU},green_screen:{type:()=>K.si,nullable:!0},beat:{type:()=>P.hW,nullable:!0},material_color:{type:()=>B.VB},multi_camera_info:{type:()=>O.k1,nullable:!0},digital_human:{type:()=>z.YN,nullable:!0},smart_crop:{type:()=>V.O3,nullable:!0},ai_translate:{type:()=>j.TA,nullable:!0},audio_track_index:{type:()=>N.Be,nullable:!0},loudness:{type:()=>R.o6,nullable:!0},vocal_beautify:{type:()=>L.jG,nullable:!0},vocal_separation:{type:()=>H.Jc},smart_relight:{type:()=>W.XY,nullable:!0}}},Z=(0,n.I2)(U,[]);class G extends q.XX{static deserialize(e){let t=new G;return(0,n.Tz)(t,e,U),t}static serialize(e){return(0,n.o8)(e,U)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new G;return(0,n.he)(this,t,U,e,!0),t}constructor(e={}){super(e),this[a.I9]=J,this.__segment_struct_type=r.Oc.SegmentVideo,this.sourceTimerange=new s.tn,this.clip=new o.bX,this.uniformScale=new l._p,this.material=new u.Ub,this.speed=new c.Ug,this.placeholderInfo=new h.yu,this.needCrossfadeIn=!1,this.needCrossfadeOut=!1,this.hasLeftSourceNeighbour=!1,this.hasRightSourceNeighbour=!1,this.alpha=1,this.background=new v.fl,this.keyframes=[],this.crop=new S.oI,this.cropRatio=r.j8.CropRatioFree,this.cropScale=1,this.aiMatting=0,this.stable=new b.IB,this.videoAlgorithm=new F.PO,this.figures=[],this.isUnifiedBeautyMode=!1,this.matting=new E.v5,this.soundChannelMapping=new M.tU,this.materialColor=new B.VB,this.vocalSeparation=new H.Jc,this.smartCropVersion=0n,this.digitalHumanLocalRenderVersion=0n,this.vocalSeparationVersion=0n,this.vocalBeautyVersion=0n,(0,n.tZ)(this,e,Z)}}let $={extend:q.FX,common:["need_crossfade_in","need_crossfade_out","has_left_source_neighbour","has_right_source_neighbour","alpha","crop_ratio","crop_scale","ai_matting","is_unified_beauty_mode"],bigint:{smart_crop_version:{},digital_human_local_render_version:{},vocal_separation_version:{},vocal_beauty_version:{}},array:{video_effects:{type:"object",clsName:()=>f.a8},video_mask:{type:"object",clsName:()=>_.Q$},voice_change:{type:"object",clsName:()=>k.Yy},keyframes:{type:"object",clsName:()=>I.tm},figures:{type:"object",clsName:()=>m.eA},plugin_effects:{type:"object",clsName:()=>x.r0}},object:{source_timerange:{type:()=>s.ze},clip:{type:()=>o.tL},uniform_scale:{type:()=>l.Rp},material:{type:()=>u.K2},material_draft:{type:()=>d.rd,nullable:!0},speed:{type:()=>c.Zk},placeholder_info:{type:()=>h.XW},chroma:{type:()=>p.Xk,nullable:!0},filter:{type:()=>m.W9,nullable:!0},beauty:{type:()=>m.W9,nullable:!0},reshape:{type:()=>m.W9,nullable:!0},adjust:{type:()=>g.cN,nullable:!0},anim:{type:()=>m.W9,nullable:!0},mix_mode:{type:()=>m.W9,nullable:!0},transition:{type:()=>y.TB,nullable:!0},background:{type:()=>v.Fq},crop:{type:()=>S.V_},realtime_denoise:{type:()=>w.tp,nullable:!0},stable:{type:()=>b.un},video_algorithm:{type:()=>F.OH},stretch_leg:{type:()=>m.W9,nullable:!0},makeup_root:{type:()=>m.W9,nullable:!0},video_tracking:{type:()=>C.Mw,nullable:!0},manual_deformation:{type:()=>A.Kr,nullable:!0},matting:{type:()=>E.zh},animations:{type:()=>D.PA,nullable:!0},sound_channel_mapping:{type:()=>M.Pr},green_screen:{type:()=>K.pj,nullable:!0},beat:{type:()=>P.NZ,nullable:!0},material_color:{type:()=>B.MK},multi_camera_info:{type:()=>O.BQ,nullable:!0},digital_human:{type:()=>z.Zg,nullable:!0},smart_crop:{type:()=>V.GZ,nullable:!0},ai_translate:{type:()=>j.BJ,nullable:!0},audio_track_index:{type:()=>N.l,nullable:!0},loudness:{type:()=>R.fQ,nullable:!0},vocal_beautify:{type:()=>L.ck,nullable:!0},vocal_separation:{type:()=>H.HV},smart_relight:{type:()=>W.Gg,nullable:!0}}},X=(0,n.I2)($,[]);class J extends q.Ev{static deserialize(e){let t=new J;return(0,n.Tz)(t,e,$,!0),t}static serialize(e){return(0,n.o8)(e,$,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new J;return(0,n.he)(this,t,$,e,!0,!0),t}constructor(e={}){super(),this[a._n]=G,this.__segment_struct_type=r.Oc.SegmentVideo,(0,n.fZ)(this,e,X)}}},53823:function(e,t,i){"use strict";i.d(t,{Ev:function(){return k},FX:function(){return _},XX:function(){return y},xV:function(){return f}});var r=i(602777),n=i(287165),a=i(669686),s=i(150251),o=i(180942),l=i(238830),u=i(468634),d=i(532652),c=i(382068),h=i(467028),p=i(95477),m=i(396981);let f={common:["id","desc","state","is_loop","is_tone_modify","reverse","intensifies_audio","cartoon","volume","last_nonzero_volume","material_id","render_index","enable_lut","enable_adjust","enable_hsl","visible","group_id","enable_color_curves","track_render_index","enable_color_wheels","track_attribute","is_placeholder","template_id","enable_smart_color_adjust","template_scene","enable_color_match_adjust","enable_color_correct_adjust","enable_adjust_mask","raw_segment_id","enable_video_mask"],bigint:{offset:{}},array:{extra_material_refs:{type:"common"},keyframe_refs:{type:"common"},common_keyframes:{type:"object",clsName:()=>c.ko}},object:{source_timerange:{type:()=>o.tn,nullable:!0},target_timerange:{type:()=>o.tn},render_timerange:{type:()=>o.tn},clip:{type:()=>l.bX,nullable:!0},uniform_scale:{type:()=>u._p,nullable:!0},hdr_settings:{type:()=>d.bE,nullable:!0},caption_info:{type:()=>h.kT,nullable:!0},responsive_layout:{type:()=>p.bN},lyric_keyframes:{type:()=>m.N2,nullable:!0}}},g=(0,a.I2)(f,["offset"]);class y extends s.w8{static deserialize(e){let t=new y;return(0,a.Tz)(t,e,f),t}static serialize(e){return(0,a.o8)(e,f)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new y;return(0,a.he)(this,t,f,e,["id"]),t.offset=this.offset,t}constructor(e={}){super(),this[s.I9]=k,this.id=(0,n.p)(),this.targetTimerange=new o.tn,this.renderTimerange=new o.tn,this.desc="",this.state=r.yM.SegmentStateNormal,this.isLoop=!1,this.isToneModify=!1,this.reverse=!1,this.intensifiesAudio=!1,this.cartoon=!1,this.volume=1,this.lastNonzeroVolume=1,this.materialId="",this.extraMaterialRefs=[],this.renderIndex=0,this.keyframeRefs=[],this.enableLut=!0,this.enableAdjust=!0,this.enableHsl=!0,this.visible=!0,this.groupId="",this.enableColorCurves=!0,this.trackRenderIndex=0,this.enableColorWheels=!0,this.trackAttribute=0,this.isPlaceholder=!1,this.templateId="",this.enableSmartColorAdjust=!1,this.templateScene=r.XO.TemplateSceneDefault,this.commonKeyframes=[],this.responsiveLayout=new p.bN,this.enableColorMatchAdjust=!1,this.enableColorCorrectAdjust=!1,this.enableAdjustMask=!0,this.rawSegmentId="",this.enableVideoMask=!0,this.offset=0n,(0,a.tZ)(this,e,g)}}let _={common:["id","desc","state","is_loop","is_tone_modify","reverse","intensifies_audio","cartoon","volume","last_nonzero_volume","material_id","render_index","enable_lut","enable_adjust","enable_hsl","visible","group_id","enable_color_curves","track_render_index","enable_color_wheels","track_attribute","is_placeholder","template_id","enable_smart_color_adjust","template_scene","enable_color_match_adjust","enable_color_correct_adjust","enable_adjust_mask","raw_segment_id","enable_video_mask"],bigint:{offset:{}},array:{extra_material_refs:{type:"common"},keyframe_refs:{type:"common"},common_keyframes:{type:"object",clsName:()=>c.ko}},object:{source_timerange:{type:()=>o.ze,nullable:!0},target_timerange:{type:()=>o.ze},render_timerange:{type:()=>o.ze},clip:{type:()=>l.tL,nullable:!0},uniform_scale:{type:()=>u.Rp,nullable:!0},hdr_settings:{type:()=>d.Gm,nullable:!0},caption_info:{type:()=>h.Lh,nullable:!0},responsive_layout:{type:()=>p.Xy},lyric_keyframes:{type:()=>m.WB,nullable:!0}}},v=(0,a.I2)(_,["offset"]);class k{static deserialize(e){let t=new k;return(0,a.Tz)(t,e,_,!0),t}static serialize(e){return(0,a.o8)(e,_,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new k;return(0,a.he)(this,t,_,e,["id"],!0),null!==this.offset&&void 0!==this.offset&&(t.offset=this.offset),t}constructor(e={}){this[s._n]=y,(0,a.fZ)(this,e,v)}}},264585:function(e,t,i){"use strict";i.d(t,{cG:function(){return d},k6:function(){return o}});var r=i(669686),n=i(150251);let a={common:["fps"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.fps=30,(0,r.tZ)(this,e,s)}}let l={common:["fps"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},194877:function(e,t,i){"use strict";i.d(t,{lD:function(){return o},vu:function(){return d}});var r=i(669686),n=i(150251);let a={common:["theme","style","need_order","screen_info","prompt_version"],bigint:{video_duration:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.theme="",this.style="",this.videoDuration=0n,this.needOrder=!1,this.screenInfo="",this.promptVersion="",(0,r.tZ)(this,e,s)}}let l={common:["theme","style","need_order","screen_info","prompt_version"],bigint:{video_duration:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},156447:function(e,t,i){"use strict";i.d(t,{IB:function(){return l},un:function(){return c}});var r=i(669686),n=i(150251),a=i(180942);let s={common:["stable_level","matrix_path"],object:{time_range:{type:()=>a.tn}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.stableLevel=0,this.matrixPath="",this.timeRange=new a.tn,(0,r.tZ)(this,e,o)}}let u={common:["stable_level","matrix_path"],object:{time_range:{type:()=>a.ze}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},527347:function(e,t,i){"use strict";i.d(t,{Of:function(){return l},ng:function(){return c}});var r=i(669686),n=i(150251),a=i(30145);let s={array:{range:{type:"object",clsName:()=>a.SV}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.range=[],(0,r.tZ)(this,e,o)}}let u={array:{range:{type:"object",clsName:()=>a.SV}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},942360:function(e,t,i){"use strict";i.d(t,{lT:function(){return o}});var r=i(669686),n=i(150251);let a={common:["material_id","video_width","video_height"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.materialId="",this.videoWidth=0,this.videoHeight=0,(0,r.tZ)(this,e,s)}}let l={common:["material_id","video_width","video_height"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},551081:function(e,t,i){"use strict";i.d(t,{Hy:function(){return d},IY:function(){return o}});var r=i(669686),n=i(150251);let a={bigint:{width:{},height:{}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.width=0n,this.height=0n,(0,r.tZ)(this,e,s)}}let l={bigint:{width:{},height:{}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},862807:function(e,t,i){"use strict";i.d(t,{MS:function(){return y},en:function(){return k}});var r=i(669686),n=i(150251),a=i(179849),s=i(796760),o=i(776320),l=i(431567),u=i(166234),d=i(351421),c=i(25588),h=i(283482),p=i(60041),m=i(977209);let f={common:["subtitle_visible"],bigint:{version:{}},array:{chapters:{type:"object",clsName:()=>u.BC},material_ids:{type:"object",clsName:()=>d.DP},short_text_ids:{type:"object",clsName:()=>c.jU}},object:{midvideo_feed_info:{type:()=>a.GC},midvideo_info:{type:()=>s.e$},prompt:{type:()=>o.Qe},prompt_inp:{type:()=>l.R8},subtitle_info:{type:()=>h.yf,nullable:!0},voice_over_tone_info:{type:()=>p.NP,nullable:!0},script_info:{type:()=>m.Vl,nullable:!0}}},g=(0,r.I2)(f,[]);class y extends n.w8{static deserialize(e){let t=new y;return(0,r.Tz)(t,e,f),t}static serialize(e){return(0,r.o8)(e,f)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new y;return(0,r.he)(this,t,f,e),t}constructor(e={}){super(),this[n.I9]=k,this.version=0n,this.midvideoFeedInfo=new a.GC,this.midvideoInfo=new s.e$,this.prompt=new o.Qe,this.promptInp=new l.R8,this.chapters=[],this.materialIds=[],this.shortTextIds=[],this.subtitleVisible=!0,(0,r.tZ)(this,e,g)}}let _={common:["subtitle_visible"],bigint:{version:{}},array:{chapters:{type:"object",clsName:()=>u.BC},material_ids:{type:"object",clsName:()=>d.DP},short_text_ids:{type:"object",clsName:()=>c.jU}},object:{midvideo_feed_info:{type:()=>a.bq},midvideo_info:{type:()=>s.Gz},prompt:{type:()=>o.Lt},prompt_inp:{type:()=>l.f_},subtitle_info:{type:()=>h.f$,nullable:!0},voice_over_tone_info:{type:()=>p.ft,nullable:!0},script_info:{type:()=>m.Dt,nullable:!0}}},v=(0,r.I2)(_,[]);class k extends n.u2{static deserialize(e){let t=new k;return(0,r.Tz)(t,e,_,!0),t}static serialize(e){return(0,r.o8)(e,_,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new k;return(0,r.he)(this,t,_,e,!1,!0),t}constructor(e={}){super(),this[n._n]=y,(0,r.fZ)(this,e,v)}}},746429:function(e,t,i){"use strict";i.d(t,{GR:function(){return d},xE:function(){return o}});var r=i(669686),n=i(150251);let a={common:["path","scale","alpha","angle","blend","range","fill"],array:{flip:{type:"common"}}},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.path="",this.flip=[],this.scale=1,this.alpha=1,this.angle=90,this.blend="no",this.range=4,this.fill="tile",(0,r.tZ)(this,e,s)}}let l={common:["path","scale","alpha","angle","blend","range","fill"],array:{flip:{type:"common"}}},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},468634:function(e,t,i){"use strict";i.d(t,{Rp:function(){return d},_p:function(){return o}});var r=i(669686),n=i(150251);let a={common:["on","value"]},s=(0,r.I2)(a,[]);class o extends n.w8{static deserialize(e){let t=new o;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new o;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=d,this.on=!0,this.value=1,(0,r.tZ)(this,e,s)}}let l={common:["on","value"]},u=(0,r.I2)(l,[]);class d extends n.u2{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=o,(0,r.fZ)(this,e,u)}}},215040:function(e,t,i){"use strict";i.d(t,{ak:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let s={common:["id","effect_id","resource_id","name","vip_status","type","custom_type","panel","category_id","category_name","request_id","source_platform","icon_url","segment_id","combination_segment_id","from_template_id"],array:{ref_ids:{type:"common"}}},o=(0,n.I2)(s,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=c,this.id="",this.effectId="",this.resourceId="",this.name="",this.vipStatus=r.Dy.VipStatusUnknown,this.type=r.cV.MetaTypeNone,this.customType="",this.panel="",this.categoryId="",this.categoryName="",this.requestId="",this.sourcePlatform=r.nj.EffectPlatformLoki,this.iconUrl="",this.segmentId="",this.combinationSegmentId="",this.refIds=[],this.fromTemplateId="",(0,n.tZ)(this,e,o)}}let u={common:["id","effect_id","resource_id","name","vip_status","type","custom_type","panel","category_id","category_name","request_id","source_platform","icon_url","segment_id","combination_segment_id","from_template_id"],array:{ref_ids:{type:"common"}}},d=(0,n.I2)(u,[]);class c extends a.u2{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,d)}}},991913:function(e,t,i){"use strict";i.d(t,{Wl:function(){return c},ic:function(){return l}});var r=i(669686),n=i(150251),a=i(110219);let s={common:["web_cover_json_path","origin_image_path"],array:{materials:{type:"object",clsName:()=>a.Zb}}},o=(0,r.I2)(s,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=c,this.materials=[],this.webCoverJsonPath="",this.originImagePath="",(0,r.tZ)(this,e,o)}}let u={common:["web_cover_json_path","origin_image_path"],array:{materials:{type:"object",clsName:()=>a.Zb}}},d=(0,r.I2)(u,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,d)}}},859874:function(e,t,i){"use strict";i.d(t,{c:()=>c});var r=i("150251"),n=i("645869"),a=i("240156"),s=i("268932"),o=i("481631");class l{getAiStoryAllAlternativeMaterials(){return this._getAttachmentDocument().materials}getAiStoryAlternativeMaterialBySegmentId(e){return this._getAttachmentDocument().materials.get(e)}getAiStoryAlternativeMaterialBySegmentIdAndAlternativeId(e,t){let i=this._getAttachmentDocument().materials.get(e);if(!!i)return i.alternatives.find(e=>{let{id:i}=e;return t===i})}getAiStoryAlternativeMaterialByAlternativeId(e){for(let t of this._getAttachmentDocument().materials.values()){let i=t.alternatives.find(t=>t.id===e);if(i)return i}}getAiStoryAlternativeMaterialAtPositionByAlternativeId(e){for(let[t,i]of this._getAttachmentDocument().materials.entries()){let r=i.alternatives.find(t=>t.id===e);if(r)return{segmentId:t,alternativeId:e,alternative:r}}}getAiStoryGlobalConfig(){return this._getAttachmentDocument().globalConfig}getAiStoryId(){return this.getAiStoryGlobalConfig().storyId}getAiStoryMeta(){return this._getAttachmentDocument().meta}getAiStoryAlternativeMaterialStatusBySegmentId(e,t){var i,r;let n=t.getSegmentById(e);if(!n||!(0,o.he)(n))return;let a=null===(r=this.getAiStoryAlternativeMaterialBySegmentId(e))||void 0===r?void 0:null===(i=r.alternatives)||void 0===i?void 0:i.find(e=>n.material.aigcHistoryId===e.aigcHistoryId&&n.material.aigcItemId===e.aigcItemId);if(a)return a.taskStatus}getAiStoryCurrentAlternativeMaterialBySegmentId(e,t){var i,r;let n=t.getSegmentById(e);if(!n||!(0,o.he)(n))return;let a=null===(r=this.getAiStoryAlternativeMaterialBySegmentId(e))||void 0===r?void 0:null===(i=r.alternatives)||void 0===i?void 0:i.find(e=>n.material.aigcHistoryId===e.aigcHistoryId&&n.material.aigcItemId===e.aigcItemId);if(!!a)return a}constructor(e){this._getAttachmentDocument=e}}var u=i("283751"),d=i("211561");class c{static deserialize(e){let t=new c;return t.recovery(a.z8.deserialize(e)),t}static serialize(e){return a.z8.serialize(e.archive())}recovery(e){let t=n.T.toModelAttachmentAiStory(e);this.materials=t.materials,this.globalConfig=t.globalConfig,this.meta=t.meta,this.version=t.version}archive(){return n.T.toPersistentAttachmentAiStory(this)}clone(e){return new c({materials:Array.from(this.materials.entries()).reduce((t,i)=>{let[r,n]=i;return t.set(r,n.clone(e)),t},new Map),globalConfig:this.globalConfig.clone(e),meta:this.meta.clone(e),version:this.version})}insertMaterial(e){this.materials.set(e.segmentId,e)}deleteMaterial(e){this.materials.delete(e)}updateMaterial(e,t){let i=this.query.getAiStoryAlternativeMaterialBySegmentId(e),r=t.clone();u.T.merge(i,t,r)}updateGlobalConfig(e){let t=new s.Wr;return u.T.merge(this.globalConfig,e,t),t}updateMeta(e){let t=new d.v3W;return u.T.merge(this.meta,e,t),t}constructor(e){this[r.I9]=null,this.query=new l(()=>this),this.version=new a.z8().version,this.materials=new Map,this.globalConfig=new s.z4,this.meta=new d.P7_,(null==e?void 0:e.materials)&&(this.materials=e.materials),(null==e?void 0:e.globalConfig)&&(this.globalConfig=new s.z4(e.globalConfig)),(null==e?void 0:e.meta)&&(this.meta=new d.P7_(e.meta)),(null==e?void 0:e.version)&&(this.version=null==e?void 0:e.version)}}},744207:function(e,t,i){"use strict";i.d(t,{k:function(){return h},q:function(){return d}});var r=i(918783),n=i(379012),a=i(903849),s=i(669686),o=i(150251),l=i(211561);let u=r.Y9;class d extends u{static deserialize(e,t){let i=new d;for(let e of Object.keys(t))i[e]=t[e];if(t.coverDraftId){let r=(0,a.t0)(e.materials,"drafts",[t.coverDraftId]);r&&(i.coverDraft=r)}return i}static serialize(e,t){let i=new r.Y9;for(let e of Object.keys(t))i[e]=t[e];return t.coverDraft&&((0,a.af)(e.materials,"drafts",t.coverDraft),i.coverDraftId=t.coverDraft.id),i}clone(){var e,t,i;let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new d;return n.type=this.type,n.subType=this.subType,n.coverTemplate=null===(e=this.coverTemplate)||void 0===e?void 0:e.clone(r),n.coverDraftId=this.coverDraftId,n.webCoverInfo=null===(t=this.webCoverInfo)||void 0===t?void 0:t.clone(r),n.coverDraft=null===(i=this.coverDraft)||void 0===i?void 0:i.clone(r),n}constructor(...e){super(...e),this[o.I9]=h}}let c=new Set(["coverDraft","type"]);class h extends r.yO{static deserialize(e){let t=new h;return e.coverDraft&&(t.coverDraft=n.rd.deserialize(e.coverDraft)),e.coverDraftId&&(t.coverDraftId=e.coverDraftId),e.coverTemplate&&(t.coverTemplate=l.wbm.deserialize(e.coverTemplate)),e.subType&&(t.subType=e.subType),e.type&&(t.type=e.type),e.webCoverInfo&&(t.webCoverInfo=l.WlO.deserialize(e.webCoverInfo)),t}static serialize(e){return{coverDraft:e.coverDraft?n.rd.serialize(e.coverDraft):void 0,coverDraftId:e.coverDraftId,coverTemplate:e.coverTemplate?l.wbm.serialize(e.coverTemplate):void 0,subType:e.subType,type:e.type,webCoverInfo:e.webCoverInfo?l.WlO.serialize(e.webCoverInfo):void 0}}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;for(let e of Object.keys(this))t[e]=this[e];return this.coverTemplate&&(t.coverTemplate=this.coverTemplate.clone(e)),this.coverDraft&&(t.coverDraft=this.coverDraft.clone(e)),t}constructor(e={}){super(e),this[o._n]=d,(0,s.fZ)(this,e,c)}}},571592:function(e,t,i){"use strict";i.d(t,{$X:function(){return r.$},D8:function(){return r.D},ES:function(){return o.E},Es:function(){return d.E},GQ:function(){return d.G},Ie:function(){return f.I},J5:function(){return u.J},K8:function(){return s.K},LN:function(){return h.L},Lq:function(){return h.t},Ni:function(){return s.N},O_:function(){return c.O},RV:function(){return m.R},S_:function(){return y.S},TK:function(){return l.T},VN:function(){return n.V},Wu:function(){return n.W},Z7:function(){return p.Z},a4:function(){return g.a},cR:function(){return f.c},eQ:function(){return y.e},eZ:function(){return c.e},ec:function(){return l.e},fp:function(){return a.f},gs:function(){return g.g},hK:function(){return o.h},n8:function(){return u.n},qX:function(){return a.q},tm:function(){return p.t},wY:function(){return m.w}});var r=i(181874),n=i(304126),a=i(678016),s=i(704738),o=i(742143),l=i(774902),u=i(882185),d=i(595883),c=i(706368),h=i(140820),p=i(620678),m=i(368708),f=i(38702),g=i(610845),y=i(454653)},283751:function(e,t,i){"use strict";i.d(t,{S:function(){return s},T:function(){return l}});var r=i(150251);let n=e=>{let t=Object.prototype.toString.call(e);return"[object String]"===t||"[object Boolean]"===t||"[object Number]"===t||"[object Symbol]"===t||"[object BigInt]"===t||!1},a=["__segment_struct_type",r.I9,r._n],s=e=>!!(null==e?void 0:e[r._n]),o=e=>e&&0===Object.keys(e).filter(e=>!a.includes(e)).length;class l{static merge(e,t,i){for(let u in t){let d=null==t?void 0:t[u];if(a.includes(u))continue;if((null===e[u]||void 0===e[u])&&s(d)){if(i){let t=new((0,r.A9)(d)),{constructor:n}=d;e[u]=l.merge(t,d,new n),i[u]=e[u]}else e[u]=d;continue}if(void 0!==t[u]){if(null===t[u]){null!==e[u]&&void 0!==e[u]&&i&&(i[u]=null),e[u]=i?void 0:null;continue}if(null===e[u]||void 0===e[u]){e[u]!==t[u]&&i&&(i[u]=t[u]),e[u]=t[u];continue}if(n(t[u])){e[u]!==t[u]&&i?i[u]=t[u]:null==i||delete i[u],e[u]=t[u];continue}if(Array.isArray(t[u])){i&&(i[u]=t[u]),0===e[u].length&&0===t[u].length&&(null==i||delete i[u]),e[u]=t[u];continue}if("object"==typeof t[u]&&"object"==typeof e[u]){let{constructor:r}=t[u],n=new r;e[u]=l.merge(e[u],t[u],i?n:void 0),i&&(i[u]=n),o(n)&&(null==i||delete i[u]);continue}"object"!=typeof e[u]&&(e[u]=t[u],i&&(i[u]=t[u]))}}return e}static pick(e,t,i){for(let r in t){if(!(void 0===t[r]||a.includes(r))){if(null===e[r]||void 0===e[r]){t[r]?i[r]=null:i[r]=void 0;continue}if(n(t[r])||null===t[r]||Array.isArray(t[r])){i[r]=e[r];continue}if(s(t[r])){let n=new t[r].constructor;i[r]=l.pick(e[r],t[r],n);continue}if("object"==typeof t[r]&&"object"==typeof e[r]){let{constructor:n}=t[r];i[r]=l.pick(e[r],t[r],new n);continue}"object"!=typeof e[r]&&(i[r]=e[r])}}return i}}},381119:function(e,t,i){"use strict";i.d(t,{Q:function(){return v}});var r=i(282192),n=i(331509),a=i(211561),s=i(475028),o=i(690613),l=i(800788),u=i(340294),d=i(198544),c=i(76592),h=i(419537);let p=(0,s.i)(d.m.InsertAttachmentKeyDuplication,"");class m{check(e){return void 0!==this.getData(e)?p(`attachment key duplication: ${this.key}`):(0,o.ly)()}constructor(e){this.key=e}}class f extends m{static deserialize(e){return new f(e.key,a.I8_.deserialize(e.value))}serialize(){return{key:this.key,value:Object.getPrototypeOf(this.value).constructor.serialize(this.value)}}getInvertMutation(e){return new c.h({attachmentKey:n.d3.AsyncTask,key:this.key})}getData(e){return e.getAsyncTask(this.key)}insertData(e){e.attachmentAsyncTask.asyncTaskMap.set(this.key,this.value)}transform(e,t,i){return[e]}constructor(e,t){super(e),this.key=e,this.value=t}}class g extends m{static deserialize(e){return new g(e.key,a.e_Q.deserialize(e.value))}serialize(){return{key:this.key,value:Object.getPrototypeOf(this.value).constructor.serialize(this.value)}}getInvertMutation(e){return new c.h({attachmentKey:n.d3.VideoAlgorithm,key:this.key})}getData(e){return e.getVideoAlgorithm(this.key)}insertData(e){e.attachmentVideoAlgorithms.algorithms.set(this.key,this.value)}transform(e,t,i){return[e]}constructor(e,t){super(e),this.key=e,this.value=t}}class y extends m{static deserialize(e){return new y(e.key,a.C8D.deserialize(e.value))}serialize(){return{key:this.key,value:Object.getPrototypeOf(this.value).constructor.serialize(this.value)}}getInvertMutation(e){return new c.h({attachmentKey:n.d3.AiWriter,key:this.key})}getData(e){return e.getAiWriterInfo(this.key)}insertData(e){e.attachmentAiWriter.aiWriterInfos.set(this.key,this.value)}transform(e,t,i){return[e]}constructor(e,t){super(e),this.key=e,this.value=t}}class _ extends m{static deserialize(e){return new _(e.key,{...e.value,material:a.bvB.deserialize(e.value.material)})}serialize(){return{key:this.key,value:{draftId:this.value.draftId,trackIndex:this.value.trackIndex,trackId:this.value.trackId,material:Object.getPrototypeOf(this.value.material).constructor.serialize(this.value.material)}}}getInvertMutation(e){return new c.h({attachmentKey:n.d3.AiStoryAlternativeMaterial,key:this.key})}getData(e){return e.getAiStoryAlternativeMaterialBySegmentId(this.key)}insertData(e){let t=this.value.material.clone();t.segmentId=this.key,e.attachmentAiStory.insertMaterial(t)}transform(e,t,i){let n={[r.x1.DeleteSegment]:this._transformWithDeleteSegmentMutation.bind(this,e,t,i),[r.x1.InsertTrack]:this._transformWithInsertTrackMutation.bind(this,e,t,i),[r.x1.DeleteTrack]:this._transformWithDeleteTrackMutation.bind(this,e,t,i),[r.x1.AttachmentInsertMutation]:this._transformWithAttachmentInsertMutation.bind(this,e,t,i)};return n[t.type]?n[t.type]():[e]}_transformWithDeleteSegmentMutation(e,t,i){let{key:r}=e.options,{segmentId:n}=t;return r===n?[]:[e]}_transformWithInsertTrackMutation(e,t,i){let{trackId:r,trackIndex:n,material:a,draftId:s}=e.options.value,{trackIndex:o}=t;return n>=o&&i?[new v({key:e.options.key,attachmentKey:e.options.attachmentKey,value:{trackId:r,draftId:s,trackIndex:n+1,material:a}})]:[e]}_transformWithDeleteTrackMutation(e,t,i){let{trackId:r,trackIndex:n,material:a,draftId:s}=e.options.value,{trackIndex:o}=t;return n>o&&i?[new v({key:e.options.key,attachmentKey:e.options.attachmentKey,value:{trackId:r,draftId:s,trackIndex:n-1,material:a}})]:[e]}_transformWithAttachmentInsertMutation(e,t,i){if(e.options.key!==t.options.key)return[e];let r=t.options.value,s=e.options.value,o=new a.mNK({segmentId:e.options.key,alternatives:s.material.alternatives});return[new h.K({attachmentKey:n.d3.AiStoryAlternativeMaterial,key:e.options.key,type:n.be.ADD,index:i?r.material.alternatives.length:0,trackIndex:s.trackIndex,delta:o,draftId:s.draftId})]}constructor(e,t){super(e),this.key=e,this.value=t}}class v extends r.mm{static deserialize(e){let t;switch(e.attachmentKey){case n.d3.AsyncTask:{let i=f.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,value:i.value};break}case n.d3.VideoAlgorithm:{let i=g.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,value:i.value};break}case n.d3.AiWriter:{let i=y.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,value:i.value};break}case n.d3.AiStoryAlternativeMaterial:{let i=_.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,value:i.value};break}case n.d3.AiStoryGlobalId:(0,l.Y2)(!1,"couldn't insert ai-story id");case n.d3.AiStoryMeta:(0,l.Y2)(!1,"couldn't insert ai story meta");case n.d3.AiCreator:(0,l.Y2)(!1,"ai creator only set[update]");default:(0,l.bP)(e.attachmentKey)}return new v(t)}static serialize(e){let t={attachmentKey:e.options.attachmentKey,data:e.executor.serialize(),version:e.version,type:e.type};return u.HH.stringify(t)}get type(){return v.type}invert(e){return[this.executor.getInvertMutation(e)]}transform(e,t){return this.executor.transform(this,e,t)}clone(){return new v(this.options)}check(e){return this.executor.check(e)}runOnModel(e){this.executor.insertData(e)}constructor(e){switch(super(),this.options=e,e.attachmentKey){case n.d3.AsyncTask:this.executor=new f(e.key,e.value);break;case n.d3.VideoAlgorithm:this.executor=new g(e.key,e.value);break;case n.d3.AiWriter:this.executor=new y(e.key,e.value);break;case n.d3.AiStoryAlternativeMaterial:this.executor=new _(e.key,e.value);break;default:(0,l.bP)(e)}}}v.type=r.x1.AttachmentInsertMutation},419537:function(e,t,i){"use strict";i.d(t,{K:function(){return o}});var r=i(282192),n=i(331509),a=i(800788),s=i(340294);class o extends r.mm{static deserialize(e){let t;switch(e.attachmentKey){case n.d3.AsyncTask:{let i=n.WL.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta};break}case n.d3.VideoAlgorithm:{let i=n.r$.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta};break}case n.d3.AiWriter:{let i=n.wG.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta};break}case n.d3.AiStoryAlternativeMaterial:{let i=n.ds.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta,index:i.index,draftId:i.draftId,type:i.type,trackIndex:i.trackIndex};break}case n.d3.AiStoryGlobalId:{let i=n.fx.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta};break}case n.d3.AiStoryMeta:{let i=n.$s.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta};break}case n.d3.AiCreator:{let i=n.zq.deserialize(e.data);t={attachmentKey:e.attachmentKey,key:i.key,delta:i.delta};break}default:(0,a.bP)(e.attachmentKey)}return new o(t)}static serialize(e){let t={attachmentKey:e.options.attachmentKey,data:e.executor.serialize(),version:e.version,type:e.type};return s.HH.stringify(t)}get type(){return o.type}invert(e){return[this.executor.getInvertMutation(e)]}transform(e,t){return this.executor.transform(this,e,t)}clone(){return new o(this.options)}check(e){return this.executor.check(e)}runOnModel(e){this.executor.setData(e)}constructor(e){switch(super(),this.options=e,e.attachmentKey){case n.d3.AsyncTask:this.executor=new n.WL(e.key,e.delta);break;case n.d3.VideoAlgorithm:this.executor=new n.r$(e.key,e.delta);break;case n.d3.AiWriter:this.executor=new n.wG(e.key,e.delta);break;case n.d3.AiStoryAlternativeMaterial:this.executor=new n.ds(e.key,e.delta,e.index,e.trackIndex,e.draftId,e.type);break;case n.d3.AiStoryGlobalId:this.executor=new n.fx(e.key,e.delta);break;case n.d3.AiStoryMeta:this.executor=new n.$s(e.key,e.delta);break;case n.d3.AiCreator:this.executor=new n.zq(e.key,e.delta);break;default:(0,a.bP)(e)}}}o.type=r.x1.AttachmentUpdateMutation},121684:function(e,t,i){"use strict";i.d(t,{r:function(){return u}});var r=i(690613),n=i(283751),a=i(932422),s=i(392742),o=i(211561),l=i(340294);class u extends a.m{static deserialize(e){let t=new u({groupContainerDelta:e.groupContainerDelta?o.k_B.deserialize(e.groupContainerDelta):null});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";if(e.groupContainerDelta){let i=o.k_B.serialize(e.groupContainerDelta);t+=`"groupContainerDelta":${l.HH.stringify(i)},`}return t+=`"version":"${e.version}","type":${e.type}}`}invert(e){if(!e.groupContainer)return[new u({groupContainerDelta:null})];if(!this.groupContainerDelta)return[new u({groupContainerDelta:new o.k_B(e.groupContainer.clone())})];{let t=new o.k_B;return[new u({groupContainerDelta:new o.k_B(n.T.pick(e.groupContainer,this.groupContainerDelta,t))})]}}transform(e,t){return[this]}check(e){return(0,r.ly)()}runOnModel(e){e.updateGroupContainer(this.groupContainerDelta)}clone(){return new u({groupContainerDelta:this.groupContainerDelta})}constructor(e){super(),this.type=s.x.SetGroupContainerProperty,this.groupContainerDelta=e.groupContainerDelta}}},313934:function(e,t,i){"use strict";i.d(t,{j:function(){return m}});var r=i(932422),n=i(198544),a=i(392742),s=i(599446),o=i(121684),l=i(475028),u=i(690613),d=i(211561),c=i(340294),h=i(699791);let p=(0,l.i)(n.m.DeleteSegmentIdNotExist,"");class m extends r.m{static deserialize(e){let t=new m({...e,targetTimerange:d.tnv.deserialize(e.targetTimerange)});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";e.draftId&&(t+=`"draftId":"${e.draftId}",`),t+=`"trackId":"${e.trackId}","trackIndex":${e.trackIndex},"segmentId":"${e.segmentId}",`;let i=d.tnv.serialize(e.targetTimerange);return t+=`"targetTimerange":${c.HH.stringify(i)},"version":"${e.version}","type":${e.type}}`}invert(e){var t;let i=null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e,r=i.getSegmentByTrackIdAndSegmentId(this.trackId,this.segmentId).clone(),n=i.getGroupBySegmentId(this.segmentId),a=[];if((null==n?void 0:n.groupMembers)&&i.groupContainer){let e=new d.k_B;e.groups=i.groupContainer.groups.map(e=>{if(e.id===n.id){let t=e.clone();return t.groupMembers.push(this.segmentId),t}return e}),new o.r({groupContainerDelta:e})}return a.push(new s._({draftId:this.draftId,trackId:this.trackId,trackIndex:this.trackIndex,segment:r})),a}transform(e,t){let i={[a.x.InsertSegment]:this._transformWithInsertSegmentMutation.bind(this,e),[a.x.DeleteSegment]:this._transformWithDeleteSegmentMutation.bind(this,e,t),[a.x.MoveSegment]:this._transformWithMoveSegmentMutation.bind(this,e,t),[a.x.InsertTrack]:this._transformWithInsertTrackMutation.bind(this,e,t),[a.x.DeleteTrack]:this._transformWithDeleteTrackMutation.bind(this,e,t),[a.x.UpdateTrack]:this._transformWithUpdateTrackMutation.bind(this,e,t)};return i[e.type]?i[e.type]():[this]}check(e){var t;return(null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e).getSegmentByTrackIdAndSegmentId(this.trackId,this.segmentId)?(0,u.ly)():p(`segment not exist: ${this.segmentId}`)}runOnModel(e){var t;(null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e).deleteSegment(this.trackId,this.segmentId)}_transformWithInsertSegmentMutation(e){let{targetTimerange:t,trackId:i,trackIndex:r,draftId:n,segmentId:a}=this,{trackId:s,segment:o}=e,{targetTimerange:l}=o;return i!==s||0!==r?[this]:t.start>l.start?[new m({draftId:n,trackId:i,trackIndex:r,segmentId:a,targetTimerange:new d.tnv({start:t.start+l.duration,duration:t.duration})})]:[this]}_transformWithDeleteSegmentMutation(e,t){let{targetTimerange:i,trackId:r,trackIndex:n,draftId:a,segmentId:s}=this,{targetTimerange:o,trackId:l,segmentId:u}=e;return s===u?[]:r!==l||0!==n?[this]:i.start>o.start?[new m({draftId:a,trackId:r,trackIndex:n,segmentId:s,targetTimerange:new d.tnv({start:i.start-o.duration,duration:i.duration})})]:[this]}_transformWithMoveSegmentMutation(e,t){let{targetTimerange:i,trackId:r,trackIndex:n,draftId:a,segmentId:s}=this,{srcTrackIndex:o,desTrackIndex:l,srcTargetTimeRanges:u,desTargetTimeRanges:d,segmentIds:c,desTrackId:p,srcTrackId:f}=e;if(r!==f&&r!==p)return[this];let g=c.indexOf(s);if(-1!==g)return[new m({draftId:a,trackId:p,trackIndex:l,segmentId:s,targetTimerange:d[g]})];let y=i.clone(!1);return n===o&&0===n&&u.forEach(e=>{i.start>e.start&&(y.start-=e.duration)}),n===l&&d.forEach(e=>{let r=e.start+e.duration;if(0===n&&(i.start>e.start||i.start===e.start&&t))y.start+=e.duration;else if(0!==n&&((0,h.D)(e,i)||t&&i.start===e.start)){let e=r-i.start;y.start+=e}}),[new m({draftId:a,trackId:r,trackIndex:n,segmentId:s,targetTimerange:y})]}_transformWithInsertTrackMutation(e,t){let{trackId:i,trackIndex:r,segmentId:n,draftId:a,targetTimerange:s}=this,{trackIndex:o}=e;return r>=o?[new m({trackId:i,trackIndex:r+1,segmentId:n,draftId:a,targetTimerange:s})]:[this]}_transformWithDeleteTrackMutation(e,t){let{trackId:i,trackIndex:r,segmentId:n,draftId:a,targetTimerange:s}=this,{trackIndex:o,trackId:l}=e;return i===l?[]:r>o?[new m({trackId:i,trackIndex:r-1,segmentId:n,draftId:a,targetTimerange:s})]:[this]}_transformWithUpdateTrackMutation(e,t){var i;let{trackId:r,segmentId:n}=this,{trackDelta:a,trackId:s}=e;return r!==s||(null===(i=a.segments)||void 0===i?void 0:i.length)&&a.segments.find(e=>e.id===n)?[this]:[]}clone(){return new m({draftId:this.draftId,trackId:this.trackId,trackIndex:this.trackIndex,segmentId:this.segmentId,targetTimerange:this.targetTimerange})}constructor(e){super(),this.type=a.x.DeleteSegment,this.draftId=e.draftId,this.trackId=e.trackId,this.trackIndex=e.trackIndex,this.segmentId=e.segmentId,this.targetTimerange=e.targetTimerange}}},575016:function(e,t,i){"use strict";i.d(t,{B:function(){return g}});var r=i(475028),n=i(690613),a=i(211561),s=i(932422),o=i(198544),l=i(392742),u=i(340294),d=i(282192),c=i(333217);let h=(0,r.i)(o.m.MoveSegmentSrcIndexInvalid,""),p=(0,r.i)(o.m.MoveSegmentDesIndexInvalid,""),m=(0,r.i)(o.m.MoveSegmentParamArrayLengthInvalid,""),f=(0,r.i)(o.m.MoveSegmentTargetTimerangeInvalid,"");class g extends s.m{static deserialize(e){let t=new g({...e,srcTargetTimeRanges:e.srcTargetTimeRangesData.map(e=>a.tnv.deserialize(e)),desTargetTimeRanges:e.desTargetTimeRangesData.map(e=>a.tnv.deserialize(e))});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";t+=`"segmentIds":${JSON.stringify(e.segmentIds)},"srcTrackIndex":${e.srcTrackIndex},"desTrackIndex":${e.desTrackIndex},"srcTrackId":"${e.srcTrackId}","desTrackId":"${e.desTrackId}",`;let i=e.srcTargetTimeRanges.map(e=>a.tnv.serialize(e));t+=`"srcTargetTimeRangesData":${u.HH.stringify(i)},`;let r=e.desTargetTimeRanges.map(e=>a.tnv.serialize(e));return t+=`"desTargetTimeRangesData":${u.HH.stringify(r)},"version":"${e.version}","type":${e.type}}`}invert(e){return[new g({segmentIds:this.segmentIds,srcTrackIndex:this.desTrackIndex,desTrackIndex:this.srcTrackIndex,srcTrackId:this.srcTrackId,desTrackId:this.desTrackId,srcTargetTimeRanges:this.desTargetTimeRanges.map(e=>e.clone()),desTargetTimeRanges:this.srcTargetTimeRanges.map(e=>e.clone())})]}transform(e,t){let i={[l.x.InsertSegment]:this._transformWithInsertSegmentMutation.bind(this,e,t),[l.x.DeleteSegment]:this._transformWithDeleteSegmentMutation.bind(this,e,t),[l.x.MoveSegment]:this._transformWithMoveSegmentMutation.bind(this,e,t),[l.x.UpdateSegment]:this._transformWithUpdateSegmentMutation.bind(this,e,t),[l.x.InsertTrack]:this._transformWithInsertTrackMutation.bind(this,e,t),[l.x.DeleteTrack]:this._transformWithDeleteTrackMutation.bind(this,e,t),[l.x.MoveTrack]:this._transformWithMoveTrackMutation.bind(this,e,t)};return i[e.type]?i[e.type]():[this]}check(e){if(!(this.srcTrackIndex>=0&&this.srcTrackIndex<e.tracks.length))return h(`srcIndex not valid: ${this.srcTrackIndex}`);if(!(this.desTrackIndex>=0&&this.desTrackIndex<e.tracks.length))return p(`desIndex not valid: ${this.desTrackIndex}`);if(this.segmentIds.length<=0||this.segmentIds.length!==this.srcTargetTimeRanges.length||this.segmentIds.length!==this.desTargetTimeRanges.length)return m(`segmentIds length: ${this.segmentIds.length}, srcTargetTimeRanges length: ${this.srcTargetTimeRanges.length}, desTargetTimeRanges\u{FF1A} ${this.desTargetTimeRanges.length}`);for(let e=0;e<this.srcTargetTimeRanges.length;e++){if(this.srcTargetTimeRanges[e].start<0n||this.srcTargetTimeRanges[e].duration<0n)return f(`src time range not valid ${this.srcTargetTimeRanges[e]}`);if(this.desTargetTimeRanges[e].start<0n||this.desTargetTimeRanges[e].duration<0n)return f(`des time range not valid ${this.desTargetTimeRanges[e]}`)}return(0,n.ly)()}runOnModel(e){e.moveSegments(this.segmentIds,this.srcTrackIndex,this.desTrackIndex,this.desTargetTimeRanges.map(e=>e.clone()))}_transformWithInsertSegmentMutation(e,t){let{srcTrackIndex:i,desTrackIndex:r,srcTargetTimeRanges:n,desTargetTimeRanges:a,segmentIds:s,srcTrackId:o,desTrackId:l}=this,{trackId:u,segment:c,trackIndex:h}=e,{targetTimerange:p}=c;if(u!==o&&u!==l)return[this];let m=n.map(e=>e.clone(!1)),f=a.map(e=>e.clone(!1));return h===i&&0===h&&m.forEach(e=>{p.start<=e.start&&(e.start+=p.duration)}),h===r&&f.forEach(e=>{let t=p.start+p.duration;if(0===h&&p.start<=e.start)e.start+=e.duration;else if(0!==h&&(0,d.DG)(p,e)){let i=t-e.start;e.start+=i}}),[new g({segmentIds:s,srcTrackIndex:i,srcTrackId:o,desTrackIndex:r,desTrackId:l,srcTargetTimeRanges:m,desTargetTimeRanges:f})]}_transformWithDeleteSegmentMutation(e,t){let{srcTrackIndex:i,desTrackIndex:r,srcTargetTimeRanges:n,desTargetTimeRanges:a,segmentIds:s,srcTrackId:o,desTrackId:l}=this,{trackId:u,segmentId:c,trackIndex:h,targetTimerange:p}=e;if(u!==o&&u!==l)return[this];let m=s.indexOf(c);if(-1!==m){if(1===s.length)return[];let e=n.map((e,t)=>{let r=e.clone(!1);return 0===i&&t>m&&(r.start-=n[m].duration),r}),t=a.map((e,t)=>{let i=e.clone(!1);return 0===r&&t>m&&(i.start-=a[m].duration),i});return[new g({segmentIds:s.splice(m,1),srcTrackIndex:i,srcTrackId:o,desTrackIndex:r,desTrackId:l,srcTargetTimeRanges:e.splice(m,1),desTargetTimeRanges:t.splice(m,1)})]}let f=n.map(e=>e.clone(!1)),y=a.map(e=>e.clone(!1));return h===i&&0===h&&f.forEach(e=>{p.start<=e.start&&(e.start-=p.duration)}),h===r&&y.forEach(e=>{let t=p.start+p.duration;if(0===h&&p.start<=e.start)e.start-=p.duration;else if(0!==h&&(0,d.DG)(p,e)){let i=t-e.start;e.start-=i}}),[new g({segmentIds:s,srcTrackIndex:i,srcTrackId:o,desTrackIndex:r,desTrackId:l,srcTargetTimeRanges:f,desTargetTimeRanges:y})]}_transformWithMoveSegmentMutation(e,t){let{srcTrackIndex:i,desTrackIndex:r,srcTargetTimeRanges:n,desTargetTimeRanges:a,segmentIds:s,srcTrackId:o,desTrackId:l}=this,{srcTrackIndex:u,desTrackIndex:c,srcTargetTimeRanges:h,desTargetTimeRanges:p,segmentIds:m,srcTrackId:f,desTrackId:y}=e,_=[],v=[...s],k=n.map(e=>e.clone(!1)),I=a.map(e=>e.clone(!1)),S=h.map(e=>e.clone(!1)),w=p.map(e=>e.clone(!1)),b=s.filter(e=>m.some(t=>e===t));if(b.length){let e=[],i=[];b.forEach(t=>{let r=s.indexOf(t),n=m.indexOf(t);v.splice(r,1),e.push(a[r]),i.push(h[n]),k.splice(r,1),I.splice(r,1),S.splice(r,1),w.splice(r,1)}),t&&_.push(new g({segmentIds:b,desTrackId:l,desTrackIndex:r,srcTrackId:y,srcTrackIndex:c,desTargetTimeRanges:e,srcTargetTimeRanges:i}))}return 0===v.length?_:(I.forEach(e=>{w.forEach(i=>{if(l!==y)return;let n=i.start+i.duration;if(0===r&&(e.start>i.start||e.start===i.start&&t))e.start+=i.duration;else if(0!==r&&((0,d.DG)(i,e)||t&&e.start===i.start)){let t=n-e.start;e.start+=t}})}),I.forEach(e=>{S.forEach(t=>{l===y&&0===r&&e.start>t.start&&(e.start-=t.duration)})}),k.forEach(e=>{w.forEach(i=>{l===y&&0===r&&(e.start>i.start||e.start===i.start&&t)&&(e.start+=i.duration)})}),k.forEach(e=>{S.forEach(t=>{l===y&&0===r&&e.start>t.start&&(e.start-=t.duration)})}),_.push(new g({segmentIds:v,desTargetTimeRanges:I,srcTargetTimeRanges:k,desTrackId:l,desTrackIndex:r,srcTrackId:o,srcTrackIndex:i})),_)}_transformWithUpdateSegmentMutation(e,t){let{srcTrackIndex:i,desTrackIndex:r,srcTargetTimeRanges:n,desTargetTimeRanges:a,segmentIds:s,srcTrackId:o,desTrackId:l}=this,{segmentDelta:u,trackId:c,trackIndex:h,segmentId:p,sourceSegmentDelta:m}=e,{targetTimerange:f}=u,{targetTimerange:y}=m,_=s.indexOf(p);if(-1!==_&&f){let e=a.map(e=>e.clone(!1)),t=f.duration-e[_].duration;e[_].duration=f.duration;for(let i=_+1;i<e.length;i++)e[i].start+=t;return[new g({segmentIds:s,desTargetTimeRanges:e,srcTargetTimeRanges:n,desTrackId:l,desTrackIndex:r,srcTrackId:o,srcTrackIndex:i})]}if(c!==l||!f)return[this];let v=f.start+f.duration,k=a.map(e=>e.clone(!1));return k.forEach(e=>{if(0===h&&(e.start>f.start||e.start===f.start&&t)){let t=f.duration-y.duration;e.start+=t}else if(0!==h&&((0,d.DG)(f,e)||t&&e.start===f.start)){let t=v-e.start;e.start+=t}}),[new g({segmentIds:s,desTargetTimeRanges:k,srcTargetTimeRanges:n,desTrackId:l,desTrackIndex:r,srcTrackId:o,srcTrackIndex:i})]}_transformWithInsertTrackMutation(e,t){let{desTrackId:i,desTrackIndex:r,srcTrackId:n,srcTrackIndex:a,srcTargetTimeRanges:s,desTargetTimeRanges:o}=this,{trackIndex:l}=e;return[new g({segmentIds:this.segmentIds,srcTrackIndex:a>=l?this.srcTrackIndex+1:this.srcTrackIndex,desTrackIndex:r>=l?this.desTrackIndex+1:this.desTrackIndex,srcTrackId:n,desTrackId:i,srcTargetTimeRanges:s,desTargetTimeRanges:o})]}_transformWithDeleteTrackMutation(e,t){let{desTrackId:i,desTrackIndex:r,srcTrackId:n,srcTrackIndex:a,segmentIds:s,srcTargetTimeRanges:o,desTargetTimeRanges:l}=this,{trackId:u,trackIndex:d,trackProperty:h,draftId:p}=e;return i===u?[new c.c({draftId:p,trackIndex:d,trackProperty:{...h,segments:[]}}),this]:[new g({segmentIds:s,srcTrackIndex:a>d?a-1:a,desTrackIndex:r>d?r-1:r,srcTrackId:n,desTrackId:i,srcTargetTimeRanges:o,desTargetTimeRanges:l})]}_transformWithMoveTrackMutation(e,t){return[this]}clone(){return new g({segmentIds:this.segmentIds,srcTrackIndex:this.srcTrackIndex,desTrackIndex:this.desTrackIndex,srcTrackId:this.srcTrackId,desTrackId:this.desTrackId,srcTargetTimeRanges:this.desTargetTimeRanges,desTargetTimeRanges:this.srcTargetTimeRanges})}constructor(e){super(),this.type=l.x.MoveSegment,this.segmentIds=e.segmentIds,this.srcTrackIndex=e.srcTrackIndex,this.srcTrackId=e.srcTrackId,this.desTrackIndex=e.desTrackIndex,this.desTrackId=e.desTrackId,this.srcTargetTimeRanges=e.srcTargetTimeRanges,this.desTargetTimeRanges=e.desTargetTimeRanges}}},417609:function(e,t,i){"use strict";i.d(t,{t:function(){return h}});var r=i(268468),n=i(475028),a=i(690613),s=i(283751),o=i(932422),l=i(198544),u=i(392742),d=i(340294);let c=(0,n.i)(l.m.UpdateTrackIdNotExist,"");class h extends o.m{static deserialize(e){let t=new h({...e,trackDelta:r.C4.deserialize(e.trackDelta)});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";t+=`"trackId":"${e.trackId}",`;let i=r.C4.serialize(e.trackDelta);return t+=`"trackDelta":${d.HH.stringify(i)},"version":"${e.version}","type":${e.type}}`}invert(e){let t=e.getTrackById(this.trackId),i=new r.C4;return[new h({trackId:this.trackId,trackDelta:s.T.pick(t,this.trackDelta,i)})]}transform(e,t){let i={[u.x.DeleteTrack]:this._transformWithDeleteTrackMutation.bind(this,e,t),[u.x.UpdateTrack]:this._transformWithUpdateTrackMutation.bind(this,e,t),[u.x.InsertTrack]:this._transformWithInsertTrackMutation.bind(this,e,t),[u.x.InsertSegment]:this._transformWithInsertSegmentMutation.bind(this,e,t)};return i[e.type]?i[e.type]():[this]}check(e){return e.getTrackById(this.trackId)?(0,a.ly)():c(`id not exist: ${this.trackId}`)}runOnModel(e){e.updateTrack(this.trackId,this.trackDelta)}_transformWithDeleteTrackMutation(e,t){return t?[]:[this]}_transformWithUpdateTrackMutation(e,t){let{trackId:i,trackDelta:r}=this,{trackId:n,trackDelta:a}=e;if(i!==n)return[this];if(t){let e=r.clone(!1);return[new h({trackId:i,trackDelta:e=s.T.merge(a,e,e)})]}return[this]}_transformWithInsertTrackMutation(e,t){return[this]}_transformWithInsertSegmentMutation(e,t){return[this]}clone(){return new h({trackId:this.trackId,trackDelta:this.trackDelta})}constructor(e){super(),this.type=u.x.UpdateTrack,this.trackId=e.trackId,this.trackDelta=e.trackDelta}}},567837:function(e,t,i){"use strict";i.d(t,{DG:function(){return r.D}});var r=i(699791)},264318:function(e,t,i){"use strict";i.d(t,{r:function(){return m}});var r=i(59670),n=i(632634),a=i(378188),s=i(211561),o=i(396402),l=i(481631),u=i(690613),d=i(733353),c=i(239431),h=i(469997);let p=e=>void 0!==e;class m extends r.D{add(e,t){return(0,l.E6)(e)?e.targetTimerange.duration<=0?(0,u.wf)(n.FF.segmentInvalid,"invalid target duration"):e.material?(this._updateAdjust(e,null,t),(0,u.ly)()):(0,u.wf)(n.FF.segmentInvalid,"no picture-adjust material"):(0,u.wf)(n.FF.segmentInvalid,"not picture-adjust segment")}update(e,t,i){let r=i.getSegmentById(e);return r&&(0,l.E6)(r)?r.targetTimerange.duration<=0?(0,u.wf)(n.FF.segmentInvalid,"invalid target duration"):r.material?((p(t.trackRenderIndex)||p(t.renderIndex))&&this._updateTrack(r,i),p(t.targetTimerange)&&this._updateTimeRange(r),p(t.material)&&this._updateAdjust(r,t,i),(0,u.ly)()):(0,u.wf)(n.FF.segmentInvalid,"no picture-adjust material"):(0,u.wf)(n.FF.segmentInvalid,"not picture-adjust segment")}remove(e){(0,a.VC)(e).forEach(e=>{var t,i;(null===(t=this._render.editor)||void 0===t?void 0:t.getClipBase(e))&&(null===(i=this._render.editor)||void 0===i||i.removeClip(e))})}_updateTrack(e,t){this.remove(e.id),this._updateAdjust(e,null,t)}_updateTimeRange(e){let t=(0,a.VC)(e.id),{start:i,duration:r}=e.targetTimerange,n=i+r;t.forEach(e=>{var t;null===(t=this._render.editor)||void 0===t||t.updateClipSequenceTime(e,i,n)})}_updateAdjust(e,t,i){this._updateBasicAdjust(e,t,i),this._updateMergedAdjust(e,t,i),this._updateOtherAdjust(e,t,i)}_updateBasicAdjust(e,t,i){let r=e.material,n=(null==t?void 0:t.material)?t.material:r;p(n.brightness)&&this._updateNormalAdjust(e,r.brightness,s.cVg.MetaTypeBrightness,[s.Eu.KFTypeBrightness],i),p(n.contrast)&&this._updateNormalAdjust(e,r.contrast,s.cVg.MetaTypeContrast,[s.Eu.KFTypeContrast],i),p(n.saturation)&&this._updateNormalAdjust(e,r.saturation,s.cVg.MetaTypeSaturation,[s.Eu.KFTypeSaturation],i),p(n.sharpening)&&this._updateNormalAdjust(e,r.sharpening,s.cVg.MetaTypeSharpen,[s.Eu.KFTypeSharpen],i),p(n.fade)&&this._updateNormalAdjust(e,r.fade,s.cVg.MetaTypeFade,[s.Eu.KFTypeFade],i),p(n.lightSensation)&&this._updateNormalAdjust(e,r.lightSensation,s.cVg.MetaTypeLightSensation,[s.Eu.KFTypeLightSensatione],i),p(n.vignetting)&&this._updateNormalAdjust(e,r.vignetting,s.cVg.MetaTypeVignetting,[s.Eu.KFTypeVignetting],i),p(n.particle)&&this._updateNormalAdjust(e,r.particle,s.cVg.MetaTypeParticle,[s.Eu.KFTypeParticle],i),p(n.filter)&&this._updateNormalAdjust(e,r.filter,s.cVg.MetaTypeFilter,[s.Eu.KFTypeFilter],i),p(n.lut)&&this._updateNormalAdjust(e,r.enableLut?r.lut:void 0,s.cVg.MetaTypeLUT,[s.Eu.KFTypeLUT],i)}_updateMergedAdjust(e,t,i){var r,n,a,o,l,u;let d=e.material,c=(null==t?void 0:t.material)?t.material:d,h=p(c.highlight),m=p(c.shadow);if(h||m){let t=!1;h&&((null===(r=d.highlight)||void 0===r?void 0:r.version)==="v2"?(this._removeAdjustByType(e.id,s.cVg.MetaTypeHighlight,!0),t=!0):this._updateNormalAdjust(e,d.highlight,s.cVg.MetaTypeHighlight,[s.Eu.KFTypeHightLight],i)),m&&((null===(n=d.shadow)||void 0===n?void 0:n.version)==="v2"?(this._removeAdjustByType(e.id,s.cVg.MetaTypeShadow,!0),t=!0):this._updateNormalAdjust(e,d.shadow,s.cVg.MetaTypeShadow,[s.Eu.KFTypeShadow],i)),t?this._updateAbnormalAdjust(e,null!==(a=d.highlight)&&void 0!==a?a:d.shadow,s.cVg.MetaTypeHighlight,[s.Eu.KFTypeHightLight,s.Eu.KFTypeShadow],i):this._removeAdjustByType(e.id,s.cVg.MetaTypeHighlight,!0)}let f=p(c.colorTemperature),g=p(c.hue);if(f||g){let t=!1;f&&((null===(o=d.colorTemperature)||void 0===o?void 0:o.version)==="v2"?(this._removeAdjustByType(e.id,s.cVg.MetaTypeTemperature,!0),t=!0):this._updateNormalAdjust(e,d.highlight,s.cVg.MetaTypeTemperature,[s.Eu.KFTypeTemperature],i)),g&&((null===(l=d.hue)||void 0===l?void 0:l.version)==="v2"?(this._removeAdjustByType(e.id,s.cVg.MetaTypeHue,!0),t=!0):this._updateNormalAdjust(e,d.hue,s.cVg.MetaTypeHue,[s.Eu.KFTypeHue],i)),t?this._updateAbnormalAdjust(e,null!==(u=d.colorTemperature)&&void 0!==u?u:d.hue,s.cVg.MetaTypeTemperature,[s.Eu.KFTypeTemperature,s.Eu.KFTypeHue],i):this._removeAdjustByType(e.id,s.cVg.MetaTypeTemperature,!0)}}_updateOtherAdjust(e,t,i){let r=e.material,n=(null==t?void 0:t.material)?t.material:r;p(n.hsl)&&this._updateAbnormalAdjust(e,r.hsl&&r.hsl.length>0?r.hsl:void 0,s.cVg.MetaTypeHsl,[],i),p(n.colorCurves)&&this._updateAbnormalAdjust(e,r.enableColorCurves?r.colorCurves:void 0,s.cVg.MetaTypeColorCurves,[],i),p(n.primaryColorWheels)&&this._updateAbnormalAdjust(e,r.enableColorWheels?r.primaryColorWheels:void 0,s.cVg.MetaTypePrimaryColorWheels,[s.Eu.KFTypePrimaryColorWheelIntensity],i),p(n.logColorWheels)&&this._updateAbnormalAdjust(e,r.enableColorWheels?r.logColorWheels:void 0,s.cVg.MetaTypeLogColorWheels,[s.Eu.KFTypeLogColorWheelIntensity],i)}_updateNormalAdjust(e,t,i,r,n){if(!t||this._isEmptyValue(n,e,r)){this._removeAdjustByType(e.id,i);return}let s=null==n?void 0:n.getDraftProperty().renderIndexTrackModeOn,o=(0,a.g5)(e,t,i,s);if(!o)return;let{start:l,duration:u}=e.targetTimerange;this._updateAdjustClip(o,l,l+u),this._updateKeyframes(n,o,e,r)}_updateAbnormalAdjust(e,t,i,r,n){var o;if(!t||this._isEmptyValue(n,e,r)){this._removeAdjustByType(e.id,i);return}let l=null==n?void 0:n.getDraftProperty().renderIndexTrackModeOn,u=i===s.cVg.MetaTypeHsl?null===(o=this._render.editor)||void 0===o?void 0:o.getClipBase(this._genClipId(e.id,s.cVg.MetaTypeHsl)):void 0,d=null==u?void 0:u.data.filter,c=(0,a.oz)(e,i,l,d);if(!c)return;let{start:h,duration:p}=e.targetTimerange;this._updateAdjustClip(c,h,h+p),this._updateKeyframes(n,c,e,r)}_isEmptyValue(e,t,i){return i.length>0&&i.every(i=>(0,c.o)(e,t,i))}_updateAdjustClip(e,t,i){var r,a;if(this._render.editor.getClipBase(e.id))null===(r=this._render.editor)||void 0===r||r.updateClip(e);else{let r=this._addTrackForFilter(e);if(!r)return(0,u.wf)(n.FF.addTrackFail,"add picture-adjust track fail");null===(a=this._render.editor)||void 0===a||a.addClip(r,e,t,i)}}_updateKeyframes(e,t,i,r){r.forEach(r=>{var n;d.Rj.executeUpdate({render:this._render,videoDocument:e,clip:t,segment:i,keyframes:null===(n=i.commonKeyframes)||void 0===n?void 0:n.find(e=>e.propertyType===r),keyframeType:r,parentId:t.id})})}_removeAdjustByType(e,t){var i,r;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this._genClipId(e,t,n);(null===(i=this._render.editor)||void 0===i?void 0:i.getClipBase(a))&&(null===(r=this._render.editor)||void 0===r||r.removeClip(a))}_genClipId(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return`${e}_${(0,h.Vp)(t,i)}`}_addTrackForFilter(e){var t,i;if((null===(t=e.filter)||void 0===t?void 0:t.render_index)===void 0)return"";{let t=null===(i=this._render.editor)||void 0===i?void 0:i.addTrack(o.u2.EffectTrack,Number(e.filter.render_index));return t?t:""}}}},825151:function(e,t,i){"use strict";i.d(t,{v:function(){return u}});var r=i(59670),n=i(391889),a=i(138302),s=i(361708),o=i(340294),l=i(909543);class u extends r.D{beginDraft(e){var t;let{editor:i}=this._render;if(!i)return;let r=i.getClipBase(e);if(!!r&&!!(null===(t=r.subState)||void 0===t?void 0:t.sequence))i.pushSequence(e)}endDraft(e,t){let{editor:i}=this._render;if(!i)return;i.popSequence();let r=i.getClipBase(e);if(!!r){if(i.isMainSequence()){var n;if(t&&(null===(n=r.subState)||void 0===n?void 0:n.sequence)){let{canvasConfig:e,fps:i}=t.getDraftProperty(),{width:n,height:s}=e,l=new a.N(i),u={fps:l.numerator(),fps_den:l.denominator(),width:BigInt(Math.round(n)),height:BigInt(Math.round(s))};r.subState.sequence.setSequenceSetting(o.HH.stringify(u))}i.replaceSubSequence(e)}}}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=e.slice(0,-1),n=t,a=new Map;for(let e of r){let t=n.getSegmentById(e);if(!t||!s.b.isCombination(t))break;a.set(e,t),n=t.materialDraft.draft}if(0===r.length||a.size!==r.length){i(n);return}for(let e of r)this.beginDraft(e);for(let e of(i(n),r.reverse())){let t=a.get(e);this.endDraft(e,t.materialDraft.draft)}}subDraftExecuteAdd(e){let{materialDraft:t,id:i}=e,{draft:r}=t;for(let e of(this.beginDraft(i),r.tracks))for(let t of e.segments){let e=t.__segment_struct_type;if(!e)continue;let i=l.Zn[n.C8.ADD][e];null==i||i(this._render.apis,t,r)}this.endDraft(i,r)}}},2559:function(e,t,i){"use strict";i.d(t,{L:function(){return d}});var r=i(59670),n=i(632634),a=i(396402),s=i(378188),o=i(481631),l=i(690613),u=i(733353);class d extends r.D{add(e,t){var i,r;if(!(0,o.w5)(e))return(0,l.wf)(n.FF.segmentInvalid,"not filter segment");if(e.targetTimerange.duration<=0)return(0,l.wf)(n.FF.segmentInvalid,"invalid target duration");if(!e.material)return(0,l.wf)(n.FF.segmentInvalid,"no effect material");let d=this.getRenderIndex(e),c=null===(i=this._render.editor)||void 0===i?void 0:i.addTrack(a.u2.EffectTrack,d);if(!c)return(0,l.wf)(n.FF.addTrackFail,"add video-effect track fail");let h=(0,s.bo)(e);return null===(r=this._render.editor)||void 0===r||r.addClip(c,h,e.targetTimerange.start,e.targetTimerange.start+e.targetTimerange.duration),e.commonKeyframes.forEach(i=>{u.Rj.executeUpdate({render:this._render,videoDocument:t,clip:h,segment:e,parentId:h.id,keyframes:i,keyframeType:i.propertyType})}),(0,l.ly)()}update(e,t,i){var r;let a=i.getSegmentById(e);if(!a||!(0,o.w5)(a))return(0,l.wf)(n.FF.segmentInvalid,"not effect segment");if(a.targetTimerange.duration<=0)return(0,l.wf)(n.FF.segmentInvalid,"invalid target duration");if(!a.material)return(0,l.wf)(n.FF.segmentInvalid,"no effect material");t.targetTimerange&&this.updateTargetTimeRange(a);let u=(0,s.bo)(a);return null===(r=this._render.editor)||void 0===r||r.updateClip(u,!0),(0,l.ly)()}remove(e){var t;null===(t=this._render.editor)||void 0===t||t.removeClip(e)}updatePreview(e,t,i){var r,a;if(!t||!(0,o.w5)(t))return(0,l.wf)(n.FF.segmentInvalid,"not effect segment");if(t.targetTimerange.duration<=0)return(0,l.wf)(n.FF.segmentInvalid,"invalid target duration");if(!t.material)return(0,l.wf)(n.FF.segmentInvalid,"no effect material");i.targetTimerange&&(null===(a=this._render.editor)||void 0===a||a.updateClipSequenceTime(e,t.targetTimerange.start,t.targetTimerange.start+t.targetTimerange.duration));let u=(0,s.bo)(t);return null===(r=this._render.editor)||void 0===r||r.updateClip(u,!0),(0,l.ly)()}}},944307:function(e,t,i){"use strict";i.d(t,{x:function(){return g}});var r=i(59670),n=i(632634),a=i(378188),s=i(396402),o=i(729951),l=i(211561),u=i(481631),d=i(690613),c=i(185400),h=i(733353),p=i(285474),m=i(75850),f=i(438176);class g extends r.D{add(e,t){if(!(0,u.Ft)(e))return(0,d.wf)(n.FF.segmentInvalid,"no text segment");if(e.targetTimerange.duration<=0)return(0,d.wf)(n.FF.segmentInvalid,"invalid target duration");if(!e.material)return(0,d.wf)(n.FF.segmentInvalid,"no text material");let{editor:i}=this._render;if(!i)return(0,d.wf)(n.FF.editorNotInit,"editor not init");let r=this.getRenderIndex(e),o=i.addTrack(s.u2.EffectTrack,r);if(!o)return(0,d.wf)(n.FF.addTrackFail,"add video track fail");let{subtitleKeywordsConfig:l}=t.getDraftProperty(),c=(0,a.Bt)(e,this._render.config,!1,l);c.id=e.id,c.filter={...c.filter,id:e.id,filterLayer:BigInt(r),param:this._subtitleTemplateRenderHelper.getUpdatedParam(e,l)};let h={start:e.offset+e.targetTimerange.start,duration:e.targetTimerange.duration},m=i.addClip(o,c,h.start,h.start+h.duration);return f.R?i.infoSticker&&e.videoTracking&&(0,p.iE)(e,i):m.then(()=>{i.infoSticker&&e.videoTracking&&(0,p.iE)(e,i)}),this.updateTransform(e.id,e.clip,t),this.updateAnimations(e,!0),this.updateKeyframes(t,c.id,c.id),(0,d.ly)()}update(e,t,i){var r;if(!(0,u.Ft)(e))return(0,d.wf)(n.FF.segmentInvalid,"no text segment");if(e.targetTimerange.duration<=0)return(0,d.wf)(n.FF.segmentInvalid,"invalid target duration");let{editor:s,config:o}=this._render;if(!s)return(0,d.wf)(n.FF.editorNotInit,"editor not init");let l=this.getRenderIndex(e),{subtitleKeywordsConfig:c}=t.getDraftProperty(),h=(0,a.Bt)(e,o,!(null==i?void 0:null===(r=i.material)||void 0===r?void 0:r.richTextCommand),c);return h.id=e.id,h.filter={...h.filter,id:e.id,filterLayer:BigInt(l),param:this._subtitleTemplateRenderHelper.getUpdatedParam(e,c)},s.updateClip(h),(0,d.ly)()}updateTransform(e,t,i,r){if(!e)return(0,d.wf)(n.FF.segmentInvalid,"segment id empty");if(!t)return(0,d.wf)(n.FF.segmentInvalid,"no segment clip");let{editor:a}=this._render;if(!a)return(0,d.wf)(n.FF.editorNotInit,"editor not init");let l=(0,o.$F)(t);return l?(l.id=`${e}_${s.UO.Transform}`,a.getFilterById(e,l.id)?a.updateFilter(l):a.addFilter(l,e),h.Rj.executeUpdateByTypeList({render:this._render,videoDocument:i,clipId:e,parentId:e,delta:r,keyframeTypeList:c.Q0}),(0,d.ly)()):(0,d.wf)(n.FF.updateFilterFail,"make text transform filter fail")}updateAnimations(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return(0,d.wf)(n.FF.segmentInvalid,"segment id empty");let{editor:i}=this._render;if(!i)return(0,d.wf)(n.FF.editorNotInit,"editor not init");!t&&this.updateTemplateParam(e);let r=(0,o.yR)(e),a=`${e.id}_${s.UO.StickerAnimation}`;return r?(r.id=a,i.getFilterById(e.id,r.id)?i.updateFilter(r):i.addFilter(r,e.id),(0,d.ly)()):t?void 0:(i.getFilterById(e.id,a)&&i.removeFilter(`${e.id}_${s.UO.StickerAnimation}`),(0,d.ly)())}updateKeyframes(e,t,i,r){h.Rj.executeUpdateByTypeList({render:this._render,videoDocument:e,clipId:t,parentId:i,delta:r,keyframeTypeList:[...c.Q0,l.Eu.KFTypeTextAlpha,l.Eu.KFTypeTextColor,l.Eu.KFTypeGlobalAlpha,l.Eu.KFTypeBorderWidth,l.Eu.KFTypeBorderColor,l.Eu.KFTypeBorderAlpha,l.Eu.KFTypeBackgroundColor,l.Eu.KFTypeBackgroundAlpha,l.Eu.KFTypeShadowColor,l.Eu.KFTypeShadowAlpha,l.Eu.KFTypeShadowSmoothing,l.Eu.KFTypeShadowAngle,l.Eu.KFTypeShadowDistance,l.Eu.KFTypeBloomStrength,l.Eu.KFTypeBloomRange,l.Eu.KFTypeBloomColor,l.Eu.KFTypeBloomAlpha,l.Eu.KFTypeBloomDirX,l.Eu.KFTypeBloomDirY]})}updateTemplateParam(e){var t;let{editor:i}=this._render;if(!i)return(0,d.wf)(n.FF.editorNotInit,"editor not init");let r=null===(t=i.getClipBase(e.id))||void 0===t?void 0:t.data;if(!!r)r.filter={...r.filter,param:this._subtitleTemplateRenderHelper.getUpdatedParam(e)},i.updateClip(r)}remove(e){var t;return(0,u.Ft)(e)?(null===(t=this._render.editor)||void 0===t||t.removeClip(e.id),(0,d.ly)()):(0,d.wf)(n.FF.segmentInvalid,"is not a text segment")}refreshTextsWithDefaultFont(e){let t=(e,i)=>{let r=[];e.getAllSegments().forEach(e=>{(0,u.Ft)(e)?r.push(e):(0,u.du)(e)&&t(e.materialDraft.draft,[...i,e.id])}),i.forEach(e=>this._render.apis.draft.beginDraft(e)),r.forEach(t=>this.update(t,e)),i.reverse().forEach(e=>this._render.apis.draft.endDraft(e))};return t(e,[]),(0,d.ly)()}updateVideoTracking(e,t){if(!(0,u.Ft)(e)){console.error("segment is invalid");return}let{editor:i}=this._render;if(!(null==i?void 0:i.infoSticker))return(0,d.wf)(n.FF.editorNotInit,"infoSticker not init");(0,p.vT)(e,t,i).then(()=>{null==i||i.commit(()=>!0)})}constructor(...e){super(...e),this._subtitleTemplateRenderHelper=new m.N(this._render)}}},448220:function(e,t,i){"use strict";i.d(t,{h:function(){return r}});let r={"7406275882400189701":1e3,"7408393759580327174":1e3,"7408430647095741702":1e3,"7408409931176512774":1e3,"7408430474407791877":1e3,"7408409685415578885":1e3,"7408387021586042118":1e3,"7408409682705927429":1e3,"7408430331314932998":2e3,"7406275298490125573":2e3,"7408429709882559749":2e3,"7408429665007783173":2e3,"7408409772950637830":2e3,"7408393601262177541":2e3,"7408430370003356933":2e3,"7408429894306106629":2e3,"7408430338122321158":2e3,"7408430025562852613":2e3,"7408430059444325638":2e3,"7408393760280792325":2e3,"7408430097012722949":2e3,"7408429981803482373":2e3,"7408430875815333125":2e3,"7408430515042209030":2e3,"7408429835011378438":2e3,"7408430616083041541":2e3,"7408430420167019781":2e3,"7408429706824912133":2e3,"7408430252050959621":2e3,"7408430748551679238":2e3,"7408429966150470917":2e3,"7408430179154038021":2e3,"7408393651212258565":2e3,"7408430244828368133":2e3,"7406275420099824901":2e3,"7408409876940049670":2e3,"7408430461774613766":2e3,"7408393608132300038":2e3,"7408430057363950854":2e3,"7408393532802731270":2e3,"7408393684028329221":2e3,"7408430752670567686":2e3,"7408429681466297606":3e3,"7408430746836208901":3e3,"7408430163215666438":3e3,"7408393763250277638":3e3,"7406275083292970245":3e3,"7406275727684848902":3e3,"7406275891141086470":3e3,"7406276519720422661":3e3,"7406275486378134789":3e3,"7408429911431597318":3e3,"7406276010175401221":3e3,"7406276674569964806":3e3,"7406275907012365574":3e3,"7408430545371286789":3e3,"7408393507246755077":3e3,"7406276605473082630":3e3,"7406275359085251846":3e3,"7406275613973089541":3e3,"7408429885527543045":3e3,"7406276567585803526":3e3,"7406275500630396166":3e3,"7406275552522439942":3e3,"7406274855613615366":3e3,"7406275346934320389":3e3,"7406275400617266437":3e3,"7408393562729106693":4e3,"7408429771991813381":4e3,"7408430556461141254":4e3,"7408393552394210565":4e3,"7406276220679130374":4e3,"7406276079112981766":4e3,"7406275895620553989":4e3,"7406275195347946757":4e3,"7406275636425231621":4e3,"7207391969436242434":1e3,"6976822940608238093":1e3,"7130176030764962305":1e3,"7130176030802711041":1e3,"7019182177380209153":1e3,"7019182285542920706":1e3,"7134583375607632386":1e3,"7134583242732081666":1e3,"7158739772733657602":2e3,"7158739772742046209":2e3,"7158739772733690369":2e3,"7158739772733673986":2e3,"7158739773601878530":2e3,"7158739772733690370":2e3,"7158739773555741185":2e3,"7158739773593489921":2e3,"7158739773497020929":2e3,"7158739772788183554":2e3,"7158759513552589313":2e3,"7158762300193640962":2e3,"7158760070040261121":2e3,"7158761955170193922":2e3,"7158759987785765378":2e3,"7158759261768520193":2e3,"7158762163207672322":2e3,"7158759182655558146":2e3,"7158746687677141506":2e3,"7158747823645659649":2e3,"7158746891818111489":2e3,"7158747168021418497":2e3,"7158748239158579714":2e3,"7158748159139648002":2e3,"7158747064812179969":2e3,"7158748001165382146":2e3,"7280056145232794113":2e3,"7158756204599054849":2e3,"7158756142250725889":2e3,"7158755294980346370":2e3,"7158755530012365314":2e3,"7158755717623583233":2e3,"7158755458193297922":2e3,"7158755624547783169":2e3,"7130178350013747714":3e3,"7130176029557019137":3e3,"7130178350017942018":3e3,"7130178350013796866":3e3,"7130178350013764097":3e3,"7134558898962305538":3e3,"7134558899079746049":3e3,"7134558898886808066":3e3,"7130178350013780481":3e3,"7019182024527188481":3e3,"7130178350013780482":3e3,"7132322502071554561":3e3,"7130178350009553409":3e3,"7019182100469256705":3e3,"7134558897448178178":3e3,"7134558899008442881":3e3,"7134558898819699201":3e3,"7134558897448227330":3e3,"7130178350013796865":3e3,"7130178350013747713":3e3,"7134558898962305537":3e3,"7134558897448210946":3e3,"7134558897590768130":3e3,"7134558898748396033":3e3,"7134558897448194562":3e3,"6977639776321016322":4e3,"6977639534938821121":4e3,"6977639665473950210":4e3,"6956089104412971534":4e3,"7229210947078853121":4e3,"7238440106577629697":4e3,"7201045783955640834":4e3,"7177342554751373826":4e3,"7177342631322587650":4e3}},344603:function(e,t,i){"use strict";i.d(t,{P:function(){return a}});var r=i(325674),n=i(632634);function a(e,t){return new r.H({renderMode:n.JH.legacy,wasm:e,config:{fps:30,layerMode:n.de.track,...t}})}},186314:function(e,t,i){"use strict";i.d(t,{W:function(){return n}});var r=i(287165);class n{get trackerMap(){return this._trackerMap}restoreTrackerData(e,t,i,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=a=a||(0,r.p)();if(s){let r=this._trackerMap.get(i);!r&&(r=[],this._trackerMap.set(i,r)),r.push({trackerId:s,targetSegmentId:e,dataPath:t,mode:0})}return s}bindTracker(e,t,i){return 0}setTrackerTrackingMode(e,t){var i;for(let r of null!==(i=this._trackerMap.get(e))&&void 0!==i?i:[])r.mode=t;return 0}unbindTracker(e,t,i){let r=this._trackerMap.get(i);if(r){let t=[];r.forEach(i=>{i.targetSegmentId!==e&&t.push(i)}),r.length=0,r.push(...t)}return Promise.resolve(0)}deleteTracker(e,t){return Promise.resolve(0)}getTrackerId(e,t){var i,r;return null===(r=this._trackerMap.get(e))||void 0===r?void 0:null===(i=r.find(e=>e.dataPath===t))||void 0===i?void 0:i.trackerId}getTrackerValidRegion(e){return Promise.resolve([])}getTrackingBaseLineTRS(e,t,i,r){return Promise.resolve(null)}getTrackerData(e,t){return Promise.resolve(null)}getTrackerPosition(e,t,i){return Promise.resolve(void 0)}setTrackerSelectArea(e,t){return Promise.resolve("")}setBachTrackingData(e,t,i,r){return Promise.resolve(0)}getStickerTemplateParam(e,t){return Promise.resolve("")}getStickerParams(e,t){return Promise.resolve("")}getStickerRichText(e,t,i){return Promise.resolve(null)}convertRichText(e,t,i){return Promise.resolve(null)}getStickerBoundingBox(e,t,i){return Promise.resolve(null)}getStickerPosition(e,t){return Promise.resolve("")}constructor(){this._trackerMap=new Map}}},192131:function(e,t,i){"use strict";i.d(t,{F:function(){return d}});var r=i(438176),n=i(879566),a=i(340294),s=i(211561),o=i(712616),l=i(155235),u=i(342040);function d(e,t,i){var d,c,h,p,m,f,g,y,_,v,k;let I=!(arguments.length>3)||void 0===arguments[3]||arguments[3],S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},w=arguments.length>5?arguments[5]:void 0,b=(0,l.P)(e.backgroundColor),F="",C=e.backgroundAlpha;e.backgroundColor?F=(0,a.EO)(e.backgroundColor,C):(F="#00000000",C=0),b[3]=C;let A=null!==(m=null==t?void 0:t.path)&&void 0!==m?m:"",{enableRtlTextRender:x,directionLevel:E,fallbackFontPathList:D=[]}=S,M=e.baseContent||e.content;if(r.R){let{fontIdPathsOut:e,effectIdPathsOut:t}=n.hM.getAllFontAndEffectIdsFromText(M),i={};for(let t of e){if(!!t.path)i[t.path]=u.k.getInstance().pathRecords.get(t.path)}for(let e of t){if(!!e.path)i[e.path]=u.k.getInstance().pathRecords.get(e.path)}for(let[e,t]of Object.entries(i)){if(e===t)continue;let i=RegExp(e,"g");M=M.replace(i,t)}}let K=(null==w?void 0:w.styles)&&(null===(c=e.subtitleKeywords)||void 0===c?void 0:null===(d=c.range)||void 0===d?void 0:d.length),P={version:"2",richText:M,typeSettingKind:e.typesetting,typeSettingAlign:e.alignment,canvas:F&&e.backgroundStyle!==s.M4l.TextBackgroundStyleNone,canvasColor:b,canvasRoundCorner:e.backgroundRoundRadius>0,canvasRoundRadiusScale:e.backgroundRoundRadius,canvasWrapped:e.backgroundStyle===s.M4l.TextBackgroundStyleWrap,canvasSplitThreshold:1e3,canvasSplitPadding:.1,canvasCustomized:!0,canvasWHCustomized:[e.backgroundWidth,e.backgroundHeight],canvasOffsetCustomized:[e.backgroundHorizontalOffset,e.backgroundVerticalOffset],boldValue:.008,italicDegree:10,decorationWidth:.05,decorationOffset:.22,lineSpacing:e.lineSpacing,letterSpacing:e.letterSpacing,innerPadding:I?.2:.0625,lineMaxWidth:e.type!==s.cVg.MetaTypeText||e.forceApplyLineMaxWidth?e.lineMaxWidth:-1,canvasWHFixed:[e.fixedWidth,e.fixedHeight],autoAdaptCanvasEnabled:e.fixedWidth>0&&e.fixedHeight>0,fallbackFontPathList:D,oneLineCutOff:!1,shapePath:u.k.getInstance().pathRecords.get(A)||A,shapeFlipX:e.shapeClipX,shapeFlipY:e.shapeClipY,autoAdaptDpiEnabled:!1,globalAlpha:e.globalAlpha,selectedColor:[.0235,.7568,.8039,.4],keyword_rich_text:K?null==w?void 0:w.styles:void 0,keyword_ranges:K?null===(p=e.subtitleKeywords)||void 0===p?void 0:null===(h=p.range)||void 0===h?void 0:h.map(e=>{let{location:t,length:i}=e;return[t,t+i]}).flat():[]},{ktvColor:B,ktvOutlineColor:O,ktvShadowColor:z}=o.i.updateKtvColor(e);B&&(P.ktvColor=(0,l.P)(B)),O&&(P.ktvOutlineColor=(0,l.P)(O)),z&&(P.ktvShadowColor=(0,l.P)(z));let V=null!==(f=e.textCurve)&&void 0!==f?f:new s.b9B,j={curveType:1,curveAngle:V.angle,offsetOnCurve:.1,points:[]};return P.typeSettingPathEnable=V.enable,P.enableMergeLines=!0,P.typeSettingPathParam={curvesInfo:[j]},(null==i?void 0:i.path)&&BigInt(e.checkFlag)&s.PbZ.LightFlag?((null===(g=i.bloomParams)||void 0===g?void 0:g.color)?(P.bloomColor=(0,l.P)(i.bloomParams.color),P.bloomColorCustomized=!0):P.bloomColorCustomized=!1,P.bloomPath=u.k.getInstance().pathRecords.get(i.path)||i.path,P.bloomStrength=null===(y=i.bloomParams)||void 0===y?void 0:y.strength,P.bloomRange=null===(_=i.bloomParams)||void 0===_?void 0:_.range,P.bloomDirX=null===(v=i.bloomParams)||void 0===v?void 0:v.dirX,P.bloomDirY=null===(k=i.bloomParams)||void 0===k?void 0:k.dirY):P.bloomPath="",P.textLocale=x?1:0,P.directionLevel=E?1:0,P}},229536:function(e,t,i){"use strict";i.d(t,{R:function(){return r}});let r=new class e{setMergeFigureCache(e,t){this._mergeFigureCache[e]=t}getMergeFigureCache(e){return this._mergeFigureCache[e]}removeFigureCache(e){this._mergeFigureCache[e]&&delete this._mergeFigureCache[e]}constructor(){this._mergeFigureCache={}}}},138302:function(e,t,i){"use strict";i.d(t,{N:function(){return s}});var r=i(340294);class n{_init(e){switch(e){case 0:this.name="23.98",this.numerator=24000n,this.denominator=1001n;break;case 1:this.name="24",this.numerator=24n;break;case 2:this.name="25",this.numerator=25n;break;case 3:this.name="29.97",this.numerator=30000n,this.denominator=1001n;break;case 4:this.name="30",this.numerator=30n;break;case 5:this.name="50",this.numerator=50n;break;case 6:this.name="59.94",this.numerator=60000n,this.denominator=1001n;break;case 7:this.name="60",this.numerator=60n}this.value=(0,r.NN)(this.numerator,this.denominator),this.interval=1e6/this.value}constructor(e){switch(this.name="",this.numerator=0n,this.denominator=1n,this.value=0,this.interval=0,this.id=e,this.id){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:this._init(this.id);break;default:this._init(4)}}}let a=[new n(1),new n(2),new n(4),new n(5),new n(7)];class s{numerator(){return this._base.numerator}denominator(){return this._base.denominator}constructor(e){let t=function(e){for(let t of a)if(1e-4>=Math.abs(t.value-e))return t.id;return 4}(e);this._base=new n(t)}}},155235:function(e,t,i){"use strict";i.d(t,{P:function(){return n}});var r=i(340294);function n(e){return!e||e.length<6?[0,0,0,1]:(0,r.rW)(e).map(e=>e/255)}},342558:function(e,t,i){"use strict";i.d(t,{Mv:function(){return a},XD:function(){return o},dM:function(){return s},j3:function(){return n.j3}});var r=i(632634),n=i(921676);function a(e,t){return e===r.de.track?100*t.trackRenderIndex:t.renderIndex}function s(e,t){return 0!==t&&e===r.de.legacy?t+2e3:t}class o{static getInstance(){return!o.instance&&(o.instance=new o),o.instance}constructor(){this.first_frame_store=!1}}},199039:function(e,t,i){"use strict";i.d(t,{L:function(){return a}});var r=i(396402),n=i(342040);function a(e,t){let i={id:`${t.id}_transition`,type:r.UO.VideoTransition,res:n.k.getInstance().pathRecords.get(e.path),effect_region:2,filterLayer:0n,parentID:"",priv:{},visible:!0};return{id:i.id,res:i.res,filter:i,type:r.AM.Effect,is_visible:i.visible,attach_file_path:""}}},884238:function(e,t,i){"use strict";i.d(t,{C:()=>D});var r,n=i("805794"),a=i("287165"),s=i("592444"),o=i("232383"),l=i("231536"),u=i("632634"),d=i("138302"),c=i("944819"),h=i("378188"),p=i("396402"),m=i("542240"),f=i("337609");class g{get pinControl(){var e;return this._pinControl?this._pinControl:null===(e=this._infoSticker)||void 0===e?void 0:e.getPinControl()}init(e){let{editorInfoSticker:t}=e;this._infoSticker=t,this._pinControl=this._infoSticker.getPinControl()}get trackerMap(){return this._trackerMap}getTrackerId(e,t){var i,r;return null===(r=this._trackerMap.get(e))||void 0===r?void 0:null===(i=r.find(e=>e.dataPath===t))||void 0===i?void 0:i.trackerId}getStickerRichText(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,f.kB)(null===(i=this._infoSticker)||void 0===i?void 0:i.getStickerRichText(e,t,r),null,"getStickerRichText")}async convertRichText(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=new Module.std$$vector$VEStickerEditRichTextParam$;for(let t of e)n.push_back(t);let a=await (0,f.kB)(null===(i=this._infoSticker)||void 0===i?void 0:i.convertRichText(n,t,r),null,"convertRichText");return n.delete(),a}getStickerParams(e,t){var i;return(0,f.kB)(null===(i=this._infoSticker)||void 0===i?void 0:i.getStickerParams(e,t),"","getStickerParams")}getStickerTemplateParam(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,f.kB)(null===(t=this._infoSticker)||void 0===t?void 0:t.getStickerTemplateParam(e,i),"","getStickerTemplateParam")}getStickerBoundingBox(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,f.kB)(null===(i=this._infoSticker)||void 0===i?void 0:i.getStickerBoundingBox(e,t,r),null,"getStickerBoundingBox")}async getTrackerData(e,t){if(this.pinControl){let r;try{var i;r=await (0,f.kB)(null===(i=this.pinControl)||void 0===i?void 0:i.getTrackerData(e,t),{buffer:0,bufferSize:0},"getTrackerData")}catch(e){return r&&0!==r.buffer&&Module._free(r.buffer),console.error("InfoSticker: getTrackerData failed:",e),null}if(r.bufferSize<=0||0===r.buffer)return console.error("InfoSticker: getTrackerData failed, bufferSize:",r.bufferSize),0!==r.buffer&&Module._free(r.buffer),null;let n=Module.HEAPU8.subarray(r.buffer,r.buffer+Number(r.bufferSize)),a=Uint8Array.from(n);return Module._free(r.buffer),a}return null}async getTrackerValidRegion(e){if(this.pinControl){let t=Module._malloc(e.byteLength);if(t<=0)return console.error("getTrackerValidRegion failed, malloc memory failed"),[];let i=null;Module.HEAPU8.set(e,t);try{i=await (0,f.kB)(this.pinControl.getTrackerValidRegion({buffer:t,bufferSize:BigInt(e.byteLength)}),[])}catch(e){return console.error("getTrackerValidRegion failed, e:",e),Module._free(t),[]}return Module._free(t),i}return[]}getTrackerPosition(e,t,i){if(this.pinControl)return(0,f.kB)(this.pinControl.getTrackerPosition(e,t,i),void 0,"getTrackerPosition")}getStickerPosition(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this._infoSticker)return(0,f.kB)(this._infoSticker.getStickerPosition(e,t),"","getStickerPosition")}bindTracker(e,t,i){return this.pinControl?((0,f.kB)(this.pinControl.bindTracker(e,t,i),-1,"bindTracker"),0):-1}async unbindTracker(e,t,i){if(this.pinControl){let r=await (0,f.kB)(this.pinControl.unbindTracker(e,t,i),-1,"unbindTracker");if(0===r){let t=this._trackerMap.get(i);if(t){let i=[];t.forEach(t=>{t.targetSegmentId!==e&&i.push(t)}),t.length=0,t.push(...i)}}return r}return Promise.resolve(-1)}deleteTracker(e,t){return this.pinControl?(0,f.kB)(this.pinControl.deleteTracker(e,t),-1,"deleteTracker"):Promise.resolve(-1)}restoreTrackerData(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(this.pinControl){n=n||(0,a.p)(),(0,f.kB)(this.pinControl.restoreTrackerData(e,t,n),"","restoreTrackerData");let s=n;if(s){let t=this._trackerMap.get(i);!t&&(t=[],this._trackerMap.set(i,t)),t.push({trackerId:s,targetSegmentId:e,dataPath:r})}return s}return""}setTrackerSelectArea(e,t){return this.pinControl?(0,f.kB)(this.pinControl.setTrackerSelectArea(e,t),"","setTrackerSelectArea"):Promise.resolve("")}setTrackerTrackingMode(e,t){return this.pinControl?((0,f.kB)(this.pinControl.setTrackerTrackingMode(e,t),-1,"setTrackerTrackingMode"),0):-1}async setBachTrackingData(e,t,i,r){if(this.pinControl){let n=await (0,f.kB)(this.pinControl.setBachTrackingData(e,t,r),-1,"setBachTrackingData");if(0===n){let{trackingClipId:t,trackerId:r,trackerDataPath:n}=i,a=this._trackerMap.get(t);!a&&(a=[],this._trackerMap.set(t,a)),a.push({trackerId:r,targetSegmentId:e,dataPath:n})}return n}return Promise.resolve(-1)}getVideoTransform(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.pinControl?(0,f.kB)(this.pinControl.getVideoTransform(e,t),-1,"getVideoTransform"):Promise.resolve(-1)}mergeTracker(e,t,i,r,n){return this.pinControl?(0,f.kB)(this.pinControl.mergeTracker(e,t,i,r,n),-1,"mergeTracker"):Promise.resolve(-1)}getTrackingBaseLineTRS(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this.pinControl?(0,f.kB)(this.pinControl.getTrackingBaseLineTRS(e,t,i,r),null,"getTrackingBaseLineTRS"):Promise.resolve(null)}constructor(){this._trackerMap=new Map,this._infoSticker=null,this._pinControl=null}}var y=i("309863"),_=i("438176"),v=i("342558"),k=i("340294"),I=i("556784"),S=i("300820"),w=i("587892"),b=i("722169"),F=i("748994"),C=i("524392"),A=i("307497");let x="";if(_.H){let{searchParams:e}=new URL(window.location.href);x=null!==(r=e.get("mock_log_level"))&&void 0!==r?r:""}let E=x&&Number.isFinite(parseInt(x,10))?parseInt(x,10):6;class D extends s.H{get utils(){return this._utilsWrapper}get mattingControl(){return this._mattingControl}get pluginManager(){return this._pluginManager}get preview(){return this._preview}get infoSticker(){return this._infoSticker}get subtitleHelper(){return this._subtitleHelper}get objectLockHelper(){return this._objectLockHelper}get clipSequenceMap(){return this._clipSequenceMap}checkEditorRunningStatus(){return this._editorRunningStateObj.first_frame_store}isHotUpdate(){return this._config.layerMode===u.de.track}commit(e){var t,i;if(!this._editor)return!1;0===this._commitSession&&(0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.begin(),-1,"begin").then(e=>{0!==e&&n.B.reportError("[render]commit",k.HH.stringify({name:"begin",result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),++this._commitSession;let r=e();if(this.setNeedForceRefrshIfNeed(!!r),--this._commitSession,!this._clipAdded)return!1;if(0===this._commitSession)return(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.commit(),-1,"commit").then(e=>{0!==e&&n.B.reportError("[render]commit",k.HH.stringify({name:"commit",result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),!this.updateSetting()&&!this.prepare();return!1}setNeedForceRefrshIfNeed(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){this.isNeedForceRefresh=e;return}e&&(this.isNeedForceRefresh=e)}isDuringCommit(){return this._commitSession>0}updateSetting(){if(!this.preview)return!1;let e=!1;if(!this.isDuringCommit()){var t,i;if(this.preview.progress>this._maxDuration&&this.preview.onProgress(this._maxDuration,!1),!this.isHotUpdate()&&this.preview.stop(),(0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.setSequenceSetting(k.HH.stringify(this._sequenceSetting)),-1,"setSequenceSetting").then(e=>{0!==e&&n.B.reportError("[render]updateSetting",k.HH.stringify({name:"setSequenceSetting",setting:this._sequenceSetting,result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),(0,f.kB)(null===(i=this._editor)||void 0===i?void 0:i.prepare(),-1,"prepare").then(e=>{2===e?n.B.warn("[render]updateSetting","prepare with empty sequence"):0!==e&&n.B.reportError("[render]updateSetting",k.HH.stringify({name:"prepare",result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this.preview.duration>=0&&this._autoRender){if(this.isNeedForceRefresh){let e=this.preview.state===m.je.PLAYING||this.preview.state===m.je.SEEK_WAIT_PLAY;!e&&(this.preview.state=m.je.PREPARED),this.preview.seekWithoutCallback(this.preview.progress),e&&(this.preview.state=m.je.SEEK_WAIT_PLAY)}else this.preview.refreshCurrentFrameWithoutQueue();this.setNeedForceRefrshIfNeed(!1,!0)}e=!0}return e}disableAutoRender(){this._autoRender=!1}enableAutoRender(){this._autoRender=!0}prepare(){if(!this.preview)return!1;let e=!1;if(!this.isDuringCommit()){if(this.preview.progress>this._maxDuration&&this.preview.onProgress(this._maxDuration,!1),!this.isHotUpdate()&&this.preview.stop(),this._editorSequence){var t,i;(0,f.kB)(null===(t=this._editor)||void 0===t?void 0:t.setSequence(this._editorSequence),-1,"setSequence").then(e=>{0!==e&&n.B.reportError("[render]prepare",k.HH.stringify({name:"setSequence",result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),(0,f.kB)(null===(i=this._editor)||void 0===i?void 0:i.prepare(),-1,"prepare").then(e=>{0!==e&&n.B.reportError("[render]prepare",k.HH.stringify({name:"prepare",result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this.preview.state=m.je.PREPARED,this.preview.seekWithoutCallback(this.preview.progress)}e=!0}return e}setMaxDuration(e){if(!!this.preview&&e!==this._maxDuration)this._maxDuration=e,this.preview.setDuration(this._maxDuration)}setBackground(e){this._sequenceSetting.bgType=(0,F.E)(e.type),this._sequenceSetting.bgColor=e.color,this._sequenceSetting.bgImage=e.image,this._sequenceSetting.bgBlur=e.blur}dumpSequence(e){return""}addTrack(e,t){var i;-1===t&&(t=++this._lastRenderIndex);let r=(0,a.p)();switch(e){case p.u2.AudioTrack:r=`audio_track_${r}`;break;case p.u2.EffectTrack:r=`effect_track_${r}`,e=p.u2.VideoTrack;break;case p.u2.VideoTrack:r=`video_track_${r}`;break;default:r=`track_${r}`}for(let[i,r]of this._trackMap.entries())if(r.type===e&&r.index===t)return i;let s={};return s.id=r,s.type=e,(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.insertTrack(k.HH.stringify(s),t),-1,"insertTrack").then(e=>{0!==e&&n.B.reportError("[render]addTrack",k.HH.stringify({name:"insertTrack",track:s,index:t,result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._trackMap.set(r,{type:e,index:t,clipIds:new Set}),r}removeTrack(e){var t,i,r;if((0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.deleteTrack(e),-1,"deleteTrack").then(t=>{0!==t&&n.B.reportError("[render]removeTrack",k.HH.stringify({name:"deleteTrack",id:e,result:t}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._trackMap.has(e)){let t=null!==(r=null===(i=this._trackMap.get(e))||void 0===i?void 0:i.clipIds)&&void 0!==r?r:[];for(let i of(this._trackMap.delete(e),t))this._clipMap.delete(i)}return 0}updateTrackIndex(e,t){var i;return(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.setTrackLayer(e,t),-1,"setTrackLayer").then(i=>{0!==i&&n.B.reportError("[render]updateTrackIndex",k.HH.stringify({name:"setTrackLayer",trackId:e,index:t,result:i}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._trackMap.has(e)&&(this._trackMap.get(e).index=t),0}getTrack(e){var t;return null!==(t=this._trackMap.get(e))&&void 0!==t?t:null}async addClip(e,t,i,r){var n,a,s,o,u,d,c,h,m,g,y;if((0,l.LO)(t.id)&&(null===(a=this._editorSequence)||void 0===a||a.setClipFirstFrameImgPath(k.HH.stringify(t),(0,l.LO)(t.id))),(0,l.o)(t.id)&&(null===(s=this._editorSequence)||void 0===s||s.setClipMediaInfoString(k.HH.stringify(t),(0,l.o)(t.id))),!t.id)return -1;for(let a of(i<0&&(i=0n),r<0&&(r=0n),!this._clipAdded&&(this._clipAdded=!0),null===(n=this._trackMap.get(e))||void 0===n||n.clipIds.add(t.id),this._clipMap.set(t.id,{trackId:e,seqIn:i,seqOut:r,data:t,filters:new Map,transition:null}),Object.keys(this._sequenceMap)))this._sequenceMap[a]===this._editorSequence&&(this._clipSequenceMap[t.id]={sequence:this._sequenceMap[a],parentClipId:a,clipMap:(0,b.clone)(this._clipMap),trackMap:(0,b.clone)(this._trackMap)});let _=0;i>=r&&console.error("[VEEditor#addClip] meets `seqIn >= seqOut`:",t,i,r);if((null===(o=t.filter)||void 0===o?void 0:o.type)===p.UO.ScriptSticker)try{let e=JSON.parse(t.res).path;this.isPathBroken(e,t.id,{filterType:t.filter.type})&&(null===(d=this._editorSequence)||void 0===d||d.setResourceBroken(t.id,!0))}catch(e){console.error("[VEEditor#addClip] failed to parse new text template res:",t)}if(this.isPathBroken(t.res,t.id)?null===(c=this._editorSequence)||void 0===c||c.setResourceBroken(t.id,!0):this.isSegmentBroken(t.segment_id,t.id)&&(null===(h=this._editorSequence)||void 0===h||h.setResourceBroken(t.id,!0)),0===(_=await (0,f.kB)(null===(u=this._editorSequence)||void 0===u?void 0:u.insertClip2(k.HH.stringify(t),e,i,r),-1,"insertClip2")));else{let{type:n}=t;n===p.AM.AudioVideo||n===p.AM.Video||n===p.AM.Image?(t.type=p.AM.Color,t.res_color={color:"#ffffff00",width:10n,height:10n,gradient:!1,gradient_color:{colors:[],percents:[],angle:0}},_=await (0,f.kB)(null===(m=this._editorSequence)||void 0===m?void 0:m.insertClip2(k.HH.stringify(t),e,i,r),-1,"insertClip2")):n===p.AM.Audio&&(t.res=null!==(y=this._config.lostAudioPlaceholder)&&void 0!==y?y:"",_=await (0,f.kB)(null===(g=this._editorSequence)||void 0===g?void 0:g.insertClip2(k.HH.stringify(t),e,i,r),-1,"insertClip2")),0===_&&this.prepare()}return this._onAddClip.fire({clipId:t.id,result:_}),_}addSubSequence(e,t,i,r){var n,a;let s=this._editor.createSequence(k.HH.stringify(this._sequenceSetting),t.id);return null===(n=this._trackMap.get(e))||void 0===n||n.clipIds.add(t.id),this._clipMap.set(t.id,{trackId:e,seqIn:i,seqOut:r,data:t,filters:new Map,transition:null,subState:{sequence:s,trackMap:new Map,clipMap:new Map}}),i>=r&&console.error("[VEEditor#addSubSequence] meets `seqIn >= seqOut`:",t,i,r),(0,f.kB)(null===(a=this._editorSequence)||void 0===a?void 0:a.insertSubSequence(s,k.HH.stringify(t),e,i,r),-1,"insertSubSequence").then(e=>{this._onAddClip.fire({clipId:t.id,result:e})}),this._sequenceMap[t.id]=s,0}replaceSubSequence(e){var t;let i=this._clipMap.get(e);return(null==i?void 0:null===(t=i.subState)||void 0===t?void 0:t.sequence)?0:-1}changeSequence(e){if(!(null==e?void 0:e.sequence)||this._editorSequence===e.sequence)return!1;let{sequence:t,parentClipId:i,trackMap:r,clipMap:n}=e;return this._stateStack.push({sequence:this._editorSequence,trackMap:this._trackMap,clipMap:this._clipMap}),this._editorSequence=t,this._trackMap=r,this._clipMap=n,!0}recoverySequence(e){if(!!e)this.popSequence()}pushSequence(e){var t;let i=null===(t=this._clipMap.get(e))||void 0===t?void 0:t.subState;if(!!i)for(let[t]of(this._stateStack.push({sequence:this._editorSequence,trackMap:this._trackMap,clipMap:this._clipMap}),this._editorSequence=i.sequence,this._trackMap=i.trackMap,this._clipMap=i.clipMap,i.clipMap.entries()))this._clipSequenceMap[t]={parentClipId:e,clipMap:(0,b.clone)(this._clipMap),trackMap:(0,b.clone)(this._trackMap),sequence:this._sequenceMap[e]}}popSequence(){let e=this._stateStack.pop();if(!!e)this._editorSequence=e.sequence,this._trackMap=e.trackMap,this._clipMap=e.clipMap}isMainSequence(){return 0===this._stateStack.length}removeClip(e){var t,i,r,a,s;if((0,l.wy)(e),(0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.deleteClip(e),-1,"deleteClip").then(t=>{0!==t&&n.B.reportError("[render]removeClip",k.HH.stringify({name:"deleteClip",clipId:e,result:t}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._clipMap.has(e)){let t=null!==(s=null===(i=this._clipMap.get(e))||void 0===i?void 0:i.trackId)&&void 0!==s?s:"";this._clipMap.delete(e),null===(r=this._trackMap.get(t))||void 0===r||r.clipIds.delete(e);let n=null===(a=this._trackMap.get(t))||void 0===a?void 0:a.clipIds.size;"number"==typeof n&&n<=0&&this.removeTrack(t)}return 0}updateClip(e){var t;return arguments.length>1&&void 0!==arguments[1]&&arguments[1],(0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.updateClipInfo(k.HH.stringify(e)),-1,"updateClipInfo").then(t=>{0!==t&&n.B.reportError("[render]updateClip",k.HH.stringify({name:"updateClipInfo",clip:e,result:t}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._clipMap.has(e.id)&&(this._clipMap.get(e.id).data=e),0}updateClipSequenceTime(e,t,i){var r;if((0,f.kB)(null===(r=this._editorSequence)||void 0===r?void 0:r.updateClipSequenceTime(e,t,i),-1,"updateClipSequenceTime").then(r=>{0!==r&&n.B.reportError("[render]updateClipSequenceTime",k.HH.stringify({name:"updateClipSequenceTime",clipId:e,seqIn:t,seqOut:i,result:r}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._clipMap.has(e)){let r=this._clipMap.get(e);r.seqIn=t,r.seqOut=i}return 0}updateClipTrack(e,t,i){var r,a,s,o;if((0,f.kB)(null===(r=this._editorSequence)||void 0===r?void 0:r.updateClipTrack(e,t,i),-1,"updateClipTrack").then(r=>{0!==r&&n.B.reportError("[render]updateClipTrack",k.HH.stringify({name:"updateClipTrack",clipId:e,trackId:t,seqIn:i,result:r}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),this._clipMap.has(e)){let i=this._clipMap.get(e),r=i.trackId;i.trackId=t,null===(a=this._trackMap.get(r))||void 0===a||a.clipIds.delete(e),null===(s=this._trackMap.get(t))||void 0===s||s.clipIds.add(e);let n=null===(o=this._trackMap.get(r))||void 0===o?void 0:o.clipIds.size;"number"==typeof n&&n<=0&&this.removeTrack(r)}return 0}getClipBase(e){return this._clipMap.get(e)}getClipConflict(e,t,i){var r,n;if(!this._trackMap.has(e))return null;for(let a of null!==(n=null===(r=this._trackMap.get(e))||void 0===r?void 0:r.clipIds)&&void 0!==n?n:[]){if(a===t||!this._clipMap.has(a))continue;let e=this._clipMap.get(a);if(e.seqIn===i)return e}return null}addFilter(e,t){var i,r,a;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1n,l=(0,h.Pt)(e.id,e);return l.trim_range={"in.us":s,"out.us":o},!(0n===s&&o===-1n)&&s>=o&&console.error("[VEEditor#addFilter] meets `seqIn >= seqOut`:",e,t,s,o),this._clipMap.has(t)&&(null===(r=this._clipMap.get(t))||void 0===r||r.filters.set(e.id,e)),this.isFilterBroken(e,t)&&(null===(a=this._editorSequence)||void 0===a||a.setResourceBroken(e.id,!0)),(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.insertClip2(k.HH.stringify(l),t,s,o),-1,"insertClip2").then(e=>{0!==e&&n.B.reportError("[render]addFilter",k.HH.stringify({name:"insertClip2",filterClip:l,parentId:t,seqIn:s,seqOut:o,result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),e.id}removeFilter(e){var t,i;(0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.deleteClip(e),-1,"deleteClip").then(t=>{0!==t&&n.B.reportError("[render]removeFilter",k.HH.stringify({name:"deleteClip",id:e,result:t}),void 0,{type:"lyra_sdk_event",apiType:"render"})});let r=e.split("_")[0];return this._clipMap.has(r)&&(null===(i=this._clipMap.get(r))||void 0===i||i.filters.delete(e)),0}updateFilter(e){var t,i,r;if(!e.id)return -1;let a=(0,h.Pt)(e.id,e),s=e.id.split("_")[0];return this._clipMap.has(s)&&(null===(i=this._clipMap.get(s))||void 0===i||i.filters.set(e.id,e)),this.isFilterBroken(e,s)&&(null===(r=this._editorSequence)||void 0===r||r.setResourceBroken(e.id,!0)),(0,f.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.updateClipInfo(k.HH.stringify(a)),-1,"updateClipInfo").then(e=>{0!==e&&n.B.reportError("[render]updateFilter",k.HH.stringify({name:"updateClipInfo",filterClip:a,result:e}),void 0,{type:"lyra_sdk_event",apiType:"render"})}),0}getFilterById(e,t){var i;if(!this._clipMap.has(e))return null;let r=this._clipMap.get(e);return null!==(i=null==r?void 0:r.filters.get(t))&&void 0!==i?i:null}getFilterByIdRecursively(e,t){var i;if(0===e.length)return null;let[r,...n]=e,a=this._clipMap.get(r);if(!a)return null;for(let e of n)if(!a.subState||!(a=a.subState.clipMap.get(e)))return null;return null!==(i=null==a?void 0:a.filters.get(t))&&void 0!==i?i:null}getFilterByType(e,t){var i;if(!this._clipMap.has(e))return null;let r=this._clipMap.get(e);for(let e of null!==(i=null==r?void 0:r.filters.values())&&void 0!==i?i:[])if(e.type===t)return e;return null}setKeyframe(e,t){var i;(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.setKeyframe(k.HH.stringify(e),t),-1,"setKeyframe").then(e=>{});let r=this._keyframesMap.get(t);return void 0===r&&(r=new Map,this._keyframesMap.set(t,r)),r.set(e.id,e),e.id}removeKeyframe(e,t){var i;(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.deleteKeyframe(k.HH.stringify(e),t),-1,"deleteKeyframe").then(e=>{});let r=this._keyframesMap.get(t);return r&&r.delete(e.id),0}resetKeyframes(e,t){var i;(0,f.kB)(null===(i=this._editorSequence)||void 0===i?void 0:i.resetKeyframe(k.HH.stringify(e),t),-1,"resetKeyframe").then(e=>{});let r=this._keyframesMap.get(t);return void 0===r&&(r=new Map,this._keyframesMap.set(t,r)),e.forEach(e=>r.set(e.id,e)),0}getKeyframesByParentId(e){var t;return null!==(t=this._keyframesMap.get(e))&&void 0!==t?t:null}getKeyframeById(e,t){var i;let r=this._keyframesMap.get(e);return null!==(i=null==r?void 0:r.get(t))&&void 0!==i?i:null}getKeyframeByType(e,t){var i;let r=this._keyframesMap.get(e);return Array.from(null!==(i=null==r?void 0:r.values())&&void 0!==i?i:[]).forEach(e=>{if(e.type===t)return e}),null}addVideoTransition(e,t,i,r){var n,a;let s=t.id.split("_")[0];return this._clipMap.has(s)&&(this._clipMap.get(s).transition=t),this.isPathBroken(t.res,t.id)&&(null===(n=this._editorSequence)||void 0===n||n.setResourceBroken(t.id,!0)),this.addClip(e,t,i,r),this._clipMap.has(s)&&(this._clipMap.get(s).transition=t),this.isPathBroken(t.res,t.id)&&(null===(a=this._editorSequence)||void 0===a||a.setResourceBroken(t.id,!0)),0}removeVideoTransition(e){this.removeClip(e);let t=e.split("_")[0];return this._clipMap.has(t)&&(this._clipMap.get(t).transition=null),0}updateVideoTransition(e){this.updateClip(e);let t=e.id.split("_")[0];return this._clipMap.has(t)&&(this._clipMap.get(t).transition=e),0}getTransition(e){let t=e.split("_")[0];return this.getTransitionByParent(t)}getTransitionByParent(e){var t,i;return this._clipMap.has(e)?null!==(i=null===(t=this._clipMap.get(e))||void 0===t?void 0:t.transition)&&void 0!==i?i:null:null}getCanvasSize(){var e,t;return{width:null!==(e=this._sequenceSetting.width)&&void 0!==e?e:100n,height:null!==(t=this._sequenceSetting.height)&&void 0!==t?t:100n}}addDefaultVideoClip(){var e,t;if(this._defaultVideoClipId)return this._defaultVideoClipId;let i="default_video_clip",r=0n+33333n,n={id:i,type:p.AM.Color,stream_type:p.vG.VideoOnly,trim_range:{"in.us":0n,"out.us":r},res_color:{width:null!==(e=this._sequenceSetting.width)&&void 0!==e?e:100n,height:null!==(t=this._sequenceSetting.height)&&void 0!==t?t:100n,color:"transparent"===this._config.defaultFrameColor?"#00000000":"#000000ff"}};return this.commit(()=>{let e=this.addTrack(p.u2.VideoTrack,0);this.addClip(e,n,0n,r)}),this._defaultVideoClipId=i,i}setSequenceBackground(e){this.commit(()=>{var t;null===(t=this._editorSequence)||void 0===t||t.setSequenceSetting(k.HH.stringify({bgColor:e||"#00000000"}))})}removeDefaultVideoClip(){return!!this._defaultVideoClipId&&(this.commit(()=>{this.removeClip(this._defaultVideoClipId)}),this._defaultVideoClipId="",!0)}startLoadAssetAllRegion(e){var t;return(0,f.kB)(null===(t=this._editor)||void 0===t?void 0:t.startLoadAssetAllRegion(e),-1,"startLoadAssetAllRegion")}async prepareAudioSample(e,t){var i,r,n,a;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=`${t}`;if(this._voiceChangeResults.has(o))return null!==(i=this._voiceChangeResults.get(o))&&void 0!==i?i:"";if(!t||!this._editorSequence||null===this._wasm.FS.findObject(t))return"";let l=this._editorSequence;s&&(l=null!==(a=null===(n=this.getClipBase(s))||void 0===n?void 0:null===(r=n.subState)||void 0===r?void 0:r.sequence)&&void 0!==a?a:this._editorSequence);let u=this._utilsWrapper.createSpAudioProcessor();if(await (0,f.kB)(u.setSequence(l),-1,"setSequence"),0!==await (0,f.kB)(u.doProcess2(e,t),-1,"doProcess2"))return await (0,f.kB)(u.reset(),-1,"reset"),"";let d=await (0,f.kB)(u.getResult(),"","getResult");return this._voiceChangeResults.set(o,d),await (0,f.kB)(u.reset(),-1,"reset"),d}async prepareAudioSample2(e,t,i,r,n){var a,s,o,l;let u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",d=`${t}`;if(this._voiceChangeResults.has(d))return null!==(a=this._voiceChangeResults.get(d))&&void 0!==a?a:"";if(!t||!this._editorSequence||null===this._wasm.FS.findObject(t))return"";let c=this._editorSequence;u&&(c=null!==(l=null===(o=this.getClipBase(u))||void 0===o?void 0:null===(s=o.subState)||void 0===s?void 0:s.sequence)&&void 0!==l?l:this._editorSequence);let h=this._utilsWrapper.createSpAudioProcessor();if(await (0,f.kB)(h.setSequence(c),-1,"setSequence"),0!==await (0,f.kB)(h.doProcess3(e,t,i,r,n),-1,"doProcess3"))return await (0,f.kB)(h.reset(),-1,"reset"),"";let p=await (0,f.kB)(h.getResult(),"","getResult");return this._voiceChangeResults.set(d,p),await (0,f.kB)(h.reset(),-1,"reset"),p}getAudioSample(e){var t;let i=`${e}`;return null!==(t=this._voiceChangeResults.get(i))&&void 0!==t?t:""}setEffectResourceFinder(e){var t;let i=this._wasm.lvveFunctionTable.add(e);null===(t=this._globalConfig)||void 0===t||t.setEffectExternalFinder(i)}setClipSubstituteImagePath(e,t){return new Promise(async(i,r)=>{var n;"number"==typeof await (0,f.kB)(null===(n=this._editorSequence)||void 0===n?void 0:n.setClipSubstituteImagePath(e,t),-1,"setClipSubstituteImagePath")?i():r()})}cancelClipSubstitute(e){return new Promise(async(t,i)=>{var r;"number"==typeof await (0,f.kB)(null===(r=this._editorSequence)||void 0===r?void 0:r.cancelClipSubstitute(e),-1,"cancelClipSubstitute")?t():i()})}setSubSeqClipSubstituteImagePath(e,t,i){return new Promise((r,n)=>{var a;"number"==typeof(null===(a=this._editorSequence)||void 0===a?void 0:a.setSubSeqClipSubstituteImagePath(e,t,i))?r():n()})}cancelSubSeqClipSubstitute(e,t){return new Promise((i,r)=>{var n;"number"==typeof(null===(n=this._editorSequence)||void 0===n?void 0:n.cancelSubSeqClipSubstitute(e,t))?i():r()})}detectAudioSnr(e,t){return(0,f.kB)(this._utils.detectAudioSnr(k.HH.stringify(e),t),{inout_snr_left:-1,inout_snr_right:-1},"detectAduioSnr")}enableSkipDropFrame(e){var t;return(0,f.kB)(null===(t=this._editorConfig)||void 0===t?void 0:t.enableSkipDropFrame(e),-1,"enableSkipDropFrame")}dumpLogInfo(){return this._bind.dumpLogInfo()}hasBrokenPath(e){return this.brokenPaths.has(e)}brokenAddPaths(e){for(let t of(console.debug("[VEEditor#brokenAddPaths]",e),e)){if(!this.brokenPaths.get(t))this.brokenPaths.set(t,[])}}async brokenRemovePaths(e,t,i){console.debug("[VEEditor#brokenRemovePaths]",e,t);let r=[];for(let t of e){let e=this.brokenPaths.get(t);if(!!e){for(let i of e){let e=this.brokenInfos.get(i);if(!!e&&!!e.paths.has(t))e.brokenPaths.delete(t),0===e.brokenPaths.size&&(r.push(e),this.brokenInfos.delete(i))}this.brokenPaths.delete(t)}}r.length&&await this.processBrokenInfo(r,t,i)}brokenAddSegmentIds(e){for(let t of(console.debug("[VEEditor#brokenAddSegmentIds]",e),e)){if(!this.brokenSegments.has(t))this.brokenSegments.set(t,[])}}async brokenRemoveSegmentIds(e,t,i){console.debug("[VEEditor#brokenRemoveSegmentIds]",e);let r=[];for(let t of e){let e=this.brokenSegments.get(t);if(!!e)r.push(...e),this.brokenSegments.delete(t)}if(r.length){var n,a,s;for(let e of r)null===(n=this._editorSequence)||void 0===n||n.setResourceBroken(e,!1);t&&i?await (null===(a=this.preview)||void 0===a?void 0:a.refreshCurrentFrame()):t&&(null===(s=this.preview)||void 0===s||s.refreshCurrentFrame())}}async processBrokenInfo(e,t,i){var r,n,a;for(let i of e)if(null===(r=this._editorSequence)||void 0===r||r.setResourceBroken(i.id,!1),i.filterType===p.UO.AudioPreprocessFilter){let e=this.getFilterById(i.parentId,i.id),[r]=i.paths;e&&(e.type===p.UO.AudioNoiseFilter?(e.modelPath=r,this.updateFilter(e)):e.type===p.UO.AudioPreprocessFilter&&this.prepareAudioSample(i.parentId,r).then(()=>{let i=this.getAudioSample(r);if(Object.assign(e,{byte_size:i?BigInt(i.length):void 0,resource:r,result:i}),this.updateFilter(e),t){var n;null===(n=this.preview)||void 0===n||n.refreshCurrentFrame()}}))}else if(i.filterType===p.UO.ScriptSticker&&this._clipMap.has(i.id)){let e=this._clipMap.get(i.id);(0,S.Q)(e.data,!1)}t&&i?await (null===(n=this.preview)||void 0===n?void 0:n.refreshCurrentFrame()):t&&(null===(a=this.preview)||void 0===a||a.refreshCurrentFrame())}isPathBroken(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.brokenPaths.get(e);if(r&&t){r.push(t);let s=this.brokenInfos.get(t);if(s)s.paths.add(e),s.brokenPaths.add(e);else{var n,a;let r={id:t,paths:new Set([e]),brokenPaths:new Set([e]),parentId:null!==(n=i.parentId)&&void 0!==n?n:"",filterType:null!==(a=i.filterType)&&void 0!==a?a:p.UO.Unknown};this.brokenInfos.set(t,r)}}return!!r}isSegmentBroken(e,t){if(!e)return!1;let i=this.brokenSegments.get(e);return i&&t&&i.push(t),!!(null==i?void 0:i.length)}isFilterBroken(e,t){let{id:i,type:r}=e,n={parentId:t,filterType:r};switch(r){case p.UO.AmazingEffect:{let t=[this.isPathBroken(e.res,i,n)];try{if(e.param){let r=JSON.parse(e.param);delete r.algorithm_cache_folder,Object.values(r).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{t.push(this.isPathBroken(e.path,i))})})}}catch(e){}return t.some(e=>e)}case p.UO.VideoCanvas:return this.isPathBroken(e.image,i,n);case p.UO.AudioPreprocessFilter:return this.isPathBroken(e.resource,i,n);case p.UO.VideoAnimation:{let t=e.anim_in.res,r=e.anim_out.res,a=e.anim_combo.res,s=this.isPathBroken(t,i,n),o=this.isPathBroken(r,i,n),l=this.isPathBroken(a,i,n);return s||o||l}case p.UO.StickerAnimation:{let t=e.anim_in,r=e.anim_out,a=e.anim_loop_path,s=this.isPathBroken(t,i,n),o=this.isPathBroken(r,i,n),l=this.isPathBroken(a,i,n);return s||o||l}case p.UO.Transform:return this.isPathBroken(e.blend_mode,i,n);default:return!1}}getCombinationSegmentScreenshots(e,t,i,r,n){var a;let s=(0,f.r7)(),o=(0,f.O3)({className:"IVEGetFramesControl",funcName:"VEGetVideoFramesCallback",listenerId:s,cb:n}),l=null===(a=this._bind)||void 0===a?void 0:a.createGetFrames(e),u=r.map(e=>({time:e,callbackData:Number(e/1000n)}));return null==l||l.setGetVideoFramesCallback(s),null==l||l.getVideoFrames(e,u,t,i),()=>{null==l||l.cancelGetVideoFrames(),null==l||l.delete(),(0,f.aS)(o)}}getAncestorIds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._clipMap;for(let[i,r]of t){if(!r.subState)continue;let t=r.subState.clipMap;if(t.has(e))return[i];let n=this.getAncestorIds(e,t);if(n.length>0)return[i,...n]}return[]}getClipBaseByPath(e){let[t,...i]=e,r=this._clipMap.get(t);if(!!r){for(let e of i){var n;if(!(r=null===(n=r.subState)||void 0===n?void 0:n.clipMap.get(e)))return}return r}}createSequence(e){if(this._editor)return this._editor.createSequence(k.HH.stringify({...this._sequenceSetting,...e}),"")}getAmazingFilterParam(e,t,i){let r=this._editorSequence;if(i){var n,a,s;r=null!==(s=null===(a=this.getClipBaseByPath(i))||void 0===a?void 0:null===(n=a.subState)||void 0===n?void 0:n.sequence)&&void 0!==s?s:this._editorSequence}return(0,f.kB)(null==r?void 0:r.getAmazingFilterParam(e,t),"","getAmazingFilterParam")}runFrameWithBachTime(e,t,i){var r;null===(r=this._editor)||void 0===r||r.runFrameWithBachTime(e,t,i)}async destroy(){var e,t,i,r,n,a,s,o;null===(e=this._editorInfoSticker)||void 0===e||e.delete(),this._editorInfoSticker=null,null===(t=this._editorPreview)||void 0===t||t.delete(),this._editorPreview=null,null===(i=this._editorSequence)||void 0===i||i.delete(),this._editorSequence=null,null===(r=this._editorConfig)||void 0===r||r.delete(),this._editorConfig=null,null===(n=this._preview)||void 0===n||n.destroy(),this._preview=null,await (0,f.kB)(null===(a=this._editor)||void 0===a?void 0:a.destroy(),-1,"destroy"),null===(s=this._editor)||void 0===s||s.delete(),this._editor=null,null===(o=this._globalConfig)||void 0===o||o.delete(),this._globalConfig=null,this._utils&&("function"!=typeof this._utils.isDeleted||!this._utils.isDeleted())&&this._utils.delete(),I.I.reset()}_init(){var e;this._sequenceSetting.width=1920n,this._sequenceSetting.height=1080n;let t=null!==(e=this._config.fps)&&void 0!==e?e:30,i=new d.N(t);this._sequenceSetting.fps=i.numerator(),this._sequenceSetting.fps_den=i.denominator(),(0,f.FN)(),this._initABConfig(),this._initEditor(),this._initListener(),!this._fromReset&&this._bind.warmUpWebGL(this._config.canvasId)}_initABConfig(){var e,t,i,r,n,a,s;for(let[t,i]of(this._globalConfig=this._utilsWrapper.getSpGlobalConfig(),Object.entries(null!==(e=this._config.abIntConfig)&&void 0!==e?e:{})))this._globalConfig.configInt(t,BigInt(i));for(let[e,i]of Object.entries(null!==(t=this._config.abBoolConfig)&&void 0!==t?t:{}))this._globalConfig.configBool(e,i);for(let[e,t]of Object.entries(null!==(i=this._config.effectAbBoolConfig)&&void 0!==i?i:{}))this._globalConfig.setEffectABConfigValueBool(e,t);for(let[e,t]of Object.entries(null!==(r=this._config.effectAbIntConfig)&&void 0!==r?r:{}))this._globalConfig.setEffectABConfigValueInt(e,t);for(let[e,t]of Object.entries(null!==(n=this._config.effectAbFloatConfig)&&void 0!==n?n:{}))this._globalConfig.setEffectABConfigValueFloat(e,t);for(let[e,t]of Object.entries(null!==(a=this._config.effectAbStringConfig)&&void 0!==a?a:{}))this._globalConfig.setEffectABConfigValueString(e,t);this._config.effectModelsDir&&this._globalConfig.setEffectFileFinderDir(this._config.effectModelsDir),this._config.enableAudioStream&&this._globalConfig.configBool(o.Ni,this._config.enableAudioStream||!1),this._config.enableStreamOpt&&this._globalConfig.configBool(o.q1,this._config.enableStreamOpt||!1),this._globalConfig.configBool(o.Xi,!0),this._config.enableUsePreFrameStrict&&this._globalConfig.configBool(o.gJ,!0),this._config.enableFF264Strict&&this._globalConfig.configBool(o.ZA,!0),this._config.enableSkipDropFrame&&this._globalConfig.configBool(o.je,!0),this._globalConfig.configBool("ve_enable_track_clip_opt",null!==(s=this._config.enableTrackClipOpt)&&void 0!==s&&s),this._globalConfig.configBool("ve_enable_sub_seq_interface_opt",!0)}_initEditor(){var e,t;this._bind.setLogConfig(E),this._editor=this._utilsWrapper.createEditor(""),this._editor.init(m.Vz.PREVIEW_COMPILE),this._editor.setLogTag(o.RF),this._editorConfig=this._editor.getEnvConfigure(),this._editorConfig.enableRenderLayer(this._config.layerMode===u.de.track),this._editorConfig.enableModelHotUpdate(this._config.layerMode===u.de.track),this._editorConfig.setStickerPinPreviewMode(1),this._editorConfig.configBool(o.Oz,!1);let i=this._editor.createSequence(k.HH.stringify(this._sequenceSetting),"");this._editorSequence=i,this._sequenceMap.main=i,this._editor.setSequence(this._editorSequence),this._editor.setCurrentOnly(m.Vz.PREVIEW_ONLY),this._editor.createPreviewControl(),this._editorPreview=this._editor.getPreviewControl(),this._config.isAudioOnly&&this._editorPreview.setOnlyAudioPlay(this._config.isAudioOnly),null===(t=this._preview)||void 0===t||t.init({config:this._config,globalconfig:this._globalConfig,sequenceSetting:this._sequenceSetting,editor:this._editor,editorSequence:this._editorSequence,editorPreview:this._editorPreview,createGetFrames:this._bind.createGetFrames.bind(this._bind),createGetImageFrame:this._bind.createGetImageFrame.bind(this._bind),createSnapshot:null===(e=this._bind.createSnapshot)||void 0===e?void 0:e.bind(this._bind)}),this._editorInfoSticker=this._editor.getInfoStickerControl(),this._infoSticker.init({editorInfoSticker:this._editorInfoSticker})}_initListener(){this._utils.registerStatisticsListener(this._statisticListenerId),(0,f.O3)({className:"IVEUtils",funcName:"OnStatisticsReceived",listenerId:this._statisticListenerId,cb:e=>{this._onStatistics.fire(e)}})}_str2ptr(e){let t=this._wasm.lengthBytesUTF8(e)+1,i=this._wasm._malloc(t);return this._wasm.stringToUTF8(e,i,t),i}_ptr2str(e){return this._wasm.UTF8ToString(e)}constructor(e){super(),this._onAddClip=new w.Q,this._onStatistics=new w.Q,this._statisticListenerId=(0,f.r7)(),this._autoRender=!0,this._globalConfig=null,this._editor=null,this._editorConfig=null,this._editorSequence=null,this._editorPreview=null,this._editorInfoSticker=null,this._stateStack=[],this._sequenceSetting={},this._trackMap=new Map,this._clipMap=new Map,this._clipSequenceMap={},this._sequenceMap={},this._keyframesMap=new Map,this._commitSession=0,this._maxDuration=0n,this._lastRenderIndex=0x3fffffff,this._defaultVideoClipId="",this._voiceChangeResults=new Map,this._clipAdded=!1,this._editorRunningStateObj=new v.XD,this.isNeedForceRefresh=!1,this.brokenPaths=new Map,this.brokenInfos=new Map,this.brokenSegments=new Map;let{wasm:t,config:i,fromReset:r}=e;this._wasm=t,this._config=i,this._fromReset=r,!D.vesdkBind&&(D.vesdkBind=new this._wasm.VESDKBind),this._bind=D.vesdkBind,this._utils=this._bind.getVEUtils(),this._utilsWrapper=new c.l({vesdkBind:this._bind,utils:this._utils,createHelper:this._bind.getVECreateHelper(),globalConfig:this._bind.getGlobalConfig()}),this._mattingControl=this._utilsWrapper.createMattingControl(),this._pluginManager=this._utilsWrapper.createPluginManager(),this._preview=new y._,this._infoSticker=new g,this._subtitleHelper=new A.G({utilWrapper:this._utilsWrapper}),this._objectLockHelper=new C.x({utilWrapper:this._utilsWrapper}),this.onAddClip=this._onAddClip.event,this.onStatistics=this._onStatistics.event,this._init()}}D.vesdkBind=null},309863:function(e,t,i){"use strict";i.d(t,{_:()=>k});var r=i("789786"),n=i("340294");class a{}var s=i("542240"),o=i("455843"),l=i("81649"),u=i("138302"),d=i("232383"),c=i("337609"),h=i("923596"),p=i("587892"),m=i("885534"),f=i("956151");function g(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(i<=1)return e>=t;let n=new l.O1(i),a=n.gen(e).round,s=n.gen(t).round;return r?s-a<BigInt(Math.floor(1e6/i)):a>=s}var y=i("342558"),_=i("748994"),v=i("211561");class k extends a{get _previewProxy(){if(!this._enablePreviewProxy||!this._preview)return this._preview;if(!("function"==typeof this._preview.isDeleted&&this._preview.isDeleted()))return this._preview}get isAudioOnly(){return this._isAudioOnly}get progress(){return this._progress}get duration(){return this._duration}get state(){return this._state}set state(e){if([s.je.SEEKING,s.je.SEEK_DONE,s.je.PAUSED,s.je.PREPARED].includes(e)&&this._sequenceSetting.fps&&this._sequenceSetting.fps_den&&g(this._progress,this._duration,Number(this._sequenceSetting.fps/this._sequenceSetting.fps_den))&&(e=s.je.PLAY_EOF),this._state===e)return;if(this._state=e,e!==s.je.SEEKING&&e!==s.je.SEEK_WAIT_PLAY)this._onStateChange.fire(e)}onProgress(e,t){if(void 0===this._sequenceSetting.fps||void 0===this._sequenceSetting.fps_den)return;let i=n.pM.div(this._sequenceSetting.fps,this._sequenceSetting.fps_den,"number");if(i>0&&(e=new l.O1(i).gen(e).tail),this._state!==s.je.STOPPED&&(!!t||this._state!==s.je.SEEKING&&this._state!==s.je.SEEK_WAIT_PLAY))this._progress=e,this._onProgressChange.fire({progress:e,isSeek:t})}init(e){let{config:t,globalconfig:i,sequenceSetting:r,editor:n,editorSequence:a,editorPreview:o,createGetFrames:l,createGetImageFrame:u,createSnapshot:h}=e;this._sequenceSetting=r,this._editor=n,this._editorConfig=this._editor.getEnvConfigure(),this._globalConfig=i,this._editorSequence=a,this._preview=o,this._createGetFrames=l,this._createGetImageFrame=u,this._createSnapshot=h;let{fps:p,backgroundRGBA:m=d._4,refreshFlag:f=s.CT.VE_SEEK_FLAG_Refresh,isAudioOnly:g=!1,enablePreviewProxy:y=!1}=t;this._frameDuration=1e6/p,this._backgroundRGBAColor=m,this._refreshFlag=f,this._isAudioOnly=g,this._enablePreviewProxy=y,this.setBackgroundColor(this._backgroundRGBAColor),this.setCanvasBackground({type:v.cVg.MetaTypeCanvasColor,color:this._backgroundRGBAColor}),this._editor.addMessageListener(this._messageListenerId),(0,c.O3)({className:"VEMessageListener",funcName:"onInfo",listenerId:this._messageListenerId,cb:e=>{let{rc:t,intValue:i,fltValue:r,msg:n}=e;this._onInfo(t,i,r,n)}}),(0,c.O3)({className:"VEMessageListener",funcName:"onError",listenerId:this._messageListenerId,cb:e=>{this._onError.fire(e)}}),this._editor.setStreamingEditListener(this._streamEditListnerId),(0,c.O3)({className:"StreamingEditListener",funcName:"onLoadFail",listenerId:this._streamEditListnerId,cb:e=>{this._onStreamFail.fire({assetId:e.asset_id,httpStatus:e.httpStatus,isBlock:e.isBlock,isGetMediaInfo:e.isGetMediaInfo})}}),(0,c.O3)({className:"StreamingEditListener",funcName:"onBufferingStart",listenerId:this._streamEditListnerId,cb:e=>{this._onStreamStart.fire(e)}}),(0,c.O3)({className:"StreamingEditListener",funcName:"onBufferingStop",listenerId:this._streamEditListnerId,cb:e=>{this._onStreamStop.fire(e)}}),(0,c.qk)(e=>{this._beforeCallbackFire.fire(e)})}updateFrameDuration(){if(void 0===this._sequenceSetting.fps||void 0===this._sequenceSetting.fps_den)return!1;let e=n.pM.div(this._sequenceSetting.fps,this._sequenceSetting.fps_den);return!!(e>=1)&&(this._frameDuration=1e6/e,!0)}setBackgroundColor(e){var t;let[i,r,n,a]=(0,f.rW)(e);return(0,c.kB)(null===(t=this._preview)||void 0===t?void 0:t.setPreviewBackgroundColor({r:i,g:r,b:n,a}),-1,"setBackgroundColor")}setDuration(e){this._duration=e}async setPreviewSize(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await (0,c.kB)(null===(i=this._preview)||void 0===i?void 0:i.setPreviewSize(e,t),0,"setPreviewSize"),!r&&this.refreshCurrentFrame()}async setPreviewCanvasSize(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await (0,c.kB)(null===(i=this._preview)||void 0===i?void 0:i.setCanvasSize(e,t),0,"setCanvasSize"),!r&&this.refreshCurrentFrame()}async setCanvasSize(e,t){var i,r;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=BigInt(Math.floor(e)),l=BigInt(Math.floor(t));if(o===this._sequenceSetting.width&&l===this._sequenceSetting.height&&!n)return;if(this._sequenceSetting.width=o,this._sequenceSetting.height=l,n&&(this.state=s.je.STOPPED,null===(i=this._preview)||void 0===i||i.stop()),await this.setPreviewCanvasSize(e,t,a),this.state===s.je.STOPPED||this.state===s.je.IDLE||this.state===s.je.UNKNOWN){if(y.XD.getInstance().first_frame_store){if(0!==await (0,c.kB)(null===(r=this._editor)||void 0===r?void 0:r.prepare(),-1,"prepare"))return;this.state=s.je.PREPARED}!a&&this.seekWithoutCallback(BigInt(this.progress))}}async setCanvasBackground(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={...e,type:(0,_.E)(e.type)};await (0,c.kB)(null===(t=this._preview)||void 0===t?void 0:t.setCanvasBackground(n.HH.stringify(r)),0,"setCanvasBackground"),!i&&this.refreshCurrentFrame()}setTimeRange(e,t){var i;return(0,c.kB)(null===(i=this._preview)||void 0===i?void 0:i.setTimeRange(e,t,1),0,"setTimeRange")}refreshCurrentFrame(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.refreshCurrentFrameWithoutQueue(e,t)}refreshCurrentFrameWithoutQueue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._isRefreshing=!0,0===e&&(e=(0,c.r7)()),new Promise(i=>{var r;let n=(0,c.O3)({className:"VEPreviewControlBind",funcName:"VEPreviewRefreshCallback",listenerId:e,cb:()=>{i(),(0,c.aS)(n)}});(0,c.kB)(null===(r=this._previewProxy)||void 0===r?void 0:r.refreshCurrentFrame(e,BigInt(t?s.CT.VE_SEEK_REFRESH_MODE_FORCE:this._refreshFlag)),-1,"refreshCurrentFrame").then(e=>{0!==e&&i()}),setTimeout(()=>i(),300)})}async play(){var e,t,i;this._state===s.je.PLAY_EOF&&this._sequenceSetting.fps&&this._sequenceSetting.fps_den&&g(this._progress,this._duration,Number(this._sequenceSetting.fps/this._sequenceSetting.fps_den),!0)&&await this._innerSeek(0n,o.Hq.seekDone);let r=await (0,c.kB)(null===(e=this._editor)||void 0===e?void 0:e.getEditorInfoGetter().getEngineState(),s.D5.VE_STATE_ENGINE_NOT_CREATED,"getEngineState");this._state===s.je.SEEKING&&r!==s.D5.VE_STATE_STOPPED?this.state=s.je.SEEK_WAIT_PLAY:((32===r||r===s.D5.VE_STATE_STOPPED)&&await this.getHotUpdateEnable()&&await (0,c.kB)(null===(i=this._editor)||void 0===i?void 0:i.prepare(),-1,"prepare"),this.state=s.je.PLAYING,await (0,c.kB)(null===(t=this._preview)||void 0===t?void 0:t.play(),-1,"play"))}pause(){switch(this._state){case s.je.SEEKING:case s.je.PAUSED:case s.je.PLAY_EOF:case s.je.STOPPED:return;default:var e;null===(e=this._previewProxy)||void 0===e||e.pause(!0),this.state=s.je.PAUSED}this.refreshCurrentFrame()}stop(){var e;if(this._state!==s.je.STOPPED)this.state=s.je.STOPPED,null===(e=this._preview)||void 0===e||e.stop()}async seekTime(e,t){return this._state===s.je.PREPARED&&await new Promise(e=>{let t=this._onStateChange.event(i=>{(i===s.je.PAUSED||i===s.je.SEEK_DONE)&&(t.dispose(),e())})}),this._innerSeek(e,t)}seekWithSpeed(e,t,i,r){return this._innerSeekWithSpeed(e,t,i,r)}flushSeekCmd(){var e;return(0,c.kB)(null===(e=this._preview)||void 0===e?void 0:e.flushSeekCmd(),-1,"flushSeekCmd")}seekForward(e){if(!this._editorSequence)return;let t=this._duration,i=l.ME.create(this._progress,this._frameDuration).next;i=n.pM.min([t,i],"bigint"),this._innerSeek(i,o.Hq.normal),this.onProgress(i,!0)}seekBackward(e){if(this._progress<=0n)return;let t=l.ME.create(this._progress,this._frameDuration).previous;t=n.pM.max([0n,t],"bigint"),this._innerSeek(t,o.Hq.normal),this.onProgress(t,!0)}seekWithoutCallback(e){var t;this.state=s.je.SEEKING,null===(t=this._preview)||void 0===t||t.seekTime(e,BigInt(s.CT.VE_SEEK_FLAG_LastSeek))}setFps(e){var t,i,r;null===(t=this._preview)||void 0===t||t.stop();let a=new u.N(e);this._sequenceSetting.fps=a.numerator(),this._sequenceSetting.fps_den=a.denominator(),null===(i=this._editorSequence)||void 0===i||i.setSequenceSetting(n.HH.stringify(this._sequenceSetting)),this.updateFrameDuration(),null===(r=this._editor)||void 0===r||r.prepare(),this.state=s.je.PREPARED}getHotUpdateEnable(){var e;return(0,c.kB)(null===(e=this._editorConfig)||void 0===e?void 0:e.getConfigBool(d.oW),!1,"getHotUpdateEnable")}stopPreview(){var e,t;if(!this._preview)return;this._isInPreview=!1;let i=this._preview.getCurrentPosition();null===(e=this._preview)||void 0===e||e.stop(),null===(t=this._editor)||void 0===t||t.prepare(),this.state=s.je.PREPARED;let r=n.pM.min([this._previewTimeRangeEndTime,i],"bigint");this.seekWithoutCallback(r)}setEffectSysFontPaths(e){var t;let i=new Module.VectorString;e.forEach(e=>{i.push_back(e)}),null===(t=this._globalConfig)||void 0===t||t.setEffectSysFontPaths(i),i.delete()}startLoadAssetAllRegion(e){var t;return(0,c.kB)(null===(t=this._editor)||void 0===t?void 0:t.startLoadAssetAllRegion(e),-1,"startLoadAssetAllRegion")}getCurrentPosition(){var e;return(0,c.kB)(null===(e=this._preview)||void 0===e?void 0:e.getCurrentPosition(),0n,"getCurrentPosition")}getPreviewVolume(){var e,t,i;return null!==(i=null===(t=this._preview)||void 0===t?void 0:null===(e=t.getPlayerVolume)||void 0===e?void 0:e.call(t))&&void 0!==i?i:0}setPreviewVolume(e){var t,i,r;return null!==(r=null===(i=this._preview)||void 0===i?void 0:null===(t=i.setPlayerVolume)||void 0===t?void 0:t.call(i,e))&&void 0!==r?r:-1}getVideoFrames(e,t,i,r,n){var a;let s=(0,c.r7)(),o=null!=r?r:null===(a=this._editor)||void 0===a?void 0:a.getSequence();if(!o)throw Error("not ready");let l=this._createGetFrames(o),u=(0,c.O3)({className:"IVEGetFramesControl",funcName:"VEGetVideoFramesCallback",listenerId:s,cb:t=>{var i;if(t.pts<0n){(0,c.aS)(u),this._finishGetFrames(u);return}let r=null===(i=e[e.length-1])||void 0===i?void 0:i.callbackData;this._onGetFrame.fire({rawPath:t.rawPath,width:t.width,height:t.height,score:t.score,callbackData:t.callbackData,pts:t.pts,taskId:u,ticket:null!=n?n:"",finished:t.callbackData===r})}});return this._frameStore.set(u,{cbId:u,control:l}),l.setGetVideoFramesCallback(s),l.getVideoFrames(o,e,t,i),u}getImageFrame(e){let t=(0,c.r7)(),i=this._createGetImageFrame(e),r=(0,c.O3)({className:"VEHEICDecodeImp",funcName:"VEHEICDecodeCallback",listenerId:t,cb:e=>{this._onGetFrame.fire({rawPath:e.rawPath,width:e.width,height:e.height,score:0,callbackData:e.ret,pts:0n,taskId:r})}});return this._frameStore.set(r,{cbId:r,control:i}),i.setCallback(t),i.start(),r}getSingleVideoSnapshotFrame(e,t,i){let r=i.assetId,n=i.decryptKey,{ptsList:a}=i,{dstW:s}=i,{dstH:o}=i,l=i.isInit||!1;if(!r||!s||!o)return"";let u=(0,c.r7)(),d=this._createSnapshot(r,null!=n?n:"",s,o),h=(0,c.O3)({className:"VESnapshotCallback",funcName:"VESnapshotCallback",listenerId:u,cb:n=>{this._onGetSingleVideoSnapshot.fire({id:e,path:t,assetId:r,rawPath:n.rawPath,width:n.width,height:n.height,callbackData:n.ret,taskId:i.taskId||"",resquest_pts:n.resquest_pts,response_pts:n.response_pts,isInit:l})}});for(let e of a)d.addPTS(e);return d.setCallback(u),d.start(),h}cancelGetVideoFrames(e){this._finishGetFrames(e)}_finishGetFrames(e){let t=this._frameStore.get(e);if(!t)return;(0,c.aS)(e);let{control:i}=t;i.cancelGetVideoFrames(),i.delete(),this._frameStore.delete(e)}getFaceInfoList(e){var t;let i=`${e}_face-query`;return(0,c.kB)(null===(t=this._editorSequence)||void 0===t?void 0:t.getAmazingFilterParam(i,"face_info"),[],"getAmazingFilterParam")}destroy(){this._onProgressChange.dispose(),this._onStateChange.dispose(),this._onFpsChange.dispose(),this._onFirstFrameRender.dispose(),this._onFrameRender.dispose(),this._onSeekDonePlay.dispose(),this._onRefreshFinish.dispose(),this._onError.dispose(),this._onStreamStart.dispose(),this._onStreamStop.dispose(),this._onStreamFail.dispose()}_onInfo(e,t,i,r){let a=n.pM.times(Number(i.toFixed(3)),1e3,"bigint");switch(e){case h.c3:this._onFpsChange.fire(i);break;case h.$D:performance.mark("LVVE_RESTORE_PREPARE_END");break;case h.BU:this._onFirstFrameRender.fire(),y.XD.getInstance().first_frame_store=!0;break;case h.pH:if(this._sequenceSetting.fps&&this._sequenceSetting.fps_den&&g(this._progress,this._duration,Number(this._sequenceSetting.fps/this._sequenceSetting.fps_den)))break;this._isInPreview?(this.stopPreview(),this.pause(),this.seekTime(this._previewTimeRangeEndTime,o.Hq.seekDone)):(this.state=s.je.PLAY_EOF,this.onProgress(a,!1));break;case h.U_:this._isRefreshing=!1,this._state===s.je.SEEK_WAIT_PLAY?(this.state=s.je.SEEK_DONE,this._onSeekDonePlay.fire()):this._state!==s.je.PLAYING&&(this.state=s.je.SEEK_DONE,this.state=s.je.PAUSED),this._onFrameRender.fire({progress:a,type:e});break;case h.TF:this._isRefreshing=!1,this._onFrameRender.fire({progress:a,type:e}),this._onRefreshFinish.fire();break;case h.yQ:this._onFrameRender.fire({progress:a,type:e});break;case h.gj:case h.tW:if(e===h.gj&&!this._isAudioOnly||e===h.tW&&this._isAudioOnly){let i=this._state;i!==s.je.STOPPED&&i!==s.je.SEEKING&&i!==s.je.SEEK_WAIT_PLAY&&(1!==t&&this.onProgress(a,!1),this._onFrameRender.fire({progress:a,type:e}))}break;case h.zQ:this._onWebGLContextLost.fire();break;case h.PO:this._onWebGLContextRestored.fire();break;case h.qy:this._onLowFrameRate.fire({intValue:t,fltValue:i,msg:r})}}_innerSeek(e,t){var i,r,n;let a;switch(this.onProgress(e,!0),t){case o.Hq.normal:case o.Hq.onGoing:this._state!==s.je.SEEKING&&(this.onProgress(e,!0),performance.mark("WEB_CALL_VE_SEEK_END"),a=(0,c.kB)(null===(i=this._previewProxy)||void 0===i?void 0:i.seekTime(e,BigInt(s.CT.VE_SEEK_FLAG_OnGoing)),-1,"seek1").then(e=>{}));break;case o.Hq.seekDone:default:this._state===s.je.PLAYING&&(null===(n=this._previewProxy)||void 0===n||n.pause(!0)),this.state=s.je.SEEKING,performance.mark("WEB_CALL_VE_SEEK_END"),a=(0,c.kB)(null===(r=this._previewProxy)||void 0===r?void 0:r.seekTime(e,BigInt(s.CT.VE_SEEK_FLAG_LastSeek)),-1,"seek2").then(e=>{})}return a}async _innerSeekWithSpeed(e,t,i,r){if(t===o.Hq.onGoing){var n;this.onProgress(e,!0),await (0,c.kB)(null===(n=this._preview)||void 0===n?void 0:n.seekWithSpeed(e,BigInt(s.CT.VE_SEEK_FLAG_OnGoing),i,r),-1,"innerSeekWithSpeed")}else this._innerSeek(e,t)}constructor(){super(),this._onProgressChange=new p.Q,this._onStateChange=new p.Q,this._onFpsChange=new p.Q,this._onFirstFrameRender=new p.Q,this._onFrameRender=new p.Q,this._onSeekDonePlay=new p.Q,this._onRefreshFinish=new p.Q,this._onError=new p.Q,this._onStreamStart=new p.Q,this._onStreamStop=new p.Q,this._onStreamFail=new p.Q,this._onGetFrame=new p.Q,this._beforeCallbackFire=new p.Q,this._onGetSingleVideoSnapshot=new p.Q,this._onWebGLContextLost=new p.Q,this._onWebGLContextRestored=new p.Q,this._onLowFrameRate=new p.Q,this._isInPreview=!1,this._previewTimeRangeEndTime=0n,this._isRefreshing=!1,this._sequenceSetting={},this._editor=null,this._editorConfig=null,this._globalConfig=null,this._editorSequence=null,this._preview=null,this._frameDuration=0,this._backgroundRGBAColor=d._4,this._refreshFlag=s.CT.VE_SEEK_FLAG_Refresh,this._isAudioOnly=!1,this._progress=0n,this._duration=0n,this._state=s.je.UNKNOWN,this._frameStore=new Map,this._enablePreviewProxy=!1,this._messageListenerId=(0,c.r7)(),this._streamEditListnerId=(0,c.r7)(),this.onProgressChange=this._onProgressChange.event,this.onStateChange=this._onStateChange.event,this.onFpsChange=this._onFpsChange.event,this.onFirstFrameRender=this._onFirstFrameRender.event,this.onFrameRender=this._onFrameRender.event,this.onSeekDonePlay=this._onSeekDonePlay.event,this.onRefreshFinish=this._onRefreshFinish.event,this.onError=this._onError.event,this.onStreamStart=this._onStreamStart.event,this.onStreamStop=this._onStreamStop.event,this.onStreamFail=this._onStreamFail.event,this.onGetFrame=this._onGetFrame.event,this.onLowFrameRate=this._onLowFrameRate.event,this.onGetSingleVideoSnapshot=this._onGetSingleVideoSnapshot.event,this.beforeCallbackFire=this._beforeCallbackFire.event,this.onWebGLContextLost=this._onWebGLContextLost.event,this.onWebGLContextRestored=this._onWebGLContextRestored.event}}(0,r.gn)([(0,m.DH)(1e4,"func"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[void 0,void 0]),(0,r.w6)("design:returntype",void 0)],k.prototype,"refreshCurrentFrame",null),(0,r.gn)([(0,m.DH)(),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",Promise)],k.prototype,"play",null),(0,r.gn)([(0,m.DH)(),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",void 0)],k.prototype,"pause",null),(0,r.gn)([(0,m.DH)(),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof BigInt?Object:BigInt,void 0===o.Hq?Object:o.Hq]),(0,r.w6)("design:returntype",Promise)],k.prototype,"seekTime",null)},657430:function(e,t,i){"use strict";i.d(t,{I:function(){return a}});var r=i(481890),n=i(347138);class a extends n.d{undo(){var e;if(!this.canUndo())return[];let t=this.getCanUndoRedoItemTopIndex(this.undoStack),i=this.undoStack.splice(t,1)[0],n=t>=1;n&&(i=this.transform(i,{stack:this.undoStack,collaboratePointer:t-1}));let a=i.reverse();return this.redoStack.unshift(a),i.execute(r.z.Undo,n),null===(e=this.onUndoRedoChange)||void 0===e||e.call(this),[i]}redo(){var e;if(!this.canRedo())return[];let t=this.getCanUndoRedoItemTopIndex(this.redoStack),i=this.redoStack.splice(t,1)[0],n=t>=1;n&&(i=this.transform(i,{stack:this.redoStack,collaboratePointer:t-1}));let a=i.reverse();return this.undoStack.unshift(a),i.execute(r.z.Redo,n),null===(e=this.onUndoRedoChange)||void 0===e||e.call(this),[i]}push(e){var t,i;let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(r){this.clearRedoStack(),this.undoStack.unshift(e),this.undoStack.length>this.maxStackSize&&this.undoStack.pop(),null===(i=this.onUndoRedoChange)||void 0===i||i.call(this);return}this.undoStack.length>0&&this.undoStack.unshift(e),this.redoStack.length>0&&this.redoStack.unshift(e),null===(t=this.onUndoRedoChange)||void 0===t||t.call(this)}pushWithOperateId(e,t){var i;let r=this.getItemIndexByOperateId(this.undoStack,e);if(r<0)return;let n=this.undoStack[r];for(let e=0;e<r;e++){let i=this.undoStack[e],r=this.followCommand(t.redoCommand,i.undoCommand,!1),n=this.followCommand(i.undoCommand,t.redoCommand,!0),a=this.followCommand(i.redoCommand,r,!1),s=this.followCommand(t.undoCommand,n,!0);t.redoCommand=r,t.undoCommand=s,i.redoCommand=a,i.undoCommand=n}return n.redoCommand=this.composeCommand(n.redoCommand,t.redoCommand),n.undoCommand=this.composeCommand(t.undoCommand,n.undoCommand),null===(i=this.onUndoRedoChange)||void 0===i||i.call(this),n}getItemByOperateId(e){let t=this.getItemIndexByOperateId(this.undoStack,e);return this.undoStack[t]}transform(e,t){let{stack:i}=t,{collaboratePointer:r}=t;for(;r>=0;){let t=i[r],n=this.followCommand(e.undoCommand,t.redoCommand,!0),a=this.followCommand(t.redoCommand,e.undoCommand,!1);e.undoCommand=n,t.redoCommand=a,r-=1}return e}getItemIndexByOperateId(e,t){for(let i=0;i<e.length;i++)if(e[i].operateId===t)return i;return -1}constructor(e){super(),this.followCommand=e.followCommand,this.composeCommand=e.composeCommand,this.onUndoRedoChange=e.onUndoRedoChange}}},521987:function(e,t,i){"use strict";i.d(t,{m3:function(){return n.m},qQ:function(){return r.q}}),i(770868);var r=i(193254),n=i(99372)},529628:function(e,t,i){"use strict";i.d(t,{GB:function(){return s},PN:function(){return l},TQ:function(){return a},cM:function(){return u}});var r=i(340294),n=i(805794);let a=!1,s=[],o=(0,n.B);function l(e){let{apiNamespace:t,apiName:i}=e;for(var a=arguments.length,s=Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];if(!(n.B.context&&[n.i.AI_CREATOR].includes(n.B.context.ccLog.host)))o.log("dataSdk-api",t,i,r.HH.stringify(s)),n.B.ccLog.then(e=>{if(!e)return;let n={type:"lyra_sdk_event",apiType:"data",apiNamespace:t,apiName:i,arguments:r.HH.stringify(s)};e.info(n)})}let u=e=>(t,i,r)=>{let n=r.value;r.value=function(){for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return l({apiNamespace:e,apiName:i},r),n.apply(this,r)}}},112160:function(e,t,i){"use strict";i.d(t,{L:function(){return n}});var r=i(827322);let n=(e,t)=>{let i=new TextEncoder().encode(t),n=URL.createObjectURL(new Blob([i],{type:"plain/text"})),a=document.createElement("a");a.href=(0,r.C)(n,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"cc_web_editor",region:"maliva",urlLimit:"10000",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!1}),a.download=`${e}_${Date().toLocaleLowerCase()}`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}},340294:function(e,t,i){"use strict";i.d(t,{Et:()=>d.Et,ci:()=>h.ci,VF:()=>h.VF,R3:()=>h.R3,fZ:()=>h.fZ,rW:()=>h.rW,yt:()=>d.yt,k3:()=>d.k3,oM:()=>K,P4:()=>o.P,TQ:()=>l.TQ,HH:()=>j,uT:()=>I,D2:()=>V.D,pM:()=>d.pM,Hr:()=>u.H,NN:()=>d.NN,QE:()=>P,y9:()=>w,Fz:()=>s.F,Uk:()=>N,BK:()=>b,cM:()=>l.cM,kd:()=>z,$F:()=>C,nr:()=>c.n,pc:()=>c.p,EO:()=>h.EO,SI:()=>a.S,jg:()=>h.jg,vC:()=>M,Ob:()=>d.Ob,Tw:()=>R,dD:()=>d.dD,dZ:()=>d.dZ,rX:()=>d.rX,sy:()=>_,Hj:()=>v,LR:()=>p.L,cx:()=>d.cx,L8:()=>k,zG:()=>O,tA:()=>S,dT:()=>B});var r=i("814250"),n=i.n(r),a=i("156216"),s=i("27545"),o=i("78975"),l=i("885534"),u=i("567142"),d=i("573461"),c=i("746966"),h=i("956151"),p=i("557370"),m=i("211890"),f=i("256077"),g=i("701897"),y=i("940105");let _={color:"#000000",width:.08,alpha:1},v={color:"#000000",alpha:.9,angle:-45,distance:5,smooth:.15},k=[f.J.Font,f.J.Size,f.J.Bold,f.J.Italic,f.J.Underline,f.J.EffectStyle,f.J.FillColor,f.J.FillAlpha,f.J.Outline,f.J.Shadow,f.J.UseLetterColor];class I{constructor(){this.text="",this.bold=!1,this.italic=!1,this.underline=!1,this.useEffectDefaultColor=!0,this.fontSize=0,this.textColor="#ffffff",this.textAlpha=1,this.fontId="",this.fontPath="",this.effectId="",this.effectPath="",this.hasBorder=!1,this.borderColor="#000000",this.borderAlpha=0,this.borderWidth=.08,this.hasShadow=!1,this.shadowColor="#000000",this.shadowAlpha=.8,this.shadowAngle=-45,this.shadowDistance=8,this.shadowSmooth=.056,this.shadowSmoothUseDiffuse=!0}}let S=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{text:e,styles:[]}};function w(e){return e.length>=2&&0===e.indexOf("{")&&e.lastIndexOf("}")===e.length-1}function b(e){return e.length>=2&&0===e.indexOf("<")&&e.lastIndexOf(">")===e.length-1}function F(e,t){return Math.abs(e-t)<Number.EPSILON}function C(e){if(!w(e))return b(e)?y.Q.xmlToJson(e):S(e);try{return JSON.parse(e)}catch(t){return console.error("****parseRichText error: ",e),S(e)}}function A(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0!==e[t]?e[t]:i}function x(e,t){if(N(e)){let t=e.content;if(N(t)&&void 0!==t.solid&&N(t.solid)){let e=t.solid.color;if(Array.isArray(e)&&e.length>=3)return function(e){let t=Math.min(255,Math.max(0,Math.round(255*e.x))),i=Math.min(255,Math.max(0,Math.round(255*e.y))),r=Math.min(255,Math.max(0,Math.round(255*e.z))),n=e=>e.toString(16).padStart(2,"0");return`#${n(t)}${n(i)}${n(r)}`}(new m.rf(e[0],e[1],e[2]))}}return t}function E(e){let t={};return t.color=x(e,_.color),t.width=A(e,"width",_.width),t.alpha=A(e,"alpha",_.alpha),t}function D(e){var t,i;let r={};return r.color=x(e,v.color),r.alpha=A(e,"alpha",1),r.angle=A(e,"angle",v.angle),r.distance=A(e,"distance",v.distance),r.smooth=null!==(i=null!==(t=null==e?void 0:e.feather)&&void 0!==t?t:null==e?void 0:e.diffuse)&&void 0!==i?i:v.smooth,r}function M(e,t){let i={};if(f.k.has(t)){let r=f.k.get(t);r&&void 0!==e[r]&&(i=e[r])}else t===f.J.FillColor||t===f.J.FillAlpha?void 0!==e.fill&&(i=t===f.J.FillColor?x(e.fill,"#ffffff"):A(e.fill,"alpha",1)):t===f.J.Outline?void 0!==e.strokes&&Array.isArray(e.strokes)&&e.strokes.length>0&&(i=E(e.strokes[0])):t===f.J.Shadow&&void 0!==e.shadows&&Array.isArray(e.shadows)&&e.shadows.length>0&&(i=D(e.shadows[0]));return i}function K(e){let t=(0,g.PS)(e);return{render_type:"solid",solid:{alpha:1,color:t.length>=3?[t[0],t[1],t[2]]:[1,1,1]}}}function P(e,t,i){if(i===f.J.Font)return JSON.stringify(e)===JSON.stringify(t);if(i===f.J.Size)return typeof e==typeof t&&"number"==typeof e?F(e,t):JSON.stringify(e)===JSON.stringify(t);if(i===f.J.Bold||i===f.J.Underline||i===f.J.Italic)return(null!==e&&e)===(null!==t&&t);if(i===f.J.FillColor)return JSON.stringify(e)===JSON.stringify(t);if(i===f.J.FillAlpha)return F(null===e?1:e,null===t?1:t);if(i===f.J.EffectStyle)return JSON.stringify(e)===JSON.stringify(t);if(i===f.J.Outline){if(null===e&&null===t)return!0;if("object"!=typeof e||"object"!=typeof t)return!1;let i={..._,...e},r={..._,...t};if(i.color!==r.color)return!1;for(let e of["alpha","width"]){let t=i[e];if(!F(t,r[e]))return!1}return!0}if(i===f.J.Shadow){if(null===e&&null===t)return!0;if("object"!=typeof e||"object"!=typeof t)return!1;let i={...v,...e},r={...v,...t};if(i.color!==r.color)return!1;for(let e of["alpha","smooth","distance","angle"]){let t=i[e];if(!F(t,r[e]))return!1}return!0}return i===f.J.UseLetterColor?(null!==e&&e)===(null!==t&&t):(console.error("Unknown RichTextStyle:",i),JSON.stringify(e)===JSON.stringify(t))}function B(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{location:0,length:0};if(!e||!w(e))return[];if(!k.includes(t))return console.warn("g_richTextFullTypes.has(type) is false"),[];let r=C(e);if("object"!=typeof r)return console.warn("json is not an object"),[];let n=r.styles;if(!Array.isArray(n)||0===n.length)return console.warn("jsonStyles is not an array or is empty"),[];let a=n[n.length-1].range[1];if(i.location<0||i.length<0||i.location+i.length>a)return console.warn("Invalid selectRange"),[];i.location<=a&&i.location>=0&&0===i.length&&(i.location=0,i.length=a);let s=[i.location,i.location+i.length],o=[];for(let e of n){let i=e.range,r=i[0],n=i[1];if(n<=s[0])continue;let a=M(e,t),l=Math.min(n,s[1]);if(o.length&&P(o[o.length-1].value,a,t)){let e=o[o.length-1];e.range={location:e.range.location,length:l-e.range.location}}else{let e={range:{location:r,length:l-r},value:a};o.push(e)}if(n>=s[1])break}return o}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{location:0,length:0},i="string"==typeof e?C(e):e;if(!N(i))return console.error("Invalid JSON format"),new Map;let r=i.styles;if(!r||!Array.isArray(r)||0===r.length)return console.error("Invalid or empty styles array"),new Map;let n=r[r.length-1].range[1];if(t.location<0||t.length<0||t.location+t.length>n)return console.error("Invalid select range"),new Map;t.location<=n&&t.location>=0&&0===t.length&&(t.location=0,t.length=n);let a=[t.location,t.location+t.length],s=new Map;for(let e of k)s.set(e,[]);for(let e of r){let t=e.range,i=t[0],r=t[1];if(r<=a[0])continue;let n=function(e){let t=new Map;for(let e of k)t.set(e,null);for(let[i,r]of f.k)e[r]&&t.set(i,e[r]);if(N(e.fill)&&(t.set(f.J.FillColor,x(e.fill,"#ffffff")),t.set(f.J.FillAlpha,A(e.fill,"alpha",1))),Array.isArray(e.shadows)&&e.shadows.length>0){let i=e.shadows[0];t.set(f.J.Shadow,D(i))}if(Array.isArray(e.strokes)&&e.strokes.length>0){let i=e.strokes[0];t.set(f.J.Outline,E(i))}return t}(e),o=Math.min(r,a[1]);for(let[e,t]of s){let r=null;if(n.has(e)&&(r=n.get(e)),null!==r)if(t.length>0&&P(t[t.length-1].value,r,e)){let e=t[t.length-1],i=e.range;e.range={location:i.location,length:o-i.location}}else{let e={range:{location:i,length:o-i},value:r};t.push(e)}}if(r>=a[1])break}return s}function z(e){if(e.length<=1)return;let t=[e[0]];for(let i=1;i<e.length;++i)Math.abs(e[i]-t[t.length-1])>1e-6&&t.push(e[i]);e.length=0,e.push(...t)}var V=i("588587");let j=n()({useNativeBigInt:!0}),N=e=>"[object Object]"===Object.prototype.toString.call(e),R=e=>Array.from(new Set(e))},399835:function(e,t,i){"use strict";i.d(t,{BU:function(){return d},Ug:function(){return u},YX:function(){return h},Ze:function(){return l},Zr:function(){return c},aj:function(){return o},kt:function(){return s},nP:function(){return p}});var r=i(211561);let n={kSmoothSkinId:"7106322605304451614",kBeautyId:"6976822940608238093",kSkinWhiteningId:"6998408303826965006",kTeethWhiteningId:"6998408263892996639",kReshapeMergeId:"7126765507457323557",kBigEyesId:"6998408219898941982",kSlimNoseId:"6998408142216237575",kSlimBodyId:"6976812219048661540",kLongLegsId:"6956089104412971534",kSlimWaistId:"6976812120591569416",kSmallHeadId:"6976812039847023111"},a={kLevel1BeautyCategoryId:"auto-beauty2",kLevel1BeautyBodyCategoryId:"auto-beauty3",kLevel1BeautyReshapeCategoryId:"auto-beauty",kLevel1BeautyMakeupCategoryId:"makeup",kLevel2BeautyCategoryId:"34949",kLevel2BeautyBodyCategoryId:"34950",kLevel2BeautyReshapeCategoryId:"39814"};function s(e){return e===n.kBeautyId||e===n.kSkinWhiteningId||e===n.kTeethWhiteningId||e===n.kSmoothSkinId}function o(e){return e===n.kSlimBodyId||e===n.kSlimWaistId||e===n.kLongLegsId||e===n.kSmallHeadId}function l(e){return e===n.kBigEyesId||e===n.kReshapeMergeId||e===n.kSlimNoseId}function u(e){return e===a.kLevel1BeautyCategoryId||e===a.kLevel2BeautyCategoryId}function d(e){return e===a.kLevel1BeautyBodyCategoryId||e===a.kLevel2BeautyBodyCategoryId}function c(e){return e===a.kLevel1BeautyReshapeCategoryId||e===a.kLevel2BeautyReshapeCategoryId}function h(e){return e===a.kLevel1BeautyMakeupCategoryId}r.n1J.VKFFCommonMaskPosition,r.n1J.VKFFCommonMaskSize,r.n1J.VKFFCommonMaskRotation,r.n1J.VKFFCommonMaskFeather,r.n1J.VKFFCommonMaskRoundCorner,r.n1J.VKFFEffectAdjustParam1,r.n1J.VKFFEffectAdjustParam2,r.n1J.VKFFEffectAdjustParam3;let p={kPlaceHolderMaterialPath:"##_material_placeholder_23B2EC28-9736-45F9-966B-EBC7E2D228BE_##",kAudioPlaceHolderMaterialPath:"##_material_placeholder_2357A453-6369-4e5e-9192-A0CE55BEA703_##",kCoverPlaceHolderMaterialPath:"##_material_placeholder_40232EF7-7217-4303-9A7F-5E33B0B12A7B_##"}},187198:function(e,t,i){"use strict";i.d(t,{Tn:function(){return c},zE:function(){return l}});var r,n=i(89172),a=i(211561),s=i(912224),o=i(217201);var l=((r={})[r.JointNone=0]="JointNone",r[r.JointInOrder=1]="JointInOrder",r);class u{constructor(){this.maxDuration=0n,this.textStickerFallbackFontPathList=[],this.materialPhotoDuration=10800n*1000000n,this.draftPath="",this.platform=new a.t4T,this.effectRenderIndexFetcher=null,this.reportCallback=null,this.lyraAbtestEnable=!1,this.abTestBool=new Map,this.clearUselessTransitionCallback=null}}class d{constructor(e){this.sTrackType=e.sTrackType,this.tTrackType=e.tTrackType,this.condition=e.condition,this.type=e.type,this.value=e.value}}class c{getMaterialPhotoMaxDuration(){return this.editDraftBasicConfig.materialPhotoDuration}setEditDraftConfigMaxDuration(e){this.editDraftBasicConfig.maxDuration=e}getEditDraftConfigMaxDuration(){return this.editDraftBasicConfig.maxDuration}setTextStickerFallbackFontPathList(e){this.editDraftBasicConfig.textStickerFallbackFontPathList=e}getTextStickerFallbackFontPathList(){return this.editDraftBasicConfig.textStickerFallbackFontPathList}setCurrentDraftPath(e){this.editDraftBasicConfig.draftPath=e}getCurrentDraftPath(){return this.editDraftBasicConfig.draftPath}registerEditDraftRuleGlobalConfig(e,t){this.globalConfig[e]=t}setABTestEnable(e,t){this.editDraftBasicConfig.abTestBool.set(e,t)}getABTestEnable(e){return!!this.editDraftBasicConfig.abTestBool.has(e)&&this.editDraftBasicConfig.abTestBool.get(e)}registerEditDraftRuleConfig(e,t,i,r,n){let a=new d({sTrackType:e,tTrackType:t,condition:i,type:r,value:n});this.configs.push(a)}findEditDraftRuleConfig(e,t,i,r){for(let r of this.configs)if(r.sTrackType===t&&r.tTrackType===i&&r.condition(t,e))return r.value;return this.globalConfig[r]}getDraftVersion(){return n.lr}setDraftPlatform(e){this.editDraftBasicConfig.platform=e.clone()}setMaterialPhotoMaxDuration(e){this.editDraftBasicConfig.materialPhotoDuration=e}getCloudDraftBaseVersion(){return n.Q3}setEffectRenderIndexFetcher(e){this.editDraftBasicConfig.effectRenderIndexFetcher=e}getEffectRenderIndexFetcher(){return this.editDraftBasicConfig.effectRenderIndexFetcher}getDraftPlatform(){return this.editDraftBasicConfig.platform}setReportCallback(e){this.editDraftBasicConfig.reportCallback=e}getReportCallback(){return this.editDraftBasicConfig.reportCallback}setClearUselessTransitionCallback(e){this.editDraftBasicConfig.clearUselessTransitionCallback=e}getClearUselessTransitionCallback(){return this.editDraftBasicConfig.clearUselessTransitionCallback}changeDraftRenderIndexMode(e,t){return e?new s.eK().changeDraftRenderIndexMode(e,t):[]}calBitrate(e,t){let i=[[480,[35e5,45e5,6e6]],[720,[8e6,1e7,16e6]],[1080,[12e6,16e6,2e7]],[1440,[2e7,25e6,3e7]],[2160,[35e6,45e6,55e6]]],r=[],n=Math.min(e,t);for(let e of i)if(e[0]>=n){r=e;break}return 0!==r.length?r[1]:i[i.length-1][1]}constructor(){this.configs=[],this.globalConfig={0:0,1:0},this.editDraftBasicConfig=new u,this.editDraftBasicConfig.maxDuration=BigInt(36e9),this.registerEditDraftRuleConfig(a.pNd.TrackTypeVideo,a.pNd.TrackTypeVideo,(e,t)=>e===a.pNd.TrackTypeVideo&&t===o.fm,0,1)}}},312473:function(e,t,i){"use strict";i.d(t,{p:function(){return r}});class r{static SetRender(e){r.render=e}static CreateVEUtils(){return r.render.utils}static CreateVePreview(){return r.render.preview}static CreateVEInfoSticker(){var e;return null===(e=r.render.editor)||void 0===e?void 0:e.infoSticker}}},585235:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var r=i(933199);class n{constructor(e){this.query=new r.z(e)}}},683598:function(e,t,i){"use strict";i.d(t,{e:function(){return n}});var r=i(217201);function n(e,t,i){let{segmentId:n,trackId:a,clipTime:s,clipType:o}=t;r.c8.updateSegmentTimeRange(e,n,s,o,[],!0,!1,i)}},687522:function(e,t,i){"use strict";i.d(t,{h:function(){return h}});var r=i(280700),n=i(448218),a=i(217201),s=i(481631),o=i(602777),l=i(392742),u=i(211561),d=i(432641),c=i(283751);function h(e,t,i){let{segmentId:h,clipTime:p,clipType:m}=t,{segmentIndex:f,trackIndex:g}=(0,r.Cm)(e.getAllTracks(),h),y=e.getAllTracks()[g],_=y.segments[f],{duration:v}=_.targetTimerange;if(a.c8.updateSegmentTimeRange(e,h,p,m,[],!0,!1,i),!t.record)return;let k=a.c8.updateStickerAnimationDurationBySegment(e,_,v);if(k&&(0,n.W)(k,i),(0,s.Ft)(_)&&_.material.addType===o.RZ.ManualAdd&&0!==_.material.words.text.length){let e=(0,s.xX)({__segment_struct_type:_.__segment_struct_type}),t=new u.edz,r=new u.JQY({...d.L.generateTextMaterialWordsTimeRange(_.material.words.text.length,_.targetTimerange.duration)});t.words=r,e.material=t;let a=(0,s.xX)({__segment_struct_type:_.__segment_struct_type});c.T.pick(_,e,a),(0,n.W)({type:l.x.UpdateSegment,params:{trackId:y.id,segmentId:_.id,segmentDelta:e,sourceSegmentDelta:a,trackIndex:g}},i)}}},383798:function(e,t,i){"use strict";i.d(t,{u:function(){return f}});var r=i(602777),n=i(211561),a=i(283751),s=i(481631),o=i(280700),l=i(599446),u=i(129862),d=i(698159),c=i(521987),h=i(340294),p=i(217201),m=i(98819);function f(e,t,i,f){var g,y,_,v,k,I,S;let w;let{segmentId:b,splitTime:F,splitTextAudioBindToText:C=!1}=t,{segmentIndex:A,trackId:x,trackIndex:E}=(0,o.Cm)(e.getAllTracks(),b),D=e.getAllTracks()[E],M=D.segments[A],K=M.clone(!0);["SegmentText","SegmentTextTemplate"].includes(K.__segment_struct_type)&&K.material&&(K.material.textToAudioIds=[]);let P=M.targetTimerange.start,B=M.targetTimerange.duration,O=F-P,z=F;if((0,s.Y9)(M)){let t=1;K.speed&&(t=K.speed.speed);let r=h.pM.times(O,t,"bigint");K.targetTimerange=new n.tnv({start:F,duration:M.targetTimerange.duration-O}),K.sourceTimerange=new n.tnv({start:M.sourceTimerange.start+r,duration:M.sourceTimerange.duration-r});let o=null!==(_=null===(g=M.fade)||void 0===g?void 0:g.fadeInDuration)&&void 0!==_?_:0n,l=null!==(v=null===(y=M.fade)||void 0===y?void 0:y.fadeOutDuration)&&void 0!==v?v:0n;if(K.fade&&(K.fade.fadeInDuration=0n,K.fade.fadeOutDuration=h.pM.min([l,O],"bigint")),C){let t=(0,c.qQ)(e,K);t&&i(t)}let d=new n.CCx;d.targetTimerange=new n.zel({start:M.targetTimerange.start,duration:O}),d.sourceTimerange=new n.zel({start:M.sourceTimerange.start,duration:r}),d.fade=new n.lMN({fadeInDuration:h.pM.min([o,O],"bigint"),fadeOutDuration:0n});let m=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});a.T.pick(M,d,m),i(new u.F({segmentId:b,trackId:x,trackIndex:E,segmentDelta:d,sourceSegmentDelta:m})),e.isTTSAutoUpdate(M.material.textId)&&p.c8.syncAudioToText(e,M,i,f)}else{K.targetTimerange=new n.tnv({start:F,duration:M.targetTimerange.duration-O}),z=F;let e=(0,s.xX)(M);e.targetTimerange=new n.zel({start:M.targetTimerange.start,duration:O});let t=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});a.T.pick(M,e,t),i(new u.F({segmentId:b,trackId:x,trackIndex:E,segmentDelta:e,sourceSegmentDelta:t}))}if(["SegmentText","SegmentSticker","SegmentImageSticker","SegmentHandwrite"].includes(M.__segment_struct_type)){let t=null===(k=M.animations)||void 0===k?void 0:k.animations;if(t){let e=null==t?void 0:null===(I=t.find(e=>"in"===e.type))||void 0===I?void 0:I.duration,r=null==t?void 0:null===(S=t.find(e=>"out"===e.type))||void 0===S?void 0:S.duration,o=[...null!=t?t:[]];e&&e>0n&&O<=e&&(o=o.filter(e=>"loop"!==e.type)),r&&r>0n&&B-O<=r&&(K.animations.animations=K.animations.animations.filter(e=>"loop"===e.type)),o=o.filter(e=>"out"!==e.type),K.animations.animations=K.animations.animations.filter(e=>"in"!==e.type);let l=new n.xKN;l.animations=new n.PA,l.animations.animations=o;let d=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});a.T.pick(M,l,d),i(new u.F({segmentId:b,trackId:x,trackIndex:E,segmentDelta:l,sourceSegmentDelta:d}))}i(w=new l._({segment:K,trackIndex:E,trackId:x})),(0,d.W)(p.c8.updateStickerAnimationDurationBySegment(e,M,B),i),(0,d.W)(p.c8.updateStickerAnimationDurationBySegment(e,K,B),i)}else"SegmentTextTemplate"===M.__segment_struct_type&&M&&(i(w=new l._({segment:K,trackId:x,trackIndex:E})),(0,d.W)(p.c8.updateStickerAnimationDurationBySegment(e,M,B),i),(0,d.W)(p.c8.updateStickerAnimationDurationBySegment(e,K,B),i));return(0,s.Ft)(M)&&(0,s.Ft)(K)&&M.material.addType===r.RZ.ManualAdd&&M.material.words.text.length>0&&(i(p.c8.updateTextMaterialWords(D.id,E,M)),i(p.c8.updateTextMaterialWords(D.id,E,K))),!w&&i(w=new l._({segment:K,trackId:x,trackIndex:E})),m._.splitKeyframesByTimeRange(e,M,K,F,z,i),K.id}},433896:function(e,t,i){"use strict";i.d(t,{q:function(){return a}});var r=i(211561),n=i(287165);let a=e=>{var t,i,a,s,o,l,u,d,c,h;let p=new r.prf;return p.id=(0,n.p)(),p.hslColorType=null!==(l=null===(t=e.hslParams)||void 0===t?void 0:t.hslColorType)&&void 0!==l?l:0,p.hue=null!==(u=null===(i=e.hslParams)||void 0===i?void 0:i.hue)&&void 0!==u?u:0,p.saturation=null!==(d=null===(a=e.hslParams)||void 0===a?void 0:a.saturation)&&void 0!==d?d:0,p.lightness=null!==(c=null===(s=e.hslParams)||void 0===s?void 0:s.lightness)&&void 0!==c?c:0,p.path=null!==(h=null===(o=e.hslParams)||void 0===o?void 0:o.path)&&void 0!==h?h:"",p.interacting=!0,p}},185400:function(e,t,i){"use strict";i.d(t,{$F:function(){return g},JL:function(){return p},Mz:function(){return l},PS:function(){return f},Q0:function(){return u},QR:function(){return d},SM:function(){return a},gb:function(){return n},jz:function(){return h},oH:function(){return c},pl:function(){return m},rp:function(){return s},yy:function(){return o}});var r=i(211561);let n=[r.Eu.KFTypeEffectAdjustParam1,r.Eu.KFTypeEffectAdjustParam2,r.Eu.KFTypeEffectAdjustParam3],a=[r.Eu.KFTypeVolume,r.Eu.KFTypeLastVolume],s=[r.Eu.KFTypeBrightness,r.Eu.KFTypeContrast,r.Eu.KFTypeSaturation,r.Eu.KFTypeSharpen,r.Eu.KFTypeHightLight,r.Eu.KFTypeShadow,r.Eu.KFTypeTemperature,r.Eu.KFTypeHue,r.Eu.KFTypeFade,r.Eu.KFTypeLightSensatione,r.Eu.KFTypeVignetting,r.Eu.KFTypeParticle],o=[r.Eu.KFTypePrimaryColorWheelIntensity,r.Eu.KFTypeLogColorWheelIntensity,r.Eu.KFTypeLUT,r.Eu.KFTypeSmartColorAdjust],l=[r.Eu.KFTypePrimaryColorWheelIntensity,r.Eu.KFTypeLogColorWheelIntensity],u=[r.Eu.KFTypePositionX,r.Eu.KFTypePositionY,r.Eu.KFTypeScaleX,r.Eu.KFTypeScaleY,r.Eu.KFTypeRotation],d=[r.Eu.KFTypeChromaIntensity,r.Eu.KFTypeChromaShadow],c=[r.Eu.KFTypeCommonMaskPositionX,r.Eu.KFTypeCommonMaskPositionY,r.Eu.KFTypeCommonMaskSizeWidth,r.Eu.KFTypeCommonMaskSizeHeight,r.Eu.KFTypeCommonMaskRotation,r.Eu.KFTypeCommonMaskFeather,r.Eu.KFTypeCommonMaskRoundCorner],h=[r.Eu.KFTypeTextColor,r.Eu.KFTypeTextAlpha,r.Eu.KFTypeGlobalAlpha],p=[r.Eu.KFTypeBorderWidth,r.Eu.KFTypeBorderColor,r.Eu.KFTypeBorderAlpha],m=[r.Eu.KFTypeBackgroundColor,r.Eu.KFTypeBackgroundAlpha],f=[r.Eu.KFTypeShadowColor,r.Eu.KFTypeShadowAlpha,r.Eu.KFTypeShadowSmoothing,r.Eu.KFTypeShadowAngle,r.Eu.KFTypeShadowDistance],g=[r.Eu.KFTypeBloomColor,r.Eu.KFTypeBloomAlpha,r.Eu.KFTypeBloomStrength,r.Eu.KFTypeBloomRange,r.Eu.KFTypeBloomDirX,r.Eu.KFTypeBloomDirY]},508278:function(e,t,i){"use strict";i.d(t,{H8:function(){return o},ZP:function(){return l},aq:function(){return a},sZ:function(){return s}});var r=i(211561),n=i(189304);let a=(e,t)=>new r.KS6({x:e,y:t});function s(e,t){for(let i of e.commonKeyframes)if(i&&i.propertyType===t)return i;return null}function o(e,t){return"number"==typeof e&&"number"==typeof t?1e3>Math.abs(e-t):("bigint"!=typeof e&&(e=BigInt(Math.round(e))),"bigint"!=typeof t&&(t=BigInt(Math.round(t))),1e3>Math.abs(Number(e-t)))}class l{constructor(e){this.query=new n.A(e)}}},127926:function(e,t,i){"use strict";i.d(t,{OL:function(){return g}});var r=i(211561),n=i(602777),a=i(129862),s=i(508278),o=i(982811),l=i(35276),u=i(481631),d=i(340294),c=i(283751);function h(e,t){let i,r,n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)return{prev:i,next:r,keyframe:n};let{keyframeList:s}=e;for(let[o,l]of s.entries())if(l.id===t){o>0&&(i=s[o-1]),o<s.length-1&&(r=s[o+1]),a&&e.keyframeList.splice(o,1),n=l;break}return{prev:i,next:r,keyframe:n}}function p(e,t){if(void 0!==e&&void 0!==t){if(e.curveType!==r.wHM.KeyframeCurveTypeLine){let i=e.rightControl;!i&&(i=new r.KS6({x:0,y:0}),e.rightControl=i);let n=t.timeOffset-e.timeOffset;0===i.x?(i.x=d.pM.times(n,.4)+0,i.y=0):i.x>=n&&(i.x=Number(n))}if(t.curveType!==r.wHM.KeyframeCurveTypeLine){let i=t.leftControl;!i&&(i=new r.KS6({x:0,y:0}),t.leftControl=i);let n=e.timeOffset-t.timeOffset;0===i.x?(i.x=d.pM.times(n,.4)+0,i.y=0):i.x<=n&&(i.x=Number(n))}}}let m=[r.Eu.KFTypeTextColor,r.Eu.KFTypeTextColor,r.Eu.KFTypeTextAlpha,r.Eu.KFTypeShadowColor,r.Eu.KFTypeShadowAlpha,r.Eu.KFTypeShadowSmoothing,r.Eu.KFTypeShadowAngle,r.Eu.KFTypeShadowDistance,r.Eu.KFTypeBorderColor,r.Eu.KFTypeBorderAlpha,r.Eu.KFTypeBorderWidth,r.Eu.KFTypeBloomColor,r.Eu.KFTypeBloomAlpha,r.Eu.KFTypeBloomStrength,r.Eu.KFTypeBloomRange,r.Eu.KFTypeBloomDirX,r.Eu.KFTypeBloomDirY],f=m.concat([r.Eu.KFTypeBackgroundColor,r.Eu.KFTypeBackgroundAlpha,r.Eu.KFTypeGlobalAlpha]);class g{static takeKeyframes(e,t){let i=e.commonKeyframes.findIndex(e=>e.propertyType===t);if(-1!==i)return e.commonKeyframes.splice(i,1)[0]}static takeKeyframesList(e,t){t.forEach(t=>{g.takeKeyframes(e,t)})}static findKeyframes(e,t){let i=e.commonKeyframes.findIndex(e=>e.propertyType===t);if(-1!==i)return e.commonKeyframes[i]}static findKeyframeByTimeOffset(e,t,i){let r,n,a;void 0===i&&([t,i]=[t-g.gKeyframeTimeTorlerance,t+g.gKeyframeTimeTorlerance]);let s=-1,{keyframeList:o}=e;for(let e of o){if(++s,!!e){if(e.timeOffset>=t&&e.timeOffset<=i){s<o.length-1&&(a=o[s+1]),r=e;break}if(e.timeOffset>i){a=e;break}n=e}}return{keyframe:r,prev:n,next:a}}static ensureKeyframes(e,t,i,n,s,o){let l=this.findKeyframes(i,n);if(void 0===l){if((l=new r.koq).propertyType=n,l.materialId=null!=s?s:"",o){let r=(0,u.xX)({__segment_struct_type:i.__segment_struct_type});r.commonKeyframes=[...i.commonKeyframes,l];let n=(0,u.xX)({__segment_struct_type:i.__segment_struct_type});c.T.pick(i,r,n),o(new a.F({segmentId:i.id,trackId:e,trackIndex:t,segmentDelta:r,sourceSegmentDelta:n}))}else i.commonKeyframes.push(l)}return l}static updateKeyframeParams(e,t,i){if(!e)return;let{flags:a,curveType:s,datas:o,leftControl:l,rightControl:u,graphData:c}=t;if(a&n.yP.KFDataParamFlag_playHead&&(e.timeOffset=i),a&n.yP.KFDataParamFlag_curveType&&e.curveType!==s&&(e.curveType=s,s===r.wHM.KeyframeCurveTypeLine&&(e.leftControl=new r.KS6({x:0,y:0}),e.rightControl=new r.KS6({x:0,y:0}))),a&n.yP.KFDataParamFlag_datas&&0!==o.length){let t=e.values.length,i=[...o];t>0&&o.length!==t&&(0,d.SI)(i,t,o[0]),e.values=i}a&n.yP.KFDataParamFlag_leftControl&&(e.leftControl=new r.KS6(l)),a&n.yP.KFDataParamFlag_rightControl&&(e.rightControl=new r.KS6(u)),a&n.yP.KFDataParamFlag_graphData&&(e.graph=new r.kJb(c))}static insertKeyframe(e,t){if(void 0===e||void 0===t)return;let{keyframeList:i}=e;if(void 0===i)return;let r=!1;for(let[e,n]of i.entries())if(n.timeOffset>t.timeOffset){i.splice(e,0,t),r=!0;break}!r&&i.push(t)}static updateDefaultControlPointById(e,t){if(void 0===e)return;let{keyframe:i,next:r,prev:n}=h(e,t);if(void 0!==i)p(n,i),p(i,r)}static takeKeyframe(e,t){return h(e,t,!0).keyframe}static takeKeyframeFromSegment(e,t){return this.findKeyframeByIdFromSegment(e,t,!0)}static findKeyframeByIdFromSegment(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==e)for(let r of e.commonKeyframes){let{keyframe:e}=h(r,t,i);if(e)return{parent:r,keyframe:e}}}static findKeyframe(e,t){if(!!e)return h(e,t,!1).keyframe}static resetControlPoints(e,t){if(!e)return;let{keyframe:i,next:r,prev:n}=h(e,t);if(!i)return;let{rightControl:a}=i;if(!a&&(a=(0,s.aq)(0,0),i.rightControl=a),a.y=0,r){let e=r.timeOffset-i.timeOffset;a.x=0+.4*Number(e)}let{leftControl:o}=i;if(!o&&(o=(0,s.aq)(0,0),i.leftControl=o),o.y=0,n){let e=n.timeOffset-i.timeOffset;o.x=0+.4*Number(e)}}static repairControlPoints(e){if(0===e.length)return;let t=e.length;for(let i=0;i<t-1;++i){if(0===i){if(e[i].leftControl){let t=(0,s.aq)(0,0);e[i].leftControl=t}let n=e[i].curveType;n!==r.wHM.KeyframeCurveTypeLine&&(1===t?e[i].curveType=r.wHM.KeyframeCurveTypeLine:n===r.wHM.KeyframeCurveTypeCurveOut||n===r.wHM.KeyframeCurveTypeCurveInOut||n===r.wHM.KeyframeCurveTypeCurveIn?e[i].curveType=r.wHM.KeyframeCurveTypeCurveOut:e[i].curveType=r.wHM.KeyframeFreeCurveTypeCurveOut)}p(e[i],e[i+1])}let i=e[e.length-1];if(i){if(i.rightControl){let e=(0,s.aq)(0,0);i.rightControl=e}let e=i.curveType;e!==r.wHM.KeyframeCurveTypeLine&&(1===t?i.curveType=r.wHM.KeyframeCurveTypeLine:e===r.wHM.KeyframeCurveTypeCurveOut||e===r.wHM.KeyframeCurveTypeCurveInOut||e===r.wHM.KeyframeCurveTypeCurveIn?i.curveType=r.wHM.KeyframeCurveTypeCurveIn:i.curveType=r.wHM.KeyframeFreeCurveTypeCurveIn)}}static hasKeyframes(e){if(!e)return!1;for(let t of e.commonKeyframes)if(t.keyframeList.length)return!0;return!1}static hasCommonPropertyKeyframe(e,t){for(let i of e.commonKeyframes)if(i.propertyType===t&&i.keyframeList.length)return!0;return!1}static getKeyframeByCurrentContext(e,t,i){if(!t)return;let r=g.findKeyframes(t,i);if(void 0===r)return;let n=g.getCurrentCaptureTimeOffsetRange(e,t);return this.findKeyframeByTimeOffset(r,n[0],n[1]).keyframe}static getCurrentCaptureTimeOffsetRange(e,t){let i=new l.b,r=o.Y.getInstance().getCaptureContextInfo();if(!r)return[-1n,-1n];let n=BigInt(Math.floor(r.captureWidth/2*1e3/r.trackPxPerMs));0n===n&&(n=g.gKeyframeTimeTorlerance);let a=i.getKeyframeTimeOffsetByTimeline(e,t,r.playHead-n);return[a,i.getKeyframeTimeOffsetByTimeline(e,t,r.playHead+n)]}static splitKeyframe(e,t,i){if(!e||0===e.keyframeList.length)return{left:[],cur:null,right:[]};let r=null,n=[],a=[];for(let s of e.keyframeList){if(!!s)s.timeOffset>=t&&s.timeOffset<=i?(s.timeOffset=t+(i-t)/2n,r?a.push(s):r=s):s.timeOffset<t?n.push(s):a.push(s)}return{left:n,cur:r,right:a}}static calCurverType(e,t){return e&&e.curveType===r.wHM.KeyframeCurveTypeCurveInOut||t&&t.curveType===r.wHM.KeyframeCurveTypeCurveInOut?r.wHM.KeyframeCurveTypeCurveInOut:r.wHM.KeyframeCurveTypeLine}static cloneKeyframeList(e){let t=[];for(let i of e)t.push(i.clone());return t}static filterTextDisableKeyframe(e,t){if(!(0,u.Ft)(t))return e;{let{material:i}=t;return e.filter(e=>{let t=e.propertyType;if(t===r.Eu.KFTypeBorderColor||t===r.Eu.KFTypeBorderWidth)return""!==i.borderColor;if(t===r.Eu.KFTypeBackgroundColor||t===r.Eu.KFTypeBackgroundAlpha)return 0!==i.backgroundStyle;if(t===r.Eu.KFTypeShadowColor||t===r.Eu.KFTypeShadowAlpha||t===r.Eu.KFTypeShadowSmoothing)return i.hasShadow;else return!0})}}static isRichTextKeyframe(e){return m.includes(e)}static isTextStyleKeyframe(e){return f.includes(e)}}g.gKeyframeTimeTorlerance=1000n},91118:function(e,t,i){"use strict";i.d(t,{R:function(){return n}});var r=i(211561);let n={getAdjustProperty(e,t){let i;return t===r.Eu.KFTypeBrightness?i=e&&e.brightness?e.brightness.value:0:t===r.Eu.KFTypeContrast?i=e&&e.contrast?e.contrast.value:0:t===r.Eu.KFTypeSaturation?i=e&&e.saturation?e.saturation.value:0:t===r.Eu.KFTypeSharpen?i=e&&e.sharpening?e.sharpening.value:0:t===r.Eu.KFTypeHightLight?i=e&&e.highlight?e.highlight.value:0:t===r.Eu.KFTypeShadow?i=e&&e.shadow?e.shadow.value:0:t===r.Eu.KFTypeTemperature?i=e&&e.colorTemperature?e.colorTemperature.value:0:t===r.Eu.KFTypeHue?i=e&&e.hue?e.hue.value:0:t===r.Eu.KFTypeFade?i=e&&e.fade?e.fade.value:0:t===r.Eu.KFTypeLightSensatione?i=e&&e.lightSensation?e.lightSensation.value:0:t===r.Eu.KFTypeVignetting?i=e&&e.vignetting?e.vignetting.value:0:t===r.Eu.KFTypeParticle?i=e&&e.particle?e.particle.value:0:t===r.Eu.KFTypeLUT?i=e&&e.lut?e.lut.value:1:t===r.Eu.KFTypePrimaryColorWheelIntensity?i=e&&e.primaryColorWheels?e.primaryColorWheels.intensity:1:t===r.Eu.KFTypeLogColorWheelIntensity?i=e&&e.logColorWheels?e.logColorWheels.intensity:1:t===r.Eu.KFTypeSmartColorAdjust?i=e&&e.smartAdjustColor?e.smartAdjustColor.value:0:t===r.Eu.KFTypeFilter&&(i=e&&e.filter?e.filter.value:1),i},setAdjustProperty(e,t,i){if(!e)return;let n=new r.NOn;n.adjust=new r.cNp;let a=i[0];if(t===r.Eu.KFTypeBrightness)(null==e?void 0:e.brightness)&&(n.adjust.brightness=new r.W9x,n.adjust.brightness.value=a);else if(t===r.Eu.KFTypeContrast)(null==e?void 0:e.contrast)&&(n.adjust.contrast=new r.W9x,n.adjust.contrast.value=a);else if(t===r.Eu.KFTypeSaturation)(null==e?void 0:e.saturation)&&(n.adjust.saturation=new r.W9x,n.adjust.saturation.value=a);else if(t===r.Eu.KFTypeSharpen)(null==e?void 0:e.sharpening)&&(n.adjust.sharpening=new r.W9x,n.adjust.sharpening.value=a);else if(t===r.Eu.KFTypeHightLight)(null==e?void 0:e.highlight)&&(n.adjust.highlight=new r.W9x,n.adjust.highlight.value=a);else if(t===r.Eu.KFTypeShadow)(null==e?void 0:e.shadow)&&(n.adjust.shadow=new r.W9x,n.adjust.shadow.value=a);else if(t===r.Eu.KFTypeTemperature)(null==e?void 0:e.colorTemperature)&&(n.adjust.colorTemperature=new r.W9x,n.adjust.colorTemperature.value=a);else if(t===r.Eu.KFTypeHue)(null==e?void 0:e.hue)&&(n.adjust.hue=new r.W9x,n.adjust.hue.value=a);else if(t===r.Eu.KFTypeFade)(null==e?void 0:e.fade)&&(n.adjust.fade=new r.W9x,n.adjust.fade.value=a);else if(t===r.Eu.KFTypeLightSensatione)(null==e?void 0:e.lightSensation)&&(n.adjust.lightSensation=new r.W9x,n.adjust.lightSensation.value=a);else if(t===r.Eu.KFTypeVignetting)(null==e?void 0:e.vignetting)&&(n.adjust.vignetting=new r.W9x,n.adjust.vignetting.value=a);else if(t===r.Eu.KFTypeParticle)(null==e?void 0:e.particle)&&(n.adjust.particle=new r.W9x,n.adjust.particle.value=a);else if(t===r.Eu.KFTypeLUT)(null==e?void 0:e.lut)&&(n.adjust.lut=new r.W9x,n.adjust.lut.value=a);else if(t===r.Eu.KFTypePrimaryColorWheelIntensity)(null==e?void 0:e.primaryColorWheels)&&(n.adjust.primaryColorWheels=new r.XPs,n.adjust.primaryColorWheels.intensity=a);else if(t===r.Eu.KFTypeLogColorWheelIntensity)(null==e?void 0:e.logColorWheels)&&(n.adjust.logColorWheels=new r.q1S,n.adjust.logColorWheels.intensity=a);else if(t===r.Eu.KFTypeSmartColorAdjust)(null==e?void 0:e.smartAdjustColor)&&(n.adjust.smartAdjustColor=new r.W9x,n.adjust.smartAdjustColor.value=a);else{if(t!==r.Eu.KFTypeFilter)return;if(null==e||!e.filter)return;n.adjust.filter=new r.W9x,n.adjust.filter.value=a}return n},getSegmentProperty(e,t){let i=[];if(t!==r.Eu.KFTypeNone){let r=this.getAdjustProperty(e.material,t);void 0!==r&&i.push(r)}return i},setSegmentProperty(e,t,i){let r=this.setAdjustProperty(e.material,t,i);if(r)return r}}},65582:function(e,t,i){"use strict";i.d(t,{p:function(){return n}});var r=i(527730);let n={setSegmentProperty(e,t,i){let n=r.s.setBaseProperty(e,t,i);if(n)return n},getSegmentProperty:(e,t)=>r.s.getBaseProperty(e,t)}},701456:function(e,t,i){"use strict";i.d(t,{o:function(){return n}});var r=i(211561);let n={setSegmentProperty(e,t,i){if(0===i.length||0===e.material.adjustParams.length)return;let n=e.material.adjustParams.map(e=>e.clone());for(let e of n)if(t===e.name){e.value=i[0];break}let a=new r.LtW;return a.material=new r.UJq,a.material.adjustParams=n,a},getSegmentProperty(e,t){let i=[];for(let r of e.material.adjustParams)if(t===r.name){i.push(r.value);break}return i}}},862227:function(e,t,i){"use strict";i.d(t,{u:function(){return u}});var r=i(211561),n=i(481631),a=i(717501),s=i(129862),o=i(501452),l=i(283751);class u extends a.v{executeNormal(e,t,i){let{segId:a,shadowValue:o}=this.params,u=e.getSegmentById(a);if(!u||!(0,n.he)(u))return;let d=t.chroma?new r.VJQ(t.chroma).clone():new r.VJQ;d.shadowValue=o;let c=new r.NOn;c.chroma=new r.Xkj(d);let h=(0,n.xX)({__segment_struct_type:u.__segment_struct_type});l.T.pick(u,c,h),i(new s.F({trackId:e.getTrackBySegmentId(u.id).id,segmentId:a,segmentDelta:c,trackIndex:e.getTrackIndexBySegmentId(u.id),sourceSegmentDelta:h}))}getKeyframeValues(){return[this.params.shadowValue]}executeInner(e,t,i,r,n){if(e.isKeyframe){let e=o.y.execute({draftView:t,segment:i,keyframeType:r,values:this.getKeyframeValues()});e&&n(new s.F(e))}return!0}}},754774:function(e,t,i){"use strict";i.d(t,{K:function(){return u}});var r=i(211561),n=i(481631),a=i(717501),s=i(129862),o=i(501452),l=i(283751);class u extends a.v{executeNormal(e,t,i){let{segId:a,spillValue:o}=this.params,u=e.getSegmentById(a);if(!u||!(0,n.he)(u))return;let d=t.chroma?new r.VJQ(t.chroma).clone():new r.VJQ;d.spillValue=o;let c=new r.NOn;c.chroma=new r.Xkj(d);let h=(0,n.xX)({__segment_struct_type:u.__segment_struct_type});l.T.pick(u,c,h),i(new s.F({trackId:e.getTrackBySegmentId(u.id).id,trackIndex:e.getTrackIndexBySegmentId(a),segmentId:a,segmentDelta:c,sourceSegmentDelta:h}))}getKeyframeValues(){return[this.params.spillValue]}executeInner(e,t,i,r,n){if(e.isKeyframe){let e=o.y.execute({draftView:t,segment:i,keyframeType:r,values:this.getKeyframeValues()});e&&n(new s.F(e))}return!0}}},188310:function(e,t,i){"use strict";i.d(t,{D:function(){return n}});var r=i(438176);class n{get(e){let t=this._map.get(e);return void 0!==t?t:""===e?(!r.R&&console.warn(`[MapProxy] get empty key from map ${this._name}`),""):void 0!==this._options.defaultGetValue?(!r.R&&console.warn(`[MapProxy] cannot get key'${e}' from map ${this._name}, returns default value ${this._options.defaultGetValue}`),this._options.defaultGetValue):(console.error(`[MapProxy] cannot get key '${e}' from map ${this._name}`),e)}safeGet(e){return this._map.get(e)}set(e,t){if(this._options.throwOnOverride&&this._map.has(e))throw Error(`overriding key '${e}' in map ${this._name} is forbidden`);this._map.set(e,t)}setMultiple(e){for(let[t,i]of Object.entries(e))this._map.set(t,i)}clear(){this._map.clear()}delete(e){if(Array.isArray(e)){e.forEach(t=>this.delete(e));return}this._map.delete(e)}all(){return this._map.entries()}constructor(e,t={}){this._map=new Map,this._name=e,this._options=t}}},822667:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var r=i(602777);class n{getSegmentByIdRecursive(e,t){let{tracks:i}=null!=t?t:this._videoDocument;for(let t of i)for(let i of t.segments){if(i.id===e)return i;let t=this._videoDocument.getMaterialDraft(i);if(!(null==t?void 0:t.draft))continue;let r=this.getSegmentByIdRecursive(e,t.draft);if(r)return r}}enumSegmentsRecursion(e,t,i,r){this._enumSegmentsRecursion([],this._videoDocument,e,t,i,r)}getSegmentsByTrackTypeRecursive(e){return this._getSegmentsByTrackType(e,!0)}getSegmentsByTrackType(e){return this._getSegmentsByTrackType(e,!1)}getAllSubDraft(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=[];return this.enumSegmentsRecursion((e,i)=>{let r=this._videoDocument.getMaterialDraft(i);if(!r)return!1;let n=r.draft;return!!n&&(t.push(n),!1)},e,r.pN.TrackTypeNone,r.cV.MetaTypeNone),t}_getSegmentsByTrackType(e,t){let i=[];return this.enumSegmentsRecursion((t,r,n)=>{if(n.type===e)i.push(r)},t,e,r.cV.MetaTypeNone),i}_enumSegmentsRecursion(e,t,i){let n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.pN.TrackTypeNone,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r.cV.MetaTypeNone,{tracks:o}=t;for(let u of o){let o=a===r.pN.TrackTypeNone||a===u.type,d=[r.pN.TrackTypeVideo,r.pN.TrackTypeAudio,r.pN.TrackTypeComposition,r.pN.TrackTypeAdCube].includes(u.type);if(!o&&!d)continue;let{segments:c}=u;for(let d of c){var l;let c=s===r.cV.MetaTypeNone||(null===(l=d.material)||void 0===l?void 0:l.type)===s;if(d&&o&&c&&i(e,d,u))return!1;if(!!n)switch(u.type){case r.pN.TrackTypeVideo:case r.pN.TrackTypeAudio:case r.pN.TrackTypeComposition:case r.pN.TrackTypeAdCube:let h=t.getMaterialDraft(d);if(!h)continue;e.push(d);let p=h.draft.clone(),m=!this._enumSegmentsRecursion(e,p,i,!0,a,s);if(e.pop(),m)return!1}}}return!0}constructor(e){this._videoDocument=e}}},109671:function(e,t,i){"use strict";i.d(t,{Oo:function(){return d},QX:function(){return c},VV:function(){return s},pG:function(){return a}});var r=i(879566),n=i(340294);function a(e,t,i,r,n,a){try{let t={path:e,fallback_font_path_list:i,depend_resource_list:r.map(e=>({type:e.type,resource_id:e.resourceId,resource_path:e.path})),screen_size:[n,a]};return JSON.stringify(t)}catch{return""}}function s(e){return"shape"===e}function o(e,t,i,r){var n,a,s,o;let l=null!==(n=e[0])&&void 0!==n?n:0,u=null!==(a=e[1])&&void 0!==a?a:0,d=null!==(s=e[2])&&void 0!==s?s:0;return{left:(l-r)/t*2,right:(d+r)/t*2,bottom:(u-r)/i*2,top:((null!==(o=e[3])&&void 0!==o?o:0)+r)/i*2}}function l(e){return(e.left+e.right)/2}function u(e){return(e.bottom+e.top)/2}function d(e,t){var i,n,a,s,d;let{globals:c,root:h,children:p}=e;if(!c||!h||!p||c.screen_size.length<2)return"";let m=t*(null!==(n=null===(i=h.scale)||void 0===i?void 0:i[0])&&void 0!==n?n:1),[f,g]=c.screen_size,y=0!==g?f/g:1,_=o(h.bounding_box,f,g,m),v=h.rotation&&null!==(a=h.rotation[2])&&void 0!==a?a:0,k=p.filter(e=>"text"===e.type).map(e=>{var t,i,n,a,s;let{text_params:d,layout_params:c}=e,h=function(e,t,i,r,n){let a=l(e),s=u(e),[o,d]=function(e,t,i,r,n,a){let s=0,o=0,{PI:l}=Math,u=a*l/180,d=1*n,c=Math.cos(u),h=Math.sin(u),p=i*d,m=1*r,f=e*d,g=1*t;return s=(f-p)*c-(g-m)*h+p,o=((f-p)*h+(g-m)*c+m)/1,[s/=d,o]}(a,s,t,i,r,n),c=o-a,h=d-s;return{left:e.left+c,right:e.right+c,bottom:e.bottom+h,top:e.top+h}}(o(null!==(t=null==c?void 0:c.bounding_box)&&void 0!==t?t:[],f,g,0),l(_),u(_),y,v);return{name:e.name,start_time:e.start_time,duration:e.duration,text_params:d,value:r.hM.getOriginContentFromContent(null!==(i=null==d?void 0:d.richText)&&void 0!==i?i:""),position:null!==(n=e.position)&&void 0!==n?n:[],scale:null!==(a=e.scale)&&void 0!==a?a:[],rotation:e.rotation&&null!==(s=e.rotation[2])&&void 0!==s?s:0,bounding_box:[h.left,h.bottom,h.right,h.top]}});return JSON.stringify({position:null!==(s=h.position)&&void 0!==s?s:[],scale:null!==(d=h.scale)&&void 0!==d?d:[],rotation:v,bounding_box:[_.left,_.bottom,_.right,_.top],text_list:k})}function c(e,t,i,r){let a=n.HH.parse(e);if(!a.root||!t)return e;let s=t.transform.x*i*.5,o=t.transform.y*r*.5;return a.root={...a.root,position:[s,o,0],scale:[t.scale.x,t.scale.y,1],rotation:[0,0,-t.rotation]},n.HH.stringify(a)}},389628:function(e,t,i){"use strict";i.d(t,{h:function(){return n}});let r="__initial_history_id__";class n{static getInstance(){return!n._instance&&(n._instance=new n),n._instance}clearSnapshots(){this._snapshotsMap.clear()}setSnapshot(e,t){this._snapshotsMap.set(null!=e?e:r,t)}getSnapshot(e){return this._snapshotsMap.get(null!=e?e:r)}constructor(){this._snapshotsMap=new Map}}},581592:function(e,t,i){"use strict";i.d(t,{f:function(){return r}});class r{static Instance(){return!r._instance&&(r._instance=new r),r._instance}static isInEditing(e){return e===r.Instance().getLastEditId()}getEditor(e){return e?this._contexts.has(e)?this._contexts.get(e):this._activeEditor:null}setEditorForKey(e,t){if(!!e&&!!t)this._contexts.set(t,e),this._activeEditor=e}removeEditorForKey(e){if(!!e)this._contexts.delete(e)}getLastEditId(){return this._lastEditId}setLastEditId(e){if(this._lastEditId!==e)this._lastEditId=e}constructor(){this._contexts=new Map,this._activeEditor=null,this._lastEditId=""}}},223729:function(e,t,i){"use strict";i.d(t,{A:function(){return a},B:function(){return a}});var r=i(397560),n=i(287165);class a extends r.G{static deserialize(e){let t=new a;return t._isDirty=e.isDirty,t._exeState=e.exeState,t._iOpCode=e.iOpCode,t._iParam1=e.iParam1,t._iParam2=e.iParam2,t._iParam3=e.iParam3,t._iParam4=e.iParam4,t._iParam5=e.iParam5,t._id=e._id,t._isExecutable=e._isExecutable,t}static serialize(e){return{isDirty:e.isDirty,exeState:e.exeState,iOpCode:e.iOpCode,iParam1:e.iParam1,iParam2:e.iParam2,iParam3:e.iParam3,iParam4:e.iParam4,iParam5:e.iParam5}}get iOpCode(){return this._iOpCode}set iOpCode(e){if(e!==this._iOpCode)this._iOpCode=e,this.markAsDirty()}get iParam1(){return this._iParam1}set iParam1(e){if(e!==this._iParam1)this._iParam1=e,this.markAsDirty()}get iParam2(){return this._iParam2}set iParam2(e){if(e!==this._iParam2)this._iParam2=e,this.markAsDirty()}get iParam3(){return this._iParam3}set iParam3(e){if(e!==this._iParam3)this._iParam3=e,this.markAsDirty()}get iParam4(){return this._iParam4}set iParam4(e){if(e!==this._iParam4)this._iParam4=e,this.markAsDirty()}get iParam5(){return this._iParam5}set iParam5(e){if(e!==this._iParam5)this._iParam5=e,this.markAsDirty()}getNodeName(){return"RichTextCommand"}deepCopy(e){let t=new a(e?(0,n.p)():this._id,this._isExecutable);return this.copyDirtyState(t),t.iOpCode=this._iOpCode,t.iParam1=this._iParam1,t.iParam2=this._iParam2,t.iParam3=this._iParam3,t.iParam4=this._iParam4,t.iParam5=this._iParam5,t}clone(e){return this.deepCopy(e)}getStashCopy(e,t){let i=t;if(!e.has(this.id))return i=!0,{node:this.deepCopy(!1),shallCreateHistory:i};{let t=e.get(this.id);if(!t||!(t instanceof a))return i=!0,{node:this.deepCopy(!1),shallCreateHistory:i};if(this.isDirty)return{node:this,shallCreateHistory:i=!0}}return{node:null,shallCreateHistory:i}}restoreFrom(e,t){if(t instanceof a)this.id=t.id,this.iOpCode=t.iOpCode,this.iParam1=t.iParam1,this.iParam2=t.iParam2,this.iParam3=t.iParam3,this.iParam4=t.iParam4,this.iParam5=t.iParam5;else throw Error(`Id conflict: ${t.id}`)}restoreTo(e){return this.markAsDirty(),this}getAllNodes(e){}getEscapeHistoryNodes(e){}setEscapeHistoryNodes(e){}constructor(e,t=!1){super(e||(0,n.p)(),t),this._iOpCode=-1,this._iParam1=0,this._iParam2=0,this._iParam3=0,this._iParam4=0,this._iParam5=""}}}}]);