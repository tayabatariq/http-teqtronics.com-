"use strict";(globalThis.__LOADABLE_LOADED_CHUNKS__=globalThis.__LOADABLE_LOADED_CHUNKS__||[]).push([["7901"],{193985:function(e,t,i){e.exports=i.p+"static/assets/vesdk-lvapi-opt.6cea31de.js"},438369:function(e,t,i){i.d(t,{a:function(){return n}});var r,n=((r={})[r.Local=0]="Local",r[r.Undo=1]="Undo",r[r.Redo=2]="Redo",r[r.History=3]="History",r[r.Collab=4]="Collab",r)},936028:function(e,t,i){i.d(t,{t:function(){return u}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(76592),d=i(331509);let c=(0,a.i)(s.H.AttachmentDeleteAsyncTaskEntityNotExist,"");class u extends r.a{get type(){return n.U.ATTACHMENT_REMOVE_ASYNC_TASK_ENTITIES}check(e){for(let t of this.options.localTaskIds)if(!e.getAsyncTaskMap().has(t))return c(`delete async task entity not exist: ${t}`);return(0,o.ly)()}do(e,t,i){for(let t of this.options.localTaskIds)e(new l.h({attachmentKey:d.d3.AsyncTask,key:t}))}}},421481:function(e,t,i){i.d(t,{j:function(){return u}});var r=i(653322),n=i(150002),a=i(862213),o=i(76592),s=i(331509),l=i(475028),d=i(690613);let c=(0,l.i)(r.H.AttachmentDeleteVideoAlgorithmNotExist,"");class u extends n.a{get type(){return a.Us.ATTACHMENT_REMOVE_VIDEO_ALGORITHMS}check(e){for(let t of this.options.segmentIds)if(!e.getVideoAlgorithmMap().has(t))return c(`delete video algorithm not exist: ${t}`);return(0,d.ly)()}do(e,t,i){for(let t of this.options.segmentIds)e(new o.h({attachmentKey:s.d3.VideoAlgorithm,key:t}))}}},634604:function(e,t,i){i.d(t,{G:function(){return u}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(381119),d=i(331509);let c=(0,a.i)(s.H.AttachmentInsertAsyncTaskEntityDuplication,"");class u extends r.a{get type(){return n.U.ATTACHMENT_INSERT_ASYNC_TASK_ENTITIES}check(e){for(let t of this.options.asyncTaskEntities)if(e.getAsyncTaskMap().has(t.localTaskId))return c("insert async task entity duplicate");return(0,o.ly)()}do(e,t,i){for(let t of this.options.asyncTaskEntities)e(new l.Q({attachmentKey:d.d3.AsyncTask,key:t.localTaskId,value:t}))}}},423196:function(e,t,i){i.d(t,{a:function(){return u}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(381119),d=i(331509);let c=(0,a.i)(s.H.AttachmentInsertVideoAlgorithmDuplication,"");class u extends r.a{get type(){return n.U.ATTACHMENT_INSERT_VIDEO_ALGORITHMS}check(e){for(let t of this.options.videoAlgorithms)if(e.getVideoAlgorithmMap().has(t.segmentId))return c("insert video algorithm duplicate");return(0,o.ly)()}do(e,t,i){for(let t of this.options.videoAlgorithms)e(new l.Q({attachmentKey:d.d3.VideoAlgorithm,key:t.segmentId,value:t}))}}},305604:function(e,t,i){i.d(t,{n:function(){return l}});var r=i(690613),n=i(150002),a=i(862213),o=i(419537),s=i(549480);class l extends n.a{get type(){return a.Us.ATTACHMENT_SET_CREATOR_CONTENT}check(e){return(0,r.ly)()}do(e,t){var i;let r=new s.Eq({content:this.options.content,title:this.options.title});e(new o.K({attachmentKey:a.d3.AiCreator,key:null!==(i=this.options.title)&&void 0!==i?i:"",delta:r}))}}},178399:function(e,t,i){i.d(t,{w:function(){return T}});var r=i(475028),n=i(690613),a=i(211561),o=i(268468),s=i(599446),l=i(700857),d=i(879388),c=i(20315),u=i(150002),m=i(853277),h=i(653322),f=i(711999),p=i(81649);let g=(0,r.i)(h.H.AddAudioTrackNotExist,""),y=(0,r.i)(h.H.AddAudioTrackTypeNotValid,""),_=(0,r.i)(h.H.AddAudioTargetTimeRangeNotValid,"");class T extends u.a{get type(){return m.U.ADD_AUDIO}check(e){let{trackId:t,startTime:i,duration:r}=this.options,o=e.getTrackById(t);return o?o.type!==a.pNd.TrackTypeAudio?y(`trackType not valid: ${o.type}`):i>=0&&r>0?(0,n.ly)():_(`duration not valid: ${r}`):g(`track not exist: ${t}`)}do(e,t,i){(0,f.F)([0,0],a.rxY.CanvasRatio16To9,!1,t,e);let{trackId:r,duration:n,sourceDuration:u}=this.options,m=t.getTrackIndexById(r,[]),h={targetStartTime:this.options.startTime,targetDuration:n<u?n:u,targetTrackIndex:m,type:a.pNd.TrackTypeAudio,targetSegmentId:""};new d.W().moveConflictSegment(t,h,t.getAllTracks(),e,i);let p=c.Ry.createSegmentAudio(this.options);if(p.id=this.options.segmentId,e(new s._({trackId:r,trackIndex:m,segment:p})),this.options.type===a.cVg.MetaTypeRecord){let i=new o.ry;i.recordAudioLastIndex=t.getDraftProperty().recordAudioLastIndex+1,e(new l.W({propertyDelta:i}))}}constructor(e,t){var i,r,n,o,s,l,d,c,u,m,h,f,g,y,_,T,v,I,w,S,k,x,b,M,C,A,E,F,P;let D=new p.O1(t.getDraftProperty().fps),z=D.gen(null!==(i=e.sourceStartTime)&&void 0!==i?i:0n).tail,N=D.gen((null!==(r=e.sourceStartTime)&&void 0!==r?r:0n)+(null!==(n=e.sourceDuration)&&void 0!==n?n:0n)).tail,V=D.gen(null!==(o=e.startTime)&&void 0!==o?o:0n).tail;super({trackId:e.trackId,segmentId:e.segmentId,duration:D.gen((null!==(s=e.startTime)&&void 0!==s?s:0n)+(null!==(l=e.duration)&&void 0!==l?l:0n)).tail-V,audioId:null!==(d=e.audioId)&&void 0!==d?d:"",appId:null!==(c=e.appId)&&void 0!==c?c:0n,audioPath:null!==(u=e.audioPath)&&void 0!==u?u:"",audioTitle:null!==(m=e.audioTitle)&&void 0!==m?m:"",audioCategoryTitle:null!==(h=e.audioCategoryTitle)&&void 0!==h?h:"",audioCategoryId:null!==(f=e.audioCategoryId)&&void 0!==f?f:"",startTime:V,sourceStartTime:z,sourceDuration:N-z,type:null!==(g=e.type)&&void 0!==g?g:a.cVg.MetaTypeNone,extrackMusic:null!==(y=e.extrackMusic)&&void 0!==y&&y,durationLimit:D.gen(null!==(_=e.durationLimit)&&void 0!==_?_:0n).tail,gear:null!==(T=e.gear)&&void 0!==T?T:a.np1.AUDIO_BEAT_GEAR_NONE,gearCount:null!==(v=e.gearCount)&&void 0!==v?v:a.tLB.AUDIO_BEAT_GEAR_COUNT_NONE,mode:null!==(I=e.mode)&&void 0!==I?I:a.seH.AUDIO_BEAT_MODE_NONE,melodyUrl:null!==(w=e.melodyUrl)&&void 0!==w?w:"",melodyPath:null!==(S=e.melodyPath)&&void 0!==S?S:"",beatUrl:null!==(k=e.beatUrl)&&void 0!==k?k:"",beatPath:null!==(x=e.beatPath)&&void 0!==x?x:"",musicBeatPercent:null!==(b=e.musicBeatPercent)&&void 0!==b?b:.6,wavePoints:null!==(M=e.wavePoints)&&void 0!==M?M:[],sourcePlatformType:null!==(C=e.sourcePlatformType)&&void 0!==C?C:a.QZ3.AudioPlatformLibrary,formulaId:null!==(A=e.formulaId)&&void 0!==A?A:"",teamId:null!==(E=e.teamId)&&void 0!==E?E:"",localMaterialId:null!==(F=e.localMaterialId)&&void 0!==F?F:"",requestId:null!==(P=e.requestId)&&void 0!==P?P:""})}}},759137:function(e,t,i){i.d(t,{o:function(){return m}});var r=i(150002),n=i(853277),a=i(211561),o=i(129862),s=i(770868),l=i(690613),d=i(481631),c=i(81649),u=i(283751);class m extends r.a{get type(){return n.U.ADD_AUDIO_BEAT}check(e){return(0,l.ly)()}do(e,t,i){let r=s.z.getInstance(),{segmentId:n}=this.options,l=t.getSegmentById(n);if(!l||!(0,d.Y9)(l))return;let c=this.options.addedBeats.length>0,m=!1,h=null;l.beat?h=l.beat.clone():(m=!0,h=new a.hWf),(m||!c||this.options.enableAiBeats)&&r.updateAudioBeats(this.options,h);let f=new a.CCx;f.beat=new a.NZo(h);let p=(0,d.xX)({__segment_struct_type:l.__segment_struct_type});if(u.T.pick(l,f,p),e(new o.F({segmentDelta:f,segmentId:n,trackId:t.getTrackBySegmentId(n,[]).id,trackIndex:t.getTrackIndexBySegmentId(n),sourceSegmentDelta:p})),c){var g;let i=[...h.userBeats];i.push(...null!==(g=this.options.addedBeats)&&void 0!==g?g:[]),i.sort((e,t)=>Number(e-t)),i=Array.from(new Set(i)),(f=new a.CCx).beat=new a.NZo({userBeats:i}),p=(0,d.xX)({__segment_struct_type:l.__segment_struct_type}),u.T.pick(l,f,p),e(new o.F({segmentDelta:f,segmentId:n,trackId:t.getTrackBySegmentId(n,[]).id,trackIndex:t.getTrackIndexBySegmentId(n),sourceSegmentDelta:p}))}else r.cacheAiBeatsDataIfNeededWithBeat(h,t.getDraftProperty().fps)}constructor(e,t){var i,r,n,a,o;let s=new c.O1(t.getDraftProperty().fps);super({segmentId:e.segmentId,gear:e.gear,gearCount:e.gearCount,mode:e.mode,enableAiBeats:null!==(i=e.enableAiBeats)&&void 0!==i&&i,useDeletedCacheWhenEnableAiBeats:null!==(r=e.useDeletedCacheWhenEnableAiBeats)&&void 0!==r&&r,melodyUrl:e.melodyUrl,melodyPath:e.melodyPath,beatUrl:e.beatUrl,beatPath:e.beatPath,musicBeatPercent:null!==(n=e.musicBeatPercent)&&void 0!==n?n:.6,addedBeats:(null!==(a=e.addedBeats)&&void 0!==a?a:[]).map(e=>s.gen(e).round),beatSpeedInfos:null!==(o=e.beatSpeedInfos)&&void 0!==o?o:[]})}}},838971:function(e,t,i){i.d(t,{s:function(){return p}});var r=i(150002),n=i(862213),a=i(211561),o=i(481631),s=i(475028),l=i(690613),d=i(653322),c=i(129862),u=i(283751);let m=(0,s.i)(d.H.ResetAudioVocalBeautifySegmentNotExist,""),h=(0,s.i)(d.H.ResetAudioVocalBeautifySegmentTypeNotValid,""),f=(0,s.i)(d.H.ResetAudioVocalBeautifySegmentHasNotVocalBeautify,"");class p extends r.a{get type(){return n.Us.RESET_AUDIO_VOCAL_BEAUTIFY}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?void 0===i.vocalBeautify?f(`segment has not vocal beautify: ${i.id}`):(0,l.ly)():h(`segmentType not valid: ${i.__segment_struct_type}`):m(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,o.he)(r)||(0,o.Y9)(r)){let i=(0,o.xX)({__segment_struct_type:r.__segment_struct_type}),s=new a.ck6;s.ambientSoundLevel=this.options.ambientSoundLevel,s.voiceChangeMode=null,i.vocalBeautify=s;let l=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});u.T.pick(r,i,l),e(new c.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:l}))}}}},284947:function(e,t,i){i.d(t,{E:function(){return g}});var r=i(475028),n=i(690613),a=i(211561),o=i(481631),s=i(129862),l=i(150002),d=i(853277),c=i(653322),u=i(987061),m=i(783959),h=i(283751);let f=(0,r.i)(c.H.SetAudioModifiedToneSegmentNotExist,""),p=(0,r.i)(c.H.SetAudioModifiedToneSegmentTypeNotValid,"");class g extends l.a{get type(){return d.U.SET_AUDIO_MODIFIED_TONE}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?(0,n.ly)():p(`segmentType not valid: ${i.__segment_struct_type}`):f(`segment not exist: ${t}`)}do(e,t,i){let{segmentId:r,modifyTone:n}=this.options,l=t.getSegmentNodeById(r,[]),d=l.segment,c=l.trackNode.track.id,f=(0,o.Y9)(d)?new a.CCx:new a.NOn;f.isToneModify=n;let p=(0,o.xX)({__segment_struct_type:d.__segment_struct_type});h.T.pick(d,f,p),e(new s.F({trackId:c,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:f,sourceSegmentDelta:p})),n&&d.speed.mode===a.yY$.SpeedModeCurve&&((0,o.Y9)(d)?(0,m.$)(t,{segmentId:r,value:1},e,i):(0,o.he)(d)&&(0,u.tv)(t,{segId:r,mode:a.yY$.SpeedModeNormal,value:1},e))}}},817292:function(e,t,i){i.d(t,{v:function(){return f}});var r=i(150002),n=i(862213),a=i(211561),o=i(481631),s=i(475028),l=i(690613),d=i(653322),c=i(129862),u=i(283751);let m=(0,s.i)(d.H.SetAudioVocalSeparationSegmentNotExist,""),h=(0,s.i)(d.H.SetAudioVocalSeparationSegmentTypeNotValid,"");class f extends r.a{get type(){return n.Us.SET_AUDIO_VOCAL_SEPARATION}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,o.Y9)(i)||(0,o.he)(i)?(0,l.ly)():h(`segmentType not valid: ${i.__segment_struct_type}`):m(`segment not exist: ${t}`)}do(e,t,i){let{segment:r,trackIndex:n}=t.getSegmentAtPositionById(this.options.segmentId);if((0,o.he)(r)||(0,o.Y9)(r)){let i=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});i.vocalSeparation=new a.HVf({choice:this.options.choice,timeRange:this.options.choice===a.ZTd.None?void 0:this.options.timeRange,productionPath:this.options.productionPath});let s=(0,o.xX)({__segment_struct_type:r.__segment_struct_type});u.T.pick(r,i,s),e(new c.F({trackId:t.getTrackByIndex(n).id,trackIndex:n,segmentId:r.id,segmentDelta:i,sourceSegmentDelta:s}))}}}},384763:function(e,t,i){i.d(t,{d:function(){return s}});var r=i(150002),n=i(853277),a=i(711999),o=i(690613);class s extends r.a{get type(){return s.type}check(){return(0,o.ly)()}do(e,t,i){let{materialSize:r,ratio:n,isVideo:o}=this.options;(0,a.F)(r,n,o,t,e)}}s.type=n.U.ENSURE_DRAFT_CANVAS_SIZE},711999:function(e,t,i){i.d(t,{F:function(){return l}});var r=i(881337),n=i(436858),a=i(236872),o=i(211561),s=i(363397);function l(e,t,i,l,d){if(!l.getDraftProperty().draftCanvasSizeConfig.ensureDraftCanvasSizeEnabled)return 0;let c=(0,r.jT7)({}),{containerWidth:u,containerHeight:m}=l.getDraftProperty().draftCanvasSizeConfig.ensureDraftCanvasSizeParam,h=l.getDefaultCanvasSize();if(u&&u>0&&m&&m>0)c=l.getDraftProperty().draftCanvasSizeConfig.ensureDraftCanvasSizeParam;else{let i=[e[0]<=0?h.width:e[0],e[1]<=0?h.height:e[1]];a.A.fix854AndScale(n.g4,i),c.containerWidth=i[0],c.containerHeight=i[1],c.ratio=t}let f=0,p=!1,g=!1,y=!1;for(let e of l.getAllTracks()){let t=e.segments.length;if(f+=t,0===t)continue;let i=e.type;i===o.pNd.TrackTypeVideo&&(p=!0),i===o.pNd.TrackTypeText&&(g=!0),i===o.pNd.TrackTypeSticker&&(y=!0)}0===f&&(0,s.fr)(c,l,d),i&&!p&&!g&&!y&&l.getDraftProperty().draftCanvasSizeConfig.modifyCanvasManually&&(0,s.fr)(c,l,d)}},369165:function(e,t,i){i.d(t,{J:function(){return d}});var r=i(150002),n=i(853277),a=i(211561),o=i(690613),s=i(268468),l=i(700857);class d extends r.a{get type(){return d.type}check(){return(0,o.ly)()}do(e){let t=new a.fln(this.options),i=new s.ry,r=new a.jhR;r.background=new a.Fq$(t),i.canvasConfig=r,e(new l.W({propertyDelta:i}))}constructor(e){var t;let i={...e};i.sourcePlatform=null!==(t=e.sourcePlatform)&&void 0!==t?t:a.nj7.EffectPlatformLoki,super(Object.assign({},i))}}d.type=n.U.SET_CANVAS_BACKGROUND},424361:function(e,t,i){i.d(t,{I:function(){return s}});var r=i(150002),n=i(853277),a=i(690613),o=i(646290);class s extends r.a{get type(){return s.type}check(e){return(0,a.ly)()}do(e,t){let{metadataDelta:i}=this.options;e(new o.e({metadataDelta:i}))}}s.type=n.U.SET_DOCUMENT_METADATA},862213:function(e,t,i){i.d(t,{nx:()=>o.n,lF:()=>r.l,aW:()=>s.a,Us:()=>n.U,d3:()=>a.d3}),i("201483");var r=i("689711"),n=i("853277"),a=i("331509"),o=i("89100");i("890400");var s=i("438369")},871550:function(e,t,i){i.d(t,{I:function(){return m}});var r=i(150002),n=i(853277),a=i(129862),o=i(982935),s=i(475028),l=i(690613),d=i(653322);let c=(0,s.i)(d.H.KeyframeSegmentNotExist,""),u=(0,s.i)(d.H.KeyframeDraftNotExist,"");class m extends r.a{get type(){return n.U.ADD_KEYFRAME}check(e){let{segmentId:t,draftId:i}=this.options,r=e.getDraftById(i);return r?r.getSegmentById(t)?(0,l.ly)():c(`segment not exist: ${t}`):u(`subDraft is not exist id:${i}`)}do(e,t){let i=t.getDraftById(this.options.draftId),r=o.k.add(i,this.options);e(new a.F(r))}}},982935:function(e,t,i){i.d(t,{k:function(){return c}});var r=i(881337),n=i(211561),a=i(35276),o=i(127926),s=i(13242),l=i(481631),d=i(283751);let c={add(e,t){let{segmentId:i,keyframeType:c,materialId:u}=t,m=(0,r.TIP)(t.dataParam),{trackId:h,segment:f,trackIndex:p}=e.getSegmentAtPositionById(i),g=f.clone(),y=new a.b().getKeyframeTimeOffsetByTimeline(e,g,m.playHead),_=o.OL.ensureKeyframes(h,p,g,c,u),{keyframe:T}=o.OL.findKeyframeByTimeOffset(_,y);T?o.OL.updateKeyframeParams(T,m,y):((T=new n.$2f).timeOffset=y,0===m.datas.length&&(T.values=s.U.getPropertyValues(e,g,c,m.playHead)),o.OL.updateKeyframeParams(T,m,y),o.OL.insertKeyframe(_,T)),T&&o.OL.updateDefaultControlPointById(_,T.id);let v=(0,l.xX)({__segment_struct_type:g.__segment_struct_type,commonKeyframes:g.commonKeyframes}),I=(0,l.xX)({__segment_struct_type:f.__segment_struct_type});return d.T.pick(f,v,I),{draftId:e.getDraftId(),trackId:h,trackIndex:p,segmentId:i,segmentDelta:v,sourceSegmentDelta:I}}}},825908:function(e,t,i){i.d(t,{a:()=>b});var r=i("150002"),n=i("853277"),a=i("211561"),o=i("176791"),s=i("448218"),l=i("361708"),d=i("239648"),c=i("287165"),u=i("121684"),m=i("217201");let h=(e,t,i,r)=>{let n=e.getDraftDroupContainer();if(!n){n=new a.Fly;let e=new a.k_B(n);r(new u.r({groupContainerDelta:e}))}let o=-1,l=new a.ZAu;for(let n of(l.id=(0,c.p)(),i)){var d;(0,s.W)(m.c8.setSegmentGroupId(e,n,l.id),r);let i=e.getCopyGroupBySegment(t,n);if(!i)continue;let a=i.groupMembers,c=[];for(let e of a){if(n!==e)c.push(e)}if(1===c.length){(0,s.W)(m.c8.setSegmentGroupId(e,a[0],""),r);let n=t.findIndex(e=>e===i);t.splice(n,1)}else i.groupMembers=a;!(null==i?void 0:null===(d=i.materialDraft)||void 0===d?void 0:d.formulaId)&&(o=-1===o?i.groupIndex:Math.min(o,i.groupIndex))}let h=-1,f=!1;for(let e of t){if(!!e&&(!e.materialDraft||!!e.materialDraft.formulaId))e.groupIndex===o&&(f=!0),h=Math.max(h,e.groupIndex)}return l.groupIndex=-1===o||f?h+1:o,l.groupMembers=i,t.push(l),t};var f=i("49667"),p=i("593642"),g=i("475028"),y=i("690613"),_=i("653322"),T=i("481631"),v=i("912224"),I=i("81649"),w=i("843363");let S=(0,g.i)(_.H.MultiSegmentTrackModePasteTargetTrackIndexNotValid,"");class k{constructor(){this.targetSegmentVec=[],this.upSegments=[],this.downSegments=[],this.toMainTrackSegs=[]}}class x{fixVideoTrackingMapping(e,t){let i=[];for(let t of this.pastedNewSegments){let r=e.getVideoTracking(t);if(!r||0===r.trackers.length)continue;let n=r.trackers.map(e=>e.clone());for(let e of n){let t=this.cacheTrackingMapping.get(e.targetSegmentId);if(!t)continue;let i=this.pasteTrackingMapping.get(t);if(!!i)e.targetSegmentId=i}let o=new a.NOn;o.videoTracking=new a.MwE,o.videoTracking.trackers=n,i.push((0,s.l)(e,t.id,o))}(0,s.W)(i,t),this.cacheTrackingMapping.clear(),this.pasteTrackingMapping.clear(),this.pastedNewSegments=[]}constructor(){this.cacheTrackingMapping=new Map,this.pasteTrackingMapping=new Map,this.pastedNewSegments=[]}}class b extends r.a{get type(){return b.type}check(e){for(let{targetTrackIndex:e}of this.options)if(e<0)return S(`target trackIndex not valid: ${e}`);return(0,y.ly)()}do(e,t,i){this._handleSegments(t,e);let r=this.mappings.pastedNewSegments.map(e=>e.id);return this._endHandleSegments(t,e,i),r}_classification(e,t){var i,r;let n=!1,o=[],s=new Map;for(let r of t){if(r.inMousePosition)e.targetSegmentVec.push(r),n=!0;else if(n)e.upSegments.push(r);else{let e=null!==(i=s.get(r.sourceTrackIndex))&&void 0!==i?i:[];e.push(r),s.set(r.sourceTrackIndex,e),!o.includes(r.sourceTrackIndex)&&o.push(r.sourceTrackIndex)}r.trackType===a.pNd.TrackTypeVideo&&r.targetTrackIndex===m.fm&&e.toMainTrackSegs.push(r)}for(let t of o.reverse()){let i=null!==(r=s.get(t))&&void 0!==r?r:[];e.downSegments.push(...i)}}_handlePart(e,t,i){t.toMainTrackSegs.length&&this._executeToMainTrackVideoAction(e,t.toMainTrackSegs,i),this._realHandleSegment(e,t.targetSegmentVec,i),this._realHandleSegment(e,t.upSegments,i),this._realHandleSegment(e,t.downSegments,i)}_handleSegments(e,t){let i=new k,r=new k;this.mappings.cacheTrackingMapping.clear(),this.mappings.pasteTrackingMapping.clear(),this.mappings.pastedNewSegments=[],this.mNeedDealTransitionSegments.clear();let n=[],o=[];for(let e of this.options)e.trackType===a.pNd.TrackTypeAudio?o.push(e):n.push(e);this._classification(i,n),this._classification(r,o),this._handlePart(e,i,t),this._handlePart(e,r,t);let l=[];for(let[i,r]of this.mMapGroupInfo.entries())if(r.length>=2){var c;let n=e.getDraftDroupContainer(),o=null;if(n)for(let e of n.groups){if(!!e){if(e.id===i){o=e;break}}}let s=h(e,(null!==(c=null==n?void 0:n.groups)&&void 0!==c?c:[]).map(e=>e.clone(!0)),r,t),l=e.getCopyGroupBySegment(s,r[0]);l&&o&&o.materialDraft&&(l.materialDraft=o.materialDraft.clone(!0));let d=new a.k_B;d.groups=s,t(new u.r({groupContainerDelta:d}))}else for(let t of r)l.push(...m.c8.setSegmentGroupId(e,t,""));(0,s.W)(l,t),(0,s.W)(new d.Uo().clearUselessTransitionAndAdjustDuration(e,this.mNeedDealTransitionSegments,t),t)}_endHandleSegments(e,t,i){this.mappings.fixVideoTrackingMapping(e,t),(0,s.W)(m.c8.updateDraftDurationIfNeeded(e),t),!i.keepEmptyTracks&&(0,s.W)(m.c8.clearEmptyTracks(e),t)}_executeToMainTrackVideoAction(e,t,i){let r=[];for(let o of t){let d=o.pasteSegmentInfo;if(!(null==d?void 0:d.segment))continue;this.mappings.cacheTrackingMapping.set(o.segmentId,d.segment.id);let c=o===t[t.length-1],u=this._handlePaste(i,e,d,o.targetTrackIndex,o.targetStartTime,!1,c);if(u===l.P){var n;let t=new a.NOn;if(t.targetTimerange=new a.zel,t.targetTimerange.start=o.targetStartTime-1n,t.targetTimerange.duration=null===(n=e.getSegmentById(o.segmentId))||void 0===n?void 0:n.targetTimerange.duration,r.push((0,s.l)(e,d.segment.id,t)),(u=this._handlePaste(i,e,d,o.targetTrackIndex,o.targetStartTime,!1))===l.P)throw Error("The sub video track has no space for the video")}let h=m.c8.updateDraftDurationIfNeeded(e);r.push(...h)}(0,s.W)(r,i)}_realHandleSegment(e,t,i){if(0!==t.length)for(let r of t){if(r.trackType===a.pNd.TrackTypeVideo&&r.targetTrackIndex===m.fm)continue;let t=r.pasteSegmentInfo;if(!!(null==t?void 0:t.segment)){if(this.mappings.cacheTrackingMapping.set(r.segmentId,t.segment.id),this._handlePaste(i,e,t,r.targetTrackIndex,r.targetStartTime,!1)===l.P)throw Error("The track has no space for the segment")}}}_insertHelper(e,t,i,r){return m.c8.insertSegmentHelper(e,t,i,r)}_handlePaste(e,t,i,r,n,s,l){var d,c;let u=new o.wK;if(!i.segment)throw Error("copy new segment failed not found !! ");let h=i.segment.clone(!0);if(b.lastPasteSegmentId===i.segment.id?b.lastPasteSegmentTimes+=1:(b.lastPasteSegmentId=i.segment.id,b.lastPasteSegmentTimes=1),"SegmentVideo"===h.__segment_struct_type&&(null===(d=h.clip)||void 0===d?void 0:d.transform)){let e=(0,w.A)(n,i.segment.targetTimerange.duration,i.segment)?.02:0;h.clip.transform=new a.wx7({x:h.clip.transform.x+e*b.lastPasteSegmentTimes,y:h.clip.transform.y+e*b.lastPasteSegmentTimes})}else("SegmentSticker"===h.__segment_struct_type||"SegmentText"===h.__segment_struct_type||"SegmentTextTemplate"===h.__segment_struct_type)&&(null===(c=h.clip)||void 0===c?void 0:c.transform)&&(h.clip.transform=new a.wx7({x:h.clip.transform.x+.02*b.lastPasteSegmentTimes*2,y:h.clip.transform.y+-(.02*b.lastPasteSegmentTimes*2)}));this.mappings.pastedNewSegments.push(h),this.mappings.pasteTrackingMapping.set(i.segment.id,h.id),h.targetTimerange&&(h.targetTimerange.start=n,m.c8.alignSegment(t,h));let g=t.getGroupIdBySegment(h);g&&(this.mMapGroupInfo.has(g)?this.mMapGroupInfo.get(g).push(h.id):this.mMapGroupInfo.set(g,[h.id]));let y=a.w9k.FlagNone;if((0,T.he)(h)){let e;r!==m.fm?(y=a.w9k.FlagSubVideo,h.transition&&(h.transition=void 0)):l&&h.transition&&(h.transition=void 0),h.renderIndex=v.eK.prototype.nextVideoRenderIndexWithTimeRange(r,h.targetTimerange,t),f.vc.FEATURE_SEPARATE_TRACE_MUTED_AND_SEGMENT_VOLUME&&(t.getAllTracks().length<=0?t.getDraftProperty().videoMute&&(h.volume=0):t.getDraftProperty().videoMute&&h.volume<=1e-6&&(h.volume=h.lastNonzeroVolume),(e=i.segment)&&u.copyMattingData(e,h,i.segId)),h.materialDraft=u.fixMaterialDraftTrackingTargetId(t,e,h),h.materialDraft=u.fixSegmentMaterialDraftMutableConfig(t,e,h),u.copyAutoBeautyAlgorithm(h)}else((0,T.Ft)(h)||(0,T.Q2)(h))&&h.material&&(h.material.textToAudioIds=[]);((0,T.he)(h)||(0,T.Y9)(h))&&((0,T.he)(i.segment)||(0,T.Y9)(i.segment))&&h.voiceChange&&i.segment.voiceChange&&(h.voiceChange=i.segment.voiceChange.map(e=>{let t=(0,p.Rl)();for(let i of h.commonKeyframes)i.materialId===e.id&&(i.materialId=t);let i=e.clone(!0);return i.id=t,i}));let _=new m.vp(i.trackType,r,y),I=-1;if(-1===(I=this._insertHelper(t,h,_,e))&&!s&&(_=new m.vp(i.trackType,r,y),I=this._insertHelper(t,h,_,e)),(0,T.he)(h)&&h.transition){let e=t.getTrackBySegmentId(h.id);if(e){let t=this.mNeedDealTransitionSegments.get(e);t?t.push(h):this.mNeedDealTransitionSegments.set(e,[h])}}return I}constructor(e,t){let i=new I.O1(t.getDraftProperty().fps);super(e.map(e=>({...e,targetStartTime:i.gen(e.targetStartTime).tail}))),this.mMapGroupInfo=new Map,this.mNeedDealTransitionSegments=new Map,this.mappings=new x}}b.type=n.U.MULTI_SEGMENT_TRACK_MODE_PASTE,b.lastPasteSegmentId="",b.lastPasteSegmentTimes=0},908232:function(e,t,i){i.d(t,{j:function(){return d},l:function(){return l}});var r=i(150002),n=i(853277),a=i(602777),o=i(503722),s=i(690613);function l(e){let t={segmentId:"",trackType:a.pN.TrackTypeNone,targetTrackIndex:0,sourceTrackIndex:0,targetStartTime:0n,inMousePosition:!1,mainVideoTargetIndex:0};return e&&(t=Object.assign(t,e)),t}class d extends r.a{get type(){return d.type}check(e){return(0,s.ly)()}do(e,t,i){this._multiSegmentMoveUtils.move(t,e,i)}constructor(e){let t=[];for(let i of e)t.push(Object.assign(l(),i));super(t),this._multiSegmentMoveUtils=new o.c(t)}}d.type=n.U.MULTI_SEGMENT_TRACK_MODE_MOVE},769936:function(e,t,i){i.d(t,{c:function(){return m}});var r=i(150002),n=i(853277),a=i(690613),o=i(217201),s=i(481631),l=i(211561),d=i(283751),c=i(129862),u=i(599446);class m extends r.a{get type(){return n.U.SEGMENT_DUPLICATE}check(e){return(0,a.ly)()}do(e,t){let i=t.getSegmentAtPositionById(this.options.segmentId);if(!i)return;let{trackId:r,trackIndex:n,segmentIndex:a}=i,m=t.getAllTracks()[n],h=m.segments[a],f=h.clone(!0);if(f.targetTimerange.start=h.targetTimerange.start+h.targetTimerange.duration,n!==o.fm&&!this.options.disabledMoveBack)for(let t=a+1;t<m.segments.length;t++){let i=(0,s.xX)({__segment_struct_type:m.segments[t].__segment_struct_type});i.targetTimerange=new l.zel({start:m.segments[t].targetTimerange.start+h.targetTimerange.duration,duration:m.segments[t].targetTimerange.duration});let a=(0,s.xX)({__segment_struct_type:h.__segment_struct_type});d.T.pick(h,i,a),e(new c.F({segmentDelta:i,segmentId:m.segments[t].id,trackId:r,trackIndex:n,sourceSegmentDelta:a}))}return e(new u._({trackId:r,trackIndex:n,segment:f})),f.id}}m.type=n.U.SEGMENT_DUPLICATE},130195:function(e,t,i){i.d(t,{y:function(){return f}});var r=i(150002),n=i(853277),a=i(129862),o=i(475028),s=i(690613),l=i(653322),d=i(211561),c=i(481631),u=i(283751);let m=(0,o.i)(l.H.MirrorSegmentNotExist,""),h=(0,o.i)(l.H.MirrorSegmentParamsNotValid,"");class f extends r.a{get type(){return f.type}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?i.clip?(0,s.ly)():h("segment clip is not exist"):m(`segment not exist: ${t}`)}do(e,t){var i,r;let{segmentId:n,horizontal:o=!1,vertical:s=!1}=this.options,l=t.getSegmentById(n),m=(0,c.xX)({__segment_struct_type:l.__segment_struct_type}),h=new d.AaE({horizontal:null!=o&&o,vertical:null!=s&&s}),f=new d.tLq;f.flip=h,m.clip=f;let p=(0,c.xX)({__segment_struct_type:l.__segment_struct_type});u.T.pick(l,m,p),e(new a.F({segmentId:n,trackId:null!==(r=null===(i=t.getTrackBySegmentId(n))||void 0===i?void 0:i.id)&&void 0!==r?r:"",trackIndex:t.getTrackIndexBySegmentId(n),segmentDelta:m,sourceSegmentDelta:p}))}}f.type=n.U.MIRROR_SEGMENT},401483:function(e,t,i){i.d(t,{G:function(){return f},e:function(){return m}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(879388),l=i(686067),d=i(602777),c=i(653322),u=i(81649);class m{constructor(){this.targetSegmentId="",this.targetTrackIndex=0,this.targetStartTime=0n,this.targetDuration=0n,this.type=d.pN.TrackTypeNone}}let h=(0,a.i)(c.H.MoveSegmentNotExist,"");(0,a.i)(c.H.MoveSegmentTrackNotExist,"");class f extends r.a{get type(){return f.type}check(e){return e.getSegmentById(this.options.segmentId)?e.getAllTracks()[this.options.sourceTrackIndex]?e.getAllTracks()[this.options.targetTrackIndex]?(0,o.ly)():h(`target track not exist index: ${this.options.targetTrackIndex}`):h(`source track not exist index: ${this.options.sourceTrackIndex}`):h(`segment not exist id: ${this.options.segmentId}`)}do(e,t,i){let{targetTrackIndex:r,segmentId:n,targetStartTime:a}=this.options,{trackIndex:o}=t.getSegmentAtPositionById(n),c=t.getAllTracks()[o],u=c.type;if(0!==r){let o=new m;for(let e of(o.targetSegmentId=n,o.targetTrackIndex=r,c.segments))if(e.id===n){o.type=c.type,o.targetStartTime=a,o.targetDuration=e.targetTimerange.duration;break}let l=t.getAllTracks();new s.W().moveConflictSegment(t,o,l,e,i)}if(u===d.pN.TrackTypeVideo){let n=0===o,a=0===r;n&&a?(0,l.J2)(this.options,t,e,i):!n&&a?(0,l.LW)(this.options,t,e,i):n&&!a?(0,l.VW)(this.options,t,e,i):!n&&!a&&(0,l.Mt)(this.options,t,e,i)}else(0,l.Z$)(this.options,t,e,i)}constructor(e,t){super(e);let i=new u.O1(t.getDraftProperty().fps);this.options.targetStartTime=i.gen(e.targetStartTime).tail}}f.type=n.U.MULTI_SEGMENT_TRACK_MODE_MOVE},549269:function(e,t,i){i.d(t,{$:function(){return h}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(129862),d=i(481631),c=i(283751);let u=(0,a.i)(s.H.ApplyVideoAllChromaSegmentNotExist,""),m=(0,a.i)(s.H.ApplyVideoAllChromaSegmentTypeNotValid,"");class h extends r.a{get type(){return h.type}check(e){let{segId:t}=this.options,i=e.getSegmentById(t);return i?(0,d.P2)(i)||(0,d.Ft)(i)||(0,d.Q2)(i)?this.options.segId?(0,o.ly)():u(`params is not valid: ${JSON.stringify(this.options)}`):m(`segment type not valid: ${t}`):u(`segment not exist: ${t}`)}do(e,t){let{segId:i}=this.options,r=t.getSegmentById(i),n=t.getTrackBySegmentId(r.id),a=(0,d.zg)(r);a.videoTracking=null;let o=(0,d.xX)({__segment_struct_type:r.__segment_struct_type});c.T.pick(r,a,o),e(new l.F({trackId:n.id,trackIndex:t.getTrackIndexBySegmentId(r.id),segmentId:r.id,segmentDelta:a,sourceSegmentDelta:o}))}}h.type=n.U.VIDEO_TRACKER_REMOVE},432094:function(e,t,i){i.d(t,{c:function(){return h}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(129862),d=i(481631),c=i(283751);let u=(0,a.i)(s.H.SegmentNotExist,""),m=(0,a.i)(s.H.DraftNotExist,"");class h extends r.a{get type(){return h.type}check(e){let t=e.getDraftById(this.options.draftId);return t?t.getSegmentById(this.options.segmentId,t,!1)?(0,o.ly)():m(`segment is not exist, segment id: ${this.options.segmentId}`):u(`draft is not exist, draft id: ${this.options.draftId}`)}do(e,t){let i=t.getDraftById(this.options.draftId),r=i.getTrackBySegmentId(this.options.segmentId),n=i.getSegmentById(this.options.segmentId),a=(0,d.xX)({__segment_struct_type:n.__segment_struct_type});a.desc=this.options.desc;let o=(0,d.xX)({__segment_struct_type:n.__segment_struct_type});c.T.pick(n,a,o),e(new l.F({draftId:this.options.draftId,trackId:r.id,trackIndex:i.getTrackIndexBySegmentId(this.options.segmentId),segmentId:this.options.segmentId,segmentDelta:a,sourceSegmentDelta:o}))}}h.type=n.U.SEGMENT_SET_DESCRIPTION},108662:function(e,t,i){i.d(t,{x:()=>M});var r=i("211561"),n=i("280700"),a=i("383798"),o=i("283751"),s=i("481631"),l=i("599446"),d=i("129862"),c=i("698159"),u=i("340294"),m=i("217201"),h=i("176791"),f=i("239648"),p=i("203447"),g=i("194460"),y=i("98819"),_=i("81649"),T=i("475028"),v=i("690613"),I=i("150002"),w=i("653322"),S=i("853277");let k=(0,T.i)(w.H.SplitSegmentParamsNotValid,""),x=(0,T.i)(w.H.SplitSegmentNotExist,""),b=(0,T.i)(w.H.SplitSegmentTimeRangeError,"");class M extends I.a{get type(){return M.type}check(e){return this.options.forEach(t=>{if(t.segmentId||!t.splitTime)return k(`segmentId: ${t.segmentId} splitTime: ${t.splitTime} is not valid`);let{segmentId:i,splitTime:r}=t,a=(0,n.Cm)(e.getAllTracks(),i);if(!a)return x("segment not is exist");let{trackIndex:o,segmentIndex:s}=a,l=e.getAllTracks()[o].segments[s];if(!l||!(l.targetTimerange.start<r)||!(l.targetTimerange.start+l.targetTimerange.duration>r))return b(`targetTimeRange: ${l.targetTimerange}, splitTime: ${r}`)}),(0,v.ly)()}do(e,t,i){this.options.forEach(_=>{let{segmentId:T}=_,{trackIndex:v}=(0,n.Cm)(t.getAllTracks(),T);return t.getAllTracks()[v].type===r.pNd.TrackTypeVideo?function(e,t,i){var a,_;let T=new p.C,v=new f.Uo,{segmentId:I,splitTime:w}=t,{segmentIndex:S,trackId:k,trackIndex:x}=(0,n.Cm)(e.getAllTracks(),I),b=e.getAllTracks()[x],M=b.segments[S];if(!(0,s.he)(M))return"";let C={...M.sourceTimerange},A=M.clone(!0);if(A){let e=M.transition;e?(A.transition=e.clone(!1),A.transition.id=`${A.id}_transition`):A.transition=void 0}let E=M.targetTimerange.start,F=M.targetTimerange.duration,P=F+E;M.sourceTimerange.start,M.sourceTimerange.duration;let D=w-E,z=M.speed;if(z&&0!==z.mode&&z.curveSpeed){let{curveSpeed:t}=z,n=M.sourceTimerange.duration,a=T.splitCurveSpeedPoints(D,n,F,t,e.getDraftProperty().fps),l=a[0],c=a[1],m=T.getCurveAveSpeed(l),h=T.getCurveAveSpeed(c);A.speed.speed=h,A.speed.curveSpeed.speedPoints=c.map(e=>e.clone()),A.speed.curveSpeed.id=t.id;let f=new r.NOn;f.targetTimerange=new r.zel({start:M.targetTimerange.start,duration:D}),f.sourceTimerange=new r.zel({start:M.sourceTimerange.start,duration:u.pM.times(D,m,"bigint")}),f.speed=new r.Zk4,f.speed.curveSpeed=new r._Xo,f.speed.curveSpeed.speedPoints=l.map(e=>e.clone()),f.speed.speed=m;let p=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});o.T.pick(M,f,p),i(new d.F({segmentId:I,trackId:k,trackIndex:x,segmentDelta:f,sourceSegmentDelta:p}))}else if(z){let e=M.targetTimerange.duration,t=M.sourceTimerange.duration,n=u.pM.div(D,e),a=u.pM.times(t,n,"bigint","round"),l=new r.NOn;l.targetTimerange=new r.zel({start:M.targetTimerange.start,duration:D}),l.sourceTimerange=new r.zel({start:M.sourceTimerange.start,duration:a}),l.speed=new r.Zk4,l.speed.mode=r.yY$.SpeedModeNormal;let c=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});o.T.pick(M,l,c),i(new d.F({segmentId:I,trackId:k,trackIndex:x,segmentDelta:l,sourceSegmentDelta:c}))}else{let e=new r.NOn;e.targetTimerange=new r.zel({start:M.targetTimerange.start,duration:D}),e.sourceTimerange=new r.zel({start:M.targetTimerange.start,duration:D}),e.speed=new r.Zk4(new r.UgE);let t=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});o.T.pick(M,e,t),i(new d.F({segmentId:I,trackId:k,trackIndex:x,segmentDelta:e,sourceSegmentDelta:t}))}if(M.transition){let e=new r.NOn;e.transition=null;let t=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});o.T.pick(M,e,t),i(new d.F({segmentId:I,trackId:k,trackIndex:x,segmentDelta:e,sourceSegmentDelta:t}))}let N=M.targetTimerange.start+M.targetTimerange.duration,V=M.sourceTimerange.start+M.sourceTimerange.duration;A.targetTimerange=new r.tnv({start:N,duration:P-N}),A.sourceTimerange=new r.tnv({start:V,duration:u.pM.times(A.targetTimerange.duration,A.speed.speed,"bigint")}),i(new l._({segment:A,trackId:k,trackIndex:x}));let O=v.findPrevSegment(b,M);if(null==O?void 0:O.transition){let t=M.targetTimerange.duration,[,r]=v.adjustVideoTransitionByDuration(e,O,t);r&&(0,c.W)(r,i)}if(A.transition){let t=A.targetTimerange.duration,[,r]=v.adjustVideoTransitionByDuration(e,A,t);r&&(0,c.W)(r,i)}0===x&&(0,c.W)(m.c8.adjustTrackTargetStartTime(e,b),i);let R=0n,H=0n;if(M.material.audioFade){R=M.material.audioFade.fadeInDuration,H=M.material.audioFade.fadeOutDuration;let e=new r.NOn;e.material=new r.K2q,e.material.audioFade=new r.lMN,e.material.audioFade.fadeInDuration=u.pM.min([R,M.targetTimerange.duration],"bigint"),e.material.audioFade.fadeOutDuration=0n;let t=(0,s.xX)({__segment_struct_type:M.__segment_struct_type});o.T.pick(M,e,t),i(new d.F({segmentId:I,trackId:k,trackIndex:x,segmentDelta:e,sourceSegmentDelta:t}))}if(A.material.audioFade){let e=new r.NOn;e.material=new r.K2q,e.material.audioFade=new r.lMN,e.material.audioFade.fadeInDuration=0n,e.material.audioFade.fadeOutDuration=u.pM.min([H,A.targetTimerange.duration],"bigint");let t=(0,s.xX)({__segment_struct_type:A.__segment_struct_type});o.T.pick(A,e,t),i(new d.F({segmentId:A.id,trackId:k,trackIndex:x,segmentDelta:e,sourceSegmentDelta:t}))}let B=[],K=new h.wK;K.updateAnimationValueIfNeeded(C,M,A,i,e);let j=K.splitVideoEffectsTimeRange(e,M.targetTimerange,M,A,w);B.push(...j),K.splitMattingTimeRange(M.targetTimerange,M,A,w,!!t.copyData);let X=e.getSegmentById(A.id);K.fixMaterialDraftTrackingTargetId(e,M,X,i),K.fixSegmentMaterialDraftMutableConfig(e,M,X,i);let L=y._.splitKeyframesByTimeRange(e,M,A,w,w,i);(0,c.W)(B,i),(0,c.W)((0,g.t)(e,M,A),i);let W=A.material.type;if((W===r.cVg.MetaTypeGif||W===r.cVg.MetaTypePhoto)&&L){let{cloneSegment:e,cloneSplitSegment:t}=L,n=e.sourceTimerange.duration,l=t.commonKeyframes.map(e=>e.clone());for(let e of l)for(let t of e.keyframeList)t.timeOffset=t.timeOffset-n;let c=new r.NOn;c.sourceTimerange=new r.zel({start:0n,duration:null===(a=t.sourceTimerange)||void 0===a?void 0:a.start}),c.commonKeyframes=l;let u=(0,s.xX)({__segment_struct_type:t.__segment_struct_type});o.T.pick(t,c,u),i(new d.F({segmentId:t.id,trackId:k,trackIndex:x,segmentDelta:c,sourceSegmentDelta:u}))}K.copyManualDeformationAlgorithmList(e,A,null!==(_=t.draftPath)&&void 0!==_?_:"",!1,i),K.copyAutoBeautyAlgorithm(A);let{greenScreen:U}=A;if(null==U?void 0:U.background){let e=U.background.sourceTimeStart,t=new r.NOn;t.greenScreen=new r.pji,t.greenScreen.background=new r.R5M,t.greenScreen.background.sourceTimeStart=e+M.sourceTimerange.duration;let n=(0,s.xX)({__segment_struct_type:A.__segment_struct_type});o.T.pick(A,t,n),i(new d.F({segmentId:A.id,trackId:k,trackIndex:x,segmentDelta:t,sourceSegmentDelta:n}))}return A.material.objectLocked&&y._.splitLockedKeyframesByTimerange(e,M,A,w,w,i),A.id}(t,_,e):(0,a.u)(t,_,e,i)})}constructor(e,t){let i=new _.O1(t.getDraftProperty().fps);e.forEach(e=>e.splitTime=i.gen(e.splitTime).tail),super(e)}}M.type=S.U.SPLIT_SEGMENT},979691:function(e,t,i){i.d(t,{A:function(){return y},Q:function(){return h}});var r=i(150002),n=i(853277),a=i(129862),o=i(211561),s=i(475028),l=i(690613),d=i(653322),c=i(501452),u=i(481631),m=i(283751);let h=[o.Ocy.SegmentSticker,o.Ocy.SegmentImageSticker,o.Ocy.SegmentHandwrite,o.Ocy.SegmentText,o.Ocy.SegmentTextTemplate,o.Ocy.SegmentVideo],f=(0,s.i)(d.H.TranslateSegmentNotExist,""),p=(0,s.i)(d.H.TranslateSegmentTypeNotValid,""),g=(0,s.i)(d.H.TranslateSegmentClipNotValid,"");class y extends r.a{get type(){return y.type}check(e){return this.options.every(t=>e.getSegmentById(t.segmentId))?this.options.every(t=>{let i=e.getSegmentById(t.segmentId);return h.includes(i.__segment_struct_type)})?this.options.every(t=>{var i;return null===(i=e.getSegmentById(t.segmentId))||void 0===i?void 0:i.clip})?(0,l.ly)():g("segment clip is invlaid"):p("segment type is invlaid"):f(`segment is not exist, ids: ${this.options}`)}do(e,t,i){let r=[];for(let i of this.options){let{segmentId:n,x:s=0,y:l=0,isKeyframe:d=!1}=i,h=t.getDraftById(i.draftId);if(!h)return;let f=h.getTrackBySegmentId(n),p=h.getSegmentById(n),g=(0,u.xX)({__segment_struct_type:p.__segment_struct_type});g.clip=new o.tLq,g.clip.transform=new o.jPZ,g.clip.transform.x=s,g.clip.transform.y=l;let y=(0,u.xX)({__segment_struct_type:p.__segment_struct_type});m.T.pick(p,g,y),r.push(new a.F({draftId:i.draftId,trackId:f.id,trackIndex:h.getTrackIndexBySegmentId(n),segmentId:n,segmentDelta:g,sourceSegmentDelta:y})),d&&[{keyframeType:o.Eu.KFTypePositionX,values:[s]},{keyframeType:o.Eu.KFTypePositionY,values:[l]}].forEach(t=>{let{keyframeType:r,values:n}=t,o=c.y.execute({draftView:h,segment:p,keyframeType:r,values:n});o&&e(new a.F({draftId:i.draftId,...o}))})}r.forEach(e)}}y.type=n.U.SEGMENT_TRANSLATE},201519:function(e,t,i){i.d(t,{a:function(){return u}});var r=i(150002),n=i(853277),a=i(129862),o=i(690613),s=i(233706),l=i(361708),d=i(481631),c=i(283751);class u extends r.a{get type(){return u.type}check(e){return(0,o.ly)()}do(e,t,i){let{identifier:r,substitute:n}=this.options,o=t.getDraftById(this.options.draftId);if(!!o)o.getAllTracks().forEach(t=>{t.segments.forEach(u=>{if((0,s.n)(u,r)){let i=u.clone();(0,s.p)(i,n);let r=(0,d.xX)(i),l=(0,d.xX)({__segment_struct_type:u.__segment_struct_type});c.T.pick(u,r,l),e(new a.F({draftId:o.getDraftId(),trackId:t.id,trackIndex:o.getTrackIndexBySegmentId(u.id),segmentId:u.id,segmentDelta:r,sourceSegmentDelta:l}))}l.b.isCombination(u)&&this.do(e,u.materialDraft.draft,i)})})}}u.type=n.U.INNER_UPDATE_SEGMENT},480113:function(e,t,i){i.d(t,{A:function(){return n}});var r=i(211561);function n(e,t){e.beauty=null,e.manualDeformation=null,e.figures=[],e.reshape=null,t.crop=new r.oIP,t.cropRatio=r.j8m.CropRatioFree,t.cropScale=1}},731774:function(e,t,i){i.d(t,{o:function(){return c}});var r=i(211561),n=i(129862),a=i(150002),o=i(853277),s=i(690613),l=i(481631),d=i(283751);class c extends a.a{get type(){return c.type}check(e){return(0,s.ly)()}do(e,t,i){var a;let o=t.getDraftById(this.options.draftId);if(!o)return;let s=o.getSegmentAtPositionById(this.options.segmentId);if(!s)return;let{trackId:c,trackIndex:u,segmentIndex:m}=s,h=o.getAllTracks()[u].segments[m];if(!h||!(0,l.Y9)(h))return;let{path:f,musicName:p,musicId:g,musicCategoryTitle:y,duration:_,targetTime:T,sourceTime:v,type:I,volume:w}=this.options,S=new r.CCx;S.material=new r.yB$({path:f,name:p,musicId:g,categoryName:null!=y?y:"music",duration:_,type:I}),S.sourceTimerange=new r.zel(v),S.targetTimerange=new r.zel(T),S.voiceChange=null===(a=h.voiceChange)||void 0===a?void 0:a.filter(e=>![r.xbm.AudioEffectTypeVCVoiceChange,r.xbm.AudioEffectTypeSpeechToSong].includes(e.subType)).map(e=>e.clone()),void 0!==w&&(S.volume=w);let k=(0,l.xX)({__segment_struct_type:h.__segment_struct_type});d.T.pick(h,S,k),e(new n.F({draftId:this.options.draftId,trackId:c,trackIndex:u,segmentId:this.options.segmentId,segmentDelta:S,sourceSegmentDelta:k}))}}c.type=o.U.TEMPLATE_REPLACE_AUDIO},369895:function(e,t,i){i.d(t,{_:function(){return p}});var r=i(150002),n=i(853277),a=i(211561),o=i(690613),s=i(879388),l=i(448218),d=i(217201),c=i(912224),u=i(802195),m=i(881337),h=i(711999),f=i(81649);class p extends r.a{get type(){return p.type}check(e){return(0,o.ly)()}do(e,t,i){(0,h.F)([0,0],a.rxY.CanvasRatio16To9,!1,t,e);let{params:r,json:n}=this.options,{trackIndex:f,material:p,resources:g}=r,y={targetSegmentId:"",targetStartTime:r.material.timeRange.start,targetDuration:r.material.timeRange.duration,targetTrackIndex:f,type:a.pNd.TrackTypeText};new s.W().moveConflictSegment(t,y,t.getAllTracks(),e,i);let _=new d.vp(a.pNd.TrackTypeText,f),T=new c.eK().nextTextAndStickerRenderIndex(t),v=u.y.createImpliment(r.segmentId,(0,m.WSD)({...p,clip:(0,m.cE6)(p.clip)}),g,r.type,T,n),[I,w]=d.c8.insertSegmentCheckTrack(t,v,_,e);if(w&&w.length>0&&(0,l.W)(w,e),I){let[i,r]=d.c8.insertSegment(t,I,v,_);-1!==i&&(0,l.W)(r,e)}return(0,o.oW)(r.segmentId)}constructor(e,t){super(e);let i=new f.O1(t.getDraftProperty().fps),r=i.gen(this.options.params.material.timeRange.start).tail,n=i.gen(this.options.params.material.timeRange.start+this.options.params.material.timeRange.duration).tail;this.options.params.material.timeRange={start:r,duration:n-r}}}p.type=n.U.ADD_TEXT_TEMPLATE_ACTION},611769:function(e,t,i){i.d(t,{Y:function(){return g}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(481631),d=i(802195),c=i(211561),u=i(129862),m=i(320149),h=i(283751);let f=(0,a.i)(s.H.removeTextTemplateAnimationActionSegmentNotExist,""),p=(0,a.i)(s.H.removeTextTemplateAnimationActionTypeNotValid,"");class g extends r.a{get type(){return g.type}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,l.Q2)(i)?(0,o.ly)():p(`segment type is not valid, type is ${i.__segment_struct_type}`):f("segment is not exist")}do(e,t,i){let{segmentId:r,textMaterialId:n,animTypes:a}=this.options,o=t.getSegmentById(r);if(!o||!(0,l.Q2)(o))return;let s=d.y.isNewTextTemplateSegment(o.material),f=e=>{let t=m.q.animType(e.type),i=a.includes(t);return i&&s?(e.path="",e.resourceId="",e.duration=0n,!0):!i},p=n?[n]:o.material.textInfoResources.map(e=>e.textMaterial.id),g=o.clone();p.forEach(e=>{d.y.updateTextAnimation(g,e,f,[])});let y=new c.kph;y.material=new c._0h,y.material.textInfoResources=g.material.textInfoResources;let _=(0,l.xX)({__segment_struct_type:o.__segment_struct_type});h.T.pick(o,y,_),e(new u.F({trackId:t.getTrackBySegmentId(r).id,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:y,sourceSegmentDelta:_}))}}g.type=n.U.UPDATE_TEXT_TEMPLATE_TEXT_ANIM_ACTION},251692:function(e,t,i){i.d(t,{T:function(){return y}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(481631),d=i(211561),c=i(712616),u=i(802195),m=i(129862),h=i(320149),f=i(283751);let p=(0,a.i)(s.H.updateTextTemplateAnimationActionSegmentNotExist,""),g=(0,a.i)(s.H.updateTextTemplateAnimationActionTypeNotValid,"");class y extends r.a{get type(){return y.type}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,l.Q2)(i)?(0,o.ly)():g(`segment type is not valid, type is ${i.__segment_struct_type}`):p("segment is not exist")}do(e,t,i){let{segmentId:r,material:n,textMaterialId:a,isKtv:o,ktvColor:s=""}=this.options,p=t.getSegmentById(r);if(!p||!(0,l.Q2)(p))return;let g=a?[a]:p.material.textInfoResources.map(e=>e.textMaterial.id),y=e=>h.q.animType(e.type)!==n.type,_=p.clone();g.forEach(e=>{let t=c.i.makeStickerAnim(n,"sticker");u.y.updateTextAnimation(_,e,y,[t],o,s)});let T=new d.kph;T.material=new d._0h,T.material.textInfoResources=_.material.textInfoResources;let v=(0,l.xX)({__segment_struct_type:p.__segment_struct_type});f.T.pick(p,T,v),e(new m.F({trackId:t.getTrackBySegmentId(p.id).id,trackIndex:t.getTrackIndexBySegmentId(p.id),segmentId:p.id,segmentDelta:T,sourceSegmentDelta:v}))}}y.type=n.U.UPDATE_TEXT_TEMPLATE_TEXT_ANIM_ACTION},851163:function(e,t,i){i.d(t,{n:function(){return m}});var r=i(475028),n=i(690613),a=i(481631),o=i(150002),s=i(853277),l=i(712616),d=i(653322);let c=(0,r.i)(d.H.RemoveTextAnimationIdEmpty,""),u=(0,r.i)(d.H.RemoveTextAnimationTypeEmpty,"");class m extends o.a{get type(){return s.U.REMOVE_TEXT_ANIMATION_ACTION}check(e){let{segmentIds:t,animTypes:i}=this.options;return 0===t.length?c("segmentIds length is 0"):0===i.length?u("animTypes length is 0"):(0,n.ly)()}do(e,t,i){let{segmentIds:r,animTypes:n}=this.options;r.forEach(i=>{let r=t.getSegmentById(i);if(!!r)((0,a.Ft)(r)||(0,a.P2)(r))&&l.i.removeTextAnims(r,n,e,t)})}}m.type=s.U.REMOVE_TEXT_ANIMATION_ACTION},827885:function(e,t,i){i.d(t,{l:function(){return p}});var r=i(150002),n=i(853277),a=i(690613),o=i(211561),s=i(268468),l=i(700857),d=i(881337),c=i(698159),u=i(481631),m=i(441021),h=i(351603),f=i(929576);class p extends r.a{get type(){return p.type}check(e){return(0,a.ly)()}do(e,t,i){let{segId:r,segIds:n,syncToAll:a=!0,clearKeywordsStyle:p}=this.options,g=t.getSegmentById(r);if(!g||!(0,u.Ft)(g))return;let y=[],_=[];if(p){let t=new s.ry;t.subtitleKeywordsConfig=null,e(new l.W({propertyDelta:t}))}else{let{fonts:e,effects:i}=f.O.getRichTextResourcesFromKeywordsConfig(t,g);e.length>0&&(_=e),i.length>0&&(y=i)}let T=(0,m.o)(t,r,a,n),v=(0,d.U_g)(),I=T.map(e=>{let i=new o.xKN;i.effect=null,i.effects=y,i.animations=null;let{text:r,fontSize:n}=e.material,a=JSON.stringify({text:r,styles:[{size:n,range:[0,r.length]}]});return i.material=new o.edz({content:a,baseContent:a,captionTemplateInfo:new o.oGT,globalAlpha:v.globalAlpha,backgroundColor:v.bgColor,backgroundAlpha:v.bgAlpha,backgroundStyle:v.bgStyle,backgroundRoundRadius:v.bgRoundRadiusScale,backgroundWidth:v.bgWidth,backgroundHeight:v.bgHeight,backgroundVerticalOffset:v.bgHorizontalOffset,backgroundHorizontalOffset:v.bgVerticalOffset,letterSpacing:v.letterSpacing,lineSpacing:v.letterSpacing,hasShadow:v.hasShadow,shadowColor:v.shadowColor,shadowAlpha:v.shadowAlpha,shadowSmoothing:v.shadowSmoothing,shadowDistance:v.shadowDistance,shadowAngle:v.shadowAngle,shadowPoint:(0,h.IN)(v.shadowDistance,v.shadowAngle),borderAlpha:v.borderAlpha,borderColor:v.borderColor,borderWidth:v.borderWidth,textColor:v.textColor,textAlpha:v.textAlpha,fontName:"",fontTitle:v.fontTitle,fontPath:v.fontPath,fontId:v.fontId,fontResourceId:v.fontResId,fontCategoryId:v.fontCategoryId,fontCategoryName:v.fontCategoryName,fontSourcePlatform:v.fontSourcePlatform,fonts:_,fontTeamId:v.fontTeamId,typesetting:v.typesetting,alignment:v.alignment,useEffectDefaultColor:v.useEffectDefaultColor,ktvColor:v.ktvColor,boldWidth:v.boldWidth,italicDegree:v.italicDegree,underline:v.hasUnderline,underlineWidth:v.underlineWidth,underlineOffset:v.underlineOffset,checkFlag:v.checkFlag,subtitleTemplateOriginalFontsize:0}),i.material.richTextCommand=null,(0,c.l)(t,e.id,i)});(0,c.W)(I,e)}}p.type=n.U.RESET_SUBTITLE_TEMPLATE},122531:function(e,t,i){i.d(t,{I:function(){return v}});var r=i(150002),n=i(853277),a=i(698159),o=i(129862),s=i(690613),l=i(217201),d=i(912224),c=i(712616),u=i(481631),m=i(602777),h=i(881337),f=i(401483),p=i(879388),g=i(711999),y=i(211561),_=i(81649),T=i(283751);class v extends r.a{get type(){return v.type}check(e){return(0,s.ly)()}do(e,t,i){var r;(0,g.F)([0,0],m.rx.CanvasRatio16To9,!1,t,e);let{trackIndex:n}=this.options,s=new f.e;s.targetStartTime=this.options.segInfo.timeRange.start,s.targetDuration=this.options.segInfo.timeRange.duration,s.targetTrackIndex=this.options.trackIndex,s.type=m.pN.TrackTypeText,new p.W().moveConflictSegment(t,s,t.getAllTracks(),e,i);let _=new l.vp(m.pN.TrackTypeText,n,t.getAllTracks()[n].flag),v=new d.eK().nextTextAndStickerRenderIndex(t),I=c.i.makeRichTextSegment((0,h.aMe)({...this.options.segInfo,material:(0,h.U_g)(this.options.segInfo.material),textEffect:(0,h.ABm)(this.options.segInfo.textEffect),shapeEffect:(0,h.ABm)(this.options.segInfo.shapeEffect),clip:(0,h.cE6)(this.options.segInfo.clip),bloomMaterial:(0,h.ABm)(this.options.segInfo.bloomMaterial)}),this.options.type,v);I.id=this.options.segInfo.segmentId;let w=null!==(r=this.options.relevanceSegment)&&void 0!==r?r:"",S=t.getSegmentById(w);if(S&&(0,u.Ft)(S)){let i=S.material.relevanceSegment;i.push(I.id);let r=new y.xKN;r.material=new y.edz,r.material.relevanceSegment=i;let n=(0,u.xX)({__segment_struct_type:I.__segment_struct_type});T.T.pick(I,r,n),e(new o.F({trackId:t.getTrackBySegmentId(S.id).id,trackIndex:t.getTrackIndexBySegmentId(S.id),segmentId:S.id,segmentDelta:r,sourceSegmentDelta:n}))}let[k,x]=l.c8.insertSegment(t,t.getAllTracks()[n],I,_);-1!==k&&(0,a.W)(x,e)}constructor(e,t){super(e);let i=new _.O1(t.getDraftProperty().fps),r=i.gen(e.segInfo.timeRange.start).tail,n=i.gen(e.segInfo.timeRange.start+e.segInfo.timeRange.duration).tail;this.options.segInfo.timeRange={start:r,duration:n-r}}}v.type=n.U.ADD_TEXT_ACTION},824160:function(e,t,i){i.d(t,{f:function(){return s}});var r=i(150002),n=i(853277),a=i(690613),o=i(129862);class s extends r.a{get type(){return s.type}check(e){return(0,a.ly)()}do(e,t,i){let{updates:r}=this.options;for(let t of r)e(new o.F(t))}}s.type=n.U.UPDATE_TEXT_EFFECT},884012:function(e,t,i){i.d(t,{g:function(){return g}});var r=i(150002),n=i(853277),a=i(176791),o=i(211561),s=i(448218),l=i(392742),d=i(475028),c=i(690613),u=i(481631),m=i(653322),h=i(268468),f=i(49667);let p=(0,d.i)(m.H.TrackSetMuteTrackNotExist,"");class g extends r.a{get type(){return g.type}check(e){let{trackId:t}=this.options||{};return e.getTrackById(t)?(0,c.ly)():p(`target track not exist: ${t}`)}do(e,t){let i=new h.ry;i.videoMute=this.options.muted,(0,s.W)({type:l.x.SetDocumentProperty,params:{propertyDelta:i}},e);let r=t.getMainTrack();if(!!r)for(let i of r.segments){if(!(0,u.he)(i))continue;let{volume:r}=i,n=i.lastNonzeroVolume,l=new o.NOn;if(!this.options.muted&&r<=0){let e=n>0?n:a.bf;f.vc.FEATURE_SEPARATE_TRACE_MUTED_AND_SEGMENT_VOLUME&&(e=n),l.volume=e,l.lastNonzeroVolume=e}else this.options.muted&&r>0&&(l.volume=0,l.lastNonzeroVolume=r);let d=new a.wK().muteAllKeyframes(i,this.options.muted);l.commonKeyframes=d,(0,s.W)((0,s.l)(t,i.id,l),e)}}}g.type=n.U.TRACK_MUTE_MAIN},691989:function(e,t,i){i.d(t,{f:function(){return h}});var r=i(150002),n=i(853277),a=i(211561),o=i(448218),s=i(392742),l=i(475028),d=i(690613),c=i(653322),u=i(268468);let m=(0,l.i)(c.H.TrackSetMuteTrackNotExist,"");class h extends r.a{get type(){return h.type}check(e){let{trackId:t}=this.options||{};return e.getTrackById(t)?(0,d.ly)():m(`target track not exist: ${t}`)}do(e,t,i){let{trackId:r,muted:n}=this.options||{},l=t.getTrackById(r).attribute||Number(a.$SW.DefaultFlags);n?l|=Number(a.$SW.MuteFlag):l^=Number(a.$SW.MuteFlag),(0,o.W)({type:s.x.UpdateTrack,params:{trackId:r,trackDelta:new u.C4({attribute:l})}},e)}}h.type=n.U.TRACK_MUTE_ADJUST},37858:function(e,t,i){i.d(t,{l:function(){return a}});var r=i(881337),n=i(602777);function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segmentId:void 0!==e.segmentId?e.segmentId:"",path:void 0!==e.path?e.path:"",mediaPath:void 0!==e.mediaPath?e.mediaPath:"",localId:void 0!==e.localId?e.localId:"",type:void 0!==e.type?e.type:n.cV.MetaTypeNone,size:void 0!==e.size?(0,r.cBb)(e.size):(0,r.cBb)({}),startTime:void 0!==e.startTime?BigInt(e.startTime):0n,sourceStartTime:void 0!==e.sourceStartTime?BigInt(e.sourceStartTime):0n,sourceDuration:void 0!==e.sourceDuration?BigInt(e.sourceDuration):0n,duration:void 0!==e.duration?BigInt(e.duration):0n,clip:void 0!==e.clip?(0,r.cE6)(e.clip):(0,r.cE6)({}),hasAudio:void 0===e.hasAudio||e.hasAudio,volume:void 0!==e.volume?e.volume:1,categoryId:void 0!==e.categoryId?e.categoryId:void 0,categoryName:void 0!==e.categoryName?e.categoryName:void 0,materialId:void 0!==e.materialId?e.materialId:void 0,materialName:void 0!==e.materialName?e.materialName:void 0,materialUrl:void 0!==e.materialUrl?e.materialUrl:void 0,copyBackground:void 0===e.copyBackground||e.copyBackground,source:void 0!==e.source?e.source:n.CH.MaterialSourceDefault,sourcePlatform:void 0!==e.sourcePlatform?e.sourcePlatform:n.cv.MaterialPlatformDefault,formulaId:void 0!==e.formulaId?e.formulaId:"",pictureSetCategoryId:void 0!==e.pictureSetCategoryId?e.pictureSetCategoryId:"",pictureSetCategoryName:void 0!==e.pictureSetCategoryName?e.pictureSetCategoryName:"",pictureFrom:void 0!==e.pictureFrom?e.pictureFrom:n.v.PictureFromNone,teamId:void 0!==e.teamId?e.teamId:"",localMaterialId:void 0!==e.localMaterialId?e.localMaterialId:"",originMaterialId:void 0!==e.originMaterialId?e.originMaterialId:"",requestId:void 0!==e.requestId?e.requestId:"",mediaInfo:e.mediaInfo,extraTypeOption:void 0!==e.extraTypeOption?e.extraTypeOption:void 0,freeze:null==e?void 0:e.freeze,historyRecordId:void 0!==e.historyRecordId?e.historyRecordId:"",aigcItemId:void 0!==e.aigcItemId?e.aigcItemId:""}}},595657:function(e,t,i){i.d(t,{J:function(){return u}});var r=i(150002),n=i(853277),a=i(211561),o=i(448218),s=i(129862),l=i(690613),d=i(481631),c=i(501452);class u extends r.a{get type(){return u.type}check(e){return(0,l.ly)()}do(e,t,i){let{segId:r,value:n,isKeyframe:l=!0}=this.options,u=t.getSegmentById(r);if(!u||!(0,d.he)(u))return;let m=new a.NOn;if(m.clip=new a.tLq,m.clip.alpha=n,(0,o.W)((0,o.l)(t,r,m),e),l){let i=c.y.execute({keyframeType:a.Eu.KFTypeAlpha,segment:u,values:[n],draftView:t});i&&e(new s.F(i))}}}u.type=n.U.VIDEO_ALPHA},915359:function(e,t,i){i.d(t,{P:function(){return T}});var r=i(211561),n=i(129862),a=i(150002),o=i(853277),s=i(475028),l=i(690613),d=i(653322),c=i(185400),u=i(481631),m=i(740495),h=i(283751);let f=[r.Eu.KFTypeSaturation,r.Eu.KFTypeTemperature,r.Eu.KFTypeHue],p=[r.Eu.KFTypeBrightness,r.Eu.KFTypeContrast,r.Eu.KFTypeHightLight,r.Eu.KFTypeShadow,r.Eu.KFTypeLightSensatione],g=[r.Eu.KFTypeSharpen,r.Eu.KFTypeFade,r.Eu.KFTypeVignetting,r.Eu.KFTypeParticle],y=(0,s.i)(d.H.ResetVideoBasicColorSegmentNotExist,""),_=(0,s.i)(d.H.ResetVideoBasicColorTypeNotValid,"");class T extends a.a{get type(){return T.type}check(e){let t=e.getSegmentById(this.options.segId);return t?(!((0,u.he)(t)||(0,u.E6)(t))&&_(`segment type is not valid. type is ${t.__segment_struct_type}`),(0,l.ly)()):y("segment is not exist")}do(e,t,i){var a;let o,s,l;let{segId:d,type:y}=this.options,_=t.getSegmentAtPositionById(d),T=null==_?void 0:_.segment,v=null!==(a=null==_?void 0:_.trackId)&&void 0!==a?a:"";(0,u.he)(T)?(s=T.adjust?T.adjust.clone():new r.sq5,o=new r.NOn):(s=T.material?T.material.clone():new r.sq5,o=new r.MYy),"color"===y?(l=(0,m.$)(T,f),s.saturation&&(s.saturation.value=0),s.colorTemperature&&(s.colorTemperature.value=0),s.hue&&(s.hue.value=0)):"lightness"===y?(l=(0,m.$)(T,p),s.brightness&&(s.brightness.value=0),s.contrast&&(s.contrast.value=0),s.lightSensation&&(s.lightSensation.value=0),s.highlight&&(s.highlight.value=0),s.shadow&&(s.shadow.value=0)):"effects"===y?(l=(0,m.$)(T,g),s.sharpening&&(s.sharpening.value=0),s.vignetting&&(s.vignetting.value=0),s.fade&&(s.fade.value=0),s.particle&&(s.particle.value=0)):(l=(0,m.$)(T,c.rp),s.brightness&&(s.brightness.value=0),s.contrast&&(s.contrast.value=0),s.saturation&&(s.saturation.value=0),s.sharpening&&(s.sharpening.value=0),s.highlight&&(s.highlight.value=0),s.shadow&&(s.shadow.value=0),s.colorTemperature&&(s.colorTemperature.value=0),s.hue&&(s.hue.value=0),s.fade&&(s.fade.value=0),s.vignetting&&(s.vignetting.value=0),s.particle&&(s.particle.value=0),s.lightSensation&&(s.lightSensation.value=0)),(0,u.RF)(o)?o.adjust=new r.cNp(s):o.material=new r.cNp(s),l&&(o.commonKeyframes=l);let I=(0,u.xX)({__segment_struct_type:T.__segment_struct_type});h.T.pick(T,o,I),e(new n.F({trackId:v,trackIndex:_.trackIndex,segmentId:d,segmentDelta:o,sourceSegmentDelta:I}))}}T.type=o.U.VIDEO_RESET_BASIC_COLOR},124401:function(e,t,i){i.d(t,{x:function(){return m}});var r=i(150002),n=i(853277),a=i(671922),o=i(475028),s=i(690613),l=i(481631),d=i(653322);let c=(0,o.i)(d.H.ReverseVideoSegmentNotExist,""),u=(0,o.i)(d.H.ReverseVideoTypeNotValid,"");class m extends r.a{get type(){return m.type}check(e){let t=e.getSegmentById(this.options.segId);return t?(0,l.he)(t)?(0,s.ly)():u(`segment type is not valid, type is ${t.__segment_struct_type}`):c("segment is not exist")}do(e,t,i){(0,a.I)(t,this.options,e)}}m.type=n.U.VIDEO_REVERSE},651405:function(e,t,i){i.d(t,{c:function(){return f}});var r=i(853277),n=i(150002),a=i(475028),o=i(690613),s=i(653322),l=i(481631),d=i(211561),c=i(129862),u=i(283751);let m=(0,a.i)(s.H.SetVideoFigureFaceIdSegmentNotExist,""),h=(0,a.i)(s.H.SetVideoFigureFaceIdTypeNotValid,"");class f extends n.a{get type(){return f.type}check(e){let t=e.getSegmentById(this.options.segmentId);return t?(0,l.he)(t)?(0,o.ly)():h(`segment type is not valid, type is ${t.__segment_struct_type}`):m("segment is not exist")}do(e,t,i){let{segmentId:r,faceId:n}=this.options,a=t.getTrackBySegmentId(r),o=t.getSegmentById(r);if(!o||!(0,l.he)(o))return;let{figures:s}=o,m=s.map(e=>e.clone()).map(e=>(e.adjustParams.length&&(e.adjustParams=e.adjustParams.map(e=>{let t={...e,name:n};return new d.VBR(t)})),e.faceAdjustParams&&(e.faceAdjustParams=e.faceAdjustParams.map(e=>{let t={...e,faceId:n};return new d.m4H(t)})),e)),h=new d.NOn;h.figures=m;let f=(0,l.xX)({__segment_struct_type:o.__segment_struct_type});u.T.pick(o,h,f),e(new c.F({trackId:a.id,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:h,sourceSegmentDelta:f}))}}f.type=r.U.VIDEO_SET_FIGURE_FACE_ID},916791:function(e,t,i){i.d(t,{c:function(){return p}});var r=i(853277),n=i(150002),a=i(475028),o=i(690613),s=i(653322),l=i(481631),d=i(211561),c=i(129862),u=i(350902),m=i(283751);let h=(0,a.i)(s.H.SetVideoFigureSegmentNotExist,""),f=(0,a.i)(s.H.SetVideoFigureTypeNotValid,"");class p extends n.a{get type(){return p.type}check(e){let t=e.getSegmentById(this.options.segmentId);return t?(0,l.he)(t)?(0,o.ly)():f(`segment type is not valid, type is ${t.__segment_struct_type}`):h("segment is not exist")}do(e,t,i){let{segmentId:r,figure:n,isUnifiedBeautyMode:a}=this.options,o=t.getTrackBySegmentId(r),s=t.getSegmentById(r);if(!s||!(0,l.he)(s))return;let h=Array.isArray(n)?n:[n],f=(0,u.cc)(h,s.figures),p=a===s.material.isUnifiedBeautyMode?void 0:a,g=new d.NOn;g.figures=f,g.material=new d.K2q,g.material.isUnifiedBeautyMode=p;let y=(0,l.xX)({__segment_struct_type:s.__segment_struct_type});m.T.pick(s,g,y),e(new c.F({trackId:o.id,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:g,sourceSegmentDelta:y}))}}p.type=r.U.VIDEO_SET_FIGURE},357230:function(e,t,i){i.d(t,{h:function(){return p}});var r=i(211561),n=i(150002),a=i(853277),o=i(129862),s=i(475028),l=i(690613),d=i(481631),c=i(653322),u=i(93735),m=i(283751);let h=(0,s.i)(c.H.SetVideoFigureFaceIdSegmentNotExist,""),f=(0,s.i)(c.H.SetVideoFigureFaceIdTypeNotValid,"");class p extends n.a{get type(){return p.type}check(e){let t=e.getSegmentById(this.options.segId);return t?(0,d.he)(t)?(0,l.ly)():f(`segment type is not valid, type is ${t.__segment_struct_type}`):h("segment is not exist")}do(e,t,i){let{segId:n,material:a}=this.options,s=t.getSegmentById(n),l=t.getTrackBySegmentId(s.id),c=null;a&&(c=new r.W9x((0,u.yK)(a)));let h=new r.NOn;h.mixMode=c;let f=(0,d.xX)({__segment_struct_type:s.__segment_struct_type});m.T.pick(s,h,f),e(new o.F({trackId:l.id,trackIndex:t.getTrackIndexBySegmentId(s.id),segmentId:s.id,segmentDelta:h,sourceSegmentDelta:f}))}}p.type=a.U.VIDEO_MIX},705565:function(e,t,i){i.d(t,{C:function(){return p}});var r=i(150002),n=i(853277),a=i(211561),o=i(129862),s=i(475028),l=i(690613),d=i(481631),c=i(653322),u=i(93735),m=i(283751);let h=(0,s.i)(c.H.ApplyVideoAllChromaSegmentNotExist,""),f=(0,s.i)(c.H.ApplyVideoAllChromaSegmentTypeNotValid,"");class p extends r.a{get type(){return p.type}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,d.he)(i)?(0,l.ly)():f(`segment type not valid: ${t}`):h(`segment not exist: ${t}`)}do(e,t,i){let{segmentId:r,path:n,enable:s,smartAdjustColor:l}=this.options,c=t.getTrackBySegmentId(r),h=t.getSegmentById(r);if(!h||!(0,d.he)(h))return;let f=new a.NOn,p=new a.K2q,g=h.adjust?h.adjust.clone():new a.sq5;g.enableSmartColorAdjust=s,s&&l?g.smartAdjustColor=(0,u.yK)(l):g.smartAdjustColor=void 0,!p.videoAlgorithm&&(p.videoAlgorithm=new a.OHm),p.videoAlgorithm.path=n,f.adjust=new a.cNp(g),f.material=p;let y=(0,d.xX)({__segment_struct_type:h.__segment_struct_type});m.T.pick(h,f,y),e(new o.F({trackId:c.id,trackIndex:t.getTrackIndexBySegmentId(r),segmentId:r,segmentDelta:f,sourceSegmentDelta:y}))}}p.type=n.U.VIDEO_SET_SMART_COLOR_ADJUST},604277:function(e,t,i){i.d(t,{U:function(){return p}});var r=i(150002),n=i(853277),a=i(129862),o=i(211561),s=i(280700),l=i(475028),d=i(690613),c=i(653322),u=i(481631),m=i(501452),h=i(283751);let f=(0,l.i)(c.H.SetVideoBasicColorSegmentNotExist,"");class p extends r.a{get type(){return p.type}check(e){return this.options.segmentIds.every(t=>e.getSegmentById(t))?(0,d.ly)():f("segment is not exist")}do(e,t,i){let{segmentIds:r,isRecordAction:n=!0,volume:l=0,isKeyframe:d=!0,draftId:c}=this.options,f=t.getDraftById(c);for(let i of r){let r=(0,s.Cm)(f.getAllTracks(),i);if(!r)throw Error(`scale cannot find segment by id: ${i}`);let{segmentIndex:c,trackIndex:p,trackId:g}=r,y=f.getAllTracks()[p].segments[c],_=(0,u.Y9)(y)?new o.CCx:new o.NOn;if((0,u.he)(y)){n&&(_.lastNonzeroVolume=l);let e=f.getMainTrack();e&&e.id===g&&f.getDraftProperty().videoMute&&f===t?_.lastNonzeroVolume=l:_.volume=l}else if((0,u.Y9)(y))_.volume=l;else throw Error(`segment ${i} is not video or audio`);let T=(0,u.xX)({__segment_struct_type:y.__segment_struct_type});if(h.T.pick(y,_,T),e(new a.F({draftId:this.options.draftId,trackId:g,trackIndex:p,segmentId:i,segmentDelta:_,sourceSegmentDelta:T})),d){let t=m.y.execute({segment:y,values:[l],keyframeType:o.Eu.KFTypeVolume,draftView:f});t&&e(new a.F(t))}}}constructor(e){var t,i,r,n,a,o;super(Object.assign({},e,{draftId:null!==(t=e.draftId)&&void 0!==t?t:"",volume:null!==(i=e.volume)&&void 0!==i?i:0,isRecordAction:null===(r=e.isRecordAction)||void 0===r||r,isKeyframe:null===(n=e.isKeyframe)||void 0===n||n,keyframeId:null!==(a=e.keyframeId)&&void 0!==a?a:"",isAutoFillKeyframe:null===(o=e.isAutoFillKeyframe)||void 0===o||o}))}}p.type=n.U.VIDEO_SET_VOLUME},207730:function(e,t,i){i.d(t,{L:function(){return p}});var r=i(150002),n=i(853277),a=i(129862),o=i(211561),s=i(475028),l=i(690613),d=i(481631),c=i(653322),u=i(283751);let m=(0,s.i)(c.H.UpdateVideoAnimationSegmentNotExist,""),h=(0,s.i)(c.H.UpdateVideoAnimationTypeNotValid,""),f=(0,s.i)(c.H.UpdateVideoAnimationSegmentNotExist,"");class p extends r.a{get type(){return n.U.UPDATE_ANIMATION}check(e){let{segId:t}=this.options,i=e.getSegmentById(t);return i?(0,d.he)(i)?(null==i?void 0:i.animations)?(0,l.ly)():f("animation length is 0"):h(`type is not valid:${i.__segment_struct_type}`):m("segment is not exist")}do(e,t,i){var r,n;let{segId:s,animation:l}=this.options,c=t.getSegmentById(s);if(!c||!(0,d.he)(c)||!(null==c?void 0:c.animations))return;let m=[...c.animations.animations],h=m.findIndex(e=>e.type===l.type);m[h]=l;let f=new o.NOn,p=new o.PA;p.animations=m,f.animations=p;let g=(0,d.xX)({__segment_struct_type:c.__segment_struct_type});u.T.pick(c,f,g),e(new a.F({trackId:null!==(n=null===(r=t.getTrackBySegmentId(s,[]))||void 0===r?void 0:r.id)&&void 0!==n?n:"",trackIndex:t.getTrackIndexBySegmentId(s),segmentId:s,segmentDelta:f,sourceSegmentDelta:g}))}}p.type=n.U.UPDATE_ANIMATION},708523:function(e,t,i){i.d(t,{H:function(){return v}});var r=i(150002),n=i(853277),a=i(475028),o=i(690613),s=i(653322),l=i(481631),d=i(129862),c=i(211561),u=i(176791),m=i(794560),h=i(217201),f=i(698159),p=i(239648),g=i(81649),y=i(283751);let _=(0,a.i)(s.H.UpdateVideoMaterialSegmentNotExist,""),T=(0,a.i)(s.H.UpdateVideoMaterialTypeNotValid,"");class v extends r.a{get type(){return v.type}check(e){let t=e.getSegmentById(this.options.segmentId);return this.options.videoParams&&this.options.videoParams.length<1?T("video params cannot be empty array, you should provide at least one video param or not provide it"):t?(0,l.he)(t)?(0,o.ly)():T(`segment type is not video, type is ${t.__segment_struct_type}`):_("segment is not exist")}do(e,t,i){let{segment:r,trackId:n,trackIndex:a}=t.getSegmentAtPositionById(this.options.segmentId);if(!!r&&!!(0,l.he)(r)){if(this.options.ttsMetaParams&&this.options.videoParams){if(-1===r.renderIndex)return;let{materialDraft:o,digitalHumanPreviewVideoSegments:s}=new u.wK().getDigitalHumanMaterialDraft(this.options.videoParams,this.options.ttsMetaParams),[g]=s,_=g.material.clone(!0);_.materialId="";let T=new c.NOn({materialDraft:o,material:_}),v=(0,l.xX)({__segment_struct_type:r.__segment_struct_type});if(y.T.pick(r,T,v),e(new d.F({trackId:n,trackIndex:a,segmentId:r.id,segmentDelta:T,sourceSegmentDelta:v})),this.options.duration){let o=new c.NOn;o.material=new c.K2q({duration:this.options.duration}),v=(0,l.xX)({__segment_struct_type:r.__segment_struct_type}),y.T.pick(r,T,v),e(new d.F({trackId:n,trackIndex:a,segmentId:r.id,segmentDelta:o,sourceSegmentDelta:v})),!(0===a&&t.getDraftProperty().maintrackAdsorb)&&(h.c8.moveSegmentsIfConflict(t,t.getAllTracks()[a],new Map([[r,new c.tnv({start:r.targetTimerange.start,duration:this.options.duration})]]),[c.pNd.TrackTypeVideo],e),(0,f.W)(new p.Uo().clearUselessTransition(t,t.getAllTracks()[a]),e),{segment:r,trackId:n,trackIndex:a}=t.getSegmentAtPositionById(this.options.segmentId),(0,f.W)(new p.Uo().clearUselessTransition(t,t.getAllTracks()[a]),e)),(0,m.c)(t,{segmentId:r.id,trackId:n,clipType:c.ZXd.ClipDuration,clipTime:r.targetTimerange.start+this.options.duration},e,i)}}if((0,l.he)(r)&&r.digitalHuman){var o,s,g,_,T,v,I,w,S,k,x;let t=new c.NOn;if(t.digitalHuman=new c.Zgq,void 0!==this.options.sourceTimerangeParam&&(t.sourceTimerange=new c.zel({start:null!==(g=null===(o=this.options.sourceTimerangeParam)||void 0===o?void 0:o.start)&&void 0!==g?g:r.sourceTimerange.start,duration:null!==(_=null===(s=this.options.sourceTimerangeParam)||void 0===s?void 0:s.duration)&&void 0!==_?_:r.sourceTimerange.duration})),void 0!==this.options.digitalHumanId&&(t.digitalHuman.digitalHumanId=this.options.digitalHumanId),void 0!==this.options.resourceId&&(t.digitalHuman.resourceId=this.options.resourceId),void 0!==this.options.localTaskId&&(t.digitalHuman.localTaskId=this.options.localTaskId),void 0!==this.options.maskParam){if(null===this.options.maskParam)t.digitalHuman.mask=null;else{if(!r.videoMask||0===r.videoMask.length){let t=new c.NOn,i=new c.Q$U;t.videoMask=[i];let o=(0,l.xX)({__segment_struct_type:r.__segment_struct_type});y.T.pick(r,t,o),e(new d.F({trackId:n,trackIndex:a,segmentId:r.id,segmentDelta:t,sourceSegmentDelta:o}))}let t=new u.wK().getVideoMaskDelta(r,this.options.maskParam,!0);if(t){let i=(0,l.xX)({__segment_struct_type:r.__segment_struct_type});y.T.pick(r,t,i),e(new d.F({trackId:n,trackIndex:a,segmentId:r.id,segmentDelta:t,sourceSegmentDelta:i}))}}}void 0!==this.options.backgroundParam&&(null===this.options.backgroundParam?t.digitalHuman.background=null:t.digitalHuman.background=new c.P28(this.options.backgroundParam)),this.options.videoParams&&(t.digitalHuman.videoMeta=new c.$my({path:this.options.videoParams[0].path})),this.options.ttsMetaParams&&(t.digitalHuman.voiceInfo=new c.mJ({speed:this.options.ttsMetaParams[0].ttsParam.text.speed,resourceId:this.options.ttsMetaParams[0].ttsParam.text.resourceId,toneType:this.options.ttsMetaParams[0].ttsParam.text.toneType,toneEffectId:this.options.ttsMetaParams[0].ttsParam.text.toneEffectId,toneEffectName:this.options.ttsMetaParams[0].ttsParam.text.toneEffectName,toneCategoryId:this.options.ttsMetaParams[0].ttsParam.text.toneCategoryId,toneCategoryName:this.options.ttsMetaParams[0].ttsParam.text.toneCategoryName,tonePlatform:null===(v=this.options.ttsMetaParams[0].ttsParam)||void 0===v?void 0:null===(T=v.text)||void 0===T?void 0:T.tonePlatform,speakerId:null===(w=this.options.ttsMetaParams[0].ttsParam)||void 0===w?void 0:null===(I=w.text)||void 0===I?void 0:I.toneSpeaker,isAiCloneTone:null===(k=this.options.ttsMetaParams[0].ttsParam)||void 0===k?void 0:null===(S=k.text)||void 0===S?void 0:S.isAiCloneTone}),t.digitalHuman.ttsMetas=null===(x=this.options.ttsMetaParams)||void 0===x?void 0:x.map(e=>new c.yU0({text:e.text,ttsPayload:e.ttsPayload,textSegId:e.ttsParam.segmentId,ttsPath:e.ttsParam.audioPath,ttsStart:e.ttsParam.startTime})));let i=(0,l.xX)({__segment_struct_type:r.__segment_struct_type});y.T.pick(r,t,i),e(new d.F({trackId:n,trackIndex:a,segmentId:r.id,segmentDelta:t,sourceSegmentDelta:i}))}}}constructor(e,t){var i;super(e);let r=null===(i=this.options.videoParams)||void 0===i?void 0:i[0];if(r&&(r.size.width=Number(r.mediaInfo.width),r.size.height=Number(r.mediaInfo.height)),this.options.duration){let e=new g.O1(t.getDraftProperty().fps);this.options.duration=e.gen(this.options.duration).tail}}}v.type=n.U.VIDEO_UPDATE_DIGITAL_HUMAN},286873:function(e,t,i){i.d(t,{w:function(){return h}});var r=i(211561),n=i(150002),a=i(475028),o=i(690613),s=i(653322),l=i(853277),d=i(481631),c=i(129862);let u=(0,a.i)(s.H.SetVideoObjectLockedNotExist,""),m=(0,a.i)(s.H.SetVideoObjectLockedTypeNotValid,"");class h extends n.a{get type(){return l.U.VIDEO_UPDATE_OBJECT_LOCKED}check(e){let{segmentId:t}=this.options,i=e.getSegmentById(t);return i?(0,d.he)(i)?i.material.type!==r.cVg.MetaTypeVideo?m(`segment material type not valid: ${i.material.type}`):(0,o.ly)():m(`segment type not valid: ${i.__segment_struct_type}`):u(`segment not exist: ${t}`)}do(e,t,i){let{segment:n,trackIndex:a}=t.getSegmentAtPositionById(this.options.segmentId);if((0,d.he)(n)){let i=new r.NOn;i.material=new r.K2q,i.material.objectLocked=new r.BnV(this.options);let o=(0,d.xX)({__segment_struct_type:n.__segment_struct_type});e(new c.F({trackId:t.getTrackByIndex(a).id,trackIndex:t.getTrackIndexBySegmentId(n.id),segmentId:n.id,segmentDelta:i,sourceSegmentDelta:o}))}}}},882407:function(e,t,i){i.d(t,{_:function(){return n}});var r=i(426336);class n{constructor(e){this.reportType=r.C2Q.ActionArgs,this.apiNamespace=e.apiNamespace,this.apiName=e.apiName,this.args=e.args,this.draftId=e.draftId}}},176991:function(e,t,i){i.d(t,{D:function(){return d}});var r=i(789786),n=i(328253),a=i(345573),o=i(522699),s=i(529628),l=i(575534);class d extends l.e{add(e){return this._mixApplyLocal({action:new n.H(e,this._videoDocument)})}updateAdjustParams(e){return this._mixApplyLocal({action:new o.H(e)})}resetAdjustParams(e){return this._mixApplyLocal({action:new a.B(e)})}}(0,r.gn)([(0,s.cM)("effectApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddEffectActionOptions?Object:IAddEffectActionOptions]),(0,r.w6)("design:returntype",void 0)],d.prototype,"add",null),(0,r.gn)([(0,s.cM)("effectApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateEffectAdjustParamsActionOptions?Object:IUpdateEffectAdjustParamsActionOptions]),(0,r.w6)("design:returntype",void 0)],d.prototype,"updateAdjustParams",null),(0,r.gn)([(0,s.cM)("effectApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IResetEffectAdjustParamsActionOptions?Object:IResetEffectAdjustParamsActionOptions]),(0,r.w6)("design:returntype",void 0)],d.prototype,"resetAdjustParams",null)},164583:function(e,t,i){i.d(t,{o:()=>A});var r=i("789786"),n=i("862213"),a=i("890400"),o=i("983516"),s=i("475028"),l=i("690613"),d=i("800788"),c=i("150002"),u=i("653322"),m=i("211561"),h=i("419537"),f=i("331509"),p=i("340294");let g=(0,s.i)(u.H.AttachmentPinAiStoryAlternativeMaterialSegmentNotExist,""),y=(0,s.i)(u.H.AttachmentPinAiStoryAlternativeMaterialMaterialNotExist,"");class _ extends c.a{get type(){return n.Us.ATTACHMENT_PIN_AI_STORY_ALTERNATIVE_MATERIAL}check(e){return e.getAiStoryAlternativeMaterialBySegmentId(this.options.segmentId)?e.getAiStoryAlternativeMaterialBySegmentIdAndAlternativeId(this.options.segmentId,this.options.alternativeId)?(0,l.ly)():y("pin ai story alternative material to a non-exist material"):g("pin ai story alternative material to a non-exist segment")}do(e,t,i){let r=t.getAiStoryAlternativeMaterialBySegmentId(this.options.segmentId);(0,d.Y2)(r,"target alternative material list should exist!");let a=new m.mNK({alternatives:r.alternatives.map(e=>{if(e.id!==this.options.alternativeId)return e.clone();if(e.pin===this.options.pin)return e.clone();{let t=e.clone();return t.pin=this.options.pin,t.updateTime=p.pM.times(Date.now(),1e3,"bigint"),t}})});e(new h.K({attachmentKey:n.d3.AiStoryAlternativeMaterial,key:this.options.segmentId,delta:a,type:f.be.UPDATE,index:r.alternatives.findIndex(e=>e.id===this.options.alternativeId),draftId:t.getDraftId(),trackIndex:t.getTrackIndexBySegmentId(this.options.segmentId)}))}}class T extends c.a{get type(){return n.Us.ATTACHMENT_REPLACE_AI_STORY_ALTERNATIVE_MATERIAL}check(e){return(0,l.ly)()}do(e,t,i){let{identifier:r,substitute:a}=this.options,o=t.getDraftById(this.options.draftId);if(!!o)for(let{segmentId:t,alternatives:i}of o.getAiStoryAllAlternativeMaterials().values()){let s;let l=-1;for(let e=0;e<i.length;++e){let t=i[e];(0,p.nr)(t,r)&&(!s&&(s=i.map(e=>e.clone())),s[e]=(0,p.pc)(s[e],a),l=e)}s&&e(new h.K({attachmentKey:n.d3.AiStoryAlternativeMaterial,key:t,delta:new m.mNK({alternatives:s}),type:f.be.UPDATE,index:l,draftId:o.getDraftId(),trackIndex:o.getTrackIndexBySegmentId(t)}))}}}var v=i("283751");let I=(0,s.i)(u.H.AttachmentUpdateAiStoryAlternativeMaterialSegmentNotExist,""),w=(0,s.i)(u.H.AttachmentUpdateAiStoryAlternativeMaterialMaterialNotExist,"");class S extends c.a{get type(){return n.Us.ATTACHMENT_UPDATE_AI_STORY_ALTERNATIVE_MATERIAL}check(e){return e.getAiStoryAlternativeMaterialBySegmentId(this.options.segmentId)?e.getAiStoryAlternativeMaterialBySegmentIdAndAlternativeId(this.options.segmentId,this.options.alternativeId)?(0,l.ly)():w("update ai story alternative material to a non-exist material"):I("update ai story alternative material to a non-exist segment")}do(e,t,i){let r=t.getAiStoryAlternativeMaterialBySegmentId(this.options.segmentId);(0,d.Y2)(r,"target alternative material list should exist!");let a=new m.mNK({alternatives:r.alternatives.map(e=>e.id!==this.options.alternativeId?e.clone():v.T.merge(e.clone(),this.options.delta))});e(new h.K({attachmentKey:n.d3.AiStoryAlternativeMaterial,key:this.options.segmentId,delta:a,type:f.be.UPDATE,index:r.alternatives.findIndex(e=>e.id===this.options.alternativeId),draftId:t.getDraftId(),trackIndex:t.getTrackIndexBySegmentId(this.options.segmentId)}))}}var k=i("692032");class x extends c.a{get type(){return n.Us.ATTACHMENT_UPDATE_MOVE_FEEDS_TO_ALTERNATIVE}check(e){return(0,l.ly)()}do(e,t,i){e(new h.K({attachmentKey:n.d3.AiStoryMeta,key:t.getDraftId(),delta:new m.v3W({moveFeedsToAlternative:this.options.moved})}))}}var b=i("575534"),M=i("481631"),C=i("325784");class A extends b.e{deleteAiStoryAlternative(e){return this._mixApplyLocal({action:new n.nx(e)},{canUndoRedo:!0})}addAiStoryAlternativeMaterials(e){return this._mixApplyLocal({action:new a.e(e)},{canUndoRedo:!0})}cloneAiStoryAlternativeMaterials(e){let t=this._videoDocument.getSegmentById(e.fromSegmentId),i=this._videoDocument.getAiStoryAlternativeMaterialBySegmentId(e.fromSegmentId);return t&&(0,M.he)(t)&&(null==i?void 0:i.alternatives)?this._mixApplyLocal({action:new a.e({segmentId:e.toSegmentId,alternatives:i.alternatives.map(e=>e.clone(!0))})},{canUndoRedo:!0}):(0,l.oW)("no need to clone")}deleteAiStoryAlternativeMaterials(e){return this._mixApplyLocal({action:new o.f(e)},{canUndoRedo:!0})}updateAiStoryAlternativeMaterial(e){return this._mixApplyLocal({action:new S(e)},{canUndoRedo:!0})}pinAiStoryAlternativeMaterial(e){let t=this._videoDocument.getAiStoryAlternativeMaterialBySegmentIdAndAlternativeId(e.segmentId,e.alternativeId);return(null==t?void 0:t.pin)===e.pin?(0,l.ly)():this._mixApplyLocal({action:new _(e)},{canUndoRedo:!0})}updateMoveFeedsToAlternative(e){return this._mixApplyLocal({action:new x(e)},{canUndoRedo:!1})}updateStoryId(e){return this._mixApplyLocal({action:new k.T({storyId:e})},{canUndoRedo:!1})}innerReplace(e){let t=this._videoDocument.getDraftMetadata().id,i=this._mixApplyLocal({action:new T({draftId:t,...e})},{canUndoRedo:!1,clearRedoStack:!1});return C.US.execute({draftId:t,...e}),i}innerReplaceStack(e){let t=this._videoDocument.getDraftMetadata().id;return C.US.execute({draftId:t,...e}),(0,l.oW)("")}_makeFindInnerReplaceExistKey(e,t){return`${e}_${t}`}findInnerReplaceIds(e){if(!e)return[];let t=new Map;for(let{alternatives:i}of this._videoDocument.getAiStoryAllAlternativeMaterials().values())for(let r of i)if(r.submitId===e&&r.aigcHistoryId){let e=this._makeFindInnerReplaceExistKey(r.aigcHistoryId,r.aigcItemId),i=t.get(e);i?!i.model&&(i.model=!0):t.set(e,{aigcHistoryId:r.aigcHistoryId,aigcItemId:r.aigcItemId,taskStatus:r.taskStatus,model:!0})}for(let i of(0,C.vi)(this._behavior._undoredoStack,e)){let e=this._makeFindInnerReplaceExistKey(i.aigcHistoryId,i.aigcItemId),r=t.get(e);r?!r.stack&&(r.stack=!0):t.set(e,{aigcHistoryId:i.aigcHistoryId,aigcItemId:i.aigcItemId,taskStatus:i.taskStatus,stack:!0})}return[...t.values()]}}(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IDeleteAiStoryAlternativeActionOptions?Object:IDeleteAiStoryAlternativeActionOptions]),(0,r.w6)("design:returntype",void 0)],A.prototype,"deleteAiStoryAlternative",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IAddAiStoryAlternativeMaterialsActionOptions?Object:IAddAiStoryAlternativeMaterialsActionOptions]),(0,r.w6)("design:returntype",void 0)],A.prototype,"addAiStoryAlternativeMaterials",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[Object]),(0,r.w6)("design:returntype",void 0)],A.prototype,"cloneAiStoryAlternativeMaterials",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IDeleteAiStoryAlternativeMaterialsActionOptions?Object:IDeleteAiStoryAlternativeMaterialsActionOptions]),(0,r.w6)("design:returntype",void 0)],A.prototype,"deleteAiStoryAlternativeMaterials",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateAiStoryAlternativeMaterialActionOptions?Object:IUpdateAiStoryAlternativeMaterialActionOptions]),(0,r.w6)("design:returntype",void 0)],A.prototype,"updateAiStoryAlternativeMaterial",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IPinAiStoryAlternativeMaterialActionOptions?Object:IPinAiStoryAlternativeMaterialActionOptions]),(0,r.w6)("design:returntype",void 0)],A.prototype,"pinAiStoryAlternativeMaterial",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof IUpdateMoveFeedsToAlternativeActionOptions?Object:IUpdateMoveFeedsToAlternativeActionOptions]),(0,r.w6)("design:returntype",void 0)],A.prototype,"updateMoveFeedsToAlternative",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[String]),(0,r.w6)("design:returntype","undefined"==typeof ILvErrorOr?Object:ILvErrorOr)],A.prototype,"updateStoryId",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],A.prototype,"innerReplace",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",["undefined"==typeof Omit?Object:Omit]),(0,r.w6)("design:returntype",void 0)],A.prototype,"innerReplaceStack",null),(0,r.gn)([(0,p.cM)("storyApi"),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[String]),(0,r.w6)("design:returntype",void 0)],A.prototype,"findInnerReplaceIds",null)},69600:function(e,t,i){i.d(t,{w:function(){return y}});var r=i(423196),n=i(607260),a=i(601463),o=i(457491),s=i(603822),l=i(790820),d=i(784392),c=i(323326),u=i(211561),m=i(481631),h=i(695780),f=i(160849),p=i(690613),g=i(575534);class y extends g.e{templateCombinationAdd(e){let t,i=!1;e.isPlaceHolder&&(i=!0),(0,f.k)(e.subDraftVideoDocument,e.setMutableVideosOptions);let a=this._mixApplyLocal({action:new n.D({...e,isHolder:i},this._videoDocument)},{canUndoRedo:!0});!this._batchContext&&(t=this._behavior.batchStart());let o=[];if(!e.skipSubDraftMutation){var s,l;this._setMutableVideosActions(e),(null!==(l=null===(s=e.originVideoAlgorithmInfo)||void 0===s?void 0:s.video_algorithms)&&void 0!==l?l:[]).forEach(t=>{let i;let{path:n,materialId:a}=t,o=e.subDraftVideoDocument.tracks.find(e=>!!(i=e.segments.find(e=>e.materialId===a))),s=null==o?void 0:o.id,l=null==i?void 0:i.id;if(n&&s&&l){var d;this._mixApplyLocal({action:new r.a({videoAlgorithms:[new u.e_Q({...t,segmentId:l,trackId:s,materialId:null===(d=i.material)||void 0===d?void 0:d.id})]})},{canUndoRedo:!1})}}),e.mute&&o.push(...(0,f.YY)(e.subDraftVideoDocument))}return o.length&&o.forEach(e=>this._mixApplyLocal({action:e},{canUndoRedo:!1})),t&&this._behavior.batchEnd(t,{canUndoRedo:!1}),a}replace(e){var t,i;let n;let{segIds:o,canUndoRedo:s,subDraftVideoDocument:l,templateId:d}=e;!this._batchContext&&(n=this._behavior.batchStart());let c=[];return o.forEach(e=>{let t=this._videoDocument.getSegmentById(e);if(!!t&&!!(0,m.du)(t))c.push(this._mixApplyLocal({action:new a.z({segmentId:e,templateId:d,subDraftPtr:l})}))}),this._setMutableVideosActions(e),(null!==(i=null===(t=e.originVideoAlgorithmInfo)||void 0===t?void 0:t.video_algorithms)&&void 0!==i?i:[]).forEach(t=>{let i;let{path:n,materialId:a}=t,o=e.subDraftVideoDocument.tracks.find(e=>!!(i=e.segments.find(e=>e.materialId===a))),s=null==o?void 0:o.id,l=null==i?void 0:i.id;if(n&&s&&l){var d;this._mixApplyLocal({action:new r.a({videoAlgorithms:[new u.e_Q({...t,segmentId:l,trackId:s,materialId:null===(d=i.material)||void 0===d?void 0:d.id})]})},{canUndoRedo:!1})}}),n&&this._behavior.batchEnd(n,{needRefresh:!0,canUndoRedo:s}),(0,p.oW)(c)}setSize(e){let{segId:t,size:i,canvasRatio:r,draftWidth:n,draftHeight:a}=e;return this._mixApplyLocal({action:new o.q({segmentId:t,size:i,canvasRatio:r,draftWidth:n,draftHeight:a})})}_setMutableVideosActions(e){for(let t of h.Q.getMutableVideosActionOptions(e.setMutableVideosOptions,e.subDraftVideoDocument)){if(!!t)this._mixApplyLocal({action:new s.u({draftId:e.subDraftVideoDocument.getDraftId(),...t.templateReplaceVideoActionOptions})}),this._mixApplyLocal({action:new c.E({draftId:e.subDraftVideoDocument.getDraftId(),...t.cropVideoActionOptions})}),this._mixApplyLocal({action:new l.k({draftId:e.subDraftVideoDocument.getDraftId(),...t.templateSetVideoSpeedActionOptions})}),this._mixApplyLocal({action:new d.c({draftId:e.subDraftVideoDocument.getDraftId(),...t.templateSetVideoVolumeOptions})})}}}},873223:function(e,t,i){i.d(t,{D:function(){return n}});var r,n=((r={})[r.OperateIdNotExist=101]="OperateIdNotExist",r)},307510:function(e,t,i){i.d(t,{Eg:function(){return p},HD:function(){return I},HV:function(){return S},Hj:function(){return T},M6:function(){return f},MQ:function(){return x},TU:function(){return v},Xd:function(){return k},bX:function(){return _},mf:function(){return g},vr:function(){return y},xv:function(){return w}});var r=i(800788),n=i(211561),a=i(438369),o=i(392742),s=i(391889),l=i(283751),d=i(268468),c=i(52386),u=i(722169),m=i(481631),h=i(623490);let f=e=>[o.x.SetDocumentMetadata,o.x.SetDocumentProperty].includes(e.type),p=e=>[o.x.AttachmentInsertMutation,o.x.AttachmentDeleteMutation,o.x.AttachmentUpdateMutation].includes(e.type),g=e=>[o.x.InsertSegment,o.x.DeleteSegment,o.x.UpdateSegment,o.x.MoveSegment].includes(e.type),y=e=>[o.x.InsertTrack,o.x.DeleteTrack,o.x.UpdateTrack,o.x.MoveTrack].includes(e.type);function _(e,t,i){switch(e.type){case o.x.InsertSegment:return[function(e,t,i){let r=i.getTrackIndexById(e.trackId,[]);return{item:{segment:e.segment,segmentType:e.segment.__segment_struct_type,trackIndex:r,path:[]},order:t,type:s.C8.ADD}}(e,t,i)];case o.x.DeleteSegment:return[function(e,t,i){let r=i.getSegmentById(e.segmentId),n=i.getTrackIndexById(e.trackId,[]);return{item:{id:e.segmentId,segmentType:r.__segment_struct_type,trackIndex:n,path:[],segment:r},order:t,type:s.C8.DELETE}}(e,t,i)];case o.x.MoveSegment:return function(e,t,i){let{segmentIds:r,srcTrackIndex:n,desTrackIndex:a,desTargetTimeRanges:o}=e;return r.map((e,r)=>{let l=i.getSegmentById(e),d=(0,m.xX)({trackRenderIndex:a,targetTimerange:o[r],__segment_struct_type:l.__segment_struct_type});return{item:{id:l.id,segmentType:l.__segment_struct_type,segment:d,beforeTargetTimeRange:l.targetTimerange,trackIndex:n},order:t+r,type:s.C8.MOVE}})}(e,t,i);case o.x.UpdateSegment:return[function(e,t,i){let r=i.getSegmentById(e.segmentId),n=i.getTrackIndexById(e.trackId,[]);return{item:{id:e.segmentId,segmentType:r.__segment_struct_type,path:[],segment:e.segmentDelta.clone(),beforeTargetTimeRange:r.targetTimerange.clone(),trackIndex:n},order:t,type:s.C8.UPDATE}}(e,t,i)];default:(0,r.bP)(e,"Error: Not Support MutationType")}}function T(e,t,i){switch(e.type){case o.x.InsertTrack:var n,a;return n=e,a=t,{item:{trackIndex:n.trackIndex,trackId:n.trackProperty.id},type:s.C8.ADD,order:a};case o.x.UpdateTrack:return function(e,t,i){let r=i.getTrackIndexById(e.trackId,[]);return{item:{trackId:e.trackId,trackIndex:r,track:d.C4.deserialize(e.trackDelta)},order:t,type:s.C8.UPDATE}}(e,t,i);case o.x.DeleteTrack:return function(e,t,i){let r=e.draftId&&e.draftId!==i.getDraftId();return{item:{trackIndex:e.trackIndex,trackId:r?"":i.tracks[e.trackIndex].id},type:s.C8.DELETE,order:t}}(e,t,i);case o.x.MoveTrack:(0,r.ss)("Error: Not Support MutationType");default:(0,r.bP)(e,"Error: Not Support MutationType")}}function v(e){let t=[];return e.forEach(e=>{e.type===s.C8.ADD&&t.push(e.item.segment.id),e.type===s.C8.DELETE&&t.push(e.item.id),e.type===s.C8.UPDATE&&t.push(e.item.id),e.type===s.C8.MOVE&&t.push(e.item.id)}),t}function I(e,t){e.forEach(e=>{if(e.type===s.C8.ADD){let{path:i=[]}=e.item,r=t.getVideoDocumentByPath(i).getSegmentById(e.item.segment.id);if(!r)return;e.item.segment=(0,u.clone)(e.item.segment);let n=e.item.segment;e.item.trackIndex=r.trackRenderIndex,n.trackRenderIndex=r.trackRenderIndex,n.targetTimerange=r.targetTimerange.clone(),n.trackAttribute=r.trackAttribute}})}function w(e,t){let i={};for(let t=0;t<e.length;t++){var r;let{item:n}=e[t],a=null!==(r=n.id)&&void 0!==r?r:n.segment.id;!i[a]&&(i[a]=[]),i[a].push(e[t])}let n=Object.values(i).map(e=>(function(e,t){let i=[];for(let r=0;r<e.length;r++)!function(e,t,i){var r,n;if(null===(r=e.item.path)||void 0===r?void 0:r.length){let t=null!==(n=e.item.id)&&void 0!==n?n:e.item.segment.id,r=e.item.path[0];if(!(1===e.item.path.length&&r===t)&&!i.getSegmentById(r))return}if(!t.length||e.type===s.C8.MOVE){t.push(e);return}let a=t[t.length-1];if(a.type===s.C8.ADD){if(e.type===s.C8.DELETE){t.splice(t.length-1,1);return}if(e.type===s.C8.UPDATE){a.item.segment=l.T.merge(a.item.segment,e.item.segment,a.type===s.C8.ADD?(0,m.xX)({__segment_struct_type:a.item.segment.__segment_struct_type}):void 0);}}else if(a.type===s.C8.UPDATE){if(e.type===s.C8.DELETE){t[t.length-1]=e;return}if(e.type===s.C8.UPDATE){a.item.segment=l.T.merge(a.item.segment,e.item.segment);}}else if(a.type===s.C8.DELETE){if(e.type===s.C8.ADD){t.push(e);}}else a.type===s.C8.MOVE&&t.push(e)}(e[r],i,t);return i})(e,t)),a=[];return n.forEach(e=>{a.push(...e)}),a.sort((e,t)=>e.order-t.order),a}function S(e,t,i){let r="";if(r=e.type===s.C8.ADD?e.item.segment.id:e.item.id,e.item.path=t.getSegmentPath(r),!e.item.path.length&&i&&(0,c.u)(i)){let n=(0,c.s)(t,i.draftId);n&&(e.item.path=[n.id,r])}return e}function k(e,t){if(e.item.segmentType!==n.Ocy.SegmentText||!(t!==a.a.Local&&e.item.segment.material))return e;let i=new n.xKN;return i.material=new n.edz,i.material.richTextCommand=null,l.T.merge(e.item.segment,i),e}function x(e){let t=[],i=e.videoDocument.getMainTrack();if(!i||!e[s.u4.SEGMENT].length)return t;let r=e[s.u4.SEGMENT].slice(-1)[0].order;if(e.hasMainTrackSegmentTargetTimeChange)for(let e=h.Z.minMainTrackChangeIndex;e<i.segments.length;e++){let a=new n.NOn,o=new n.zel;o.start=i.segments[e].targetTimerange.start,o.duration=i.segments[e].targetTimerange.duration,a.targetTimerange=o;let l={type:s.C8.UPDATE,order:r+e,item:{id:i.segments[e].id,segment:a,trackIndex:0,segmentType:n.Ocy.SegmentVideo}};t.push(l)}return t}},508355:function(e,t,i){i.d(t,{o:()=>o});var r=i("453463"),n=i("391889");let a=e=>e[n.u4.CONFIG].find(e=>{var t;return null===(t=e.item.metadata)||void 0===t?void 0:t.id}),o=(e,t,i)=>{(0,r.v)(e)&&i.canvasChange.fire(!0),a(e)&&i.draftIdChange.fire(t.getDraftId())}},209747:function(e,t,i){i.d(t,{B:function(){return p}});var r=i(391889),n=i(552261),a=i(436858),o=i(481631),s=i(587892),l=i(800788),d=i(426336),c=i(881337),u=i(602777),m=i(211561),h=i(802195),f=i(930801);class p{get onMutableVideosChanged(){return this._onMutableVideosChanged.event}get onMutableTextsChanged(){return this._onMutableTextsChanged.event}get onMutableAudiosChanged(){return this._onMutableAudiosChanged.event}get onRelationVideoGroupChanged(){return this._onRelationVideoGroupChanged.event}listen(e){e(e=>{if(e.videoDocument)for(let[t,i]of(0,f.gG)(e.videoDocument))this.segmentId2initialSpeed[t]=i;let{actionOperateType:t}=e,i=e[r.u4.SEGMENT],n=e[r.u4.CONFIG],a=new Set;t===c.aWQ.History&&(this._prevDraftId=this._draftView.getDraftId()),n.forEach(e=>{var t,i,r;let{item:n}=e;(null===(t=n.metadata)||void 0===t?void 0:t.id)&&(a.add(null===(i=n.metadata)||void 0===i?void 0:i.id),this._prevDraftId&&(delete this.draftIdToMutableAudios[this._prevDraftId],delete this.draftIdToMutableTexts[this._prevDraftId],delete this.draftIdToMutableVideos[this._prevDraftId],delete this.draftIdToRelationVideoGroup[this._prevDraftId]),this._prevDraftId=null===(r=n.metadata)||void 0===r?void 0:r.id)}),i.filter(e=>{var t,i,n,s,d,c;let{item:u,type:m}=e;if(m===r.C8.UPDATE||m===r.C8.ADD){let e;let{segment:n}=u;e=m===r.C8.ADD?u.segment.id:u.id;let s=this._draftView.getSegmentById(e);if(s&&(0,o.du)(s)&&(n.materialDraft||n.targetTimerange)){let e=null===(t=s.materialDraft)||void 0===t?void 0:t.draft.getDraftId();(0,l.Y2)(e),this._subDraftToParentSegment[e]=s,a.add(e)}else if(u.path&&u.path.length>=2){let e=u.path[0],t=null===(i=this._draftView.getSegmentById(e).materialDraft)||void 0===i?void 0:i.draft.getDraftId();(0,l.Y2)(t),a.add(t)}else a.add(this._draftView.getDraftId())}else if(m===r.C8.DELETE){let{segment:e,id:t}=u,i=this._draftView.getSegmentById(t);if(i&&(0,o.du)(i)){let e=null===(s=i.materialDraft)||void 0===s?void 0:s.draft.getDraftId();delete this._subDraftToParentSegment[null!=e?e:""]}if(u.path&&(null===(n=u.path)||void 0===n?void 0:n.length)>=1&&u.path[0]!==e.id){let e=u.path[0],t=null===(d=this._draftView.getSegmentById(e).materialDraft)||void 0===d?void 0:d.draft.getDraftId();(0,l.Y2)(t),a.add(t)}else{if((0,o.he)(e)&&e.materialDraft){let t=e.materialDraft.draft.getDraftId();delete this.draftIdToMutableVideos[t],delete this.draftIdToMutableAudios[t],delete this.draftIdToMutableTexts[t],delete this.draftIdToRelationVideoGroup[t]}if((0,o.Y9)(e)||(0,o.Ft)(e)){let e="";e=null!==(c=this._draftView.getDraftId())&&void 0!==c?c:"",a.add(e),delete this.draftIdToMutableVideos[e],delete this.draftIdToMutableAudios[e],delete this.draftIdToMutableTexts[e],delete this.draftIdToRelationVideoGroup[e]}}}});let s={},d={},u={},m={};a.forEach(e=>{var t,i,r,n;let a=this.getMutableVideos(e),o=this.getMutableAudios(e),l=this.getMutableTexts(e);if((null===(t=this.draftIdToMutableVideos[e])||void 0===t?void 0:t.length)!==0||0!==a.length){s[e]=a,this.draftIdToMutableVideos[e]=a;let t=this._parseRelationVideoGroup(e,a);(null===(n=this.draftIdToRelationVideoGroup[e])||void 0===n?void 0:n.size)!==t.size&&(m[e]=t,this.draftIdToRelationVideoGroup[e]=t)}((null===(i=this.draftIdToMutableAudios[e])||void 0===i?void 0:i.length)!==0||0!==o.length)&&(d[e]=o,this.draftIdToMutableAudios[e]=o),((null===(r=this.draftIdToMutableTexts[e])||void 0===r?void 0:r.length)!==0||0!==l.length)&&(u[e]=l,this.draftIdToMutableTexts[e]=l)}),Object.keys(s).length>0&&this._onMutableVideosChanged.fire(s,this.draftIdToMutableVideos),Object.keys(d).length>0&&this._onMutableAudiosChanged.fire(d,this.draftIdToMutableAudios),Object.keys(u).length>0&&this._onMutableTextsChanged.fire(u,this.draftIdToMutableTexts),Object.keys(m).length>0&&this._onRelationVideoGroupChanged.fire(m,this.draftIdToRelationVideoGroup)})}fireOnMutableVideosChanged(){this._onMutableVideosChanged.fire({},this.draftIdToMutableVideos)}fireOnMutableAudiosChanged(){this._onMutableAudiosChanged.fire({},this.draftIdToMutableAudios)}reset(){this.draftIdToMutableVideos={},this.draftIdToMutableAudios={},this.draftIdToMutableTexts={},this.draftIdToRelationVideoGroup={},this.maxSpeed=0,this.minSpeed=0}getTemplateCanvasConfig(){return this._draftView.getDraftProperty().canvasConfig}getMutableVideos(e,t){let i=e&&e!==this._draftView.getDraftId()?this._draftView.getDraftById(e):this._draftView,r=this._subDraftToParentSegment[null!=e?e:""];(0,l.Y2)(i,`${e} is not found in draft`);let n=[],a=(0,f.GU)(i);for(let e of a.keys()){let t=this.findMutableVideo(i,a,e);t&&n.push(t)}return(n.sort((e,t)=>e.targetStart<t.targetStart?-1:1),t)?n:this._getValidTimeRangeSegInCombinationSeg(n,r)}getMutableAudios(e,t){let i=e?this._draftView.getDraftById(e):this._draftView,r=this._subDraftToParentSegment[null!=e?e:""];(0,l.Y2)(i,`sub draft id: ${e} don't find in main draft`);let n=[];for(let e of i.getTracksByType(u.pN.TrackTypeAudio))for(let t of e.segments){var a,o,s,d;let e={__segment_struct_type:"SegmentAudio",id:t.material.id,segmentId:t.id,targetStart:t.targetTimerange.start,targetDuration:t.targetTimerange.duration,sourceStart:(null===(a=t.sourceTimerange)||void 0===a?void 0:a.start)?null===(o=t.sourceTimerange)||void 0===o?void 0:o.start:0n,sourceDuration:(null===(s=t.sourceTimerange)||void 0===s?void 0:s.duration)?null===(d=t.sourceTimerange)||void 0===d?void 0:d.duration:0n,materialId:t.material.id,materialName:t.material.name,metaType:t.material.type,path:t.material.path,volume:t.volume,musicId:t.material.musicId,duration:t.material.duration?t.material.duration:0n,sourcePlatform:t.material.sourcePlatform};n.push(e)}return t?n:this._getValidTimeRangeSegInCombinationSeg(n,r)}getMutableTexts(e,t){let i=e?this._draftView.getDraftById(e):this._draftView,r=this._subDraftToParentSegment[null!=e?e:""];(0,l.Y2)(i,`sub draft id: ${e} don't find in main draft`);let n=[],a=(0,f.GU)(i);for(let e of i.getTracksByTypes([u.pN.TrackTypeText,u.pN.TrackTypeSticker]))for(let t of e.segments)if((0,o.Ft)(t)){let e=t.material.id;if(!a.has(e))continue;let i={__segment_struct_type:"SegmentText",...(0,c.iAM)({})};i.id=e,i.segmentId=t.id,i.targetStart=t.targetTimerange.start,i.targetDuration=t.targetTimerange.duration,i.text=t.material.text,i.animations=(0,f.Bh)(t),i.commonKeyframes=(0,f.K4)(t),i.clip=t.clip,n.push(i)}else if((0,o.Q2)(t)){let e=h.y.isNewTextTemplateSegment(t.material);for(let i of t.material.textInfoResources){let r=i.textMaterial,o=r.id;if(!a.has(o))continue;let s={__segment_struct_type:"SegmentText",...(0,c.iAM)({})};s.id=o,s.segmentId=t.id,s.targetStart=t.targetTimerange.start,s.targetDuration=t.targetTimerange.duration,e?s.text=r.text:s.text=r.content,n.push(s)}}return(n.sort((e,t)=>e.targetStart<t.targetStart?-1:1),t)?n:this._getValidTimeRangeSegInCombinationSeg(n,r)}genSetMutableTextsOptions(e,t){let i=t?this._draftView.getDraftById(t):this._draftView;if(!i)return{text:[{updates:[]}],textTemplate:[{updates:[]}],draftId:t};let r=[],n=[];return e.forEach(e=>{let a=null==i?void 0:i.getSegmentById(e.segmentId);if(!!a){if((0,o.Ft)(a)){let n=this._genSetMutableTextDeltasForText(a,e);r.push({...n,draftId:t,segmentId:a.id,trackId:i.getTrackBySegmentId(a.id).id,trackIndex:i.getTrackIndexBySegmentId(a.id)})}else if((0,o.Q2)(a)){let r=this._genSetMutableTextDeltasForTextTemplate(a,e);r&&n.push({...r,draftId:t,segmentId:a.id,trackId:i.getTrackBySegmentId(a.id).id,trackIndex:i.getTrackIndexBySegmentId(a.id)})}}}),{text:[{updates:r}],textTemplate:[{updates:n}],draftId:t}}getSegmentByDraftId(e){return this._subDraftToParentSegment[e]}findMutableVideo(e,t,i){for(let _ of e.getSegmentsByTrackTypes([u.pN.TrackTypeVideo])){var r,n,a,s,l,m,h,g,y;if(!(0,o.he)(_)||i!==_.material.id)continue;let{material:e}=_,T=e.type,v={__segment_struct_type:"SegmentVideo",...(0,c.ndz)({}),visible:_.visible};v.id=i,v.segmentId=_.id,v.clip=_.clip,v.crop=[e.crop.upperLeftX,e.crop.upperLeftY,e.crop.upperRightX,e.crop.upperRightY,e.crop.lowerLeftX,e.crop.lowerLeftY,e.crop.lowerRightX,e.crop.lowerRightY],v.width=e.width,v.height=e.height,v.source=e.source,v.sourcePlatform=e.sourcePlatform,v.materialId=e.materialId,v.materialName=e.materialName,v.path=e.path,v.targetStart=_.targetTimerange.start,v.targetDuration=_.targetTimerange.duration,v.sourceStart=null!==(a=null===(r=_.sourceTimerange)||void 0===r?void 0:r.start)&&void 0!==a?a:0n,v.sourceDuration=null!==(s=null===(n=_.sourceTimerange)||void 0===n?void 0:n.duration)&&void 0!==s?s:0n,v.duration=T===u.cV.MetaTypePhoto?0n:e.duration,v.metaType=T;let I=this._draftView.getTrackNodeBySegmentId(v.segmentId);v.trackIdx=I?I.trackIndex:-1;let w=0,S=!1,k=d.OLp.findKeyframes(_,u.Eu.KFTypeVolume);if(k)for(let e of k.keyframeList){if(null!==e&&0!==e.values.length)S=!0,w=Math.max(e.values[0],w)}!S&&(w=_.volume),v.volume=w;let x=(0,d.MnT)(e);v.gameplay={algorithm:null!==(l=null==x?void 0:x.algorithm)&&void 0!==l?l:"",path:null!==(m=null==x?void 0:x.path)&&void 0!==m?m:"",reshape:null!==(h=null==x?void 0:x.reshape)&&void 0!==h&&h},v.isCartoon=_.cartoon;let b=t.get(i);return v.relationVideoGroup=null!==(g=null==b?void 0:b.relationVideoGroup)&&void 0!==g?g:"",v.coverPath=null!==(y=null==b?void 0:b.coverPath)&&void 0!==y?y:"",v.filled=(0,f.RA)(v.path,p.templateSlotLostVideoHolderPath,v.coverPath),v.streamVideoDidRemoved=!!(e.extraTypeOption&this.kSteamVideoDidRemovedFlag),v.animations=(0,f.Bh)(_),v.transition=(0,f.Sx)(_),v.commonKeyframes=(0,f.K4)(_),v}return null}getMutableById(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._draftView.getDraftId(),i=this.draftIdToMutableVideos[t],r=this.draftIdToMutableAudios[t],n=this.draftIdToMutableTexts[t],a=null==i?void 0:i.find(t=>t.id===e);if(a)return a;let o=null==r?void 0:r.find(t=>t.id===e);return o?o:null==n?void 0:n.find(t=>t.id===e)}getMutableBySegmentId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._draftView.getDraftId(),i=this.draftIdToMutableVideos[t],r=this.draftIdToMutableAudios[t],n=this.draftIdToMutableTexts[t],a=null==i?void 0:i.find(t=>t.segmentId===e);if(a)return a;let o=null==r?void 0:r.find(t=>t.segmentId===e);return o?o:null==n?void 0:n.find(t=>t.segmentId===e)}getMutableVideoIndexById(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._draftView.getDraftId();return null===(t=this.draftIdToMutableVideos[i])||void 0===t?void 0:t.findIndex(t=>t.id===e)}getMutableAudioIndexById(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._draftView.getDraftId();return null===(t=this.draftIdToMutableAudios[i])||void 0===t?void 0:t.findIndex(t=>t.id===e)}getMutableTextIndexById(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._draftView.getDraftId();return null===(t=this.draftIdToMutableTexts[i])||void 0===t?void 0:t.findIndex(t=>t.id===e)}_parseRelationVideoGroup(e,t){let i=new Map;return t.reduce((e,t)=>{let i=t.relationVideoGroup;return i?(e.has(i)?e.get(i).add(t.id):e.set(i,new Set([t.id])),e):e},new Map).forEach((e,t)=>{e.size>1&&i.set(t,e)}),i}_getValidTimeRangeSegInCombinationSeg(e,t){if(!t){let t=this._draftView.getDuration();return e.filter(e=>{let{targetStart:i}=e;return t-i>=n.G8})}return e.filter(e=>{let{targetStart:i,targetDuration:r}=e,{sourceTimerange:{start:a=i,duration:o=r}={}}=t,s=(0,d.edG)([i,i+r],[a,a+o]),l=a+o-i>=n.G8;return s&&l})}_genSetMutableTextDeltasForText(e,t){let i=d.hMI.replaceRichTextContent(e.material.content,t.text),r=new m.xKN,n=new m.edz({content:i,baseContent:i,text:t.text});r.material=n;let a=(0,o.xX)({__segment_struct_type:e.__segment_struct_type});return d.T8X.pick(e,r,a),{segmentDelta:r,sourceSegmentDelta:a}}_genSetMutableTextDeltasForTextTemplate(e,t){let i=e.material.textInfoResources.findIndex(e=>e.textMaterial.id===t.id);if(-1===i)return null;let{textMaterial:r}=e.material.textInfoResources[i],n=h.y.isNewTextTemplate(e.material)?d.hMI.replaceRichTextContent(r.content,t.text):t.text,a=h.y.updateTextTemplateText(e,{segId:e.id,textInfo:{index:i,content:n}});if(!a)return null;let s=(0,o.xX)({__segment_struct_type:e.__segment_struct_type});return d.T8X.pick(e,a,s),{segmentDelta:a,sourceSegmentDelta:s}}constructor(e,t){this._prevDraftId="",this._subDraftToParentSegment={},this.draftIdToMutableVideos={},this.draftIdToMutableAudios={},this.draftIdToMutableTexts={},this.draftIdToRelationVideoGroup={},this.segmentId2initialSpeed={},this.maxSpeed=0,this.minSpeed=0,this.kSteamVideoDidRemovedFlag=-0x80000000,this._onMutableVideosChanged=new s.Q,this._onMutableAudiosChanged=new s.Q,this._onMutableTextsChanged=new s.Q,this._onRelationVideoGroupChanged=new s.Q,this._draftView=e,this.listen(t)}}p.templateSlotLostVideoHolderPath=a.v6},134429:function(e,t,i){i.d(t,{$U:function(){return s},Mr:function(){return o},f4:function(){return l}});var r=i(159845),n=i(862024),a=i(89172);let o="undefined"!=typeof LYRA_DRAFT_VERSION?LYRA_DRAFT_VERSION:a.lr,s="undefined"!=typeof LYRA_APP_VERSION?LYRA_APP_VERSION:r.Hv.b2,l="undefined"!=typeof LYRA_SDK_VERSION?LYRA_APP_VERSION:n.VE;r.Hv.NO},436858:function(e,t,i){i.d(t,{AA:function(){return m},Fx:function(){return p},OR:function(){return c},P5:function(){return d},VQ:function(){return y},Yz:function(){return l},g4:function(){return f},gy:function(){return s},ks:function(){return h},oU:function(){return g},qm:function(){return o},v6:function(){return u}});var r=i(340294),n=i(234075),a=i.n(n);let o=r.P4.ensureRootPath("/editor");a().join(o,"font");let s=a().join(o,"effect"),l=a().join(o,"model"),d=a().join(o,"builtin_font"),c=a().join(o,"areaLocked"),u=`${o}/assets/default-sprite.jpg`,m=864,h=486,f=1080,p="template.json",g="attachment_video_algorithm.json",y="cover.jpg"},881337:function(e,t,i){i.d(t,{OTo:()=>E.O,u3w:()=>z.u,yCo:()=>F,mFk:()=>c,lFK:()=>G.lF,GSF:()=>v.G,Sz3:()=>_,TIP:()=>I.T,Mvo:()=>N.M,v$N:()=>w,jT7:()=>a,QZ7:()=>p.Q,Q2f:()=>y.Q,aWQ:()=>G.aW,d3H:()=>G.d3,a0p:()=>r.a,IgE:()=>O.I,cjd:()=>k.c,vSN:()=>m.v,cE6:()=>d,fSd:()=>V.f,chi:()=>W.c,IOn:()=>L.I,znm:()=>U.z,FLl:()=>H,nOc:()=>$,o46:()=>Z.o,Ljr:()=>j.L,kvz:()=>X.k,iAM:()=>R.i,ndz:()=>B.n,FeB:()=>K.F,CTM:()=>T.C,ABm:()=>u,BZR:()=>h,ZoZ:()=>l.Z,hK6:()=>x.h,bJb:()=>M,nV7:()=>g.n,cBb:()=>s,Gh5:()=>C,F3_:()=>S.F,U_g:()=>b.U,aMe:()=>A,WSD:()=>P.W,zy4:()=>D.z,xrB:()=>o,mpE:()=>f.m}),i("703193"),i("786869"),i("324993"),i("196615"),i("432023"),i("221972"),i("25000");var r=i("558254");i("580420"),i("410013"),i("566590"),i("654508"),i("197013"),i("276117");var n=i("602777");function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{containerWidth:void 0!==e.containerWidth?e.containerWidth:0,containerHeight:void 0!==e.containerHeight?e.containerHeight:0,customWidth:void 0!==e.customWidth?e.customWidth:0,customHeight:void 0!==e.customHeight?e.customHeight:0,ratio:void 0!==e.ratio?e.ratio:n.rx.CanvasRatioOriginal,minSize:void 0!==e.minSize?e.minSize:1080,maxSize:void 0!==e.maxSize?e.maxSize:1920,domWidth:void 0!==e.domWidth?e.domWidth:0,domHeight:void 0!==e.domHeight?e.domHeight:0}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{start:void 0!==e.start?BigInt(e.start):0n,duration:void 0!==e.duration?BigInt(e.duration):0n}}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{width:void 0!==e.width?e.width:0,height:void 0!==e.height?e.height:0}}var l=i("983452");function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{scaleX:void 0!==e.scaleX?e.scaleX:1,scaleY:void 0!==e.scaleY?e.scaleY:1,transformX:void 0!==e.transformX?e.transformX:0,transformY:void 0!==e.transformY?e.transformY:0,rotation:void 0!==e.rotation?e.rotation:0,flipVertical:void 0!==e.flipVertical&&e.flipVertical,flipHorizontal:void 0!==e.flipHorizontal&&e.flipHorizontal,limitWidthScale:void 0!==e.limitWidthScale?e.limitWidthScale:1,limitHeightScale:void 0!==e.limitHeightScale?e.limitHeightScale:1}}function c(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segId:void 0!==t.segId?t.segId:"",clipType:void 0!==t.clipType?t.clipType:n.ZX.ClipStart,clipTime:void 0!==t.clipTime?BigInt(t.clipTime):0n,record:void 0!==t.record&&t.record,isSpreadForCut:void 0!==t.isSpreadForCut&&t.isSpreadForCut,curveSpeedPoints:(null!==(e=null==t?void 0:t.curveSpeedPoints)&&void 0!==e?e:[]).map(e=>(0,l.Z)(e)),autoAdjustTts:void 0!==t.autoAdjustTts&&t.autoAdjustTts,forceResolveTrackConflicts:void 0!==t.forceResolveTrackConflicts&&t.forceResolveTrackConflicts}}function u(){var e,t,i;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{effectId:void 0!==r.effectId?r.effectId:"",resId:void 0!==r.resId?r.resId:"",thirdResourceId:void 0!==r.thirdResourceId?r.thirdResourceId:"",name:void 0!==r.name?r.name:"",type:void 0!==r.type?r.type:n.cV.MetaTypeNone,subType:void 0!==r.subType?r.subType:n.De.MetaSubTypeNone,path:void 0!==r.path?r.path:"",value:void 0!==r.value?r.value:0,categoryId:void 0!==r.categoryId?r.categoryId:"",categoryName:void 0!==r.categoryName?r.categoryName:"",platform:void 0!==r.platform?r.platform:"all",version:void 0!==r.version?r.version:"",sourcePlatform:void 0!==r.sourcePlatform?r.sourcePlatform:n.nj.EffectPlatformLoki,adjustParams:(null!==(e=null==r?void 0:r.adjustParams)&&void 0!==e?e:[]).map(e=>(0,y.Q)(e)),hslParams:void 0!==r.hslParams?h(r.hslParams):h({}),formulaId:void 0!==r.formulaId?r.formulaId:"",enableSkinToneCorrection:void 0!==r.enableSkinToneCorrection&&r.enableSkinToneCorrection,colorCurvesParams:void 0!==r.colorCurvesParams?(0,T.C)(r.colorCurvesParams):(0,T.C)({}),colorWheelsParam:void 0!==r.colorWheelsParam?(0,v.G)(r.colorWheelsParam):(0,v.G)({}),algorithmArtifactPath:void 0!==r.algorithmArtifactPath?r.algorithmArtifactPath:"",intensityKey:void 0!==r.intensityKey?r.intensityKey:"",faceAdjustParams:(null!==(t=null==r?void 0:r.faceAdjustParams)&&void 0!==t?t:[]).map(e=>(0,g.n)(e)),exclusionGroup:(null!==(i=null==r?void 0:r.exclusionGroup)&&void 0!==i?i:[]).map(e=>e),panelId:void 0!==r.panelId?r.panelId:"",bloomActionParams:void 0!==r.bloomActionParams?(0,m.v)(r.bloomActionParams):(0,m.v)({}),requestId:void 0!==r.requestId?r.requestId:""}}var m=i("1925");function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{hslColorType:void 0!==e.hslColorType?e.hslColorType:0,hue:void 0!==e.hue?e.hue:0,saturation:void 0!==e.saturation?e.saturation:0,lightness:void 0!==e.lightness?e.lightness:0,interacting:void 0!==e.interacting&&e.interacting,path:void 0!==e.path?e.path:"",visible:void 0===e.visible||e.visible}}i("949434"),i("215920"),i("41253");var f=i("832248");i("381197"),i("81564");var p=i("83822"),g=i("862777"),y=i("888656");function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{anchor:void 0!==e.anchor?(0,l.Z)(e.anchor):(0,l.Z)({}),leftControl:void 0!==e.leftControl?(0,l.Z)(e.leftControl):(0,l.Z)({}),rightControl:void 0!==e.rightControl?(0,l.Z)(e.rightControl):(0,l.Z)({})}}i("705482"),i("524335"),i("594978");var T=i("872630");i("882851"),i("411920");var v=i("806975");i("859435"),i("807316"),i("402025");var I=i("987635");function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segId:void 0!==e.segId?e.segId:"",keyframeType:void 0!==e.keyframeType?e.keyframeType:"",dataParam:void 0!==e.dataParam?(0,I.T)(e.dataParam):(0,I.T)({})}}i("759286"),i("139081"),i("344730"),i("347830"),i("788775"),i("995619"),i("128950"),i("576451"),i("368306"),i("191882"),i("434394"),i("116375"),i("208759"),i("164191"),i("937910");var S=i("322646");i("508166"),i("39802"),i("186655"),i("584413"),i("747550"),i("523462"),i("955285"),i("331161"),i("556990"),i("826917"),i("998955");var k=i("150412"),x=i("596506"),b=i("467955");function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:void 0!==e.id?e.id:"",resourceId:void 0!==e.resourceId?e.resourceId:"",categoryId:void 0!==e.categoryId?e.categoryId:"",categoryName:void 0!==e.categoryName?e.categoryName:"",path:void 0!==e.path?e.path:"",effectId:void 0!==e.effectId?e.effectId:"",title:void 0!==e.title?e.title:"",panel:void 0!==e.panel?e.panel:"",sourcePlatform:void 0!==e.sourcePlatform?e.sourcePlatform:n.nj.EffectPlatformLoki}}function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{categoryId:void 0!==e.categoryId?e.categoryId:"",categoryName:void 0!==e.categoryName?e.categoryName:"",name:void 0!==e.name?e.name:"",path:void 0!==e.path?e.path:"",resourceId:void 0!==e.resourceId?e.resourceId:"",stickerId:void 0!==e.stickerId?e.stickerId:"",unicode:void 0!==e.unicode?e.unicode:"",iconUrl:void 0!==e.iconUrl?e.iconUrl:"",previewCoverUrl:void 0!==e.previewCoverUrl?e.previewCoverUrl:"",platform:void 0!==e.platform?e.platform:"all",sourcePlatform:void 0!==e.sourcePlatform?e.sourcePlatform:n.nj.EffectPlatformLoki,formulaId:void 0!==e.formulaId?e.formulaId:"",teamId:void 0!==e.teamId?e.teamId:"",requestId:void 0!==e.requestId?e.requestId:""}}function A(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segId:void 0!==t.segId?t.segId:"",material:void 0!==t.material?(0,b.U)(t.material):(0,b.U)({}),clip:void 0!==t.clip?d(t.clip):d({}),timeRange:void 0!==t.timeRange?o(t.timeRange):o({}),animations:(null!==(e=null==t?void 0:t.animations)&&void 0!==e?e:[]).map(e=>(0,k.c)(e)),textEffect:void 0!==t.textEffect?u(t.textEffect):u({}),shapeEffect:void 0!==t.shapeEffect?u(t.shapeEffect):u({}),bloomMaterial:void 0!==t.bloomMaterial?u(t.bloomMaterial):u({}),textPresetResourceId:void 0!==t.textPresetResourceId?t.textPresetResourceId:"",relevanceSegment:void 0!==t.relevanceSegment?t.relevanceSegment:""}}i("564914"),i("159981"),i("771111"),i("13057");var E=i("306166");function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{segId:void 0!==e.segId?e.segId:"",textInfo:void 0!==e.textInfo?(0,D.z)(e.textInfo):(0,D.z)({})}}i("574999"),i("923938"),i("379742"),i("213688"),i("608020"),i("948729"),i("100516"),i("93738"),i("85716"),i("592261"),i("713754"),i("119280");var P=i("636093"),D=i("189217"),z=i("380976");i("727971"),i("324890");var N=i("452586"),V=i("567470"),O=i("127485");i("414144"),i("814812"),i("847148"),i("171205"),i("338673"),i("770898"),i("944999"),i("380227"),i("890625"),i("833094"),i("27120"),i("188744"),i("358878"),i("59742"),i("620327"),i("949981"),i("569385"),i("211561"),i("621030"),i("789504"),i("629543"),i("456955"),i("27059"),i("106347"),i("320251"),i("181078"),i("583303"),i("629005"),i("796543");var R=i("552736");function H(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{algorithm:void 0!==e.algorithm?e.algorithm:"",path:void 0!==e.path?e.path:"",reshape:void 0!==e.reshape&&e.reshape}}var B=i("467144");i("305350");var K=i("515605"),j=i("808450"),X=i("788453"),L=i("384374"),W=i("822318"),U=i("159638");function $(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:void 0!==t.id?t.id:"",resourceId:void 0!==t.resourceId?t.resourceId:"",resourceName:void 0!==t.resourceName?t.resourceName:"",graphPoints:(null!==(e=null==t?void 0:t.graphPoints)&&void 0!==e?e:[]).map(e=>(0,Z.o)(e))}}var Z=i("334092"),G=i("862213")},768883:function(e,t,i){i.d(t,{B:function(){return a}});var r=i(288907),n=i(300741);class a{createAttachmentControl(e){if(e===r.JF.AttachmentVideoAlgorithm)return new r.Pu;if(e===r.JF.AttachmentAiWriter)return new r.C5;if(e===r.JF.AttachmentAiCreator)return new n.H;else if(e===r.JF.AttachmentAiStory)return new r.PV;else throw Error(`unknown attachment name: ${e}`)}}},211434:function(e,t,i){i.d(t,{P:function(){return s}});var r=i(587892),n=i(331509),a=i(354101),o=i(265418);class s extends a.X{getDraftStr(e){return e.getAttachmentAiStoryStr()}getFileName(){return o.J.AttachmentAiStory}getJsonKey(){return""}draftDidUpdate(e,t){let{attachment:i=[]}=t;for(let e of i)switch(e.item.attachmentKey){case n.d3.AiStoryAlternativeMaterial:case n.d3.AiStoryGlobalId:case n.d3.AiStoryMeta:this._onChange.fire()}}constructor(){super(),this._onChange=new r.Q,this.onChange=this._onChange.event,this.setListenDraftUpdate(!0)}}s.controlName="aiStoryAttachmentControl"},812218:function(e,t,i){i.d(t,{C:function(){return s}});var r=i(587892),n=i(354101),a=i(211561),o=i(331509);class s extends n.X{getDraftStr(e){return e.getAttachmentAiWriterStr()}getHasListenDraftUpdate(){return!0}setDraftSegment(e,t){t.draftView.getAiWriterInfo(e.segmentId)?t.api.attachment.updateAiWriterInfo({segmentId:e.segmentId,aiWriterType:e.aiWriterType}):t.api.attachment.insertAiWriterInfos({aiWriterInfos:[e]})}getSegmentAiWriterType(e,t){let i=t.draftView.getAiWriterInfo(e);if(i)return i.aiWriterType}getSegmentAiTextType(e,t){let i=this.getSegmentAiWriterType(e,t);return[a.TUZ.GenerateText,a.TUZ.GenerateTitle].includes(i)?"generate_text":[a.TUZ.Shorter,a.TUZ.Longer,a.TUZ.Rewrite].includes(i)?"rewrite_text":"unprocessed"}draftDidUpdate(e,t){let{attachment:i=[]}=t;for(let e of i)if(e.item.attachmentKey===o.d3.AiWriter){this._onChange.fire();break}}constructor(...e){super(...e),this._onChange=new r.Q,this.onChange=this._onChange.event}}},722955:function(e,t,i){i.d(t,{Y:function(){return function e(t){var i,a,o,s,l,d,c,u,m,h,f,p;let g={},y={},_={},{materials:T,tracks:v}=t;if(!T)return g;if(v){for(let e of v)if("video"===e.type)for(let t of e.segments)t.material_id&&Array.isArray(t.extra_material_refs)&&(y[t.material_id]=t.extra_material_refs),t.material_id&&t.speed>=4&&(_[t.material_id]=!0);else if("audio"===e.type)for(let t of e.segments)t.material_id&&Array.isArray(t.extra_material_refs)&&(y[t.material_id]=t.extra_material_refs)}let{videos:I,audios:w,images:S,canvases:k,video_trackings:x,digital_humans:b,beats:M,audio_effects:C,vocal_beautifys:A,vocal_separations:E}=T,F={};if(Array.isArray(C))for(let e of C)F[e.id]=e;let P={};if(Array.isArray(k))for(let e of k)P[e.id]=e;let D={};if(Array.isArray(b))for(let e of b)D[e.id]=e;let z={};if(Array.isArray(A))for(let e of A)z[e.id]=e;let N={};if(Array.isArray(E))for(let e of E)N[e.id]=e;if(Array.isArray(I))for(let e of I){let{id:t,video_algorithm:u}=e,{matting:m}=e,{stable:h}=e,{object_locked:f}=e,p=[],T=null!==(i=y[t])&&void 0!==i?i:[],v="";for(let t of T){let i=null!==(o=F[t])&&void 0!==o?o:null;i&&i.sub_type===r.xbm.AudioEffectTypeVCVoiceChange&&p.push({node:i,key_production_path:"production_path"});let n=null!==(s=P[t])&&void 0!==s?s:null;n&&n.type===r.cVg.MetaTypeCanvasImage&&!n.image_id&&p.push({node:n,key_canvas_image_path:"image"});let u=null!==(l=D[t])&&void 0!==l?l:null;(null==u?void 0:null===(a=u.video_meta)||void 0===a?void 0:a.path)&&(v="digital-human"),u&&m.path&&p.push({node:u,key_is_rendered_digital_human:"type"});let h=null!==(d=z[t])&&void 0!==d?d:null;h&&h.production_path&&(p.push({node:h,key_vocal_beautify_production_path:"production_path"}),p.push({node:h,key_vocal_beautify_enabled:"enable"}));let f=null!==(c=N[t])&&void 0!==c?c:null;f&&f.production_path&&(p.push({node:f,key_vocal_separation_production_path:"production_path"}),p.push({node:f,key_vocal_separation_enabled:"choice"})),(e.aigc_item_id||e.aigc_history_id)&&(v="local_item")}n({collection:g,node:e,key_path:"path",key_intensifies_audio_path:"intensifies_audio_path",key_reverse_path:"reverse_path",key_reverse_intensifies_path:"reverse_intensifies_path",key_matrix_path:h&&h.stable_level>0?"matrix_path":"",key_ai_matting_path:m?"matting.path":"",key_video_algorithm_path:u?"video_algorithm.path":"",key_object_locked_enabled:f?"enable":"",extra_references:p,id:t,app_id:0,material_id:void 0!==e.material_id?e.material_id:"",meta_type:e.type,source_platform:void 0!==e.source_platform?e.source_platform:r.cvu.MaterialPlatformDefault,support_stream:!_[t],panel:v,original_material_id:e.origin_material_id,source:e.source,ai_matting_flag:m?m.flag:0})}if(Array.isArray(w))for(let e of w){let{id:t}=e,i=[];for(let e of null!==(u=y[t])&&void 0!==u?u:[]){let t=null!==(m=F[e])&&void 0!==m?m:null;t&&t.sub_type===r.xbm.AudioEffectTypeVCVoiceChange&&i.push({node:t,key_production_path:"production_path"});let n=null!==(h=z[e])&&void 0!==h?h:null;n&&n.production_path&&(i.push({node:n,key_vocal_beautify_production_path:"production_path"}),i.push({node:n,key_vocal_beautify_enabled:"enable"}));let a=null!==(f=N[e])&&void 0!==f?f:null;a&&a.production_path&&(i.push({node:a,key_vocal_separation_production_path:"production_path"}),i.push({node:a,key_vocal_separation_enabled:"choice"}))}let a="";e.effect_id&&(a=e.effect_id),e.music_id&&(a=e.music_id),n({collection:g,node:e,key_path:"path",extra_references:i,id:t,app_id:void 0!==e.app_id?e.app_id:0,material_id:a,meta_type:void 0!==e.type?e.type:r.cVg.MetaTypeMusic,source_platform:void 0!==e.source_platform?e.source_platform:r.cvu.MaterialPlatformDefault,support_stream:!0,original_material_id:e.origin_material_id,source:e.source})}if(Array.isArray(S))for(let e of S){let{id:t}=e;n({collection:g,node:e,key_path:"path",id:t,app_id:0,material_id:"",meta_type:r.cVg.MetaTypePhoto,source_platform:void 0!==e.source_platform?e.source_platform:r.cvu.MaterialPlatformDefault,support_stream:!1,original_material_id:e.origin_material_id,source:e.source})}if(Array.isArray(k)){for(let e of k)if(e.type===r.cVg.MetaTypeCanvasImage&&!e.image_id){let{id:t}=e;n({collection:g,node:e,key_path:"image",id:t,app_id:0,material_id:"",meta_type:r.cVg.MetaTypeCanvasImage,source_platform:void 0!==e.source_platform?e.source_platform:r.cvu.MaterialPlatformDefault,support_stream:!1})}}if(Array.isArray(M)){for(let e of M)if(e.ai_beats){let{id:t}=e;n({collection:g,node:e.ai_beats,key_path:"",id:t,app_id:0,material_id:"",meta_type:r.cVg.MetaTypeBeats,source_platform:void 0!==e.source_platform?e.source_platform:r.cvu.MaterialPlatformDefault,support_stream:!1,key_beats_path:"beats_path",key_melody_path:"melody_path",original_material_id:e.origin_material_id,source:e.source})}}if(Array.isArray(x))for(let e of x){let{id:t}=e,i=[],a=[];if(e.trackers&&Array.isArray(e.trackers))for(let t=0;t<e.trackers.length;++t)i.push(`trackers.${t}.data_path`),a.push(null!==(p=e.trackers[t].target_segment_id)&&void 0!==p?p:"");n({collection:g,node:e,key_path:"map_path",key_video_tracking_paths:i,key_melody_path:"result_path",id:t,meta_type:r.cVg.MetaTypeVideoTracking,source_platform:r.cvu.MaterialPlatformDefault,material_id:"",app_id:0,support_stream:!1,tracking_segment_ids:a})}let{drafts:V}=T;if(Array.isArray(V))for(let t of V)!function(e,t){for(let[i,r]of Object.entries(t))e[i]?e[i].references.push(...r.references):e[i]=r}(g,e(t.draft));return g}}});var r=i(211561);function n(e){let{collection:t,node:i,key_path:r,key_cover_path:n="",key_intensifies_audio_path:a="",key_reverse_path:o="",key_reverse_intensifies_path:s="",key_matrix_path:l="",key_ai_matting_path:d="",key_video_algorithm_path:c="",key_video_tracking_paths:u=[],key_beats_path:m="",key_melody_path:h="",key_object_locked_enabled:f="",extra_references:p=[],id:g,meta_type:y,source_platform:_,material_id:T,app_id:v,panel:I,original_material_id:w,source:S,support_stream:k=!1,ai_matting_flag:x,tracking_segment_ids:b=[]}=e;t[g]={references:[{node:i,key_path:r,key_cover_path:n,key_intensifies_audio_path:a,key_reverse_path:o,key_reverse_intensifies_path:s,key_matrix_path:l,key_ai_matting_path:d,key_video_algorithm_path:c,key_video_tracking_paths:u,key_canvas_image_path:"",key_beats_path:m,key_melody_path:h,key_object_locked_enabled:f,key_production_path:"",key_vocal_beautify_production_path:"",key_vocal_beautify_enabled:"",key_vocal_separation_production_path:"",key_vocal_separation_enabled:"",key_is_rendered_digital_human:""},...p],id:g,meta_type:y,source_platform:_,material_id:T,app_id:v,panel:I,original_material_id:w,source:S,support_stream:k,ai_matting_flag:x,tracking_segment_ids:b}}},674120:function(e,t,i){i.d(t,{V:function(){return o}});var r=i(52757),n=i(320271),a=i(211561);class o{collect(e){let t={},i=new Set([r.hO,"fonts","shape-animation"]),{materials:o}=e,s=o.text_templates;if(Array.isArray(s))for(let e of s){let o=e.id,s=e.resource_id,d=0;void 0!==e.source_platform&&(d=e.source_platform);let{type:c}=e;(0,r.LM)(t,e,["effect_id"],"path","","title","",o,s,n.U_.TextTemplate,c,d);let{resources:u,non_text_info_resources:m}=e,h={};if(Array.isArray(u))for(let e of u){let s,{panel:l}=e,d=(0,r.oI)(l);if(d===a.cVg.MetaTypeNone&&!i.has(l))continue;let c=e.resource_id;if(s=e.source_platform?e.source_platform:0,!c){if(l!==n.U_.Fonts)continue;l=n.U_.Integration,s=a.nj7.EffectPlatformLoki}h[c]={panel:l,sourcePlatform:s},(0,r.LM)(t,e,["effect_id"],"path","","","",o,c,l,d,s)}if(Array.isArray(m))for(let e of m){if(!e.animate_material_info)continue;let{animations:i}=e.animate_material_info;if(!!Array.isArray(i))for(let e of i){var l;let i=null!==(l=e.resource_id)&&void 0!==l?l:"",n=h[i];if(!!n)(0,r.LM)(t,e,[],"path","","name","",o,i,n.panel,(0,r.oI)(n.panel),n.sourcePlatform)}}}return t}}},643293:function(e,t,i){i(722169),i(211561)},44991:function(e,t,i){i.d(t,{f:function(){return a}});var r=i(722169);function n(e,t,i,n,a,o){if(!!n.node&&!!n[a]){if(Array.isArray(n[a]));else if((0,r.get)(n.node,n[a])){var s;let l=(0,r.get)(n.node,n[a]),d=(null===(s=t[e])||void 0===s?void 0:s[o])||l;d=i[d]||d,(0,r.set)(n.node,n[a],d)}}}function a(e,t,i){for(let[,r]of Object.entries(i))for(let i of r.references)n(r.id,e,t,i,"key_path","path"),n(r.id,e,t,i,"key_reverse_path","reverse_path"),!function(e,t,i,r){var n,a;if(!r.node)return;let o=null===(n=r.node.matting)||void 0===n?void 0:n.path;if(o){let n=(null===(a=t[e])||void 0===a?void 0:a.ai_matting_path)||o;n=n.split(";").map(e=>i[e]?i[e]:!e.startsWith("/")&&i[`/${e}`]?i[`/${e}`]:e).join(";"),r.node.matting.path=n}}(r.id,e,t,i),n(r.id,e,t,i,"key_beats_path","beats_path")}},488890:function(e,t,i){i.d(t,{cw:function(){return o},rt:function(){return s},y_:function(){return a}});var r=i(234075),n=i(211561);function a(e){return/\.\w+$/.test(e)}function o(e,t){let i=[],n=0;if(t.isDir(e))for(let a of t.readdirSync(e)){if(a.startsWith(".")||a.startsWith("..")||!t.isFile(r.join(e,a)))continue;let o=r.extname(a);if((o=(o=o.replace(/^\./,"")).toLowerCase()).length!==a.length&&!!o){if(["ttf","otf"].includes(o)){let t=r.join(e,a);i.push(t),"zh-hans.ttf"===a&&(n=i.length-1)}}}return{fontPaths:i,index:n}}function s(e,t,i,s){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];for(let[l,d]of Object.entries(e))for(let e of d.references)if(t[l]){let i=function(e,t,i,s){let{meta_type:l,panel:d}=e;if(!(l===n.cVg.MetaTypeText||l===n.cVg.MetaTypeSticker||l===n.cVg.MetaTypeSubtitle||l===n.cVg.MetaTypeLyrics||l===n.cVg.MetaTypeTextTemplate&&"fonts"===d))return i;if(!s){if(!((l===n.cVg.MetaTypeText||l===n.cVg.MetaTypeSubtitle||l===n.cVg.MetaTypeLyrics)&&a(t))||a(i))return i;{let e=r.basename(t);return r.join(i,e)}}let{fontPaths:c,index:u}=o(i,s);if(c.length>=1)return c[u];if(!((l===n.cVg.MetaTypeText||l===n.cVg.MetaTypeSubtitle||l===n.cVg.MetaTypeLyrics)&&a(t))||a(i))return i;{let e=r.basename(t);return r.join(i,e)}}(d,e.node[e.key_path],t[l],s);e.node[e.key_path]=i}else(null==i?void 0:i[e.node[e.key_path]])&&(e.node[e.key_path]=i[e.node[e.key_path]],e.key_resource_id&&e.node[e.key_resource_id]&&(e.node[e.key_resource_id]=""));for(let{relativePath:e,reference:t,effect:i}of l)i.path=`${t.path}${e}`}},47497:function(e,t,i){i.d(t,{C:function(){return a}});var r=i(340294),n=i(49667);function a(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e,{config:o}=e,{subtitle_keywords_config:s}=o;if(!(null==s?void 0:s.styles))return;let l=e=>{for(let r of t){var i;if(!Array.isArray(null==r?void 0:null===(i=r.node)||void 0===i?void 0:i.fonts))continue;let t=r.node.fonts.find(t=>t.resource_id===e);if(t)return t.path}},d=e=>{let t=i.find(t=>t.node.resource_id===e);return null==t?void 0:t.node.path},c=(0,r.$F)(s.styles);c.styles.forEach(e=>{if(e.font){if(n.NG.has(e.font.id))e.font=void 0;else{let t=l(e.font.id);t&&(e.font.path=a(t))}}if(e.effectStyle){let t=d(e.effectStyle.id);t&&(e.effectStyle.path=a(t))}});let u=JSON.stringify(c);s.styles=u}},848701:function(e,t,i){i.d(t,{U:function(){return l}});var r=i(234075),n=i(211561),a=i(879566),o=i(488890),s=i(340294);function l(e,t,i){for(let c of e){var l,d;let e=[];(null==c?void 0:null===(l=c.node)||void 0===l?void 0:l.fonts)&&Array.isArray(null==c?void 0:null===(d=c.node)||void 0===d?void 0:d.fonts)&&e.push(...c.node.fonts);let u={resource_id:c.node.font_resource_id,category_id:c.node.font_category_id,category_name:c.node.font_category_name,source_platform:c.node.font_source_platform,path:c.node.font_path,effect_id:c.node.font_id,title:c.node.font_title};e.push(u);let m=c.node.base_content||c.node.content,{fontIdPathsOut:h,effectIdPathsOut:f}=a.hM.getAllFontAndEffectIdsFromText(m),p=(0,s.$F)(m),g="";if(p.styles.length>0){let a="";for(let t of h){let n=!1;for(let i of e){if(t.id&&i.resource_id===t.id){p.styles.forEach(e=>{e.font&&(e.font.id&&e.font.id===t.id||e.font.path===t.path)&&(t.path===c.node.font_path&&(a=i.path),e.font.path=i.path)}),n=!0;break}!t.id&&t.path&&t.path===i.path&&i.resource_id&&(p.styles.forEach(e=>{e.font&&!e.font.id&&e.font.path===t.path&&(t.path===c.node.font_path&&(a=i.path),e.font.id=i.resource_id)}),n=!0)}if(!n&&i[t.id]&&(0,o.y_)(t.path)){let e=i[t.id],n=r.basename(t.path),o=r.join(e,n);p.styles.forEach(e=>{e.font&&e.font.path===t.path&&(t.path===c.node.font_path&&(a=o),e.font.path=o)})}}let s=[];if(f.length&&!s.length)for(let e of t){let{node:t}=e;if(t.type!==n.cVg.MetaTypeTextEffect)continue;let i=[t.resource_id,t.path];s.push(i)}for(let e of f)for(let[t,i]of s)e.id&&t===e.id&&p.styles.forEach(t=>{t.effectStyle&&(e.path&&t.effectStyle.path===e.path||t.effectStyle.id===e.id)&&(t.effectStyle.path=i)});a&&(c.node.font_path=a),g=JSON.stringify(p)}else g=p.text;c.node.base_content?c.node.base_content=g:c.node.content=g}}},146514:function(e,t,i){i.d(t,{Cg:function(){return n.Cg},GE:function(){return r.GE},Sy:function(){return n.Sy},UI:function(){return n.UI},Y_:function(){return r.Y_},cw:function(){return n.cw},fG:function(){return n.fG},rt:function(){return n.rt},sU:function(){return r.sU}});var r=i(475298),n=i(830187)},626956:function(e,t,i){i.d(t,{h:function(){return a},j:function(){return n}});var r=i(83293);let n=r.I;class a extends r.o{constructor(e){super(),this.tasks=[],this.tasks=e}}},108616:function(e,t,i){i.d(t,{I:function(){return s},m:function(){return l}});var r,n=i(690613),a=i(987733),o=i(283395);var s=((r={}).Upgrade="upgrade",r.Downgrade="downgrade",r);class l{migrate(){var e,t;let i=this._getSourceVersion();if(!i.ok)return i;let r=this._getFirstTaskIndex();if(-1===r)return(null===(t=this._listener)||void 0===t?void 0:t.needExtraMigrate())&&this._listener.taskFinishedMigrate(this._json,(0,a.kA)(this._json),!0),(0,n.oW)(this._json);let o=this._json;for(let e=r;e<this._tasks.length;e++){let t=this._migrateByTask(this._tasks[e],o);if(!t.ok)return t;o=t.value}return null===(e=this._listener)||void 0===e||e.taskFinishedMigrate(o,(0,a.kA)(this._json),!1),(0,n.oW)(o)}_getSourceVersion(){let e=(0,a.UC)(this._json);return e>0?(0,n.oW)(e):(0,n.wf)(o.D.kJsonVersionEmpty,"draft version is not valid")}_getFirstTaskIndex(){let e=this._getSourceVersion();if(!e.ok)return -1;for(let t=0;t<this._tasks.length;t++)if(this._needMigrateByVersion(e.value,this._tasks[t].getNumberVersion()))return t;return -1}_needMigrateByVersion(e,t){return"upgrade"===this._type?e<t:e>t}_migrateByTask(e,t){if(this._listener){let i=this._listener.taskBeforeMigrate(t,e.getStringVersion());if(!i.ok)return i}let i=e.migrate(t);if(this._listener){let i=this._listener.taskAfterMigrate(t,e.getStringVersion());if(!i.ok)return i}return i}constructor(e){this._type=e.type,this._json=e.json,this._listener=e.listener,this._tasks=e.tasks}}},179153:function(e,t,i){i.d(t,{P:()=>eX});var r=i("565866"),n=i("108616"),a=i("690613");class o{needExtraMigrate(){for(let e of this._listeners)if(e.needExtraMigrate())return!0;return!1}_runTasks(e,t,i){let r=(0,a.oW)(e);for(let n of this._listeners)if(!(r=n[i](e,t)).ok)break;return r}taskBeforeMigrate(e,t){return this._runTasks(e,t,"taskBeforeMigrate")}taskAfterMigrate(e,t){return this._runTasks(e,t,"taskAfterMigrate")}taskFinishedMigrate(e,t,i){for(let r of this._listeners)r.taskFinishedMigrate(e,t,i)}constructor(e){this._listeners=[],this._listeners=e}}var s=i("899065"),l=i("495423"),d=i("602777"),c=i("341360"),u=i("283395");class m extends c.k{migrateInner(e){if(!("materials"in e))return(0,a.wf)(u.D.kDeserializeJsonFailed,"no materials in json");let{effects:t}=e.materials;for(let e of t)"beauty"===e.type?(e.type=d.cV.MetaTypeFigure,e.resource_id="6976822940608238093"):"reshape"===e.type?(e.type=d.cV.MetaTypeFigure,e.resource_id="6976823053212717576"):"stretch_leg"===e.type&&(e.type=d.cV.MetaTypeFigure);return(0,a.oW)(e)}constructor(...e){super(...e),this.version="32.0.0"}}class h extends c.k{migrateInner(e){if(!("keyframes"in e))return(0,a.oW)(e);let t=e.keyframes;if(!t.videos)return(0,a.oW)(e);for(let e of t.videos)e.flags&&(e.flags=BigInt(e.flags)|BigInt(d.n1.VKFFCommonMaskPosition));return(0,a.oW)(e)}constructor(...e){super(...e),this.version="33.0.0"}}var f=i("744581"),p=i("340294");class g extends c.k{migrateInner(e,t){let i=[],r=[];if(e&&(0,p.Fz)(e.materials)){let{materials:t}=e;if(t.effects&&Array.isArray(t.effects)&&(!t.video_effects||0===t.video_effects.length)){let{effects:e}=t;for(let t=0;t<e.length;t++){let n=e[t];if(!n.type)continue;let a=n.type;a===d.cV.MetaTypeVideoEffect||a===d.cV.MetaTypeFaceEffect?i.push(n):r.push(n)}t.effects=r,t.video_effects=i}e.materials=t}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="35.0.0"}}var y=i("502186");class _ extends c.k{migrateInner(e,t){return _.fillDraftDuration(e),_.fillVideoMaterialDuration(e,t),(0,a.oW)(e)}static fillDraftDuration(e){if(!("tracks"in e)||!Array.isArray(e.tracks))return;let t=e.tracks,i=0;"duration"in e&&(i=e.duration),t.forEach(e=>{let{segments:t}=e;if(!Array.isArray(t))return;let r=t[t.length-1];if(!r)return;let n=r.target_timerange,a=n.start,o=n.duration;i=p.pM.max([i,a+o])}),e.duration=i}static fillVideoMaterialDuration(e,t){if(!("materials"in e)||"object"!=typeof e.materials)return;let i=e.materials;"videos"in i&&Array.isArray(i.videos)&&i.videos.forEach(e=>{if(!("type"in e)||!("duration"in e)||!("path"in e))return;let t=d.cV.MetaTypeVideo,i=e.duration;e.path,t===d.cV.MetaTypeVideo})}constructor(...e){super(...e),this.version="35.0.2"}}class T extends c.k{migrateInner(e,t){if("materials"in e&&((0,p.Fz)(e.materials),1)){let i=e.materials;if("audio_effects"in i&&Array.isArray(i.audio_effects)&&i.audio_effects.length>0){let e=i.audio_effects;for(let i=0;i<e.length;){let r=e[i];if(!("type"in r)||!(null==t?void 0:t.resourceIdMapper)){e.splice(i,1);continue}let n=t.resourceIdMapper("voice-change",r.name);if(""!==n){r.resource_id=n;let e="";"path"in r&&"string"==typeof r.path&&r.path,i++}else e.splice(i,1)}}e.materials=i}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="38.0.0"}}var v=i("987733");class I extends c.k{migrateInner(e,t){return this.migrationTo400000Impl(e),(0,a.oW)(e)}migrationTo400000Impl(e){if("materials"in e&&(0,p.Fz)(e.materials)){let t=e.materials;if("texts"in t&&Array.isArray(t.texts)&&t.texts.length>0)for(let e of t.texts){let t=7n;if("check_flag"in e&&(0,v.Je)(e.check_flag)&&(t=BigInt(e.check_flag)),"border_color"in e&&""!==e.border_color&&(t|=d.Pb.BorderFlag),"background_color"in e&&""!==e.background_color&&(t|=d.Pb.FrameFlag),"has_shadow"in e){let i=e.has_shadow;if("boolean"==typeof i)i&&(t|=d.Pb.ShadowFlag);else if("number"==typeof i){let r=i>0;e.has_shadow=r,r&&(t|=d.Pb.ShadowFlag)}}e.check_flag=t}if("stickers"in t&&Array.isArray(t.stickers)&&t.stickers.length>0)for(let e of t.stickers)e.check_flag=d.jR.PosSizeFlag}if("cover"in e){let t=e.cover;if((0,p.Fz)(t)&&"cover_draft"in t){let e=t.cover_draft;(0,p.Fz)(e)&&this.migrationTo400000Impl(e)}}}constructor(...e){super(...e),this.version="40.0.0"}}var w=i("349461"),S=i("763974"),k=i("430133");class x extends c.k{migrateInner(e,t){return(0,a.oW)(e)}constructor(...e){super(...e),this.version="45.0.0"}}var b=i("568155"),M=i("211561"),C=i("287165");function A(e,t,i){return t in e?null===e[t]?i:parseFloat(e[t]):i}class E extends c.k{migrateInner(e,t){var i,r;let n=[];for(let e of this._resourceIds)n.push(e);if(!("materials"in e&&(0,p.Fz)(e.materials)))return(0,a.oW)(e);let o=[],s=e.materials;if("material_animations"in s&&Array.isArray(s.material_animations)){for(let e of s.material_animations)for(let r of e.animations)if(null==t?void 0:null===(i=t.resourceIdMapper)||void 0===i?void 0:i.call(t,"MigrationTo470000_text",r.resource_id)){let e="";"path"in r&&"string"==typeof r.path&&r.path,o.push(r)}}if("effects"in s&&Array.isArray(s.effects)){for(let e of s.effects)if("resource_id"in e&&(null==t?void 0:null===(r=t.resourceIdMapper)||void 0===r?void 0:r.call(t,"MigrationTo470000_text",e.resource_id))){let t=0;"source_platform"in e&&"number"==typeof e.source_platform&&(t=e.source_platform);let i=d.nj.EffectPlatformLoki;0!==t&&d.nj.EffectPlatformArtist;let r="";"path"in e&&"string"==typeof e.path&&e.path,o.push(e)}}return e.materials=s,this.migrationToRichText(e),(0,a.oW)(e)}migrationToRichText(e){if(!e.materials)return;let{materials:t}=e;if(!e.tracks)return;let{tracks:i}=e;if(!t.texts||!t.effects)return;let{texts:r}=t,{effects:n}=t,a=new Set;for(let e of i){if(!["sticker","text","text_to_video_text"].includes(e.type))continue;let{segments:t}=e;for(let e of t){let t=e.material_id,i=r.find(e=>t===e.id);if(!i||a.has(JSON.stringify(t)))continue;a.add(JSON.stringify(t));let o=i.type;if(!("text"===o||"lyrics"===o||"subtitle"===o))continue;let s=i.content||"",l="",c="";if(i.underline&&(l+="<u>",c=`</u>${c}`),"italic_degree"in i&&i.italic_degree>0&&(l+="<i>",c=`</i>${c}`),"font_size"in i){let e=i.font_size;l+=`<size=${e}>`,c=`</size>${c}`}i.bold_width>0&&(l+="<b>",c=`</b>${c}`);let u=1;if("text_color"in i&&"text_alpha"in i){let e=i.text_color||"#FFFFFFFF";u=i.text_alpha,l+=`<color=${this.parseColor(e,i.text_alpha)}>`,c=`</color>${c}`}let m=i.border_color||"";if(""!==m&&"#00000000"!==m){let e=i.border_width,t=-1;"text_alpha"in i&&(t=u),l+=`<outline color=${this.parseColor(m,t)} width=${e}>`,c=`</outline>${c}`}if("has_shadow"in i&&"boolean"==typeof i.has_shadow){let e=i.has_shadow,t=7n;if(!e&&"check_flag"in i&&(0,v.Je)(i.check_flag)&&(t=BigInt(i.check_flag))&d.Pb.ShadowFlag&&(e=!0),e){let e=i.shadow_color||"#00000000",t=A(i,"shadow_alpha",0);"text_alpha"in i&&(t*=u);let r=A(i,"shadow_smoothing",0),n=A(i,"shadow_angle",0),a=i.shadow_point,o=new M._OS;o.x=a.x,o.y=a.y;let s="<shadow color=";s+=this.parseColor(e,t),s+=` offset=(${o.x/18},${o.y/18}) smooth=${r/18} angle=${n}>`,l+=s,c=`</shadow>${c}`}}let h=i.font_id||"",f=i.font_title||"",p=[];if(""!==h||""!==f){let e=i.font_resource_id||"",t=i.font_category_id||"",r=i.font_category_name||"",n=A(i,"font_source_platform",0),a=i.font_path||"";l+=`<font id="${""===e?h:e}" path="${a}">`,c=`</font>${c}`;let o={};o.id=(0,C.p)(),o.effect_id=h,o.resource_id=e,o.category_id=t,o.category_name=r,o.source_platform=n,o.path=a,o.title=f,p.push(o)}i.fonts=p;let g=e.extra_material_refs;if(Array.isArray(g)&&g.length>0)for(let e of g){let t=n.find(t=>e===t.id&&"text_effect"===t.type);if(!t)continue;let i=t.resource_id,{path:r}=t,a="<effectStyle id=";a+=`"${i}" path="${r}">`,l+=a,c=`</effectStyle>${c}`}"use_effect_default_color"in i&&!i.use_effect_default_color&&(l+="<useLetterColor>",c=`</useLetterColor>${c}`);let y=`${l}[${s.replaceAll("]","]]")}]${c}`;i.content=y}}if(t.drafts){let{drafts:e}=t;for(let t of e){if("draft"in t)this.migrationToRichText(t.draft)}}}parseColor(e,t){if(0===e.length&&t>=1)return"(1,1,1,1)";if(0===e.length||e.length<6)return"(0,0,0,0)";let[i,r,n,a]=(0,p.rW)(e),o=a/255;t>=0&&(o=t);let s=`(${(i/255).toString()},`;return s+=`${(r/255).toString()},${(n/255).toString()},${o.toString()})`}constructor(...e){super(...e),this._resourceIds=["6915269706769240583","6779879712261935619","6724916044072227332","6771294855785091588","6763469998330483213","6724921217721045515","6724919499042066958","6763873859402732039","6724920136056181256","6763470111253729803","6724921985282871816","6779084126457696776","6774626830038077960","6771288500240126478","6774625910067827212","6774626192990409224","6775803763652301326","6724920249654710791","6724920636403094028","6724920521462387207","6763470195894784525","6799873891352187406","6835571502050447879","6840689010034086407","6841115718172283406","6845191009861636616","6862897343176380942","6865175746420150792","6869302248103481869","6870061463243854350","6872642542765085191","6872642398095151629","6872642189260755463","6884154692398486023","6887482184844710413","6897084405781631496","6897084292908716557","6917178744775905806","6923094735116571150","6926718978064650760","7028458557058060831","7029231035007111710","7026674824537707038","7021831463867781662","7035902226602136071","7038882772450021896","7043778124760224292","7051512227353858590","7041836555903701540","7054482687297327630","6771294855785091588","6779879836916650509","6724919382104871427","6763469915518145032","6724921351385125387","6724919767200698884","6763873732143354376","6763873533115240968","6724919284893487619","6779084194392838670","6774626748177846791","6774625752794010115","6774626081791021576","6775804032318444045","6763469696260903435","6763469767555682823","6763873602476446221","6724920744431587853","6763469838368117256","6783908820176343566","6799874105710481927","6834511218552607239","6840698265277567496","6862897350478664200","6865176065514410503","6869302139584254477","6870061326698287624","6872642497013617159","6872642354898014728","6872642084977775118","6884154487246688776","6887482090351235592","6897085341811872270","6897085246206906893","6917178803521327630","6923094772907250189","6926719087158497806","7029522072724312612","7026619708627489293","7026617357300666893","7023684709737566728","7023684632591733284","7034717113130422791","7039245189638001183","7042278078415901192","7052633346936934942","7057801223109349925","6764189482871689742","6763900973946507784","6763897586328801805","6724920002958332420","6724919955654971918","6724921437930394120","6724920869363126795","6724921579517514248","6724927688047333891","6790247082155315719","6790246884683289102","6790246693674684942","6799874389669057037","6835878163575214605","6840710593289130503","6857036499389518349","6857714281136263687","6884155832838132231","6908592686781960717","6917143282690560526","6986920909927879199","7045150354672980516","7045155566003425823","7051409132804379149","7052257626897256968","6980916124976157220"],this.version="47.0.0"}}var F=i("488139"),P=i("950355"),D=i("927463");class z extends c.k{migrateInner(e,t){let i=this.mainTrackMuteUpgrade(e,t);return i=this.enableVoiceChangeIfExists(e,t)&&i,(0,a.oW)(e)}mainTrackMuteUpgrade(e,t){if(!("tracks"in e))return!1;let{tracks:i}=e;for(let e of i){var r;if(!("flag"in e&&0===e.flag&&"type"in e&&"video"===e.type))continue;let t=null!==(r=e.attribute)&&void 0!==r?r:Number(d.$S.DefaultFlags);if(e.attribute=t,!("segments"in e))break;for(let i of e.segments)i.track_attribute=t;break}return!0}enableVoiceChangeIfExists(e,t){if(!("tracks"in e)||!("materials"in e))return!1;let i=e.materials,r=new Set;for(let e of i.audio_effects)"id"in e&&r.add(e.id);let n={};for(let e of i.audios)n[e.id]=e;let a={};for(let e of i.videos)a[e.id]=e;for(let t of e.tracks){let e=t.type,i=null,o=0;if("audio"===e)i=n,o=Number(d.sQ.VoiceChangeFlag);else{if("video"!==e)continue;i=a,o=Number(d.FC.AudioVoiceChangeFlag)}for(let e of t.segments){if(!e.extra_material_refs.some(e=>r.has(e))||!(e.material_id in i))continue;let t=i[e.material_id],n=(t.check_flag||0)|o;t.check_flag=n}}if("drafts"in i){let{drafts:e}=i;for(let i of e){if("draft"in i){if(!this.enableVoiceChangeIfExists(i.draft,t))return!1}}}return!0}constructor(...e){super(...e),this.version="53.0.0"}}var N=i("195127"),V=i("289621");let O="auto_beauty",R="none";class H extends c.k{migrateInner(e,t){let i=this.CheckflagUpgrade(e);if(!i.ok)return i;let r=this.autoBeautyUpgrade(e,t);return r.ok?(0,a.oW)(e):r}autoBeautyUpgrade(e,t){if(!("materials"in e)||!("tracks"in e))return(0,a.wf)(u.D.kDeserializeJsonFailed,"no materials or tracks in root");let i=e.materials.effects,r=e.tracks,n=[],o={};for(let e of i){if(!("type"in e)||!("sub_type"in e)||!("resource_id"in e)||"string"!=typeof e.type||"string"!=typeof e.sub_type||"string"!=typeof e.resource_id)continue;let t=e.type,i=e.sub_type,r=e.resource_id;if("beauty"===t?(e.type="figure",t="figure"):"reshape"===t&&(e.type="figure",t="figure"),"figure"!==t||"none"!==i&&""!==i||!(r in this._autoBeautyResourceIdMap))continue;let a="";"path"in e&&"string"==typeof e.path&&e.path,n.push(e)}for(let e of r){if("video"===e.type)for(let t of e.segments){let e=t.material_id,i=t.extra_material_refs;if(!!Array.isArray(i)&&0!==i.length)for(let t of i){let i=n.find(e=>t===e.id);if(!!i)o[i.resource_id]=e}}}return(0,a.ly)()}CheckflagUpgrade(e){let t=e=>{if(!("materials"in e))return;let t=e.materials;if("videos"in t&&Array.isArray(t.videos))for(let e of t.videos){let t=null!==e.check_flag&&void 0!==e.check_flag?e.check_flag:0;t=t|Number(d.FC.VideoBackground)|Number(d.FC.ManualDeformation),e.check_flag=t}};if(t(e),!("materials"in e))return(0,a.wf)(u.D.kDeserializeJsonFailed,"no materials in root");let i=e.materials;if("drafts"in i&&Array.isArray(i.drafts))for(let e of i.drafts)"draft"in e&&t(e.draft);return(0,a.ly)()}constructor(...e){super(...e),this.version="56.0.0",this._autoBeautyResourceIdMap={"6976822940608238093":["6976822940608238093",O],"6976823053212717576":["6976823053212717576",O],"6998408219898941982":["6998408219898941982",O],"7019182024527188481":["7019182024527188481",O],"6998408142216237575":["6998408142216237575",O],"7019182100469256705":["7019182100469256705",O],"6998408303826965006":["6998408303826965006",R],"7019182177380209153":["7019182177380209153",R],"6998408263892996639":["6998408263892996639",O],"7019182285542920706":["7019182285542920706",O]}}}var B=i("710879");class K extends c.k{migrateInner(e,t){let i=this.beautyUpgrade(e,t);return i.ok?(this.migrationVideoAlgorithmPath(e,t),(0,a.oW)(e)):i}beautyUpgrade(e,t){if(!("materials"in e)||!("tracks"in e))return(0,a.wf)(u.D.kDeserializeJsonFailed,"no materials or tracks in root");let i=e.materials,r=i.effects,n=[];if("videos"in i&&Array.isArray(i.videos)){let e=i.videos;for(let t=0;t<e.length;t++){let i=e[t],r="check_flag"in i?i.check_flag:0;r&Number(d.FC.Beauty)&&(i.check_flag=r|Number(d.FC.BeautyReshape))}}0===this.beautyIds.size&&(this.beautyIds=new Set([B.S.kSmoothSkinId,B.S.kBeautyId,B.S.kSkinWhiteningId,B.S.kTeethWhiteningId])),0===this.beautyBodyIds.size&&(this.beautyBodyIds=new Set([B.S.kLongLegsId,B.S.kSmallHeadId,B.S.kSlimWaistId,B.S.kSlimBodyId])),0===this.beautyReshapeIds.size&&(this.beautyReshapeIds=new Set([B.S.kReshapeId,B.S.kBigEyesId,B.S.kSlimNoseId]));for(let e=0;e<r.length;e++){let t=r[e],{type:i}=t,a=t.resource_id;if("figure"!==i)continue;let o=t.category_id;if(this.beautyIds.has(a)&&o!==B.m.kLevel2BeautyCategoryId?t.category_id=B.m.kLevel2BeautyCategoryId:this.beautyBodyIds.has(a)&&o!==B.m.kLevel2BeautyBodyCategoryId?t.category_id=B.m.kLevel2BeautyBodyCategoryId:this.beautyReshapeIds.has(a)&&o!==B.m.kLevel2BeautyReshapeCategoryId&&(t.category_id=B.m.kLevel2BeautyReshapeCategoryId),!(a in this.beautyResourcesIdMap))continue;this.beautyResourcesIdMap[a][0];let s="";"path"in t&&"string"==typeof t.path&&t.path,n.push(t)}return e.materials=i,(0,a.ly)()}migrationVideoAlgorithmPath(e,t){let i=!1;if(!("materials"in e)||!("tracks"in e))return i;let r=e.materials;if(!("videos"in r))return i;let n=e.tracks,a=r.videos;for(let e=0;e<n.length;e++){let t=n[e];if("video"!==t.type)continue;let r=t.segments;for(let e=0;e<r.length;e++){let t=r[e];if(!t.reverse)continue;let n=t.material_id;for(let e=0;e<a.length;e++){let t=a[e];if(n!==t.id)continue;if(!("video_algorithm"in t))break;let r=t.video_algorithm;if(!("reverse_path"in t))break;r.path=r.reverse_path,i=!0;break}}}return i}constructor(...e){super(...e),this.version="57.0.0",this.beautyIds=new Set,this.beautyBodyIds=new Set,this.beautyReshapeIds=new Set,this.beautyResourcesIdMap={"6976823053212717576":["7126765507457323557","face_adjust_TotalFace"]}}}class j extends c.k{migrateInner(e,t){if(!("materials"in e)||!(0,p.Fz)(e.materials))return(0,a.oW)(e);let{materials:i}=e;if(!("videos"in i)||!Array.isArray(i.videos))return(0,a.oW)(e);let{videos:r}=i;for(let e=0;e<r.length;e++){let t=r[e];if(!("video_algorithm"in t)||!(0,p.Fz)(t.video_algorithm))continue;let i=t.video_algorithm;if(!("algorithms"in i)||!Array.isArray(i.algorithms))continue;let n=!1,a={},{algorithms:o}=i;for(let e=0;e<o.length;e++){let t=o[e];if("motion_blur_config"in t&&!!(0,p.Fz)(t.motion_blur_config))"blur"in t.motion_blur_config&&(n=!0,a=t.motion_blur_config)}n&&(i.motion_blur_config=a)}return this.beautyUpgrade(e,t),(0,a.oW)(e)}beautyUpgrade(e,t){if(!("tracks"in e)||!("materials"in e))return(0,a.wf)(u.D.kDeserializeJsonFailed,"no tracks or materials in root");let i=e.materials,r=i.effects;for(let e=0;e<r.length;e++){let t=r[e],{type:i}=t,n=t.category_id;if("figure"===i)this.beautyCategoryIdMap[n]&&(t.category_id=this.beautyCategoryIdMap[n])}return e.materials=i,(0,a.ly)()}constructor(...e){super(...e),this.version="58.0.0",this.beautyCategoryIdMap={39814:"auto-beauty",34949:"auto-beauty2",34950:"auto-beauty3"}}}var X=i("591118"),L=i("621062"),W=i("920482"),U=i("603894"),$=i("394332"),Z=i("873375"),G=i("126073"),Y=i("609894"),q=i("773919"),J=i("720207");class Q extends c.k{migrateInner(e,t){return this.migrationDraftKeyframe(e),(0,a.oW)(e)}migrationDraftKeyframe(e){if(!("keyframes"in e))return;let t=e.tracks,i=e.keyframes,r=e.materials,n=[],a=[];for(let e of t){let t=e.segments;if(t)for(let e of t)e.common_keyframes=[],a.push(e)}this.migrationKeyframe(a,i,r,n),delete e.keyframes,e.keyframe_graph_list=n}migrationKeyframe(e,t,i,r){for(let n of J.hm.get_keyframe_migration_processors()){let a=n[0],o=n[1],s=n[2],l=n[3],d=t[a];if(!!d&&0!==d.length)for(let t of d){let n=e.find(e=>{if(!("keyframe_refs"in e))return!1;for(let i of e.keyframe_refs)if(i===t.id)return!0;return!1});if(!n)continue;let d=-1n;if("flags"in t&&(d=BigInt(t.flags)),!!o){for(let e of o)if(d&BigInt(e.keyframeFlag)&&J.hm.check_keyframe_valid(a,n,BigInt(e.keyframeFlag),i)){if("mask_config"===e.fieldKey&&null===t.mask_config)continue;J.hm.migration(n,t,Number(e.keyframeFlag),r,s,l)}}}}if("effects"in t){let r=[];for(let e of i.video_effects)r.push(e);J.hm.migration_video_effect_keyframes(e,r,t.effects)}for(let t of e)delete t.keyframe_refs}constructor(...e){super(...e),this.version="72.0.0",this.needEnumerateSubDrafts=!0}}let ee={\u81EA\u5B9A\u4E49:"6768730851543880206",\u8499\u592A\u5947:"6768648600848175619",\u82F1\u96C4\u65F6\u523B:"6768650238149267981",\u5B50\u5F39\u65F6\u95F4:"6768731518358524430",\u8DF3\u63A5:"6768731594225095175",\u95EA\u8FDB:"6768731653402530307",\u95EA\u51FA:"6768731733484376589"};class et extends c.k{curveSpeedResourceIdFix(e){let t=!1,i=e.materials;if(i&&Array.isArray(i)&&i.length>0){let{speeds:e}=i;if(e&&Array.isArray(e)&&e.length>0)for(let i of e){let e=i.curve_speed;if(e&&e.name){let i=ee[e.name];i&&(e.id=i,t=!0)}}}return t}migrateInner(e,t){return e.materials?(this.curveSpeedResourceIdFix(e),(0,a.oW)(e)):(0,a.wf)(u.D.kDeserializeJsonFailed,"no materials in json")}constructor(...e){super(...e),this.version="73.0.0",this.needEnumerateSubDrafts=!0}}var ei=i("285649"),er=i("994551"),en=i("875351"),ea=i("875845");class eo extends c.k{migrateInner(e,t){return this.migrateAudioEffectRemake(e),(0,a.oW)(e)}migrateAudioEffectRemake(e){var t,i;if(!("materials"in e)||!("tracks"in e))return;let r=[];for(let n of(null===(i=e.materials)||void 0===i||null===(t=i.audio_effects)||void 0===t||t.forEach(e=>{"string"==typeof e.id&&r.push(e.id)}),e.tracks||[]))for(let e of n.segments||[]){if("common_keyframes"in e&&!!Array.isArray(e.common_keyframes)){for(let t of e.extra_material_refs||[])if(r.includes(t))for(let i of e.common_keyframes||[])[d.Eu.KFTypeEffectAdjustParam2,d.Eu.KFTypeEffectAdjustParam1,d.Eu.KFTypeEffectAdjustParam3].includes(i.property_type)?i.material_id=t:i.material_id=""}}}constructor(...e){super(...e),this.version="79.0.0",this.needEnumerateSubDrafts=!0}}var es=i("508263"),el=i("848170");class ed extends c.k{migrateInner(e,t){var i,r;if(!("materials"in e)||!("tracks"in e))return(0,a.oW)(e);let n=null!==(i=e.tracks)&&void 0!==i?i:[],o=null!==(r=e.materials)&&void 0!==r?r:{};if(!("video"in o))return(0,a.oW)(e);let s=o.videos;for(let e of n){if("video"===e.type)for(let t of e.segments){let e=s.find(e=>e.id===t.material_id);if(!e||!e.gameplay)continue;let i=e.gameplay;if("gameplay_source_timerange"in i)i.gameplay_source_timerange.start=t.source_timerange.start}}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="82.0.0",this.needEnumerateSubDrafts=!0}}class ec extends c.k{migrateInner(e,t){var i;if(!("materials"in e)||!("tracks"in e))return(0,a.oW)(e);let r=null!==(i=e.materials)&&void 0!==i?i:{};if(!("video"in r))return(0,a.oW)(e);for(let e of r.videos)!("stable"in e)&&(e.stable={matrix_path:"",stable_level:0});return(0,a.oW)(e)}constructor(...e){super(...e),this.version="84.0.0",this.needEnumerateSubDrafts=!0}}var eu=i("447747"),em=i("296862"),eh=i("940105");class ef extends c.k{migrateInner(e,t){let{materials:i}=e;if(i&&i.videos)for(let e of i.videos){let t=e.smart_motion;if(t){let{motion_param:e,keyframes:i}=t;!e&&!i&&(t.motion_enable=!0)}}let r=i&&i.texts;if(r)for(let e of r){let{content:t}=e;t&&(0,p.BK)(t)&&(e.content=JSON.stringify(eh.Q.xmlToJson(t)))}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="93.0.0",this.needEnumerateSubDrafts=!0}}var ep=i("402878"),eg=i("520622"),ey=i("899286"),e_=i("352960");let eT=new Map([["img2video_jianying@pixel","7319826809686740229"],["img2video_jianying@vapour","7319827652649422085"],["img2video_jianying@science","7319825129796537605"],["velocity_edit@flash","7298309792857328902"],["velocity_edit@blur_shake","7298309792857361670"],["velocity_edit@fade_blur","7298309792857345286"],["velocity_edit@retro_zoom","7298309792857312518"],["velocity_edit@rainbow","7298309792857296134"],["img2video_3dmove@firework_festival","7298370919280463109"],["img2video_3dmove@korean_manga","7298376175456374022"],["img2video_3dmove@infinity_travel_us","7298370919280545029"],["img2video_3dmove@infinity_travel_jk","7298373731326528774"],["img2video_3dmove@cyber_future","7298370919280495877"],["img2video_3dmove@real_barbie_us","7298370919280561413"],["img2video_3dmove@real_barbie_asia","7298373731326545158"],["naked_eye_3d","7298370919280413957"],["video_camera_jump","7298366024972356870"],["video_camera_move","7298366024972373254"],["img2video3d_v2","7298366024972274950"],["dolly_zoom_jianying","7298366024972324102"],["neonshards","7298373731326659846"],["particle_evanish","7298373731326676230"],["particle_evanish_reverse","7298376175456357638"],["portrait_photo_jy@yi_nationality","7316454731059137798"],["portrait_photo_jy@basketball","7309019460441066758"],["portrait_photo_jy@rugby","7311300825593253126"],["portrait_photo_jy@cheerleaders","7311300825593203974"],["portrait_photo_jy@baseball","7309019460441050374"],["portrait_photo_jy@old_money","7311300825593154822"],["portrait_photo_jy@hippie","7309019460441083142"],["portrait_photo_jy@fitness_muscles","7311300825593187590"],["portrait_photo_jy@halloween_wednesday_girl","7298373731326577926"],["portrait_photo_jy@halloween_wednesday_boy","7298310134332214533"],["portrait_photo_jy@halloween_ghost_doll_girl","7298310134332198149"],["portrait_photo_jy@halloween_ghost_doll_boy","7298310134332132613"],["portrait_photo_jy@girl_under_moon","7298332928965217541"],["portrait_photo_jy@assassin_under_moon","7298309792857378054"],["portrait_photo@wedding","7298310134332247301"],["portrait_photo@rich_daughter","7298310134332165381"],["portrait_photo_jy@girl_under_moon","7298332928965217541"],["portrait_photo_jy@assassin_under_moon","7298309792857378054"],["portrait_photo@american_passport_v1","7298310134332263685"],["portrait_photo@american_passport_v2","7298310134332280069"],["portrait_photo@oxygen_photo","7298332928965184773"],["portrait_photo@portrait_v1","7298332928965152005"],["portrait_photo@portrait_v2","7298332928965168389"],["portrait_photo@japanese_film","7298373731326561542"],["portrait_photo@net_sense_daily","7298332928965119237"],["portrait_photo@exotic","7298332928965201157"],["portrait_photo@korean_pictorial","7298310134332230917"],["portrait_photo_jy@cutie_bunny","7298373731326594310"],["emotion_portrait@sad","7298358335659576581"],["emotion_portrait@jiuwo","7298337014770945286"],["emotion_portrait@tight_smile","7298337014770928902"],["emotion_portrait@cool","7298337014770961670"],["emotion_portrait@classic_white_teeth","7298337014770978054"],["panoptic_seg","7298373731326610694"],["stereo_album","7298373731326627078"],["prequel_cartoon","7298363215279344902"],["3dgame_cartoon_abroad","7298358335659658501"],["classic_cartoon","7298358335659674885"],["amcartoon","7298358335659724037"],["pixar","7298363215279312134"],["tccartoon","7298363215279295750"],["jzcartoon","7298358335659707653"],["Comic-cut","7298363215279328518"],["hkcartoon","7298358335659691269"],["img2img_outpainting","7309019460445179141"],["img2img_outpainting@two","7311300825593236742"],["img2img_anime_v2_cc@CC_snowy","7298337014770912518"],["img2img_anime_v2_cc@CC_freckle","7298337014770896134"],["img2img_anime_cc@jy_beauty1","7298337014770863366"],["img2img_anime_cc@jy_beauty2","7298337014770879750"],["img2img_anime_cc@jy_cat","7298337014770846982"],["img2img_anime_cc@jy_muscle","7298337014770830598"],["hd_gender_swap_tt@female","7298363215279410438"],["hd_gender_swap_tt@male","7298363215279394054"],["angel_demon_capcut@angel","7298363215279443206"],["angel_demon_capcut@demon","7298363215279377670"],["face_swap_morphing_qixi_modern","7298373731326643462"],["face_swap_morphing_qixi_wedding","7298366024972340486"],["beauty_boy","7298373731326643462"],["become_baby","7298363215279361286"],["big_head","7298366024972307718"],["cyberpunk","7298358335659625733"],["sky_change_video@yellow","7298358335659592965"],["sky_change_video@white","7298358335659609349"],["oilpaint","7298358335659642117"],["dynamic_light_wave","7298309792857279750"],["shadow_through","7298309792857246982"],["shadow_left","7298309792857263366"],["image2image-ai_create-exquisiteDetails-jianying-async","7311637740938972422"],["image2image-ai_create-DreamlabsOil-jianying-async","7316444974646562053"],["image2image-ai_create-dynavision-jianying-async","7311642171436813573"],["image2image-ai_create-PoltergeistMix-jianying-async","7316454273162808581"],["img2img_controlnet_magicmixReverie","7309019460466232581"],["img2img_controlnet_revAnimated_v122","7309019460470426886"],["img2img_guozov_async","7311642171432504581"],["img2img_ai_portrait_async_jy_moyou","7311642299639942406"],["img2img_ai_portrait_async_jy_brav5","7316152802680720646"],["img2img_ai_portrait_async_jy_cyberrealistic","7311642997567786246"],["img2img_anime_async","7322023246646299910"]]),ev=new Map([["img2video_jianying@pixel","7319507918615760165"],["img2video_jianying@vapour","7319506618654133531"],["img2video_jianying@science","7319506618654199067"],["velocity_edit@flash","7295676374377942298"],["velocity_edit@blur_shake","7297139174027676954"],["velocity_edit@fade_blur","7297139174027693338"],["velocity_edit@retro_zoom","7297139174027709722"],["velocity_edit@rainbow","7297156389036625179"],["img2video_3dmove@antique_time_travel","7293813826296761626"],["img2video_3dmove@time_travel","7295719072551931186"],["img2video_3dmove@korean_manga","7295719072551996722"],["img2video_3dmove@infinity_travel_us","7296802940608646409"],["img2video_3dmove@cyber_future","7296867041879788851"],["img2video_3dmove@hero","7296802940608679177"],["img2video_3dmove@firework_festival","7296802940608695561"],["img2video_3dmove@real_barbie_asia","7296802940608711945"],["video_camera_move","7297156389036674331"],["img2video3d_v2","7297156389036641563"],["dolly_zoom_jianying","7297156389036657947"],["portrait_photo_jy@yi_nationality","7325000226815642917"],["portrait_photo_jy@geisha","7317856908226858246"],["portrait_photo_jy@basketball","7311255732026936626"],["portrait_photo_jy@rugby","7310065101363563813"],["portrait_photo_jy@cheerleaders","7310065101363531045"],["portrait_photo_jy@baseball","7311255732026920242"],["portrait_photo_jy@old_money","7311255732026887474"],["portrait_photo_jy@hippie","7310065101363547429"],["portrait_photo_jy@zanhua","7311255732026903858"],["portrait_photo_jy@zanhua_v2","7311255732026903858"],["portrait_photo_jy@fitness","7311255732026871090"],["portrait_photo_jy@halloween_wednesday_girl","7295720225301876018"],["portrait_photo_jy@halloween_wednesday_boy","7295720225301859634"],["portrait_photo_jy@halloween_ghost_doll_girl","7295719072552062258"],["portrait_photo_jy@halloween_ghost_doll_boy","7295719072552045874"],["portrait_photo_jy@girl_under_moon","7295720225302007090"],["portrait_photo_jy@assassin_under_moon","7296802940608597257"],["portrait_photo_jy@travel_girl","7295720225301892402"],["portrait_photo_jy@travel_boy","7296802940608613641"],["portrait_photo_jy@girl_in_red","7295720225301990706"],["portrait_photo_jy@cutie_bunny","7295720225301957938"],["portrait_photo@rich_daughter","7295719072552078642"],["portrait_photo@american_passport_v2","7297156389036756251"],["portrait_photo@oxygen_photo","7295720225301974322"],["portrait_photo@portrait_v1","7296802940608728329"],["portrait_photo@portrait_v2","7296867041879838003"],["portrait_photo@korean_pictorial","7297156389036690715"],["portrait_photo@exotic","7297156389036707099"],["portrait_photo@net_sense_daily","7297156389036739867"],["portrait_photo@japanese_film","7297156389036723483"],["portrait_photo@american_passport_v1","7295720225301925170"],["portrait_photo@wedding","7295719072552029490"],["emotion_portrait@ sad","7297121952244747530"],["emotion_portrait@jiuwo","7297121952244714762"],["emotion_portrait@liwo","7297121952244731146"],["emotion_portrait@classic_white_teeth","7297121952244763914"],["panoptic_seg","7297123360662703386"],["stereo_album","7295676374377909530"],["cyberpunk","7297123360662637850"],["sky_change_video@yellow","7297123360662654234"],["sky_change_video@white","7297123360662670618"],["oilpaint","7297123360662687002"],["prequel_cartoon","7297139174027562266"],["3dgame_cartoon","7297123360662719770"],["classic_cartoon","7297123360662736154"],["amcartoon","7297139174027578650"],["pixar","7297139174027611418"],["tccartoon","7297139174027595034"],["jzcartoon","7297123360662768922"],["hkcartoon","7297123360662752538"],["Comic-cut","7297139174027627802"],["img2img_outpainting","7310065101363580197"],["img2img_outpainting@two","7311255732026953010"],["img2img_anime@jy_spring","7296802940608744713"],["img2img_anime@jy_spring_man","7296867041879805235"],["img2img_anime@jy_beauty1","7296867041879821619"],["img2img_anime@jy_beauty2","7296867041879854387"],["img2img_anime@jy_beauty4","7296867041879870771"],["img2img_anime@jy_dog","7296867041879887155"],["img2img_anime@jy_cat","7296867041879903539"],["img2img_anime@jy_muscle","7296867041879919923"],["img2img_anime@jy_fat","7296867041879936307"],["img2img_anime@jy_beauty3","7297121952244698378"],["hd_gender_swap","7297123360662621466"],["face_swap_morphing_qixi_ancient","7297121952244813066"],["face_swap_morphing_qixi_modern","7297121952244845834"],["face_swap_morphing_qixi_wedding","7297121952244829450"],["become_baby","7297121952244780298"],["big_head","7297121952244796682"],["dynamic_light_wave","7297139174027660570"],["shadow_through","7295676374377925914"],["shadow_left","7297139174027644186"],["image2image-ai_create-exquisiteDetails-jianying-async","7315263469857672457"],["image2image-ai_create-DreamlabsOil-jianying-async","7317555902167534858"],["image2image-ai_create-dynavision-jianying-async","7315306398110289190"],["image2image-ai_create-PoltergeistMix-jianying-async","7317556050528439602"],["img2img_controlnet_magicmixReverie","7311255732048006410"],["img2img_controlnet_revAnimated_v122","7311255732026985778"],["img2img_guozov_async","7310161836618403099"],["img2img_ai_portrait_async_jy_moyou","7315306975884021042"],["img2img_ai_portrait_async_jy_brav5","7315306975884037426"],["img2img_ai_portrait_async_jy_cyberrealistic","7319862918768495909"],["v2v_magic_openprompt","7315306975884053810"],["v2v_guozovya_openprompt","7315307962837323059"],["img2img_anime_async","7322377786612550922"],["img2img_anime","7322376472704929050"],["img2img_comic_jianying","7322375355535330570"],["img2img_guozov_jianying","7322372565157121290"],["v2v_majicmixReverie","7322372044308434227"]]);function eI(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(t?eT:ev).get(e)||""}var ew=i("722169");class eS extends c.k{migrateInner(e){let t=e.last_modified_platform,i=!1;if(t){let e=t.app_source,r=t.app_id;i="cc"===e||"359289"===r||"3006"===r}let{materials:r}=e;for(let e of null==r?void 0:r.videos){let{gameplay:t}=e;!(0,ew.isNil)(t)&&""!==t.algorithm&&(t.resource_id=eI(t.algorithm,i))}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="99.0.0",this.needEnumerateSubDrafts=!0}}class ek extends c.k{migrateInner(e,t){return(0,a.oW)(e)}constructor(...e){super(...e),this.version="88.0.0",this.needEnumerateSubDrafts=!0}}class ex extends c.k{migrateInner(e){let t=e.last_modified_platform,i=!1;if(t){let e=t.app_source,r=t.app_id;i="cc"===e||"359289"===r||"3006"===r}let{materials:r}=e;for(let e of(null==r?void 0:r.videos)||[]){let{gameplay:t}=e;if(!(0,ew.isNil)(t)){let e="none"===t.resource_id||""===t.resource_id;!0===t.is_aigc&&""!==t.algorithm&&e&&(t.resource_id=eI(t.algorithm,i))}}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="100.0.0"}}var eb=i("593642");class eM extends c.k{migrateInner(e){let t={0:"AlgorithmDefault",1:"ComplementFrame",2:"MotionBlur",3:"Deflicker",4:"NoiseReduction",5:"QualityEnhance",6:"SmartCrop",7:"SpeechToSong",8:"AudioVocalSeparation",9:"AudioVcVoiceChange",10:"AudioSpeechToSong",11:"AudioLoudness",12:"VideoGamePlay",13:"AudioVocalBeautify",14:"SmartRelight",15:"VideoAITranslate",16:"AudioAITranslate"},{materials:i}=e,{videos:r}=i;for(let e of r){let i=e.video_algorithm;if(!(0,ew.isNil)(i)){let{algorithms:r}=i;if(!(0,ew.isNil)(r)){for(let e of r){let r=t[e.type];if(!(0,ew.isNil)(r)){if("ComplementFrame"===r){let t={mode:e.name};i.complement_frame_config=t}e.type=r,e.algorithm_id="",e.name=void 0}}i.algorithms=r}let{gameplay:n}=e;if(!(0,ew.isNil)(n)){let{algorithm:t,enable:r,gameplay_source_timerange:a,is_aigc:o,path:s}=n,l=null;if(!(0,ew.isNil)(s)&&!(0,ew.isNil)(t)&&(l={type:o?M.zzh.AigcGamePlay:M.zzh.VideoGamePlay,algorithm_id:(0,eb.Rl)()}),!(0,ew.isNil)(l)){n.algorithm_type=l.type,n.algorithm_id=l.algorithm_id;let e=[n];if((0,ew.isNil)(i)&&(i={}),i.gameplay_configs=e,r){let e=i.algorithms;(0,ew.isNil)(e)&&(e=[]),e.unshift(l),1===e.length&&(i.path=s,i.time_range=a),i.algorithms=e}}e.gameplay=void 0}i&&(e.video_algorithm=i)}}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="106.0.0",this.needEnumerateSubDrafts=!0}}var eC=i("970151");class eA extends c.k{migrateInner(e){let t=e.materials.ai_translates;if(t)for(let e of t)e.time_range&&!e.actual_time_range&&(e.actual_time_range=e.time_range);return(0,a.oW)(e)}constructor(...e){super(...e),this.version="108.0.0"}}var eE=i("973627"),eF=i("570605"),eP=i("807826"),eD=i("973588"),ez=i("819556");class eN extends c.k{migrateInner(e){let{materials:t}=e,{videos:i}=t;if(!i||0===i.length)return(0,a.oW)(e);for(let e of i){let{matting:t}=e;if(t){let{strokes:e}=t;e&&e.length>0&&t.flag<128&&(t.flag+=128)}}return(0,a.oW)(e)}constructor(...e){super(...e),this.version="123.0.0",this.needEnumerateSubDrafts=!0}}class eV extends c.k{migrateInner(e){let{materials:t}=e,{audios:i}=t;if(!i||0===i.length)return(0,a.oW)(e);for(let e of i)e.ai_music_type===M.QSZ.AIMusicTypeVocal&&(e.lyric_type=M.XlB.AIMusicLyricTypeCustom);return(0,a.oW)(e)}constructor(...e){super(...e),this.version="123.0.0",this.needEnumerateSubDrafts=!0}}var eO=i("967101"),eR=i("589635"),eH=i("886250");class eB extends c.k{migrateInner(e){let{materials:t,tracks:i}=e,{common_mask:r}=t;if(!r||0===r.length)return(0,a.oW)(e);for(let e of r){var n;(null===(n=e.config)||void 0===n?void 0:n.feather)&&(e.config.feather=Math.sqrt(e.config.feather))}if(!i||0===i.length)return(0,a.oW)(e);for(let e of i){let{segments:t}=e;if(!!t&&0!==t.length)for(let e of t)this._migrateFeatherKeyframes(e)}return(0,a.oW)(e)}_migrateFeatherKeyframes(e){let t=e.common_keyframes;if(!!t&&0!==t.length)for(let e of t){if(e.property_type!==M.Eu.KFTypeCommonMaskFeather)continue;let t=e.keyframe_list;if(!!t&&0!==t.length)t.forEach(e=>{if(!!e.values&&0!==e.values.length)for(let t=0;t<e.values.length;t++)e.values[t]=Math.sqrt(e.values[t])})}}constructor(...e){super(...e),this.version="127.0.0",this.needEnumerateSubDrafts=!0}}let eK=[new s.T,new l.z,new m,new h,new f.S,new g,new y.x,new _,new T,new I,new w.j,new S.V,new k.H,new x,new b.Z,new E,new F.G,new P.q,new D.U,new z,new N.j,new V.g,new H,new K,new j,new X.r,new L.G,new W.H,new U.K,new $.P,new Z.w,new G.G,new Y.T,new q.i,new Q,new et,new ei.B,new er.u,new en.r,new ea.M,new eo,new es.d,new el.Z,new ed,new ec,new eu.E,new em.W,new ek,new eg.E,new ep.$,new ef,new ey.w,new e_.k,new eS,new ex,new eM,new eC.y,new eA,new eE.g,new eF.z,new eP.$,new eD.S,new ez.m,new eN,new eV,new eO.V,new eR.c,new eH.N,new eB];class ej{needExtraMigrate(){return this._listener.needExtraUpgrade()}taskAfterMigrate(e,t){let i=this._listener.taskAfterUpgrade(e,t);return i.ok?(0,a.oW)(e):i}taskBeforeMigrate(e,t){let i=this._listener.taskBeforeUpgrade(e,t);return i.ok?(0,a.oW)(e):i}taskFinishedMigrate(e,t,i){return this._listener.taskFinishedUpgrade(e,t,i),(0,a.oW)(e)}constructor(){this._listener=new r.Q}}class eX extends n.m{constructor(e){super({type:n.I.Upgrade,json:e,tasks:eK,listener:new o([new ej])})}}},501754:function(e,t,i){i.d(t,{b:function(){return s}});var r=i(690613),n=i(12826),a=i(211561),o=i(722169);class s extends n.j{shouldRepairBackground(e){var t,i,r;let n=[a.cVg.MetaTypeCanvasColor,a.cVg.MetaTypeCanvasImage,a.cVg.MetaTypeCanvasBlur].includes(null!==(r=null===(t=e.canvas_config)||void 0===t?void 0:t.type)&&void 0!==r?r:a.cVg.MetaTypeNone),o=!(null===(i=e.canvas_config)||void 0===i?void 0:i.background);return n&&o}repairBackgroundColor(e){var t,i,r;let n=null!==(r=null==e?void 0:null===(t=e.canvas_config)||void 0===t?void 0:t.background)&&void 0!==r?r:{};n.color=null===(i=e.canvas_config)||void 0===i?void 0:i.color,(0,o.unset)(e,"canvas_config.color"),(0,o.set)(e,"canvas_config.background",n)}repairBackgroundBlur(e){var t,i,r;let n=null!==(r=null==e?void 0:null===(t=e.canvas_config)||void 0===t?void 0:t.background)&&void 0!==r?r:{};n.blur=null===(i=e.canvas_config)||void 0===i?void 0:i.blur,(0,o.unset)(e,"canvas_config.blur"),(0,o.set)(e,"canvas_config.background",n)}repairBackgroundImage(e){var t,i,r,n,a,s;let l=null!==(s=null==e?void 0:null===(t=e.canvas_config)||void 0===t?void 0:t.background)&&void 0!==s?s:{};l.image=null===(i=e.canvas_config)||void 0===i?void 0:i.image,l.image_id=null===(r=e.canvas_config)||void 0===r?void 0:r.image_id,l.image_name=null===(n=e.canvas_config)||void 0===n?void 0:n.image_name,l.source_platform=null===(a=e.canvas_config)||void 0===a?void 0:a.source_platform,(0,o.unset)(e,"canvas_config.image"),(0,o.unset)(e,"canvas_config.image_id"),(0,o.unset)(e,"canvas_config.image_name"),(0,o.unset)(e,"canvas_config.source_platform"),(0,o.set)(e,"canvas_config.background",l)}repair(e){let{draft:t}=e;return this.shouldRepairBackground(t)&&(this.repairBackgroundColor(t),this.repairBackgroundBlur(t),this.repairBackgroundImage(t)),(0,r.oW)(e)}}},830253:function(e,t,i){i.d(t,{C:function(){return a}});var r=i(690613),n=i(12826);class a extends n.j{repair(e){let{draft:t}=e;if(!Array.isArray(t.tracks))return(0,r.oW)(e);for(let e of t.tracks){if(!Array.isArray(null==e?void 0:e.segments))continue;let t=e.segments.length;for(;t--;){let i=e.segments[t];if((null==i?void 0:i.target_timerange)&&0===(i.target_timerange.duration||0)){e.segments.splice(t,1);continue}(null==i?void 0:i.source_timerange)&&0>(i.source_timerange.start||0)&&(i.source_timerange.start=0)}}return(0,r.oW)(e)}}},907482:function(e,t,i){i.d(t,{V:function(){return s}});var r=i(690613),n=i(12826),a=i(287165),o=i(602777);class s extends n.j{repair(e){var t,i;let{draft:n}=e,s=null===(t=n.materials)||void 0===t?void 0:t.effects;if(!Array.isArray(s))return(0,r.oW)(e);let l=s.filter(e=>{if("figure"===e.type&&this._preloadPrefabResourcesIds.includes(e.resource_id))return e.version="v2",!0});return null===(i=n.tracks)||void 0===i||i.forEach(e=>{var t;null===(t=e.segments)||void 0===t||t.forEach(e=>{let t=e.extra_material_refs;if(t){let e=l.find(e=>t.find(t=>t===e.id));if(e){var i;let r=(i=e,(0,a.p)(),{adjust_params:[],algorithm_artifact_path:i.algorithm_artifact_path,apply_target_type:0,bloom_params:i.bloom_params,category_id:i.category_id,category_name:"",effect_id:"",enable_skin_tone_correction:i.enable_skin_tone_correction,exclusion_group:[],face_adjust_params:[],formula_id:i.formula_id,id:(0,a.p)(),intensity_key:"",name:"makeup-root",panel_id:i.panel_id,path:"/editor/effect/0196e5c1dc9d5498f4fa44dd090c49dd",platform:i.platform,request_id:"",resource_id:"7280056145232794113",source_platform:i.source_platform,sub_type:i.sub_type,time_range:i.time_range,type:o.cV.MetaTypeMakeupRoot,value:i.value,version:""});t.push(r.id),s.push(r)}}})}),(0,r.oW)(e)}constructor(e){super(),this._preloadPrefabResourcesIds=e}}},996853:function(e,t,i){i.d(t,{n:function(){return o}});var r=i(211561),n=i(690613),a=i(12826);class o extends a.j{repair(e){var t,i,a;let{draft:o}=e;if(!(null===(t=o.materials)||void 0===t?void 0:t.chromas)||!Array.isArray(null===(i=o.materials)||void 0===i?void 0:i.chromas))return(0,n.oW)(e);for(let e of o.materials.chromas){if(!e)continue;let{tracks:t=[],materials:i,mutable_config:n}=o,s=new Set((null!==(a=null==n?void 0:n.mutable_materials)&&void 0!==a?a:[]).map(e=>null==e?void 0:e.id).filter(Boolean));null==t||t.forEach(t=>{if((null==t?void 0:t.type)===r.pNd.TrackTypeVideo&&!!Array.isArray(t.segments))t.segments.forEach(t=>{var r,n,a,o;if(!t||!s.has(t.material_id))return;let l=null===(r=t.extra_material_refs)||void 0===r?void 0:r.findIndex(t=>t===e.id);if(void 0!==l&&l>-1){null===(n=t.extra_material_refs)||void 0===n||n.splice(l,1);let r=null===(a=i.chromas)||void 0===a?void 0:a.findIndex(t=>(null==t?void 0:t.id)===e.id);void 0!==r&&r>-1&&(null===(o=i.chromas)||void 0===o||o.splice(r,1))}})})}return(0,n.oW)(e)}}},112317:function(e,t,i){i.d(t,{d:function(){return o}});var r=i(602777),n=i(690613),a=i(12826);class o extends a.j{repair(e){let{draft:t}=e,{materials:i,tracks:a}=t;if(!(null==i?void 0:i.transitions)||!a||!Array.isArray(null==i?void 0:i.transitions)||!Array.isArray(a))return(0,n.oW)(e);let o=i.transitions.length;for(;o--;){let e=i.transitions[o];("none"===e.effect_id||e.duration&&e.duration<0||""===e.resource_id)&&(a.forEach(t=>{if(!!t&&t.flag===r.w9.FlagNone&&t.type===r.pN.TrackTypeVideo&&!!Array.isArray(t.segments))t.segments.forEach(t=>{var i,r;let n=null==t?void 0:null===(i=t.extra_material_refs)||void 0===i?void 0:i.findIndex(t=>t===(null==e?void 0:e.id));void 0!==n&&n>-1&&(null==t||null===(r=t.extra_material_refs)||void 0===r||r.splice(n,1))})}),i.transitions.splice(o,1))}return(0,n.oW)(e)}}},584665:function(e,t,i){i.d(t,{y:function(){return s}});var r=i(211561),n=i(700845),a=i(127926),o=i(185400);function s(e){let{material:t}=e,i=t.checkFlag;!(0,n.yE)(i,r.sQs.BasicFlag)&&(e.volume=1,e.fade&&(e.fade.fadeInDuration=0n,e.fade.fadeOutDuration=0n),a.OL.takeKeyframesList(e,[r.Eu.KFTypeVolume,r.Eu.KFTypeLastVolume])),!(0,n.yE)(i,r.sQs.VoiceChangeFlag)&&(e.voiceChange=[],a.OL.takeKeyframesList(e,o.gb)),e.material.checkFlag=i|Number(r.sQs.BasicFlag)|Number(r.sQs.VoiceChangeFlag)}},189777:function(e,t,i){i.d(t,{X:function(){return o}});var r=i(211561),n=i(700845),a=i(481631);function o(e){let{material:t}=e,i=t.checkFlag;if(!(0,n.yE)(i,r.jRC.PosSizeFlag)){let{clip:t}=e,i=(0,a.P7)(e)||(0,a.WX)(e)?e.material.initialScale:1;t&&(t.transform.x=0,t.transform.y=0,t.scale.x=i,t.scale.y=i,t.rotation=0),e.commonKeyframes=[]}e.material.checkFlag=i|Number(r.jRC.PosSizeFlag)}},347311:function(e,t,i){i.d(t,{NG:function(){return c},ix:function(){return l},zD:function(){return d}});var r=i(211561),n=i(700845),a=i(127926),o=i(185400);function s(e){return e.__segment_struct_type===r.Ocy.SegmentText}function l(e){let t=s(e)?e.material:e,{checkFlag:i}=t;!(0,n.yE)(i,r.PbZ.ArrangeFlag)&&(t.letterSpacing=0,t.lineSpacing=0,t.alignment=1,t.typesetting=0),s(e)&&!(0,n.yE)(i,r.PbZ.TPosSizeFlag)&&(e.clip&&(e.clip.transform.x=0,e.clip.transform.y=0,e.clip.scale.x=1,e.clip.scale.y=1,e.clip.rotation=0),a.OL.takeKeyframesList(e,o.Q0)),!(0,n.yE)(i,r.PbZ.TMixFlag)&&(t.textAlpha=1,t.globalAlpha=1,s(e)&&a.OL.takeKeyframes(e,r.Eu.KFTypeTextAlpha)),!(0,n.yE)(i,r.PbZ.BorderFlag)&&(t.borderColor="",t.borderWidth=0,s(e)&&a.OL.takeKeyframes(e,r.Eu.KFTypeBorderWidth)),(0,n.yE)(i,r.PbZ.FrameFlag)?t.backgroundStyle===r.M4l.TextBackgroundStyleNone&&""!==t.backgroundColor&&(t.backgroundStyle=r.M4l.TextBackgroundStyleSquare):(t.backgroundColor="",t.backgroundAlpha=1,t.backgroundStyle=r.M4l.TextBackgroundStyleNone,s(e)&&a.OL.takeKeyframes(e,r.Eu.KFTypeBackgroundAlpha)),(0,n.yE)(i,r.PbZ.ShadowFlag)?t.hasShadow=!0:(t.hasShadow=!1,t.shadowAlpha=.8,t.shadowSmoothing=1,t.shadowPoint.x=1.0182337649086284,t.shadowPoint.y=1.0182337649086284,t.shadowColor="#000000cc",s(e)&&a.OL.takeKeyframesList(e,[r.Eu.KFTypeShadowAlpha,r.Eu.KFTypeShadowSmoothing])),t.checkFlag=Number(BigInt(i)|r.PbZ.ArrangeFlag|r.PbZ.TPosSizeFlag|r.PbZ.TMixFlag)}function d(e){let{material:t}=e;if(t)for(let e of t.textInfoResources){let{textMaterial:t}=e;l(t)}}function c(e){let{bloom:t}=e,{checkFlag:i}=e.material;t?e.material.checkFlag=Number(BigInt(i)|r.PbZ.LightFlag):e.material.checkFlag=Number(BigInt(i)&~r.PbZ.LightFlag)}},231163:function(e,t,i){i.d(t,{j:function(){return l}});var r=i(211561),n=i(700845),a=i(399835),o=i(127926),s=i(185400);function l(e){let{material:t}=e,i=t.checkFlag;if(!(0,n.yE)(i,r.FC7.FilterFlag)&&(e.filter=void 0,o.OL.takeKeyframes(e,r.Eu.KFTypeFilter)),!(0,n.yE)(i,r.FC7.EffectFlag)&&(e.videoEffects=[]),!(0,n.yE)(i,r.FC7.VPosSizeFlag)){let{clip:t}=e;t.rotation=0,t.transform.x=0,t.transform.y=0,t.scale.x=1,t.scale.y=1,o.OL.takeKeyframesList(e,s.Q0)}if(!(0,n.yE)(i,r.FC7.VMixFlag)&&(e.mixMode=void 0,e.clip.alpha=1,o.OL.takeKeyframes(e,r.Eu.KFTypeAlpha)),!(0,n.yE)(i,r.FC7.Beauty))for(let t of(e.material.isUnifiedBeautyMode=!1,e.figures)){let{resourceId:e}=t;((0,a.Ug)(e)||(0,a.kt)(e))&&(t.value=0,t.adjustParams=[],t.faceAdjustParams=[])}if(!(0,n.yE)(i,r.FC7.BeautyReshape))for(let t of(e.material.isUnifiedBeautyMode=!1,e.figures)){let{resourceId:e}=t;((0,a.Zr)(e)||(0,a.Ze)(e))&&(t.value=0,t.adjustParams=[])}if(!(0,n.yE)(i,r.FC7.BeautyBody))for(let t of(e.material.isUnifiedBeautyMode=!1,e.figures)){let{resourceId:e}=t;((0,a.BU)(e)||(0,a.aj)(e))&&(t.value=0)}if(!(0,n.yE)(i,r.FC7.BeautyMakeup))for(let t of(e.material.isUnifiedBeautyMode=!1,e.figures)){let{resourceId:e}=t;(0,a.YX)(e)&&(t.value=0,t.adjustParams=[],t.faceAdjustParams=[])}!(0,n.yE)(i,r.FC7.Chroma)&&(e.chroma=void 0,o.OL.takeKeyframesList(e,s.QR)),!(0,n.yE)(i,r.FC7.Masking)&&(e.videoMask=void 0,o.OL.takeKeyframesList(e,s.oH)),!(0,n.yE)(i,r.FC7.AudioBasic)&&(e.volume=1,e.material.audioFade&&(e.material.audioFade.fadeInDuration=0n,e.material.audioFade.fadeOutDuration=0n),o.OL.takeKeyframesList(e,[r.Eu.KFTypeVolume,r.Eu.KFTypeLastVolume])),!(0,n.yE)(i,r.FC7.AudioVoiceChangeFlag)&&(e.voiceChange=[],o.OL.takeKeyframesList(e,s.gb)),!(0,n.yE)(i,r.FC7.Stable)&&e.material.stable&&(e.material.stable.stableLevel=0),!(0,n.yE)(i,r.FC7.VideoBackground)&&e.background&&(e.background.color="",e.background.blur=0,e.background.image="",e.background.albumImage="",e.background.imageId="",e.background.imageName="",e.background.type=r.cVg.MetaTypeCanvasColor),!(0,n.yE)(i,r.FC7.ManualDeformation)&&(e.manualDeformation=void 0),!(0,n.yE)(i,r.FC7.SmartCropFlag)&&(e.smartCrop=void 0);let l=e.adjust;for(let t of((null==l?void 0:l.enableSmartColorAdjust)===!1&&(l.smartAdjustColor=void 0,o.OL.takeKeyframesList(e,[r.Eu.KFTypeSmartColorAdjust])),e.material.checkFlag=i|16383&~Number(r.FC7.HDRSettingsFlag),e.figures))"7148630807379186177"===t.resourceId&&(t.intensityKey="face_adjust_yunfu")}},2940:function(e,t,i){i.d(t,{M:function(){return s}});var r=i(602777),n=i(481631),a=i(234396),o=i(690613);class s extends a.K{repair(e){let{draft:t}=e;for(let e of t.tracks)if([r.pN.TrackTypeVideo,r.pN.TrackTypeAudio].includes(e.type)){for(let t of e.segments)if((0,n.he)(t)||(0,n.Y9)(t)){let e=t.realtimeDenoise;e&&!e.path&&(e.path="/__opfs_system_root/integration/audio")}}return(0,o.oW)(e)}}},852453:function(e,t,i){i.d(t,{m:function(){return o}});var r=i(690613),n=i(234396),a=i(211561);class o extends n.K{repair(e){let{draft:t}=e,i=t.tracks.filter(e=>e.type!==a.pNd.TrackTypeAudio),n=t.tracks.filter(e=>e.type===a.pNd.TrackTypeAudio);return t.tracks=i.concat(n),(0,r.oW)(e)}}},120361:function(e,t,i){i.d(t,{E:function(){return l}});var r=i(234396),n=i(690613),a=i(602777),o=i(211561),s=i(287165);class l extends r.K{repair(e){let{draft:t}=e;return t.getAllSegments().forEach(e=>{var t;if(e.commonKeyframes.length>0&&(null===(t=e.uniformScale)||void 0===t?void 0:t.on)){let t=e.commonKeyframes.filter(e=>e.propertyType===a.Eu.KFTypeScaleX),i=[];t.forEach(t=>{let r=e.commonKeyframes.find(e=>e.propertyType===a.Eu.KFTypeScaleY),n=new o.koq(t);n.id=(0,s.p)(),n.propertyType=a.Eu.KFTypeScaleY,n.keyframeList.forEach(e=>e.id=(0,s.p)()),r?r.keyframeList=n.keyframeList:i.push(n)}),i.forEach(t=>{e.commonKeyframes.push(t)})}}),(0,n.oW)(e)}}},810909:function(e,t,i){i.d(t,{CP:function(){return h},F6:function(){return y},Uz:function(){return T},WL:function(){return p},av:function(){return f},he:function(){return _},r_:function(){return m},vK:function(){return g}});var r=i(602777);function n(e,t){for(let i of t)if(BigInt(i.oldFlag)===e)return i.newKeyframeType;return r.Eu.KFTypeNone}let a=[{oldFlag:r.w8.ADKFFBrightness,newKeyframeType:r.Eu.KFTypeBrightness},{oldFlag:r.w8.ADKFFContrast,newKeyframeType:r.Eu.KFTypeContrast},{oldFlag:r.w8.ADKFFSaturation,newKeyframeType:r.Eu.KFTypeSaturation},{oldFlag:r.w8.ADKFFSharpen,newKeyframeType:r.Eu.KFTypeSharpen},{oldFlag:r.w8.ADKFFHightLight,newKeyframeType:r.Eu.KFTypeHightLight},{oldFlag:r.w8.ADKFFShadow,newKeyframeType:r.Eu.KFTypeShadow},{oldFlag:r.w8.ADKFFTemperature,newKeyframeType:r.Eu.KFTypeTemperature},{oldFlag:r.w8.ADKFFTone,newKeyframeType:r.Eu.KFTypeHue},{oldFlag:r.w8.ADKFFFade,newKeyframeType:r.Eu.KFTypeFade},{oldFlag:r.w8.ADKFFLightSensation,newKeyframeType:r.Eu.KFTypeLightSensatione},{oldFlag:r.w8.ADKFFVignetting,newKeyframeType:r.Eu.KFTypeVignetting},{oldFlag:r.w8.ADKFFParticle,newKeyframeType:r.Eu.KFTypeParticle},{oldFlag:r.w8.ADKFFLUT,newKeyframeType:r.Eu.KFTypeLUT},{oldFlag:r.w8.ADKFFPrimaryColorWheelsIntensity,newKeyframeType:r.Eu.KFTypePrimaryColorWheelIntensity},{oldFlag:r.w8.ADKFFLogColorWheelsIntensity,newKeyframeType:r.Eu.KFTypeLogColorWheelIntensity},{oldFlag:r.w8.ADKFFSmartColorAdjust,newKeyframeType:r.Eu.KFTypeSmartColorAdjust},{oldFlag:r.w8.ADKFFFilter,newKeyframeType:r.Eu.KFTypeFilter}],o=[{oldFlag:r.cw.AUKFFVolume,newKeyframeType:r.Eu.KFTypeVolume},{oldFlag:r.cw.AUKFFEffectAdjustParam1,newKeyframeType:r.Eu.KFTypeEffectAdjustParam1},{oldFlag:r.cw.AUKFFEffectAdjustParam2,newKeyframeType:r.Eu.KFTypeEffectAdjustParam2},{oldFlag:r.cw.AUKFFEffectAdjustParam3,newKeyframeType:r.Eu.KFTypeEffectAdjustParam3}],s=[{oldFlag:r.k6.FKFFValue,newKeyframeType:r.Eu.KFTypeFilter}],l=[{oldFlag:r.FD.SKFFPosition,newKeyframeType:r.Eu.KFTypePositionX},{oldFlag:r.FD.SKFFPosition,newKeyframeType:r.Eu.KFTypePositionY},{oldFlag:r.FD.SKFFScale,newKeyframeType:r.Eu.KFTypeScale},{oldFlag:r.FD.SKFFRotation,newKeyframeType:r.Eu.KFTypeRotation},{oldFlag:r.FD.SKFFGraph,newKeyframeType:r.Eu.KFTypeGraph}],d=[{oldFlag:r.ND.TKFFPosition,newKeyframeType:r.Eu.KFTypePositionX},{oldFlag:r.ND.TKFFScale,newKeyframeType:r.Eu.KFTypeScale},{oldFlag:r.ND.TKFFRotation,newKeyframeType:r.Eu.KFTypeRotation},{oldFlag:r.ND.TKFFBorderWidth,newKeyframeType:r.Eu.KFTypeBorderWidth},{oldFlag:r.ND.TKFFTextAlpha,newKeyframeType:r.Eu.KFTypeTextAlpha},{oldFlag:r.ND.TKFFBackgroundAlpha,newKeyframeType:r.Eu.KFTypeBackgroundAlpha},{oldFlag:r.ND.TKFFShadowAlpha,newKeyframeType:r.Eu.KFTypeShadowAlpha},{oldFlag:r.ND.TKFFShadowSmoothing,newKeyframeType:r.Eu.KFTypeShadowSmoothing},{oldFlag:r.ND.TKFFShadowAngle,newKeyframeType:r.Eu.KFTypeShadowAngle},{oldFlag:r.ND.TKFFShadowPoint,newKeyframeType:r.Eu.KFTypeShadowDistance},{oldFlag:r.ND.TKFFBorderColor,newKeyframeType:r.Eu.KFTypeBorderColor},{oldFlag:r.ND.TKFFTextColor,newKeyframeType:r.Eu.KFTypeTextColor},{oldFlag:r.ND.TKFFShadowColor,newKeyframeType:r.Eu.KFTypeShadowColor},{oldFlag:r.ND.TKFFBackgroundColor,newKeyframeType:r.Eu.KFTypeBackgroundColor},{oldFlag:r.ND.TKFFGraph,newKeyframeType:r.Eu.KFTypeGraph},{oldFlag:r.ND.TKFFGlobalAlpha,newKeyframeType:r.Eu.KFTypeGlobalAlpha},{oldFlag:r.ND.TKFFBloomColor,newKeyframeType:r.Eu.KFTypeBloomColor},{oldFlag:r.ND.TKFFBloomStrength,newKeyframeType:r.Eu.KFTypeBloomStrength},{oldFlag:r.ND.TKFFBloomRange,newKeyframeType:r.Eu.KFTypeBloomRange},{oldFlag:r.ND.TKFFBloomDirX,newKeyframeType:r.Eu.KFTypeBloomDirX},{oldFlag:r.ND.TKFFBloomDirY,newKeyframeType:r.Eu.KFTypeBloomDirY}],c=[{oldFlag:r.n1.VKFFPosition,newKeyframeType:r.Eu.KFTypePositionX},{oldFlag:r.n1.VKFFScale,newKeyframeType:r.Eu.KFTypeScale},{oldFlag:r.n1.VKFFRotation,newKeyframeType:r.Eu.KFTypeRotation},{oldFlag:r.n1.VKFFAlpha,newKeyframeType:r.Eu.KFTypeAlpha},{oldFlag:r.n1.VKFFVolume,newKeyframeType:r.Eu.KFTypeVolume},{oldFlag:r.n1.VKFFLastVolume,newKeyframeType:r.Eu.KFTypeLastVolume},{oldFlag:r.n1.VKFFFilter,newKeyframeType:r.Eu.KFTypeFilter},{oldFlag:r.n1.VKFFBrightness,newKeyframeType:r.Eu.KFTypeBrightness},{oldFlag:r.n1.VKFFContrast,newKeyframeType:r.Eu.KFTypeContrast},{oldFlag:r.n1.VKFFSaturation,newKeyframeType:r.Eu.KFTypeSaturation},{oldFlag:r.n1.VKFFSharpen,newKeyframeType:r.Eu.KFTypeSharpen},{oldFlag:r.n1.VKFFHightLight,newKeyframeType:r.Eu.KFTypeHightLight},{oldFlag:r.n1.VKFFShadow,newKeyframeType:r.Eu.KFTypeShadow},{oldFlag:r.n1.VKFFTemperature,newKeyframeType:r.Eu.KFTypeTemperature},{oldFlag:r.n1.VKFFTone,newKeyframeType:r.Eu.KFTypeHue},{oldFlag:r.n1.VKFFFade,newKeyframeType:r.Eu.KFTypeFade},{oldFlag:r.n1.VKFFLightSensatione,newKeyframeType:r.Eu.KFTypeLightSensatione},{oldFlag:r.n1.VKFFVignetting,newKeyframeType:r.Eu.KFTypeVignetting},{oldFlag:r.n1.VKFFParticle,newKeyframeType:r.Eu.KFTypeParticle},{oldFlag:r.n1.VKFFChromaIntensity,newKeyframeType:r.Eu.KFTypeChromaIntensity},{oldFlag:r.n1.VKFFChromaShadow,newKeyframeType:r.Eu.KFTypeChromaShadow},{oldFlag:r.n1.VKFFCommonMaskPosition,newKeyframeType:r.Eu.KFTypeMaskPostion},{oldFlag:r.n1.VKFFCommonMaskSize,newKeyframeType:r.Eu.KFTypeMaskSize},{oldFlag:r.n1.VKFFCommonMaskRotation,newKeyframeType:r.Eu.KFTypeMaskRotation},{oldFlag:r.n1.VKFFCommonMaskFeather,newKeyframeType:r.Eu.KFTypeMaskFeather},{oldFlag:r.n1.VKFFCommonMaskRoundCorner,newKeyframeType:r.Eu.KFTypeMaskRoundCorner},{oldFlag:r.n1.VKFFLUT,newKeyframeType:r.Eu.KFTypeLUT},{oldFlag:r.n1.VKFFGraph,newKeyframeType:r.Eu.KFTypeGraph},{oldFlag:r.n1.VKFFStretch,newKeyframeType:r.Eu.KFTypeStretch},{oldFlag:r.n1.VKFFSlim,newKeyframeType:r.Eu.KFTypeSlim},{oldFlag:r.n1.VKFFZoom,newKeyframeType:r.Eu.KFTypeZoom},{oldFlag:r.n1.VKFFPrimaryColorWheelIntensity,newKeyframeType:r.Eu.KFTypePrimaryColorWheelIntensity},{oldFlag:r.n1.VKFFLogColorWheelIntensity,newKeyframeType:r.Eu.KFTypeLogColorWheelIntensity},{oldFlag:r.n1.VKFFSmartColorAdjust,newKeyframeType:r.Eu.KFTypeSmartColorAdjust},{oldFlag:r.n1.VKFFEffectAdjustParam1,newKeyframeType:r.Eu.KFTypeEffectAdjustParam1},{oldFlag:r.n1.VKFFEffectAdjustParam2,newKeyframeType:r.Eu.KFTypeEffectAdjustParam2},{oldFlag:r.n1.VKFFEffectAdjustParam3,newKeyframeType:r.Eu.KFTypeEffectAdjustParam3}],u=[{oldFlag:r.cV.MetaTypeBrightness,newKeyframeType:r.Eu.KFTypeBrightness},{oldFlag:r.cV.MetaTypeContrast,newKeyframeType:r.Eu.KFTypeContrast},{oldFlag:r.cV.MetaTypeSaturation,newKeyframeType:r.Eu.KFTypeSaturation},{oldFlag:r.cV.MetaTypeSharpen,newKeyframeType:r.Eu.KFTypeSharpen},{oldFlag:r.cV.MetaTypeHighlight,newKeyframeType:r.Eu.KFTypeHightLight},{oldFlag:r.cV.MetaTypeShadow,newKeyframeType:r.Eu.KFTypeShadow},{oldFlag:r.cV.MetaTypeTemperature,newKeyframeType:r.Eu.KFTypeTemperature},{oldFlag:r.cV.MetaTypeHue,newKeyframeType:r.Eu.KFTypeHue},{oldFlag:r.cV.MetaTypeFade,newKeyframeType:r.Eu.KFTypeFade},{oldFlag:r.cV.MetaTypeLightSensation,newKeyframeType:r.Eu.KFTypeLightSensatione},{oldFlag:r.cV.MetaTypeVignetting,newKeyframeType:r.Eu.KFTypeVignetting},{oldFlag:r.cV.MetaTypeParticle,newKeyframeType:r.Eu.KFTypeParticle},{oldFlag:r.cV.MetaTypeLUT,newKeyframeType:r.Eu.KFTypeLUT},{oldFlag:r.cV.MetaTypePrimaryColorWheels,newKeyframeType:r.Eu.KFTypePrimaryColorWheelIntensity},{oldFlag:r.cV.MetaTypeLogColorWheels,newKeyframeType:r.Eu.KFTypeLogColorWheelIntensity},{oldFlag:r.cV.MetaTypeSmartColorAdjust,newKeyframeType:r.Eu.KFTypeSmartColorAdjust},{oldFlag:r.cV.MetaTypeFilter,newKeyframeType:r.Eu.KFTypeFilter},{oldFlag:r.cV.MetaTypeHsl,newKeyframeType:r.Eu.KFTypeNone}];function m(e){for(let t of u)if(t.oldFlag===e)return t.newKeyframeType;return r.Eu.KFTypeNone}function h(e){return n(e,a)}function f(e){return n(e,o)}function p(e){return n(e,s)}function g(e){return n(e,l)}function y(e){return n(e,d)}function _(e){return n(e,c)}function T(e){return function(e,t,i){let r=[];for(let n=0;n<i;++n)(BigInt(t[n].oldFlag)&e)===BigInt(t[n].oldFlag)&&r.push(t[n].newKeyframeType);return r}(e,c,c.length)}},728592:function(e,t,i){i.d(t,{G4:function(){return l}});var r=i(669686),n=i(150251),a=i(542099);let o={common:["segment_id"],object:{time_range:{type:()=>a.E_}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.segmentId="",this.timeRange=new a.E_,(0,r.tZ)(this,e,s)}}let d={common:["segment_id"],object:{time_range:{type:()=>a.q9}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},168433:function(e,t,i){i.d(t,{YG:function(){return c},_o:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","big_picture","tone_type","mask_bg_pic"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.bigPicture="",this.toneType="",this.maskBgPic="",(0,r.tZ)(this,e,o)}}let l={common:["id","big_picture","tone_type","mask_bg_pic"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},176104:function(e,t,i){i.d(t,{$Z:function(){return f},yi:function(){return u}});var r=i(669686),n=i(150251),a=i(199234),o=i(573149),s=i(124157),l=i(168433);let d={bigint:{version:{}},array:{parts:{type:"object",clsName:()=>a.s8},musics:{type:"object",clsName:()=>s.wG},lv_routines:{type:"common"}},object:{script_info:{type:()=>o.rH},template_digit_human_info:{type:()=>l._o}}},c=(0,r.I2)(d,[]);class u extends n.w8{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d),t}static serialize(e){return(0,r.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e),t}constructor(e={}){super(),this[n.I9]=f,this.version=0n,this.parts=[],this.scriptInfo=new o.rH,this.musics=[],this.templateDigitHumanInfo=new l._o,this.lvRoutines=[],(0,r.tZ)(this,e,c)}}let m={bigint:{version:{}},array:{parts:{type:"object",clsName:()=>a.s8},musics:{type:"object",clsName:()=>s.wG},lv_routines:{type:"common"}},object:{script_info:{type:()=>o.WS},template_digit_human_info:{type:()=>l.YG}}},h=(0,r.I2)(m,[]);class f extends n.u2{static deserialize(e){let t=new f;return(0,r.Tz)(t,e,m,!0),t}static serialize(e){return(0,r.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,r.he)(this,t,m,e,!1,!0),t}constructor(e={}){super(),this[n._n]=u,(0,r.fZ)(this,e,h)}}},573149:function(e,t,i){i.d(t,{WS:function(){return c},rH:function(){return s}});var r=i(669686),n=i(150251);let a={common:["product","selling_points","brand","price","lv_routine_text","choose_duration","promotion","origin_word_num"],bigint:{routine:{},selling_points_num:{},script_id:{}},array:{audience:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.routine=0n,this.product="",this.sellingPoints="",this.sellingPointsNum=0n,this.scriptId=0n,this.brand="",this.price="",this.lvRoutineText="",this.chooseDuration=0,this.audience=[],this.promotion="",this.originWordNum=0,(0,r.tZ)(this,e,o)}}let l={common:["product","selling_points","brand","price","lv_routine_text","choose_duration","promotion","origin_word_num"],bigint:{routine:{},selling_points_num:{},script_id:{}},array:{audience:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},5910:function(e,t,i){i.d(t,{e:function(){return h},uI:function(){return c}});var r=i(602777),n=i(669686),a=i(150251),o=i(769066),s=i(187496);let l={common:["version","post_edit_scene","track_info"],array:{edited_editor:{type:"common"}},object:{post_edit_info:{type:()=>o.Xf},prompt_understanding_info:{type:()=>s.G}}},d=(0,n.I2)(l,[]);class c extends a.w8{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,l),t}static serialize(e){return(0,n.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,l,e),t}constructor(e={}){super(),this[a.I9]=h,this.version="",this.postEditScene=r.a$.AICNone,this.postEditInfo=new o.Xf,this.promptUnderstandingInfo=new s.G,this.trackInfo="",this.editedEditor=[],(0,n.tZ)(this,e,d)}}let u={common:["version","post_edit_scene","track_info"],array:{edited_editor:{type:"common"}},object:{post_edit_info:{type:()=>o.uu},prompt_understanding_info:{type:()=>s.TA}}},m=(0,n.I2)(u,[]);class h extends a.u2{static deserialize(e){let t=new h;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=c,(0,n.fZ)(this,e,m)}}},573106:function(e,t,i){i.d(t,{DB:function(){return c},v0:function(){return s}});var r=i(669686),n=i(150251);let a={common:["music_item_id","mv_template_id","mv_template_name","lyrics_template_id","is_custom_lyrics"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.musicItemId="",this.mvTemplateId="",this.mvTemplateName="",this.lyricsTemplateId="",this.isCustomLyrics=!1,(0,r.tZ)(this,e,o)}}let l={common:["music_item_id","mv_template_id","mv_template_name","lyrics_template_id","is_custom_lyrics"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},880515:function(e,t,i){i.d(t,{ig:function(){return u},mH:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["type","report_params"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=u,this.type=r._s.DraftTypeUnknown,this.reportParams="",(0,n.tZ)(this,e,s)}}let d={common:["type","report_params"]},c=(0,n.I2)(d,[]);class u extends a.u2{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,c)}}},204638:function(e,t,i){i.d(t,{pr:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","submit_id","task_status","source_platform","panel","path","resource_id","aigc_history_id","material_type","aigc_item_id","pin","name"],bigint:{create_time:{},update_time:{},duration:{}}},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.submitId="",this.taskStatus=r.zD.LVVEAiTaskStatusDefault,this.sourcePlatform=r.Z6.AiStoryMaterialSourcePlatformDefault,this.panel=r.mG.AiStoryMaterialPanelDefault,this.path="",this.resourceId="",this.aigcHistoryId="",this.materialType=r.cV.MetaTypeNone,this.aigcItemId="",this.pin=!1,this.createTime=0n,this.updateTime=0n,this.name="",this.duration=0n,(0,a.tZ)(this,e,l)}}let c={common:["id","submit_id","task_status","source_platform","panel","path","resource_id","aigc_history_id","material_type","aigc_item_id","pin","name"],bigint:{create_time:{},update_time:{},duration:{}}},u=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},767282:function(e,t,i){i.d(t,{C8:function(){return l},ni:function(){return u}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["segment_id","ai_writer_type"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=u,this.segmentId="",this.aiWriterType=r.TU.Rewrite,(0,n.tZ)(this,e,s)}}let d={common:["segment_id","ai_writer_type"]},c=(0,n.I2)(d,[]);class u extends a.u2{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,c)}}},187496:function(e,t,i){i.d(t,{G:function(){return l},TA:function(){return u}});var r=i(669686),n=i(150251),a=i(642853);let o={common:["enter_from","prompt_attempt","flow_context"],object:{router_info:{type:()=>a.Kr}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.enterFrom="",this.promptAttempt="",this.routerInfo=new a.Kr,this.flowContext="",(0,r.tZ)(this,e,s)}}let d={common:["enter_from","prompt_attempt","flow_context"],object:{router_info:{type:()=>a.o_}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},319008:function(e,t,i){i.d(t,{OP:function(){return m},iN:function(){return d}});var r=i(669686),n=i(150251),a=i(93744),o=i(830709);let s={object:{task_info:{type:()=>a.sE},server_extra:{type:()=>o.bO}}},l=(0,r.I2)(s,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=m,this.taskInfo=new a.sE,this.serverExtra=new o.bO,(0,r.tZ)(this,e,l)}}let c={object:{task_info:{type:()=>a.ZD},server_extra:{type:()=>o.R5}}},u=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,u)}}},86488:function(e,t,i){i.d(t,{eX:function(){return l},gC:function(){return u}});var r=i(669686),n=i(150251),a=i(827707);let o={common:["music_recommend_json"],array:{text_item_list:{type:"object",clsName:()=>a.qK}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.textItemList=[],this.musicRecommendJson="",(0,r.tZ)(this,e,s)}}let d={common:["music_recommend_json"],array:{text_item_list:{type:"object",clsName:()=>a.qK}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},827707:function(e,t,i){i.d(t,{qK:function(){return s}});var r=i(669686),n=i(150251);let a={common:["segment_id","text","index"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.segmentId="",this.text="",this.index=-1,(0,r.tZ)(this,e,o)}}let l={common:["segment_id","text","index"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},830709:function(e,t,i){i.d(t,{R5:function(){return u},bO:function(){return l}});var r=i(669686),n=i(150251),a=i(86488);let o={common:["template_id","server_context"],object:{server_edit_context:{type:()=>a.eX}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.templateId="",this.serverContext="",this.serverEditContext=new a.eX,(0,r.tZ)(this,e,s)}}let d={common:["template_id","server_context"],object:{server_edit_context:{type:()=>a.gC}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},968266:function(e,t,i){var r=i(669686);i(150251);var n=i(319008),a=i(543005),o=i(68187);(0,r.I2)({common:["version"],array:{speakers:{type:"object",clsName:()=>o.tw},original_speakers:{type:"object",clsName:()=>o.tw},capflow_ids:{type:"common"}},object:{original_info:{type:()=>n.iN},current_info:{type:()=>n.iN},original_draft_info:{type:()=>a.nU}}},[]);(0,r.I2)({common:["version"],array:{speakers:{type:"object",clsName:()=>o.tw},original_speakers:{type:"object",clsName:()=>o.tw},capflow_ids:{type:"common"}},object:{original_info:{type:()=>n.OP},current_info:{type:()=>n.OP},original_draft_info:{type:()=>a.ob}}},[])},565875:function(e,t,i){i.d(t,{df:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","source","url"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.source=0,this.url="",(0,r.tZ)(this,e,o)}}let l={common:["id","source","url"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},820689:function(e,t,i){i.d(t,{Uz:function(){return s}});var r=i(669686),n=i(150251);let a={common:["type","gear"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.type="",this.gear=0,(0,r.tZ)(this,e,o)}}let l={common:["type","gear"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},187200:function(e,t,i){i.d(t,{Re:function(){return c},mx:function(){return s}});var r=i(669686),n=i(150251);let a={common:["benefit_log_id","benefit_log_extra","benefit_type"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.benefitLogId="",this.benefitLogExtra="",this.benefitType="",(0,r.tZ)(this,e,o)}}let l={common:["benefit_log_id","benefit_log_extra","benefit_type"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},76619:function(e,t,i){i.d(t,{fy:function(){return u},nt:function(){return l}});var r=i(669686),n=i(150251),a=i(45021);let o={common:["keyword_capital","keyword_supersize","keyword_isolation","keyword_isolation_supersize"],array:{style_unbundling:{type:"object",clsName:()=>a.sH}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.keywordCapital="",this.keywordSupersize=1,this.keywordIsolation="",this.keywordIsolationSupersize=1,this.styleUnbundling=[],(0,r.tZ)(this,e,s)}}let d={common:["keyword_capital","keyword_supersize","keyword_isolation","keyword_isolation_supersize"],array:{style_unbundling:{type:"object",clsName:()=>a.sH}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},908510:function(e,t,i){i.d(t,{Tg:function(){return s},kI:function(){return c}});var r=i(669686),n=i(150251);let a={common:["value","from"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.value="",this.from="",(0,r.tZ)(this,e,o)}}let l={common:["value","from"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},238830:function(e,t,i){i.d(t,{bX:function(){return c},tL:function(){return h}});var r=i(669686),n=i(150251),a=i(889803),o=i(883501),s=i(608757);let l={common:["rotation","alpha"],object:{scale:{type:()=>a.Ci},transform:{type:()=>o.wx},flip:{type:()=>s.BW}}},d=(0,r.I2)(l,[]);class c extends n.w8{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=h,this.scale=new a.Ci,this.rotation=0,this.transform=new o.wx,this.flip=new s.BW,this.alpha=1,(0,r.tZ)(this,e,d)}}let u={common:["rotation","alpha"],object:{scale:{type:()=>a.o_},transform:{type:()=>o.jP},flip:{type:()=>s.A}}},m=(0,r.I2)(u,[]);class h extends n.u2{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=c,(0,r.fZ)(this,e,m)}}},468019:function(e,t,i){i.d(t,{Wr:function(){return s},n7:function(){return c}});var r=i(669686),n=i(150251);let a={common:["target_feature_path","source_feature_path","target_image_path"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.targetFeaturePath="",this.sourceFeaturePath="",this.targetImagePath="",(0,r.tZ)(this,e,o)}}let l={common:["target_feature_path","source_feature_path","target_image_path"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},908099:function(e,t,i){i.d(t,{P8:function(){return s},an:function(){return c}});var r=i(669686),n=i(150251);let a={common:["red","green","blue","luma","saturation"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.red=0,this.green=0,this.blue=0,this.luma=0,this.saturation=0,(0,r.tZ)(this,e,o)}}let l={common:["red","green","blue","luma","saturation"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},570435:function(e,t,i){var r=i(669686);i(150251);(0,r.I2)({array:{commercial_music_category_ids:{type:"common"}}},[]);(0,r.I2)({array:{commercial_music_category_ids:{type:"common"}}},[])},852340:function(e,t,i){i.d(t,{$2:function(){return u}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(760554),l=i(425325);let d={common:["id","curveType","string_value","graphID"],bigint:{time_offset:{}},array:{values:{type:"common"}},object:{left_control:{type:()=>s.KS},right_control:{type:()=>s.KS},graph:{type:()=>l.kJ,nullable:!0}}},c=(0,a.I2)(d,["graph"]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,d),t}static serialize(e){return(0,a.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,d,e,["id"]),t.graph=this.graph?this.graph.clone(e):void 0,t}constructor(e={}){super(),this[o.I9]=f,this.id=(0,n.p)(),this.curveType=r.wH.KeyframeCurveTypeLine,this.timeOffset=0n,this.leftControl=new s.KS,this.rightControl=new s.KS,this.values=[],this.stringValue="",this.graphId="",(0,a.tZ)(this,e,c)}}let m={common:["id","curveType","string_value","graphID"],bigint:{time_offset:{}},array:{values:{type:"common"}},object:{left_control:{type:()=>s.Ly},right_control:{type:()=>s.Ly},graph:{type:()=>l.tf,nullable:!0}}},h=(0,a.I2)(m,["graph"]);class f extends o.u2{static deserialize(e){let t=new f;return(0,a.Tz)(t,e,m,!0),t}static serialize(e){return(0,a.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,a.he)(this,t,m,e,["id"],!0),null!==this.graph&&void 0!==this.graph&&(t.graph=this.graph?this.graph.clone(e):void 0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,h)}}},382068:function(e,t,i){i.d(t,{ko:function(){return d}});var r=i(287165),n=i(669686),a=i(150251),o=i(852340);let s={common:["id","material_id","property_type"],array:{keyframe_list:{type:"object",clsName:()=>o.$2}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[a.I9]=m,this.id=(0,r.p)(),this.materialId="",this.propertyType="None",this.keyframeList=[],(0,n.tZ)(this,e,l)}}let c={common:["id","material_id","property_type"],array:{keyframe_list:{type:"object",clsName:()=>o.$2}}},u=(0,n.I2)(c,[]);class m extends a.u2{static deserialize(e){let t=new m;return(0,n.Tz)(t,e,c,!0),t}static serialize(e){return(0,n.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,n.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,u)}}},123246:function(e,t,i){i.d(t,{LD:function(){return c},u1:function(){return s}});var r=i(669686),n=i(150251);let a={common:["longitude","latitude","shoot_time"],bigint:{width:{},height:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.width=0n,this.height=0n,this.longitude=0,this.latitude=0,this.shootTime="",(0,r.tZ)(this,e,o)}}let l={common:["longitude","latitude","shoot_time"],bigint:{width:{},height:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},677655:function(e,t,i){i.d(t,{gi:function(){return d}});var r=i(669686),n=i(150251),a=i(640233),o=i(123246);let s={common:["type","source","format","id"],bigint:{duration:{}},object:{video_meta_data:{type:()=>a.W6},image_meta_data:{type:()=>o.u1}}},l=(0,r.I2)(s,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=m,this.type="",this.source="",this.format="",this.id="",this.duration=0n,this.videoMetaData=new a.W6,this.imageMetaData=new o.u1,(0,r.tZ)(this,e,l)}}let c={common:["type","source","format","id"],bigint:{duration:{}},object:{video_meta_data:{type:()=>a.Aw},image_meta_data:{type:()=>o.LD}}},u=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,u)}}},534931:function(e,t,i){i.d(t,{Lh:function(){return s},Ms:function(){return c}});var r=i(669686),n=i(150251);let a={common:["title","screen_info","time_range","need_order","is_business_video","product_name","sell_point"],bigint:{video_duration:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.title="",this.screenInfo="",this.videoDuration=0n,this.timeRange="",this.needOrder=!1,this.isBusinessVideo=!1,this.productName="",this.sellPoint="",(0,r.tZ)(this,e,o)}}let l={common:["title","screen_info","time_range","need_order","is_business_video","product_name","sell_point"],bigint:{video_duration:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},909809:function(e,t,i){i.d(t,{Ir:function(){return s},ai:function(){return c}});var r=i(669686),n=i(150251);let a={common:["room_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.roomId="",(0,r.tZ)(this,e,o)}}let l={common:["room_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},162015:function(e,t,i){i.d(t,{Jx:function(){return s},wb:function(){return c}});var r=i(669686),n=i(150251);let a={common:["cover_template_id","cover_template_category","cover_template_category_id"],array:{cover_template_material_ids:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.coverTemplateId="",this.coverTemplateCategory="",this.coverTemplateCategoryId="",this.coverTemplateMaterialIds=[],(0,r.tZ)(this,e,o)}}let l={common:["cover_template_id","cover_template_category","cover_template_category_id"],array:{cover_template_material_ids:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},918783:function(e,t,i){i.d(t,{Y9:function(){return c},yO:function(){return h}});var r=i(602777),n=i(669686),a=i(150251),o=i(162015),s=i(991913);let l={common:["type","cover_draft_id","sub_type"],object:{cover_template:{type:()=>o.Jx,nullable:!0},web_cover_info:{type:()=>s.ic,nullable:!0}}},d=(0,n.I2)(l,[]);class c extends a.w8{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,l),t}static serialize(e){return(0,n.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,l,e),t}constructor(e={}){super(),this[a.I9]=h,this.type=r._6.CoverTypeFrame,this.subType=r.SJ.CoverSubTypeNone,(0,n.tZ)(this,e,d)}}let u={common:["type","cover_draft_id","sub_type"],object:{cover_template:{type:()=>o.wb,nullable:!0},web_cover_info:{type:()=>s.Wl,nullable:!0}}},m=(0,n.I2)(u,[]);class h extends a.u2{static deserialize(e){let t=new h;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=c,(0,n.fZ)(this,e,m)}}},182248:function(e,t,i){i.d(t,{$m:function(){return c},H$:function(){return s}});var r=i(669686),n=i(150251);let a={common:["path"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.path="",(0,r.tZ)(this,e,o)}}let l={common:["path"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},589416:function(e,t,i){i.d(t,{mJ:function(){return c},re:function(){return s}});var r=i(669686),n=i(150251);let a={common:["speed","tone_type","tone_category_id","tone_category_name","tone_second_category_id","tone_second_category_name","tone_effect_id","tone_effect_name","tone_platform","tone_emotion_name_key","tone_emotion_style","tone_emotion_role","tone_emotion_selection","tone_emotion_scale","resource_id","speaker_id","is_ugc","is_ai_clone_tone","is_ai_clone_tone_post","tts_task_id","tts_generate_scene"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.speed=0,this.toneType="",this.toneCategoryId="",this.toneCategoryName="",this.toneSecondCategoryId="",this.toneSecondCategoryName="",this.toneEffectId="",this.toneEffectName="",this.tonePlatform="",this.toneEmotionNameKey="",this.toneEmotionStyle="",this.toneEmotionRole="",this.toneEmotionSelection="",this.toneEmotionScale=0,this.resourceId="",this.speakerId="",this.isUgc=!1,this.isAiCloneTone=!1,this.isAiCloneTonePost=!1,this.ttsTaskId="",this.ttsGenerateScene="",(0,r.tZ)(this,e,o)}}let l={common:["speed","tone_type","tone_category_id","tone_category_name","tone_second_category_id","tone_second_category_name","tone_effect_id","tone_effect_name","tone_platform","tone_emotion_name_key","tone_emotion_style","tone_emotion_role","tone_emotion_selection","tone_emotion_scale","resource_id","speaker_id","is_ugc","is_ai_clone_tone","is_ai_clone_tone_post","tts_task_id","tts_generate_scene"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},834072:function(e,t,i){i.d(t,{Bh:function(){return l},pB:function(){return u}});var r=i(669686),n=i(150251),a=i(137414);let o={array:{music_id_map:{type:"object",clsName:()=>a.fu}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.musicIdMap=[],(0,r.tZ)(this,e,s)}}let d={array:{music_id_map:{type:"object",clsName:()=>a.fu}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},88874:function(e,t,i){i.d(t,{rn:function(){return l}});var r=i(669686),n=i(150251),a=i(670908);let o={common:["id","target"],object:{position:{type:()=>a.HH}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.id="",this.target="",this.position=new a.HH,(0,r.tZ)(this,e,s)}}let d={common:["id","target"],object:{position:{type:()=>a.T3}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},835056:function(e,t,i){i.d(t,{ov:function(){return c},uC:function(){return s}});var r=i(669686),n=i(150251);let a={common:["target"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.target="",(0,r.tZ)(this,e,o)}}let l={common:["target"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},185236:function(e,t,i){i.d(t,{VB:function(){return s}});var r=i(669686),n=i(150251);let a={common:["name","value","default_value"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.name="",this.value=0,this.defaultValue=0,(0,r.tZ)(this,e,o)}}let l={common:["name","value","default_value"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},430071:function(e,t,i){i.d(t,{m4:function(){return l}});var r=i(669686),n=i(150251),a=i(185236);let o={common:["face_id","enable"],array:{adjust_params:{type:"object",clsName:()=>a.VB},disable_part:{type:"common"}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.faceId="",this.enable=!0,this.adjustParams=[],this.disablePart=[],(0,r.tZ)(this,e,s)}}let d={common:["face_id","enable"],array:{adjust_params:{type:"object",clsName:()=>a.VB},disable_part:{type:"common"}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},719314:function(e,t,i){i.d(t,{an:function(){return s},ox:function(){return c}});var r=i(669686),n=i(150251);let a={common:["intensity","upper","bottom"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.intensity=0,this.upper=.66,this.bottom=.33,(0,r.tZ)(this,e,o)}}let l={common:["intensity","upper","bottom"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},346038:function(e,t,i){i.d(t,{Tk:function(){return s},qB:function(){return c}});var r=i(669686),n=i(150251);let a={common:["intensity","x","y","radius"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.intensity=0,this.x=.5,this.y=.5,this.radius=.165,(0,r.tZ)(this,e,o)}}let l={common:["intensity","x","y","radius"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},470919:function(e,t,i){i.d(t,{ph:function(){return s},zd:function(){return c}});var r=i(669686),n=i(150251);let a={common:["angle","mode","style"],array:{color:{type:"common"},alpha:{type:"common"},percent:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.color=[],this.alpha=[],this.percent=[],this.angle=90,this.mode="all",this.style="linear",(0,r.tZ)(this,e,o)}}let l={common:["angle","mode","style"],array:{color:{type:"common"},alpha:{type:"common"},percent:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},214802:function(e,t,i){i.d(t,{CI:function(){return u},cz:function(){return l}});var r=i(669686),n=i(150251),a=i(238830);let o={object:{clip:{type:()=>a.bX}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.clip=new a.bX,(0,r.tZ)(this,e,s)}}let d={object:{clip:{type:()=>a.tL}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},445180:function(e,t,i){i.d(t,{Nl:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","type","value"],bigint:{time_offset:{},flags:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.type="filter",this.timeOffset=0n,this.flags=-1n,this.value=1,(0,r.tZ)(this,e,o)}}let l={common:["id","type","value"],bigint:{time_offset:{},flags:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},579399:function(e,t,i){i.d(t,{QC:function(){return c}});var r=i(669686),n=i(150251),a=i(883501),o=i(889803),s=i(425325);let l={common:["id","type","rotation"],bigint:{time_offset:{},flags:{}},object:{position:{type:()=>a.wx},scale:{type:()=>o.Ci},graph:{type:()=>s.kJ,nullable:!0}}},d=(0,r.I2)(l,[]);class c extends n.w8{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=h,this.id="",this.type="sticker",this.timeOffset=0n,this.flags=-1n,this.position=new a.wx,this.scale=new o.Ci,this.rotation=0,(0,r.tZ)(this,e,d)}}let u={common:["id","type","rotation"],bigint:{time_offset:{},flags:{}},object:{position:{type:()=>a.jP},scale:{type:()=>o.o_},graph:{type:()=>s.tf,nullable:!0}}},m=(0,r.I2)(u,[]);class h extends n.u2{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=c,(0,r.fZ)(this,e,m)}}},39498:function(e,t,i){i.d(t,{oz:function(){return c},z_:function(){return s}});var r=i(669686),n=i(150251);let a={common:["avg_loudness","peak_loudness"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.avgLoudness=0,this.peakLoudness=0,(0,r.tZ)(this,e,o)}}let l={common:["avg_loudness","peak_loudness"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},578592:function(e,t,i){i.d(t,{Ox:function(){return l}});var r=i(669686),n=i(150251),a=i(53823);let o={common:["lyric_track_id"],object:{sticker:{type:()=>a.XX}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.lyricTrackId=0,this.sticker=new a.XX,(0,r.tZ)(this,e,s)}}let d={common:["lyric_track_id"],object:{sticker:{type:()=>a.Ev}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},939402:function(e,t,i){i.d(t,{xj:function(){return l}});var r=i(669686),n=i(150251),a=i(776278);let o={common:["group_id"],array:{segments:{type:"object",clsName:()=>a.uh}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.groupId="",this.segments=[],(0,r.tZ)(this,e,s)}}let d={common:["group_id"],array:{segments:{type:"object",clsName:()=>a.uh}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},791007:function(e,t,i){i.d(t,{YB:function(){return s}});var r=i(669686),n=i(150251);let a={common:["panel_id","resource_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.panelId="",this.resourceId="",(0,r.tZ)(this,e,o)}}let l={common:["panel_id","resource_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},946917:function(e,t,i){i.d(t,{An:function(){return s},oy:function(){return c}});var r=i(669686),n=i(150251);let a={common:["resource_id","resource_name","panel","effect_id","path","category_id","category_name","request_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.resourceId="",this.resourceName="",this.panel="",this.effectId="",this.path="",this.categoryId="",this.categoryName="",this.requestId="",(0,r.tZ)(this,e,o)}}let l={common:["resource_id","resource_name","panel","effect_id","path","category_id","category_name","request_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},217849:function(e,t,i){i.d(t,{H:function(){return c},W$:function(){return s}});var r=i(669686),n=i(150251);let a={common:["width","height","centerX","centerY","rotation","feather","expansion","roundCorner","invert","aspectRatio"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.width=0,this.height=0,this.centerX=0,this.centerY=0,this.rotation=0,this.feather=0,this.expansion=0,this.roundCorner=0,this.invert=!1,this.aspectRatio=1,(0,r.tZ)(this,e,o)}}let l={common:["width","height","centerX","centerY","rotation","feather","expansion","roundCorner","invert","aspectRatio"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},908301:function(e,t,i){i.d(t,{PA:function(){return h},ZP:function(){return c}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(401611);let l={common:["id","type","multi_language_current"],array:{animations:{type:"object",clsName:()=>s.FJ}}},d=(0,a.I2)(l,[]);class c extends o.w8{static deserialize(e){let t=new c;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeAnimation,this.animations=[],this.multiLanguageCurrent=r.Hw.MultiLanguageNone,(0,a.tZ)(this,e,d)}}let u={common:["id","type","multi_language_current"],array:{animations:{type:"object",clsName:()=>s.FJ}}},m=(0,a.I2)(u,[]);class h extends o.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=c,(0,a.fZ)(this,e,m)}}},290703:function(e,t,i){i.d(t,{Ld:function(){return d},rE:function(){return m}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","type","enable_balance","peak_loudness","average_loudness","target_loudness"]},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.type=r.cV.MetaTypeAudioBalance,this.enableBalance=!1,this.peakLoudness=0,this.averageLoudness=0,this.targetLoudness=0,(0,a.tZ)(this,e,l)}}let c={common:["id","type","enable_balance","peak_loudness","average_loudness","target_loudness"]},u=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},254574:function(e,t,i){i.d(t,{ZD:function(){return c},yB:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(937379);let l={common:["id","type","name","path","category_name","music_id","text_id","tone_type","source_platform","video_id","effect_id","resource_id","third_resource_id","category_id","intensifies_path","formula_id","check_flag","team_id","local_material_id","tone_speaker","tone_effect_id","tone_effect_name","tone_platform","tone_category_id","tone_category_name","tone_second_category_id","tone_second_category_name","tone_emotion_name_key","tone_emotion_style","tone_emotion_role","tone_emotion_selection","tone_emotion_scale","request_id","query","search_id","sound_separate_type","is_text_edit_overdub","is_ugc","is_ai_clone_tone","is_ai_clone_tone_post","source_from","copyright_limit_type","aigc_history_id","aigc_item_id","music_source","pgc_id","pgc_name","ai_music_type","lyric_type","tts_task_id","tts_generate_scene","ai_music_generate_scene"],bigint:{duration:{},app_id:{}},array:{wave_points:{type:"common"}},object:{similiar_music_info:{type:()=>s.uk}}},d=(0,a.I2)(l,[]);class c extends o.w8{static deserialize(e){let t=new c;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeNone,this.name="",this.duration=0n,this.path="",this.categoryName="",this.wavePoints=[],this.musicId="",this.appId=0n,this.textId="",this.toneType="",this.sourcePlatform=r.QZ.AudioPlatformLibrary,this.videoId="",this.effectId="",this.resourceId="",this.thirdResourceId="",this.categoryId="",this.intensifiesPath="",this.formulaId="",this.checkFlag=1,this.teamId="",this.localMaterialId="",this.toneSpeaker="",this.toneEffectId="",this.toneEffectName="",this.tonePlatform="",this.toneCategoryId="",this.toneCategoryName="",this.toneSecondCategoryId="",this.toneSecondCategoryName="",this.toneEmotionNameKey="",this.toneEmotionStyle="",this.toneEmotionRole="",this.toneEmotionSelection="",this.toneEmotionScale=0,this.requestId="",this.query="",this.searchId="",this.soundSeparateType="",this.isTextEditOverdub=!1,this.isUgc=!1,this.isAiCloneTone=!1,this.isAiCloneTonePost=!1,this.sourceFrom="",this.copyrightLimitType=r.OW.AudioCopyrightLimitTypeNone,this.aigcHistoryId="",this.aigcItemId="",this.musicSource="",this.pgcId="",this.pgcName="",this.similiarMusicInfo=new s.uk,this.aiMusicType=r.QS.AIMusicTypeNone,this.lyricType=r.Xl.AIMusicLyricTypeNone,this.ttsTaskId="",this.ttsGenerateScene="",this.aiMusicGenerateScene=r.MB.AIMusicGenerateSceneAIMusic,(0,a.tZ)(this,e,d)}}let u={common:["id","type","name","path","category_name","music_id","text_id","tone_type","source_platform","video_id","effect_id","resource_id","third_resource_id","category_id","intensifies_path","formula_id","check_flag","team_id","local_material_id","tone_speaker","tone_effect_id","tone_effect_name","tone_platform","tone_category_id","tone_category_name","tone_second_category_id","tone_second_category_name","tone_emotion_name_key","tone_emotion_style","tone_emotion_role","tone_emotion_selection","tone_emotion_scale","request_id","query","search_id","sound_separate_type","is_text_edit_overdub","is_ugc","is_ai_clone_tone","is_ai_clone_tone_post","source_from","copyright_limit_type","aigc_history_id","aigc_item_id","music_source","pgc_id","pgc_name","ai_music_type","lyric_type","tts_task_id","tts_generate_scene","ai_music_generate_scene"],bigint:{duration:{},app_id:{}},array:{wave_points:{type:"common"}},object:{similiar_music_info:{type:()=>s.HF}}},m=(0,a.I2)(u,[]);class h extends o.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=c,(0,a.fZ)(this,e,m)}}},276583:function(e,t,i){i.d(t,{EI:function(){return u},oG:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["resource_id","third_resource_id","resource_name","category_id","category_name","effect_id","request_id","path","is_new","source_platform"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=u,this.resourceId="",this.thirdResourceId="",this.resourceName="",this.categoryId="",this.categoryName="",this.effectId="",this.requestId="",this.path="",this.isNew=!1,this.sourcePlatform=r.nj.EffectPlatformArtist,(0,n.tZ)(this,e,s)}}let d={common:["resource_id","third_resource_id","resource_name","category_id","category_name","effect_id","request_id","path","is_new","source_platform"]},c=(0,n.I2)(d,[]);class u extends a.u2{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,c)}}},755118:function(e,t,i){i.d(t,{rD:function(){return s}});var r=i(669686),n=i(150251);let a={common:["resource_id","effect_id","resource_name","category_id","category_name","segment_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.resourceId="",this.effectId="",this.resourceName="",this.categoryId="",this.categoryName="",this.segmentId="",(0,r.tZ)(this,e,o)}}let l={common:["resource_id","effect_id","resource_name","category_id","category_name","segment_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},64144:function(e,t,i){i.d(t,{Q$:function(){return m},zZ:function(){return p}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(217849),l=i(642982),d=i(774129);let c={common:["id","type","category","is_old_version","resource_id","constant_material_id","name","resource_type","path","position_info","platform","loader_work_space","track_segment","source_platform"],object:{config:{type:()=>s.W$},text_config:{type:()=>l.XN},contour_path:{type:()=>d.nI,nullable:!0}}},u=(0,a.I2)(c,[]);class m extends o.w8{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c),t}static serialize(e){return(0,a.o8)(e,c)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"]),t}constructor(e={}){super(),this[o.I9]=p,this.id=(0,n.p)(),this.type=r.cV.MetaTypeVideoMask,this.category="",this.isOldVersion=!1,this.resourceId="",this.constantMaterialId="",this.name="",this.resourceType="",this.path="",this.positionInfo="",this.config=new s.W$,this.textConfig=new l.XN,this.platform="all",this.loaderWorkSpace="",this.trackSegment="",this.sourcePlatform=r.nj.EffectPlatformLoki,(0,a.tZ)(this,e,u)}}let h={common:["id","type","category","is_old_version","resource_id","constant_material_id","name","resource_type","path","position_info","platform","loader_work_space","track_segment","source_platform"],object:{config:{type:()=>s.H},text_config:{type:()=>l.VW},contour_path:{type:()=>d.P3,nullable:!0}}},f=(0,a.I2)(h,[]);class p extends o.u2{static deserialize(e){let t=new p;return(0,a.Tz)(t,e,h,!0),t}static serialize(e){return(0,a.o8)(e,h,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;return(0,a.he)(this,t,h,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=m,(0,a.fZ)(this,e,f)}}},639208:function(e,t,i){i.d(t,{N:function(){return c},lU:function(){return s}});var r=i(669686),n=i(150251);let a={common:["path","resource_id","effect_id","effect_name","category_id","category_name","panel","source_platform"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.path="",this.resourceId="",this.effectId="",this.effectName="",this.categoryId="",this.categoryName="",this.panel="",this.sourcePlatform=0,(0,r.tZ)(this,e,o)}}let l={common:["path","resource_id","effect_id","effect_name","category_id","category_name","panel","source_platform"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},923001:function(e,t,i){i.d(t,{Gm:function(){return m},Ly:function(){return d}});var r=i(669686),n=i(150251),a=i(620675),o=i(153730);let s={common:["enable","alpha","style","round_radius","width","height","vertical_offset","horizontal_offset"],array:{strokes:{type:"object",clsName:()=>o.qe}},object:{color:{type:()=>a.tP}}},l=(0,r.I2)(s,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=m,this.enable=!1,this.color=new a.tP,this.alpha=1,this.style=0,this.roundRadius=0,this.width=.14,this.height=.14,this.verticalOffset=0,this.horizontalOffset=0,this.strokes=[],(0,r.tZ)(this,e,l)}}let c={common:["enable","alpha","style","round_radius","width","height","vertical_offset","horizontal_offset"],array:{strokes:{type:"object",clsName:()=>o.qe}},object:{color:{type:()=>a.w2}}},u=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,u)}}},988210:function(e,t,i){i.d(t,{Xk:function(){return l},ah:function(){return u}});var r=i(669686),n=i(150251),a=i(620675);let o={common:["alpha"],object:{color:{type:()=>a.tP}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.color=new a.tP,this.alpha=1,(0,r.tZ)(this,e,s)}}let d={common:["alpha"],object:{color:{type:()=>a.w2}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},153730:function(e,t,i){i.d(t,{qe:function(){return l}});var r=i(669686),n=i(150251),a=i(620675);let o={common:["enable","alpha","width"],object:{color:{type:()=>a.tP}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.enable=!1,this.color=new a.tP,this.alpha=1,this.width=.2,(0,r.tZ)(this,e,s)}}let d={common:["enable","alpha","width"],object:{color:{type:()=>a.w2}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},583109:function(e,t,i){i.d(t,{pj:function(){return f},si:function(){return u}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(738402),l=i(214802);let d={common:["type","id","material_id"],object:{background:{type:()=>s.Kt,nullable:!0},foreground:{type:()=>l.cz}}},c=(0,a.I2)(d,[]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,d),t}static serialize(e){return(0,a.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,d,e,["id"]),t}constructor(e={}){super(),this[o.I9]=f,this.type=r.cV.MetaTypeGreenScreen,this.id=(0,n.p)(),this.materialId="",this.foreground=new l.cz,(0,a.tZ)(this,e,c)}}let m={common:["type","id","material_id"],object:{background:{type:()=>s.R5,nullable:!0},foreground:{type:()=>l.CI}}},h=(0,a.I2)(m,[]);class f extends o.u2{static deserialize(e){let t=new f;return(0,a.Tz)(t,e,m,!0),t}static serialize(e){return(0,a.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,a.he)(this,t,m,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,h)}}},750581:function(e,t,i){i.d(t,{pr:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","constant_material_id","hsl_color_type","hue","saturation","lightness","interacting","version","path","type","lumi_hub_path","custom_color","resource_id","source_platform","visible"]},l=(0,a.I2)(s,["visible"]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t.visible=this.visible,t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.constantMaterialId="",this.hslColorType=0,this.hue=0,this.saturation=0,this.lightness=0,this.interacting=!1,this.version="",this.path="",this.type=r.cV.MetaTypeHsl,this.lumiHubPath="",this.customColor="",this.resourceId="",this.sourcePlatform=r.nj.EffectPlatformLoki,this.visible=!0,(0,a.tZ)(this,e,l)}}let c={common:["id","constant_material_id","hsl_color_type","hue","saturation","lightness","interacting","version","path","type","lumi_hub_path","custom_color","resource_id","source_platform","visible"]},u=(0,a.I2)(c,["visible"]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),null!==this.visible&&void 0!==this.visible&&(t.visible=this.visible),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},973815:function(e,t,i){i.d(t,{_Z:function(){return c},mF:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(245062);let l={common:["id","type","path","width","height","initial_scale","check_flag"],object:{combo_info:{type:()=>s.$y}}},d=(0,a.I2)(l,[]);class c extends o.w8{static deserialize(e){let t=new c;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeImage,this.path="",this.width=0,this.height=0,this.initialScale=0,this.comboInfo=new s.$y,this.checkFlag=1,(0,a.tZ)(this,e,d)}}let u={common:["id","type","path","width","height","initial_scale","check_flag"],object:{combo_info:{type:()=>s.PZ}}},m=(0,a.I2)(u,[]);class h extends o.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=c,(0,a.fZ)(this,e,m)}}},269289:function(e,t,i){i.d(t,{y:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","constant_material_id","light_source_type","action_object","color","alpha","z","x","y","intensity","specular_light_intensity","reflectance","radius","color_changed_speed","xy_changed_speed","intensity_changed_speed"]},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.constantMaterialId="",this.lightSourceType=r.XC.PointLight,this.actionObject=r.DT.AllObject,this.color="",this.alpha=1,this.z=0,this.x=0,this.y=0,this.intensity=0,this.specularLightIntensity=0,this.reflectance=0,this.radius=0,this.colorChangedSpeed=0,this.xyChangedSpeed=0,this.intensityChangedSpeed=0,(0,a.tZ)(this,e,l)}}let c={common:["id","constant_material_id","light_source_type","action_object","color","alpha","z","x","y","intensity","specular_light_intensity","reflectance","radius","color_changed_speed","xy_changed_speed","intensity_changed_speed"]},u=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},247795:function(e,t,i){i.d(t,{XW:function(){return m},yu:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","type","meta_type","res_path","res_text","error_path","error_text"]},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.type=r.cV.MetaTypePlaceholderInfo,this.metaType=r.cV.MetaTypeNone,this.resPath="",this.resText="",this.errorPath="",this.errorText="",(0,a.tZ)(this,e,l)}}let c={common:["id","type","meta_type","res_path","res_text","error_path","error_text"]},u=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},519769:function(e,t,i){i.d(t,{sV:function(){return d}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","name","type","material_resource_id"]},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.name="",this.type=r.cV.MetaTypeNone,this.materialResourceId="",(0,a.tZ)(this,e,l)}}let c={common:["id","name","type","material_resource_id"]},u=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},213030:function(e,t,i){i.d(t,{jU:function(){return d},tp:function(){return m}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251);let s={common:["id","type","is_denoise","denoise_mode","denoise_rate","path","sami_name","sami_version","sami_type"]},l=(0,a.I2)(s,[]);class d extends o.w8{static deserialize(e){let t=new d;return(0,a.Tz)(t,e,s),t}static serialize(e){return(0,a.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,a.he)(this,t,s,e,["id"]),t}constructor(e={}){super(),this[o.I9]=m,this.id=(0,n.p)(),this.type=r.cV.MetaTypeRealtimeDenoise,this.isDenoise=!1,this.denoiseMode=1,this.denoiseRate=1,this.path="",this.samiName="denoise_v2",this.samiVersion="1.0",this.samiType=0,(0,a.tZ)(this,e,l)}}let c={common:["id","type","is_denoise","denoise_mode","denoise_rate","path","sami_name","sami_version","sami_type"]},u=(0,a.I2)(c,[]);class m extends o.u2{static deserialize(e){let t=new m;return(0,a.Tz)(t,e,c,!0),t}static serialize(e){return(0,a.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,a.he)(this,t,c,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=d,(0,a.fZ)(this,e,u)}}},959026:function(e,t,i){i.d(t,{Gg:function(){return f},XY:function(){return u}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(269289),l=i(180942);let d={common:["id","type","category_id","preset_id","resource_id","resource_name","resource_path","light_mode","albedo_color","albedo_alpha","albedo_intensity","albedo_rate","glow_intensity","cache_path","source_platform"],array:{light_sources:{type:"object",clsName:()=>s.y}},object:{cache_time_range:{type:()=>l.tn,nullable:!0}}},c=(0,a.I2)(d,[]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,d),t}static serialize(e){return(0,a.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,d,e,["id"]),t}constructor(e={}){super(),this[o.I9]=f,this.id=(0,n.p)(),this.type=r.cV.MetaTypeSmartRelight,this.categoryId="",this.presetId="",this.resourceId="",this.resourceName="",this.resourcePath="",this.lightMode=0,this.lightSources=[],this.albedoColor="",this.albedoAlpha=1,this.albedoIntensity=1,this.albedoRate=5,this.glowIntensity=1,this.cachePath="",this.sourcePlatform=r.nj.EffectPlatformLoki,(0,a.tZ)(this,e,c)}}let m={common:["id","type","category_id","preset_id","resource_id","resource_name","resource_path","light_mode","albedo_color","albedo_alpha","albedo_intensity","albedo_rate","glow_intensity","cache_path","source_platform"],array:{light_sources:{type:"object",clsName:()=>s.y}},object:{cache_time_range:{type:()=>l.ze,nullable:!0}}},h=(0,a.I2)(m,[]);class f extends o.u2{static deserialize(e){let t=new f;return(0,a.Tz)(t,e,m,!0),t}static serialize(e){return(0,a.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,a.he)(this,t,m,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,h)}}},280283:function(e,t,i){i.d(t,{Ug:function(){return c},Zk:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(5497);let l={common:["id","type","mode","speed"],object:{curve_speed:{type:()=>s.yP,nullable:!0}}},d=(0,a.I2)(l,[]);class c extends o.w8{static deserialize(e){let t=new c;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=h,this.id=(0,n.p)(),this.type=r.cV.MetaTypeSpeed,this.mode=r.yY.SpeedModeNormal,this.speed=1,(0,a.tZ)(this,e,d)}}let u={common:["id","type","mode","speed"],object:{curve_speed:{type:()=>s._X,nullable:!0}}},m=(0,a.I2)(u,[]);class h extends o.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=c,(0,a.fZ)(this,e,m)}}},488071:function(e,t,i){i.d(t,{ed:function(){return w},jG:function(){return T}});var r=i(602777),n=i(287165),a=i(223729),o=i(669686),s=i(879566),l=i(150251),d=i(182570),c=i(245062),u=i(276583),m=i(510742),h=i(840700),f=i(553859),p=i(527347),g=i(946917);let y={common:["recognize_task_id","id","name","type","content","base_content","global_alpha","background_color","background_alpha","background_style","layer_weight","letter_spacing","line_spacing","has_shadow","shadow_color","shadow_alpha","shadow_smoothing","shadow_distance","shadow_angle","border_alpha","border_color","border_width","style_name","text_color","text_alpha","font_name","font_title","font_size","font_path","font_id","font_resource_id","initial_scale","font_url","typesetting","alignment","line_feed","use_effect_default_color","is_rich_text","shape_clip_x","shape_clip_y","ktv_color","bold_width","italic_degree","underline","underline_width","underline_offset","sub_type","check_flag","text_size","font_category_name","font_source_platform","font_third_resource_id","font_category_id","add_type","recognize_type","background_round_radius","background_width","background_height","background_vertical_offset","background_horizontal_offset","background_fill","font_team_id","tts_auto_update","text_preset_resource_id","group_id","preset_id","preset_name","preset_category","preset_category_id","preset_index","preset_has_set_alignment","force_apply_line_max_width","language","fixed_width","fixed_height","line_max_width","oneline_cutoff","cutoff_postfix","subtitle_template_original_fontsize","inner_padding","multi_language_current","source_from","is_lyric_effect","lyric_group_id","is_words_linear","ssml_content","is_blank_text","text"],array:{text_to_audio_ids:{type:"common"},fonts:{type:"object",clsName:()=>f.Lh},relevance_segment:{type:"common"},original_size:{type:"common"}},object:{words:{type:()=>d.H1},combo_info:{type:()=>c.$y},caption_template_info:{type:()=>u.oG},text_curve:{type:()=>m.b9,nullable:!0},shadow_point:{type:()=>h._O},subtitle_keywords:{type:()=>p.Of,nullable:!0},lyrics_template:{type:()=>g.An},rich_text_command:{type:()=>a.B}}},_=(0,o.I2)(y,["isBlankText","richTextCommand","text"]);class T extends l.w8{static deserialize(e){let t=new T;return(0,o.Tz)(t,e,y),t.text=s.hM.getOriginContentFromContent(t.content),t}static serialize(e){return(0,o.o8)(e,y)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new T;return(0,o.he)(this,t,y,e,["id"]),t.isBlankText=this.isBlankText,t.text=s.hM.getOriginContentFromContent(t.content),t}constructor(e={}){super(),this[l.I9]=w,this.recognizeTaskId="",this.id=(0,n.p)(),this.name="",this.type=r.cV.MetaTypeNone,this.content="",this.baseContent="",this.words=new d.H1,this.globalAlpha=1,this.backgroundColor="",this.backgroundAlpha=1,this.backgroundStyle=0,this.comboInfo=new c.$y,this.captionTemplateInfo=new u.oG,this.layerWeight=0,this.letterSpacing=0,this.lineSpacing=.2,this.hasShadow=!1,this.shadowColor="",this.shadowAlpha=.8,this.shadowSmoothing=0,this.shadowDistance=0,this.shadowPoint=new h._O,this.shadowAngle=0,this.borderAlpha=1,this.borderColor="",this.borderWidth=.06,this.styleName="",this.textColor="",this.textAlpha=1,this.fontName="",this.fontTitle="none",this.fontSize=15,this.fontPath="",this.fontId="",this.fontResourceId="",this.initialScale=0,this.fontUrl="",this.typesetting=0,this.alignment=1,this.lineFeed=1,this.useEffectDefaultColor=!0,this.isRichText=!1,this.shapeClipX=!1,this.shapeClipY=!1,this.ktvColor="",this.textToAudioIds=[],this.boldWidth=0,this.italicDegree=0,this.underline=!1,this.underlineWidth=.05,this.underlineOffset=.22,this.subType=r.SY.SubtitleMix,this.checkFlag=63,this.textSize=30,this.fontCategoryName="",this.fontSourcePlatform=0,this.fontThirdResourceId="",this.fontCategoryId="",this.addType=r.RZ.ManualAdd,this.recognizeType=r.jI.UnkownType,this.fonts=[],this.backgroundRoundRadius=0,this.backgroundWidth=.14,this.backgroundHeight=.14,this.backgroundVerticalOffset=0,this.backgroundHorizontalOffset=0,this.backgroundFill="",this.fontTeamId="",this.ttsAutoUpdate=!1,this.textPresetResourceId="",this.groupId="",this.presetId="",this.presetName="",this.presetCategory="",this.presetCategoryId="",this.presetIndex=0,this.presetHasSetAlignment=!1,this.forceApplyLineMaxWidth=!1,this.language="",this.relevanceSegment=[],this.originalSize=[],this.fixedWidth=-1,this.fixedHeight=-1,this.lineMaxWidth=.82,this.onelineCutoff=!1,this.cutoffPostfix="",this.subtitleTemplateOriginalFontsize=0,this.innerPadding=-1,this.multiLanguageCurrent=r.Hw.MultiLanguageNone,this.sourceFrom="",this.isLyricEffect=!1,this.lyricGroupId="",this.lyricsTemplate=new g.An,this.isWordsLinear=!1,this.ssmlContent="",this.isBlankText=!1,this.richTextCommand=new a.B,this.text="",(0,o.tZ)(this,e,_),!Object.prototype.hasOwnProperty.call(e,"text")&&(this.text=s.hM.getOriginContentFromContent(this.content))}}let v={common:["recognize_task_id","id","name","type","content","base_content","global_alpha","background_color","background_alpha","background_style","layer_weight","letter_spacing","line_spacing","has_shadow","shadow_color","shadow_alpha","shadow_smoothing","shadow_distance","shadow_angle","border_alpha","border_color","border_width","style_name","text_color","text_alpha","font_name","font_title","font_size","font_path","font_id","font_resource_id","initial_scale","font_url","typesetting","alignment","line_feed","use_effect_default_color","is_rich_text","shape_clip_x","shape_clip_y","ktv_color","bold_width","italic_degree","underline","underline_width","underline_offset","sub_type","check_flag","text_size","font_category_name","font_source_platform","font_third_resource_id","font_category_id","add_type","recognize_type","background_round_radius","background_width","background_height","background_vertical_offset","background_horizontal_offset","background_fill","font_team_id","tts_auto_update","text_preset_resource_id","group_id","preset_id","preset_name","preset_category","preset_category_id","preset_index","preset_has_set_alignment","force_apply_line_max_width","language","fixed_width","fixed_height","line_max_width","oneline_cutoff","cutoff_postfix","subtitle_template_original_fontsize","inner_padding","multi_language_current","source_from","is_lyric_effect","lyric_group_id","is_words_linear","ssml_content","is_blank_text","text"],array:{text_to_audio_ids:{type:"common"},fonts:{type:"object",clsName:()=>f.Lh},relevance_segment:{type:"common"},original_size:{type:"common"}},object:{words:{type:()=>d.JQ},combo_info:{type:()=>c.PZ},caption_template_info:{type:()=>u.EI},text_curve:{type:()=>m.eG,nullable:!0},shadow_point:{type:()=>h.d9},subtitle_keywords:{type:()=>p.ng,nullable:!0},lyrics_template:{type:()=>g.oy},rich_text_command:{type:()=>a.A}}},I=(0,o.I2)(v,["isBlankText","richTextCommand","text"]);class w extends l.u2{static deserialize(e){let t=new w;return(0,o.Tz)(t,e,v,!0),t.text=s.hM.getOriginContentFromContent(t.content),t}static serialize(e){return(0,o.o8)(e,v,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new w;return(0,o.he)(this,t,v,e,["id"],!0),null!==this.isBlankText&&void 0!==this.isBlankText&&(t.isBlankText=this.isBlankText),null!==this.text&&void 0!==this.text&&(t.text=this.text),t}constructor(e={}){super(),this[l._n]=T,(0,o.fZ)(this,e,I)}}},569566:function(e,t,i){i.d(t,{UJ:function(){return g},a8:function(){return h}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(185236),l=i(180942),d=i(382068),c=i(64144);let u={common:["id","effect_id","resource_id","name","type","path","value","category_id","category_name","platform","apply_target_type","source_platform","version","formula_id","render_index","track_render_index","request_id","algorithm_artifact_path","covering_relation_change","enable_mask"],bigint:{item_effect_type:{}},array:{adjust_params:{type:"object",clsName:()=>s.VB},common_keyframes:{type:"object",clsName:()=>d.ko},disable_effect_faces:{type:"common"},effect_mask:{type:"object",clsName:()=>c.Q$}},object:{time_range:{type:()=>l.tn,nullable:!0},apply_time_range:{type:()=>l.tn,nullable:!0}}},m=(0,a.I2)(u,[]);class h extends o.w8{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,u),t}static serialize(e){return(0,a.o8)(e,u)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,u,e,["id"]),t}constructor(e={}){super(),this[o.I9]=g,this.id=(0,n.p)(),this.effectId="",this.resourceId="",this.name="",this.type=r.cV.MetaTypeNone,this.path="",this.value=0,this.categoryId="",this.categoryName="",this.platform="all",this.applyTargetType=0,this.sourcePlatform=r.nj.EffectPlatformLoki,this.version="",this.itemEffectType=0n,this.adjustParams=[],this.formulaId="",this.renderIndex=0,this.trackRenderIndex=0,this.commonKeyframes=[],this.requestId="",this.algorithmArtifactPath="",this.disableEffectFaces=[],this.coveringRelationChange=r.fm.Unknow,this.enableMask=!0,(0,a.tZ)(this,e,m)}}let f={common:["id","effect_id","resource_id","name","type","path","value","category_id","category_name","platform","apply_target_type","source_platform","version","formula_id","render_index","track_render_index","request_id","algorithm_artifact_path","covering_relation_change","enable_mask"],bigint:{item_effect_type:{}},array:{adjust_params:{type:"object",clsName:()=>s.VB},common_keyframes:{type:"object",clsName:()=>d.ko},disable_effect_faces:{type:"common"},effect_mask:{type:"object",clsName:()=>c.Q$}},object:{time_range:{type:()=>l.ze,nullable:!0},apply_time_range:{type:()=>l.ze,nullable:!0}}},p=(0,a.I2)(f,[]);class g extends o.u2{static deserialize(e){let t=new g;return(0,a.Tz)(t,e,f,!0),t}static serialize(e){return(0,a.o8)(e,f,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new g;return(0,a.he)(this,t,f,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=h,(0,a.fZ)(this,e,p)}}},132392:function(e,t,i){i.d(t,{ck:function(){return f},jG:function(){return u}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(180942),l=i(528156);let d={common:["id","type","enable","production_path","ambient_sound_level"],object:{time_range:{type:()=>s.tn,nullable:!0},voice_change_mode:{type:()=>l.Yy,nullable:!0}}},c=(0,a.I2)(d,[]);class u extends o.w8{static deserialize(e){let t=new u;return(0,a.Tz)(t,e,d),t}static serialize(e){return(0,a.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,a.he)(this,t,d,e,["id"]),t}constructor(e={}){super(),this[o.I9]=f,this.id=(0,n.p)(),this.type=r.cV.MetaTypeVocalBeautify,this.enable=!1,this.productionPath="",this.ambientSoundLevel=0,(0,a.tZ)(this,e,c)}}let m={common:["id","type","enable","production_path","ambient_sound_level"],object:{time_range:{type:()=>s.ze,nullable:!0},voice_change_mode:{type:()=>l.sn,nullable:!0}}},h=(0,a.I2)(m,[]);class f extends o.u2{static deserialize(e){let t=new f;return(0,a.Tz)(t,e,m,!0),t}static serialize(e){return(0,a.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,a.he)(this,t,m,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=u,(0,a.fZ)(this,e,h)}}},414375:function(e,t,i){i.d(t,{MG:function(){return ei},wE:function(){return Q}});var r=i(669686),n=i(150251),a=i(527295),o=i(563091),s=i(518938),l=i(254574),d=i(973815),c=i(488071),u=i(686513),m=i(266218),h=i(6467),f=i(461203),p=i(528156),g=i(757327),y=i(468699),_=i(908301),T=i(519769),v=i(247795),I=i(280283),w=i(64144),S=i(289109),k=i(232959),x=i(213030),b=i(217381),M=i(750581),C=i(379012),A=i(398163),E=i(229133),F=i(684372),P=i(569566),D=i(290703),z=i(1841),N=i(557599),V=i(29709),O=i(956156),R=i(583109),H=i(2995),B=i(345768),K=i(143743),j=i(907350),X=i(519348),L=i(67792),W=i(137234),U=i(132392),$=i(232524),Z=i(959026),G=i(36219),Y=i(801927);let q={array:{flowers:{type:"object",clsName:()=>a.Hh},videos:{type:"object",clsName:()=>o.Ub},tail_leaders:{type:"object",clsName:()=>s.W9},audios:{type:"object",clsName:()=>l.ZD},images:{type:"object",clsName:()=>d._Z},texts:{type:"object",clsName:()=>c.jG},effects:{type:"object",clsName:()=>u.eA},stickers:{type:"object",clsName:()=>m.cJ},canvases:{type:"object",clsName:()=>h.fl},transitions:{type:"object",clsName:()=>f.EF},audio_effects:{type:"object",clsName:()=>p.Yy},audio_fades:{type:"object",clsName:()=>g.KT},beats:{type:"object",clsName:()=>y.hW},material_animations:{type:"object",clsName:()=>_.ZP},placeholders:{type:"object",clsName:()=>T.sV},placeholder_infos:{type:"object",clsName:()=>v.yu},speeds:{type:"object",clsName:()=>I.Ug},common_mask:{type:"object",clsName:()=>w.Q$},chromas:{type:"object",clsName:()=>S.VJ},text_templates:{type:"object",clsName:()=>k.WQ},realtime_denoises:{type:"object",clsName:()=>x.jU},video_trackings:{type:"object",clsName:()=>b.FM},hsl:{type:"object",clsName:()=>M.pr},drafts:{type:"object",clsName:()=>C.Wu},color_curves:{type:"object",clsName:()=>A.vI},primary_color_wheels:{type:"object",clsName:()=>E.i3},log_color_wheels:{type:"object",clsName:()=>F.p4},video_effects:{type:"object",clsName:()=>P.a8},audio_balances:{type:"object",clsName:()=>D.Ld},handwrites:{type:"object",clsName:()=>z.Td},manual_deformations:{type:"object",clsName:()=>N.RR},plugin_effects:{type:"object",clsName:()=>V.r0},sound_channel_mappings:{type:"object",clsName:()=>O.tU},green_screens:{type:"object",clsName:()=>R.si},shapes:{type:"object",clsName:()=>H.vx},material_colors:{type:"object",clsName:()=>B.VB},digital_humans:{type:"object",clsName:()=>K.YN},smart_crops:{type:"object",clsName:()=>j.O3},ai_translates:{type:"object",clsName:()=>X.TA},audio_track_indexes:{type:"object",clsName:()=>L.Be},loudnesses:{type:"object",clsName:()=>W.o6},vocal_beautifys:{type:"object",clsName:()=>U.jG},vocal_separations:{type:"object",clsName:()=>$.Jc},smart_relights:{type:"object",clsName:()=>Z.XY},time_marks:{type:"object",clsName:()=>G.wR},multi_language_refs:{type:"object",clsName:()=>Y.jk}}},J=(0,r.I2)(q,[]);class Q extends n.w8{static deserialize(e){let t=new Q;return(0,r.Tz)(t,e,q),t}static serialize(e){return(0,r.o8)(e,q)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Q;return(0,r.he)(this,t,q,e),t}constructor(e={}){super(),this[n.I9]=ei,this.flowers=[],this.videos=[],this.tailLeaders=[],this.audios=[],this.images=[],this.texts=[],this.effects=[],this.stickers=[],this.canvases=[],this.transitions=[],this.audioEffects=[],this.audioFades=[],this.beats=[],this.materialAnimations=[],this.placeholders=[],this.placeholderInfos=[],this.speeds=[],this.commonMask=[],this.chromas=[],this.textTemplates=[],this.realtimeDenoises=[],this.videoTrackings=[],this.hsl=[],this.drafts=[],this.primaryColorWheels=[],this.logColorWheels=[],this.videoEffects=[],this.audioBalances=[],this.handwrites=[],this.manualDeformations=[],this.pluginEffects=[],this.soundChannelMappings=[],this.greenScreens=[],this.shapes=[],this.materialColors=[],this.digitalHumans=[],this.smartCrops=[],this.aiTranslates=[],this.audioTrackIndexes=[],this.loudnesses=[],this.vocalBeautifys=[],this.vocalSeparations=[],this.smartRelights=[],this.timeMarks=[],this.multiLanguageRefs=[],(0,r.tZ)(this,e,J)}}let ee={array:{flowers:{type:"object",clsName:()=>a.Hh},videos:{type:"object",clsName:()=>o.Ub},tail_leaders:{type:"object",clsName:()=>s.W9},audios:{type:"object",clsName:()=>l.ZD},images:{type:"object",clsName:()=>d._Z},texts:{type:"object",clsName:()=>c.jG},effects:{type:"object",clsName:()=>u.eA},stickers:{type:"object",clsName:()=>m.cJ},canvases:{type:"object",clsName:()=>h.fl},transitions:{type:"object",clsName:()=>f.EF},audio_effects:{type:"object",clsName:()=>p.Yy},audio_fades:{type:"object",clsName:()=>g.KT},beats:{type:"object",clsName:()=>y.hW},material_animations:{type:"object",clsName:()=>_.ZP},placeholders:{type:"object",clsName:()=>T.sV},placeholder_infos:{type:"object",clsName:()=>v.yu},speeds:{type:"object",clsName:()=>I.Ug},common_mask:{type:"object",clsName:()=>w.Q$},chromas:{type:"object",clsName:()=>S.VJ},text_templates:{type:"object",clsName:()=>k.WQ},realtime_denoises:{type:"object",clsName:()=>x.jU},video_trackings:{type:"object",clsName:()=>b.FM},hsl:{type:"object",clsName:()=>M.pr},drafts:{type:"object",clsName:()=>C.Wu},color_curves:{type:"object",clsName:()=>A.vI},primary_color_wheels:{type:"object",clsName:()=>E.i3},log_color_wheels:{type:"object",clsName:()=>F.p4},video_effects:{type:"object",clsName:()=>P.a8},audio_balances:{type:"object",clsName:()=>D.Ld},handwrites:{type:"object",clsName:()=>z.Td},manual_deformations:{type:"object",clsName:()=>N.RR},plugin_effects:{type:"object",clsName:()=>V.r0},sound_channel_mappings:{type:"object",clsName:()=>O.tU},green_screens:{type:"object",clsName:()=>R.si},shapes:{type:"object",clsName:()=>H.vx},material_colors:{type:"object",clsName:()=>B.VB},digital_humans:{type:"object",clsName:()=>K.YN},smart_crops:{type:"object",clsName:()=>j.O3},ai_translates:{type:"object",clsName:()=>X.TA},audio_track_indexes:{type:"object",clsName:()=>L.Be},loudnesses:{type:"object",clsName:()=>W.o6},vocal_beautifys:{type:"object",clsName:()=>U.jG},vocal_separations:{type:"object",clsName:()=>$.Jc},smart_relights:{type:"object",clsName:()=>Z.XY},time_marks:{type:"object",clsName:()=>G.wR},multi_language_refs:{type:"object",clsName:()=>Y.jk}}},et=(0,r.I2)(ee,[]);class ei extends n.u2{static deserialize(e){let t=new ei;return(0,r.Tz)(t,e,ee,!0),t}static serialize(e){return(0,r.o8)(e,ee,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ei;return(0,r.he)(this,t,ee,e,!1,!0),t}constructor(e={}){super(),this[n._n]=Q,(0,r.fZ)(this,e,et)}}},310385:function(e,t,i){var r=i(669686);i(150251);var n=i(674685);(0,r.I2)({array:{data:{type:"object",clsName:()=>n.WJ}}},[]);(0,r.I2)({array:{data:{type:"object",clsName:()=>n.WJ}}},[])},622625:function(e,t,i){i.d(t,{U3:function(){return d},dR:function(){return m}});var r=i(669686),n=i(150251),a=i(274120),o=i(767348);let s={array:{video_time_infos:{type:"object",clsName:()=>o.hm}},object:{gray_words_info:{type:()=>a.wd}}},l=(0,r.I2)(s,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=m,this.grayWordsInfo=new a.wd,this.videoTimeInfos=[],(0,r.tZ)(this,e,l)}}let c={array:{video_time_infos:{type:"object",clsName:()=>o.hm}},object:{gray_words_info:{type:()=>a.DR}}},u=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,u)}}},432202:function(e,t,i){i.d(t,{OB:function(){return s}});var r=i(669686),n=i(150251);let a={common:["chapter_id","title","description","duration_range_head","duration_range_tail","fragment_range_head","fragment_range_tail","is_filling","is_placeholder","time_limit","short_text"],array:{short_text_list:{type:"common"},action_list:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.chapterId=0,this.title="",this.description="",this.durationRangeHead=0,this.durationRangeTail=0,this.fragmentRangeHead=0,this.fragmentRangeTail=0,this.isFilling=!1,this.isPlaceholder=!1,this.timeLimit=0,this.shortText="",this.shortTextList=[],this.actionList=[],(0,r.tZ)(this,e,o)}}let l={common:["chapter_id","title","description","duration_range_head","duration_range_tail","fragment_range_head","fragment_range_tail","is_filling","is_placeholder","time_limit","short_text"],array:{short_text_list:{type:"common"},action_list:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},569230:function(e,t,i){i.d(t,{hi:function(){return s}});var r=i(669686),n=i(150251);let a={common:["material_id","generated_material_id","vid","generate","subtitle","caption"],bigint:{start:{},end:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.materialId="",this.generatedMaterialId="",this.vid="",this.start=0n,this.end=0n,this.generate=!1,this.subtitle="",this.caption="",(0,r.tZ)(this,e,o)}}let l={common:["material_id","generated_material_id","vid","generate","subtitle","caption"],bigint:{start:{},end:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},45854:function(e,t,i){i.d(t,{Fx:function(){return s},u4:function(){return c}});var r=i(669686),n=i(150251);let a={common:["vid","play_addr"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.vid="",this.playAddr="",(0,r.tZ)(this,e,o)}}let l={common:["vid","play_addr"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},318284:function(e,t,i){i.d(t,{VG:function(){return s},r6:function(){return c}});var r=i(669686),n=i(150251);let a={common:["text_template"],bigint:{start:{},end:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.textTemplate="",this.start=0n,this.end=0n,(0,r.tZ)(this,e,o)}}let l={common:["text_template"],bigint:{start:{},end:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},796760:function(e,t,i){i.d(t,{Gz:function(){return m},e$:function(){return d}});var r=i(669686),n=i(150251),a=i(250863),o=i(45854);let s={common:["chapter_cnt","auto_subtitle","auto_tts","template_id","draft_id"],array:{template_chapter_infos:{type:"object",clsName:()=>a.ZY}},object:{template_music_info:{type:()=>o.Fx}}},l=(0,r.I2)(s,[]);class d extends n.w8{static deserialize(e){let t=new d;return(0,r.Tz)(t,e,s),t}static serialize(e){return(0,r.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,r.he)(this,t,s,e),t}constructor(e={}){super(),this[n.I9]=m,this.chapterCnt=0,this.autoSubtitle=!1,this.autoTts=!1,this.templateId="",this.draftId="",this.templateChapterInfos=[],this.templateMusicInfo=new o.Fx,(0,r.tZ)(this,e,l)}}let c={common:["chapter_cnt","auto_subtitle","auto_tts","template_id","draft_id"],array:{template_chapter_infos:{type:"object",clsName:()=>a.ZY}},object:{template_music_info:{type:()=>o.u4}}},u=(0,r.I2)(c,[]);class m extends n.u2{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c,!0),t}static serialize(e){return(0,r.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,r.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[n._n]=d,(0,r.fZ)(this,e,u)}}},283482:function(e,t,i){i.d(t,{f$:function(){return f},yf:function(){return u}});var r=i(669686),n=i(150251),a=i(485451),o=i(584845),s=i(300472),l=i(167953);let d={bigint:{original_duration:{}},array:{animations:{type:"object",clsName:()=>o.fD}},object:{text_info:{type:()=>a.tg},clip:{type:()=>s.xJ},effect:{type:()=>l.W_},shape:{type:()=>l.W_},bloom:{type:()=>l.W_}}},c=(0,r.I2)(d,[]);class u extends n.w8{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d),t}static serialize(e){return(0,r.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e),t}constructor(e={}){super(),this[n.I9]=f,this.textInfo=new a.tg,this.animations=[],this.clip=new s.xJ,this.effect=new l.W_,this.shape=new l.W_,this.bloom=new l.W_,this.originalDuration=0n,(0,r.tZ)(this,e,c)}}let m={bigint:{original_duration:{}},array:{animations:{type:"object",clsName:()=>o.fD}},object:{text_info:{type:()=>a.vW},clip:{type:()=>s.nO},effect:{type:()=>l.$D},shape:{type:()=>l.$D},bloom:{type:()=>l.$D}}},h=(0,r.I2)(m,[]);class f extends n.u2{static deserialize(e){let t=new f;return(0,r.Tz)(t,e,m,!0),t}static serialize(e){return(0,r.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,r.he)(this,t,m,e,!1,!0),t}constructor(e={}){super(),this[n._n]=u,(0,r.fZ)(this,e,h)}}},26674:function(e,t,i){i.d(t,{TS:function(){return s},tk:function(){return c}});var r=i(669686),n=i(150251);let a={common:["text","tone_speaker","tone_speed","tone_emotion","tts_task_id","tts_generate_scene","tone_speaker_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.text="",this.toneSpeaker="",this.toneSpeed=1,this.toneEmotion="",this.ttsTaskId="",this.ttsGenerateScene="",this.toneSpeakerId="",(0,r.tZ)(this,e,o)}}let l={common:["text","tone_speaker","tone_speed","tone_emotion","tts_task_id","tts_generate_scene","tone_speaker_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},917062:function(e,t,i){i.d(t,{Mm:function(){return c}});var r=i(669686),n=i(150251),a=i(818149),o=i(910203),s=i(908301);let l={common:["name","type"],object:{attach_info:{type:()=>a.aw},shape_param:{type:()=>o.eb},animate_material_info:{type:()=>s.ZP,nullable:!0}}},d=(0,r.I2)(l,["animateMaterialInfo"]);class c extends n.w8{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e),t.animateMaterialInfo=this.animateMaterialInfo?this.animateMaterialInfo.clone(e):void 0,t}constructor(e={}){super(),this[n.I9]=h,this.name="",this.type="",this.attachInfo=new a.aw,this.shapeParam=new o.eb,(0,r.tZ)(this,e,d)}}let u={common:["name","type"],object:{attach_info:{type:()=>a.WT},shape_param:{type:()=>o.MF},animate_material_info:{type:()=>s.PA,nullable:!0}}},m=(0,r.I2)(u,["animateMaterialInfo"]);class h extends n.u2{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,u,e,!1,!0),null!==this.animateMaterialInfo&&void 0!==this.animateMaterialInfo&&(t.animateMaterialInfo=this.animateMaterialInfo?this.animateMaterialInfo.clone(e):void 0),t}constructor(e={}){super(),this[n._n]=c,(0,r.fZ)(this,e,m)}}},493478:function(e,t,i){i.d(t,{JS:function(){return l},cf:function(){return u}});var r=i(669686),n=i(150251),a=i(934388);let o={bigint:{version:{}},array:{oneoff_gameplays:{type:"object",clsName:()=>a.PB}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.version=0n,this.oneoffGameplays=[],(0,r.tZ)(this,e,s)}}let d={bigint:{version:{}},array:{oneoff_gameplays:{type:"object",clsName:()=>a.PB}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},934388:function(e,t,i){i.d(t,{PB:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["algorithm","material_id","name","icon_url","oneff_type"],array:{resource_types:{type:"common"}}},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=u,this.algorithm="",this.materialId="",this.name="",this.iconUrl="",this.oneffType=r.P1.GameplayTypeUnknown,this.resourceTypes=[],(0,n.tZ)(this,e,s)}}let d={common:["algorithm","material_id","name","icon_url","oneff_type"],array:{resource_types:{type:"common"}}},c=(0,n.I2)(d,[]);class u extends a.u2{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,c)}}},404660:function(e,t,i){i.d(t,{As:function(){return l}});var r=i(669686),n=i(150251),a=i(706719);let o={common:["word_id"],array:{sentence:{type:"object",clsName:()=>a.VQ}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.wordId="",this.sentence=[],(0,r.tZ)(this,e,s)}}let d={common:["word_id"],array:{sentence:{type:"object",clsName:()=>a.VQ}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},225504:function(e,t,i){i.d(t,{Km:function(){return s}});var r=i(669686),n=i(150251);let a={common:["sentence_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.sentenceId="",(0,r.tZ)(this,e,o)}}let l={common:["sentence_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},482764:function(e,t,i){i.d(t,{Ju:function(){return l},al:function(){return u}});var r=i(669686),n=i(150251),a=i(785108);let o={object:{report_info:{type:()=>a.wo,nullable:!0}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,(0,r.tZ)(this,e,s)}}let d={object:{report_info:{type:()=>a.oG,nullable:!0}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},182570:function(e,t,i){i.d(t,{H1:function(){return s},JQ:function(){return c}});var r=i(669686),n=i(150251);let a={array:{start_time:{type:"bigint"},end_time:{type:"bigint"},text:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.startTime=[],this.endTime=[],this.text=[],(0,r.tZ)(this,e,o)}}let l={array:{start_time:{type:"bigint"},end_time:{type:"bigint"},text:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},553859:function(e,t,i){i.d(t,{Lh:function(){return s},mF:function(){return c}});var r=i(669686),n=i(150251);let a={common:["id","resource_id","third_resource_id","category_id","category_name","source_platform","path","effect_id","title","team_id","file_uri","request_id"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.resourceId="",this.thirdResourceId="",this.categoryId="",this.categoryName="",this.sourcePlatform=0,this.path="",this.effectId="",this.title="",this.teamId="",this.fileUri="",this.requestId="",(0,r.tZ)(this,e,o)}}let l={common:["id","resource_id","third_resource_id","category_id","category_name","source_platform","path","effect_id","title","team_id","file_uri","request_id"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},95477:function(e,t,i){i.d(t,{Xy:function(){return u},bN:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["enable","target_follow","size_layout","horizontal_pos_layout","vertical_pos_layout"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=u,this.enable=!1,this.targetFollow="",this.sizeLayout=r.qL.kSizeNone,this.horizontalPosLayout=r._v.kHorizontalNone,this.verticalPosLayout=r.NV.kVerticalNone,(0,n.tZ)(this,e,s)}}let d={common:["enable","target_follow","size_layout","horizontal_pos_layout","vertical_pos_layout"]},c=(0,n.I2)(d,[]);class u extends a.u2{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,c)}}},555673:function(e,t,i){i.d(t,{Dq:function(){return h},__:function(){return c}});var r=i(602777),n=i(669686),a=i(150251),o=i(984736),s=i(832497);let l={common:["retouch_path","retouch_web_path","base_type","frame_segment_id","image_path","only_base_layer"],bigint:{frame_timestamp:{}},object:{image_crop:{type:()=>o.oI,nullable:!0},report_extras:{type:()=>s.ke,nullable:!0}}},d=(0,n.I2)(l,[]);class c extends a.w8{static deserialize(e){let t=new c;return(0,n.Tz)(t,e,l),t}static serialize(e){return(0,n.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,n.he)(this,t,l,e),t}constructor(e={}){super(),this[a.I9]=h,this.retouchPath="",this.retouchWebPath="",this.baseType=r._6.CoverTypeFrame,this.frameSegmentId="",this.frameTimestamp=0n,this.imagePath="",this.onlyBaseLayer=!1,(0,n.tZ)(this,e,d)}}let u={common:["retouch_path","retouch_web_path","base_type","frame_segment_id","image_path","only_base_layer"],bigint:{frame_timestamp:{}},object:{image_crop:{type:()=>o.V_,nullable:!0},report_extras:{type:()=>s.Ae,nullable:!0}}},m=(0,n.I2)(u,[]);class h extends a.u2{static deserialize(e){let t=new h;return(0,n.Tz)(t,e,u,!0),t}static serialize(e){return(0,n.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,n.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[a._n]=c,(0,n.fZ)(this,e,m)}}},28881:function(e,t,i){i.d(t,{ik:function(){return c},l0:function(){return s}});var r=i(669686),n=i(150251);let a={common:["top_left","top_right","bottom_left","bottom_right"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.topLeft=0,this.topRight=0,this.bottomLeft=0,this.bottomRight=0,(0,r.tZ)(this,e,o)}}let l={common:["top_left","top_right","bottom_left","bottom_right"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},78676:function(e,t,i){i.d(t,{jm:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","title","type"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.title="",this.type="",(0,r.tZ)(this,e,o)}}let l={common:["id","title","type"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},544664:function(e,t,i){i.d(t,{vm:function(){return s}});var r=i(669686),n=i(150251);let a={common:["id","content"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.id="",this.content="",(0,r.tZ)(this,e,o)}}let l={common:["id","content"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},173469:function(e,t,i){i.d(t,{go:function(){return T},x_:function(){return g}});var r=i(602777),n=i(669686),a=i(150251),o=i(238830),s=i(468634),l=i(1841),d=i(908301),c=i(595506),u=i(217381),m=i(686513),h=i(53823);let f={extend:h.xV,array:{keyframes:{type:"object",clsName:()=>c.OM},effects:{type:"object",clsName:()=>m.eA}},object:{clip:{type:()=>o.bX},uniform_scale:{type:()=>s._p},material:{type:()=>l.Td},animations:{type:()=>d.ZP,nullable:!0},video_tracking:{type:()=>u.FM,nullable:!0}}},p=(0,n.I2)(f,[]);class g extends h.XX{static deserialize(e){let t=new g;return(0,n.Tz)(t,e,f),t}static serialize(e){return(0,n.o8)(e,f)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new g;return(0,n.he)(this,t,f,e,!0),t}constructor(e={}){super(e),this[a.I9]=T,this.__segment_struct_type=r.Oc.SegmentHandwrite,this.clip=new o.bX,this.uniformScale=new s._p,this.material=new l.Td,this.keyframes=[],this.effects=[],(0,n.tZ)(this,e,p)}}let y={extend:h.FX,array:{keyframes:{type:"object",clsName:()=>c.OM},effects:{type:"object",clsName:()=>m.eA}},object:{clip:{type:()=>o.tL},uniform_scale:{type:()=>s.Rp},material:{type:()=>l.y9},animations:{type:()=>d.PA,nullable:!0},video_tracking:{type:()=>u.Mw,nullable:!0}}},_=(0,n.I2)(y,[]);class T extends h.Ev{static deserialize(e){let t=new T;return(0,n.Tz)(t,e,y,!0),t}static serialize(e){return(0,n.o8)(e,y,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new T;return(0,n.he)(this,t,y,e,!0,!0),t}constructor(e={}){super(),this[a._n]=g,this.__segment_struct_type=r.Oc.SegmentHandwrite,(0,n.fZ)(this,e,_)}}},760399:function(e,t,i){i.d(t,{MM:function(){return u},MY:function(){return f}});var r=i(602777),n=i(669686),a=i(150251),o=i(414516),s=i(206653),l=i(53823);let d={extend:l.xV,common:["name"],array:{keyframes:{type:"object",clsName:()=>s.eH}},object:{material:{type:()=>o.sq}}},c=(0,n.I2)(d,[]);class u extends l.XX{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d),t}static serialize(e){return(0,n.o8)(e,d)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!0),t}constructor(e={}){super(e),this[a.I9]=f,this.__segment_struct_type=r.Oc.SegmentPictureAdjust,this.name="",this.material=new o.sq,this.keyframes=[],(0,n.tZ)(this,e,c)}}let m={extend:l.FX,common:["name"],array:{keyframes:{type:"object",clsName:()=>s.eH}},object:{material:{type:()=>o.cN}}},h=(0,n.I2)(m,[]);class f extends l.Ev{static deserialize(e){let t=new f;return(0,n.Tz)(t,e,m,!0),t}static serialize(e){return(0,n.o8)(e,m,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new f;return(0,n.he)(this,t,m,e,!0,!0),t}constructor(e={}){super(),this[a._n]=u,this.__segment_struct_type=r.Oc.SegmentPictureAdjust,(0,n.fZ)(this,e,h)}}},557962:function(e,t,i){i.d(t,{S8:function(){return g},rk:function(){return T}});var r=i(602777),n=i(669686),a=i(150251),o=i(238830),s=i(468634),l=i(266218),d=i(908301),c=i(579399),u=i(217381),m=i(188428),h=i(53823);let f={extend:h.xV,common:["adaption_model"],array:{keyframes:{type:"object",clsName:()=>c.QC}},object:{clip:{type:()=>o.bX},uniform_scale:{type:()=>s._p},material:{type:()=>l.cJ},animations:{type:()=>d.ZP,nullable:!0},video_tracking:{type:()=>u.FM,nullable:!0},multi_language_material_refs:{type:()=>m.K1,nullable:!0}}},p=(0,n.I2)(f,[]);class g extends h.XX{static deserialize(e){let t=new g;return(0,n.Tz)(t,e,f),t}static serialize(e){return(0,n.o8)(e,f)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new g;return(0,n.he)(this,t,f,e,!0),t}constructor(e={}){super(e),this[a.I9]=T,this.__segment_struct_type=r.Oc.SegmentSticker,this.adaptionModel=0,this.clip=new o.bX,this.uniformScale=new s._p,this.material=new l.cJ,this.keyframes=[],(0,n.tZ)(this,e,p)}}let y={extend:h.FX,common:["adaption_model"],array:{keyframes:{type:"object",clsName:()=>c.QC}},object:{clip:{type:()=>o.tL},uniform_scale:{type:()=>s.Rp},material:{type:()=>l.ak},animations:{type:()=>d.PA,nullable:!0},video_tracking:{type:()=>u.Mw,nullable:!0},multi_language_material_refs:{type:()=>m.CR,nullable:!0}}},_=(0,n.I2)(y,[]);class T extends h.Ev{static deserialize(e){let t=new T;return(0,n.Tz)(t,e,y,!0),t}static serialize(e){return(0,n.o8)(e,y,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new T;return(0,n.he)(this,t,y,e,!0,!0),t}constructor(e={}){super(),this[a._n]=g,this.__segment_struct_type=r.Oc.SegmentSticker,(0,n.fZ)(this,e,_)}}},806820:function(e,t,i){i.d(t,{Fy:function(){return T},xK:function(){return w}});var r=i(602777),n=i(669686),a=i(150251),o=i(238830),s=i(468634),l=i(488071),d=i(379012),c=i(908301),u=i(686513),m=i(827174),h=i(217381),f=i(527295),p=i(188428),g=i(53823);let y={extend:g.xV,array:{keyframes:{type:"object",clsName:()=>m.ye},effects:{type:"object",clsName:()=>u.eA},flowers:{type:"object",clsName:()=>f.Hh}},object:{clip:{type:()=>o.bX},uniform_scale:{type:()=>s._p},material:{type:()=>l.jG},material_draft:{type:()=>d.Wu,nullable:!0},animations:{type:()=>c.ZP,nullable:!0},effect:{type:()=>u.eA,nullable:!0},shape:{type:()=>u.eA,nullable:!0},bloom:{type:()=>u.eA,nullable:!0},video_tracking:{type:()=>h.FM,nullable:!0},multi_language_material_refs:{type:()=>p.K1,nullable:!0}}},_=(0,n.I2)(y,[]);class T extends g.XX{static deserialize(e){let t=new T;return(0,n.Tz)(t,e,y),t}static serialize(e){return(0,n.o8)(e,y)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new T;return(0,n.he)(this,t,y,e,!0),t}constructor(e={}){super(e),this[a.I9]=w,this.__segment_struct_type=r.Oc.SegmentText,this.clip=new o.bX,this.uniformScale=new s._p,this.material=new l.jG,this.keyframes=[],this.effects=[],this.flowers=[],(0,n.tZ)(this,e,_)}}let v={extend:g.FX,array:{keyframes:{type:"object",clsName:()=>m.ye},effects:{type:"object",clsName:()=>u.eA},flowers:{type:"object",clsName:()=>f.Hh}},object:{clip:{type:()=>o.tL},uniform_scale:{type:()=>s.Rp},material:{type:()=>l.ed},material_draft:{type:()=>d.rd,nullable:!0},animations:{type:()=>c.PA,nullable:!0},effect:{type:()=>u.W9,nullable:!0},shape:{type:()=>u.W9,nullable:!0},bloom:{type:()=>u.W9,nullable:!0},video_tracking:{type:()=>h.Mw,nullable:!0},multi_language_material_refs:{type:()=>p.CR,nullable:!0}}},I=(0,n.I2)(v,[]);class w extends g.Ev{static deserialize(e){let t=new w;return(0,n.Tz)(t,e,v,!0),t}static serialize(e){return(0,n.o8)(e,v,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new w;return(0,n.he)(this,t,v,e,!0,!0),t}constructor(e={}){super(),this[a._n]=T,this.__segment_struct_type=r.Oc.SegmentText,(0,n.fZ)(this,e,I)}}},910203:function(e,t,i){i.d(t,{MF:function(){return c},eb:function(){return s}});var r=i(669686),n=i(150251);let a={common:["shape_type"],array:{points:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.shapeType=0,this.points=[],(0,r.tZ)(this,e,o)}}let l={common:["shape_type"],array:{points:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},21431:function(e,t,i){i.d(t,{cf:function(){return c},lb:function(){return s}});var r=i(669686),n=i(150251);let a={common:["type","query","is_hd"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.type=0,this.query="",this.isHd=!1,(0,r.tZ)(this,e,o)}}let l={common:["type","query","is_hd"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},977209:function(e,t,i){i.d(t,{Dt:function(){return g},Vl:function(){return h}});var r=i(669686),n=i(150251),a=i(689631),o=i(194877),s=i(734301),l=i(519124),d=i(794554),c=i(143703);let u={common:["phase"],array:{video_understandings:{type:"object",clsName:()=>s.FY},video_infos:{type:"object",clsName:()=>l.lb},group_infos:{type:"object",clsName:()=>d.Ac},short_texts:{type:"object",clsName:()=>c.ce}},object:{template_info:{type:()=>a.bq},prompt_inp:{type:()=>o.lD}}},m=(0,r.I2)(u,[]);class h extends n.w8{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,u),t}static serialize(e){return(0,r.o8)(e,u)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,u,e),t}constructor(e={}){super(),this[n.I9]=g,this.phase=0,this.templateInfo=new a.bq,this.promptInp=new o.lD,this.videoUnderstandings=[],this.videoInfos=[],this.groupInfos=[],this.shortTexts=[],(0,r.tZ)(this,e,m)}}let f={common:["phase"],array:{video_understandings:{type:"object",clsName:()=>s.FY},video_infos:{type:"object",clsName:()=>l.lb},group_infos:{type:"object",clsName:()=>d.Ac},short_texts:{type:"object",clsName:()=>c.ce}},object:{template_info:{type:()=>a.hj},prompt_inp:{type:()=>o.vu}}},p=(0,r.I2)(f,[]);class g extends n.u2{static deserialize(e){let t=new g;return(0,r.Tz)(t,e,f,!0),t}static serialize(e){return(0,r.o8)(e,f,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new g;return(0,r.he)(this,t,f,e,!1,!0),t}constructor(e={}){super(),this[n._n]=h,(0,r.fZ)(this,e,p)}}},548782:function(e,t,i){i.d(t,{nR:function(){return s}});var r=i(669686),n=i(150251);let a={common:["x","y"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.x=0,this.y=0,(0,r.tZ)(this,e,o)}}let l={common:["x","y"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},678021:function(e,t,i){i.d(t,{F2:function(){return l}});var r=i(669686),n=i(150251),a=i(942360);let o={common:["segment_id","template_id","support_unlock_free","is_free_unlock","category","category_id","search_keyword","keyword_source","raw_query","search_id","request_id","search_result_id","search_filter_value","enter_from","template_page","template_name","template_author_id","template_type","template_need_purchase","commerce_template_cate","commerce_template_pay_type","commerce_template_pay_status","template_use_report","is_collected","task_id","tos_id"],bigint:{keyword_position:{},rank:{},template_drafts_price:{},template_duration:{},template_use_cnt:{},template_collect_cnt:{},template_fragment_cnt:{},commerce_template_price:{},video_type_id:{}},array:{template_fragment_infos:{type:"object",clsName:()=>a.lT}}},s=(0,r.I2)(o,[]);class l extends n.w8{static deserialize(e){let t=new l;return(0,r.Tz)(t,e,o),t}static serialize(e){return(0,r.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,r.he)(this,t,o,e),t}constructor(e={}){super(),this[n.I9]=u,this.segmentId="",this.templateId="",this.supportUnlockFree=!1,this.isFreeUnlock=!1,this.category="",this.categoryId="",this.searchKeyword="",this.keywordSource="",this.rawQuery="",this.searchId="",this.requestId="",this.searchResultId="",this.keywordPosition=0n,this.searchFilterValue="",this.rank=0n,this.enterFrom="",this.templatePage="",this.templateName="",this.templateAuthorId="",this.templateDraftsPrice=0n,this.templateDuration=0n,this.templateUseCnt=0n,this.templateCollectCnt=0n,this.templateFragmentCnt=0n,this.templateType="",this.templateNeedPurchase=!0,this.commerceTemplateCate="",this.commerceTemplatePayType="",this.commerceTemplatePayStatus="",this.commerceTemplatePrice=0n,this.templateUseReport=!1,this.templateFragmentInfos=[],this.isCollected=!1,this.videoTypeId=0n,this.taskId="",this.tosId="",(0,r.tZ)(this,e,s)}}let d={common:["segment_id","template_id","support_unlock_free","is_free_unlock","category","category_id","search_keyword","keyword_source","raw_query","search_id","request_id","search_result_id","search_filter_value","enter_from","template_page","template_name","template_author_id","template_type","template_need_purchase","commerce_template_cate","commerce_template_pay_type","commerce_template_pay_status","template_use_report","is_collected","task_id","tos_id"],bigint:{keyword_position:{},rank:{},template_drafts_price:{},template_duration:{},template_use_cnt:{},template_collect_cnt:{},template_fragment_cnt:{},commerce_template_price:{},video_type_id:{}},array:{template_fragment_infos:{type:"object",clsName:()=>a.lT}}},c=(0,r.I2)(d,[]);class u extends n.u2{static deserialize(e){let t=new u;return(0,r.Tz)(t,e,d,!0),t}static serialize(e){return(0,r.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,r.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[n._n]=l,(0,r.fZ)(this,e,c)}}},204437:function(e,t,i){i.d(t,{q4:function(){return s},qr:function(){return c}});var r=i(669686),n=i(150251);let a={common:["ratio"],bigint:{duration_less:{},duration_more:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.ratio="",this.durationLess=0n,this.durationMore=0n,(0,r.tZ)(this,e,o)}}let l={common:["ratio"],bigint:{duration_less:{},duration_more:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},917955:function(e,t,i){i.d(t,{Kb:function(){return c},os:function(){return s}});var r=i(669686),n=i(150251);let a={bigint:{subtitle_status:{}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.subtitleStatus=0n,(0,r.tZ)(this,e,o)}}let l={bigint:{subtitle_status:{}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},25749:function(e,t,i){i.d(t,{lQ:function(){return c},x7:function(){return s}});var r=i(669686),n=i(150251);let a={common:["product_name","brand_name","price","input_mode","tab_type","life_data","origin_product_name"],array:{sell_points:{type:"common"},audience_types:{type:"common"},discount_activity:{type:"common"},user_input_texts:{type:"common"}}},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.productName="",this.brandName="",this.price="",this.sellPoints=[],this.audienceTypes=[],this.discountActivity=[],this.inputMode=0,this.userInputTexts=[],this.tabType="",this.lifeData="",this.originProductName="",(0,r.tZ)(this,e,o)}}let l={common:["product_name","brand_name","price","input_mode","tab_type","life_data","origin_product_name"],array:{sell_points:{type:"common"},audience_types:{type:"common"},discount_activity:{type:"common"},user_input_texts:{type:"common"}}},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},691600:function(e,t,i){i.d(t,{P$:function(){return m}});var r=i(669686),n=i(150251),a=i(818149),o=i(382068),s=i(488071),l=i(686513),d=i(908301);let c={common:["text_material_id","clip_type","order_in_layer","capital"],array:{extra_material_refs:{type:"common"},lyric_keyframes:{type:"object",clsName:()=>o.ko},word_index:{type:"common"},text_effect_materials:{type:"object",clsName:()=>l.eA}},object:{attach_info:{type:()=>a.aw},text_material:{type:()=>s.jG},text_shape_material:{type:()=>l.eA,nullable:!0},text_animate_material:{type:()=>d.ZP,nullable:!0},bloom_effect_material:{type:()=>l.eA,nullable:!0}}},u=(0,r.I2)(c,["textMaterial","textShapeMaterial","textAnimateMaterial","bloomEffectMaterial","textEffectMaterials"]);class m extends n.w8{static deserialize(e){let t=new m;return(0,r.Tz)(t,e,c),t}static serialize(e){return(0,r.o8)(e,c)}clone(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=new m;return(0,r.he)(this,i,c,t),i.textMaterial=this.textMaterial?this.textMaterial.clone(t):new s.jG,i.textShapeMaterial=this.textShapeMaterial?this.textShapeMaterial.clone(t):void 0,i.textAnimateMaterial=this.textAnimateMaterial?this.textAnimateMaterial.clone(t):void 0,i.bloomEffectMaterial=this.bloomEffectMaterial?this.bloomEffectMaterial.clone(t):void 0,i.textEffectMaterials=(null!==(e=this.textEffectMaterials)&&void 0!==e?e:[]).map(e=>e.clone(t)),i}constructor(e={}){super(),this[n.I9]=p,this.attachInfo=new a.aw,this.textMaterialId="",this.extraMaterialRefs=[],this.clipType="",this.lyricKeyframes=[],this.wordIndex=[],this.orderInLayer=0,this.capital="",this.textMaterial=new s.jG,this.textEffectMaterials=[],(0,r.tZ)(this,e,u)}}let h={common:["text_material_id","clip_type","order_in_layer","capital"],array:{extra_material_refs:{type:"common"},lyric_keyframes:{type:"object",clsName:()=>o.ko},word_index:{type:"common"},text_effect_materials:{type:"object",clsName:()=>l.eA}},object:{attach_info:{type:()=>a.WT},text_material:{type:()=>s.ed},text_shape_material:{type:()=>l.W9,nullable:!0},text_animate_material:{type:()=>d.PA,nullable:!0},bloom_effect_material:{type:()=>l.W9,nullable:!0}}},f=(0,r.I2)(h,["textMaterial","textShapeMaterial","textAnimateMaterial","bloomEffectMaterial","textEffectMaterials"]);class p extends n.u2{static deserialize(e){let t=new p;return(0,r.Tz)(t,e,h,!0),t}static serialize(e){return(0,r.o8)(e,h,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new p;if((0,r.he)(this,t,h,e,!1,!0),null!==this.textMaterial&&void 0!==this.textMaterial&&(t.textMaterial=this.textMaterial?this.textMaterial.clone(e):new s.ed),null!==this.textShapeMaterial&&void 0!==this.textShapeMaterial&&(t.textShapeMaterial=this.textShapeMaterial?this.textShapeMaterial.clone(e):void 0),null!==this.textAnimateMaterial&&void 0!==this.textAnimateMaterial&&(t.textAnimateMaterial=this.textAnimateMaterial?this.textAnimateMaterial.clone(e):void 0),null!==this.bloomEffectMaterial&&void 0!==this.bloomEffectMaterial&&(t.bloomEffectMaterial=this.bloomEffectMaterial?this.bloomEffectMaterial.clone(e):void 0),null!==this.textEffectMaterials&&void 0!==this.textEffectMaterials){var i;t.textEffectMaterials=(null!==(i=this.textEffectMaterials)&&void 0!==i?i:[]).map(t=>t.clone(e))}return t}constructor(e={}){super(),this[n._n]=m,(0,r.fZ)(this,e,f)}}},510742:function(e,t,i){i.d(t,{b9:function(){return s},eG:function(){return c}});var r=i(669686),n=i(150251);let a={common:["enable","angle"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.enable=!1,this.angle=72,(0,r.tZ)(this,e,o)}}let l={common:["enable","angle"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},30145:function(e,t,i){i.d(t,{SV:function(){return l}});var r=i(602777),n=i(669686),a=i(150251);let o={common:["location","length","source_type"]},s=(0,n.I2)(o,[]);class l extends a.w8{static deserialize(e){let t=new l;return(0,n.Tz)(t,e,o),t}static serialize(e){return(0,n.o8)(e,o)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new l;return(0,n.he)(this,t,o,e),t}constructor(e={}){super(),this[a.I9]=u,this.location=0,this.length=0,this.sourceType=r.Q6.SubtitleKeywordsSourceUnknown,(0,n.tZ)(this,e,s)}}let d={common:["location","length","source_type"]},c=(0,n.I2)(d,[]);class u extends a.u2{static deserialize(e){let t=new u;return(0,n.Tz)(t,e,d,!0),t}static serialize(e){return(0,n.o8)(e,d,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new u;return(0,n.he)(this,t,d,e,!1,!0),t}constructor(e={}){super(),this[a._n]=l,(0,n.fZ)(this,e,c)}}},433568:function(e,t,i){i.d(t,{Fr:function(){return c},UO:function(){return h}});var r=i(669686),n=i(150251),a=i(703753),o=i(43987),s=i(38629);let l={common:["template_id","smart_match_type","is_start_from_text"],array:{transfer_paths:{type:"common"}},object:{tutorial_info:{type:()=>a.vc,nullable:!0},split_screen_info:{type:()=>o.Q3,nullable:!0},subtitle_batch_editing_info:{type:()=>s.Sj,nullable:!0}}},d=(0,r.I2)(l,[]);class c extends n.w8{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l),t}static serialize(e){return(0,r.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e),t}constructor(e={}){super(),this[n.I9]=h,this.transferPaths=[],this.templateId="",this.smartMatchType=0,this.isStartFromText=!1,(0,r.tZ)(this,e,d)}}let u={common:["template_id","smart_match_type","is_start_from_text"],array:{transfer_paths:{type:"common"}},object:{tutorial_info:{type:()=>a.PV,nullable:!0},split_screen_info:{type:()=>o.i8,nullable:!0},subtitle_batch_editing_info:{type:()=>s.I6,nullable:!0}}},m=(0,r.I2)(u,[]);class h extends n.u2{static deserialize(e){let t=new h;return(0,r.Tz)(t,e,u,!0),t}static serialize(e){return(0,r.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,r.he)(this,t,u,e,!1,!0),t}constructor(e={}){super(),this[n._n]=c,(0,r.fZ)(this,e,m)}}},458622:function(e,t,i){i.d(t,{C4:function(){return h},fQ:function(){return c}});var r=i(602777),n=i(287165),a=i(669686),o=i(150251),s=i(53823);let l={common:["id","type","flag","attribute","name","is_default_name"],array:{segments:{type:"object",clsName:()=>s.XX}}},d=(0,a.I2)(l,[]);class c extends o.w8{static deserialize(e){let t=new c;return(0,a.Tz)(t,e,l),t}static serialize(e){return(0,a.o8)(e,l)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,a.he)(this,t,l,e,["id"]),t}constructor(e={}){super(),this[o.I9]=h,this.id=(0,n.p)(),this.type=r.pN.TrackTypeNone,this.segments=[],this.flag=r.w9.FlagNone,this.attribute=0,this.name="",this.isDefaultName=!1,(0,a.tZ)(this,e,d)}}let u={common:["id","type","flag","attribute","name","is_default_name"],array:{segments:{type:"object",clsName:()=>s.XX}}},m=(0,a.I2)(u,[]);class h extends o.u2{static deserialize(e){let t=new h;return(0,a.Tz)(t,e,u,!0),t}static serialize(e){return(0,a.o8)(e,u,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new h;return(0,a.he)(this,t,u,e,["id"],!0),t}constructor(e={}){super(),this[o._n]=c,(0,a.fZ)(this,e,m)}}},883501:function(e,t,i){i.d(t,{jP:function(){return c},wx:function(){return s}});var r=i(669686),n=i(150251);let a={common:["x","y"]},o=(0,r.I2)(a,[]);class s extends n.w8{static deserialize(e){let t=new s;return(0,r.Tz)(t,e,a),t}static serialize(e){return(0,r.o8)(e,a)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new s;return(0,r.he)(this,t,a,e),t}constructor(e={}){super(),this[n.I9]=c,this.x=0,this.y=0,(0,r.tZ)(this,e,o)}}let l={common:["x","y"]},d=(0,r.I2)(l,[]);class c extends n.u2{static deserialize(e){let t=new c;return(0,r.Tz)(t,e,l,!0),t}static serialize(e){return(0,r.o8)(e,l,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new c;return(0,r.he)(this,t,l,e,!1,!0),t}constructor(e={}){super(),this[n._n]=s,(0,r.fZ)(this,e,d)}}},734879:function(e,t,i){i.d(t,{He:function(){return d}});var r=i(602777),n=i(669686),a=i(150251),o=i(215040);let s={common:["id","feature_id","feature_name","feature_key","vip_status","type","icon_url","segment_id","combination_segment_id","feature_pay_status","from_template_id"],array:{ref_list:{type:"object",clsName:()=>o.ak}}},l=(0,n.I2)(s,[]);class d extends a.w8{static deserialize(e){let t=new d;return(0,n.Tz)(t,e,s),t}static serialize(e){return(0,n.o8)(e,s)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new d;return(0,n.he)(this,t,s,e),t}constructor(e={}){super(),this[a.I9]=m,this.id="",this.featureId="",this.featureName="",this.featureKey="",this.vipStatus=r.Dy.VipStatusUnknown,this.type=r.Dj.VipFeatureUnKnown,this.iconUrl="",this.segmentId="",this.combinationSegmentId="",this.featurePayStatus=r.LC.FeaturePayStatusNeed,this.refList=[],this.fromTemplateId="",(0,n.tZ)(this,e,l)}}let c={common:["id","feature_id","feature_name","feature_key","vip_status","type","icon_url","segment_id","combination_segment_id","feature_pay_status","from_template_id"],array:{ref_list:{type:"object",clsName:()=>o.ak}}},u=(0,n.I2)(c,[]);class m extends a.u2{static deserialize(e){let t=new m;return(0,n.Tz)(t,e,c,!0),t}static serialize(e){return(0,n.o8)(e,c,!0)}clone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new m;return(0,n.he)(this,t,c,e,!1,!0),t}constructor(e={}){super(),this[a._n]=d,(0,n.fZ)(this,e,u)}}},534418:function(e,t,i){i.d(t,{b:function(){return r}});class r{clone(e){let t=new r;for(let[i,r]of this.aiWriterInfos.entries())t.aiWriterInfos.set(i,r.clone(e));return t}constructor(){this.aiWriterInfos=new Map}}},825245:function(e,t,i){i.d(t,{i:function(){return r}});class r{clone(e){let t=new r;for(let[i,r]of this.asyncTaskMap.entries())t.asyncTaskMap.set(i,r.clone(e));return t}constructor(){this.asyncTaskMap=new Map}}},524595:function(e,t,i){i.d(t,{c:function(){return r}});class r{clone(e){let t=new r;return t.algorithms=new Map,this.algorithms.forEach((i,r)=>{t.algorithms.set(r,i.clone(e))}),t}constructor(){this.algorithms=new Map}}},307502:function(e,t,i){i.d(t,{l:function(){return n}});var r=i(881337);class n{static deserialize(e){let t=new n;return t.ensureDraftCanvasSizeEnabled=e.ensureDraftCanvasSizeEnabled,t.modifyCanvasManually=e.modifyCanvasManually,t.abEnableResolution720=e.abEnableResolution720,t.ensureDraftCanvasSizeParam=e.ensureDraftCanvasSizeParam,t}static serialize(e){return e}constructor(){this.ensureDraftCanvasSizeEnabled=!0,this.ensureDraftCanvasSizeParam=(0,r.jT7)({}),this.modifyCanvasManually=!1,this.abEnableResolution720=!1}}},268468:function(e,t,i){i.d(t,{C4:function(){return r.C4},UK:function(){return n.UK},UY:function(){return n.UY},Uw:function(){return a.Uw},fQ:function(){return r.fQ},nu:function(){return s.nu},q7:function(){return o.q},ry:function(){return a.ry},wO:function(){return r.fQ}}),i(53823);var r=i(458622),n=i(545065),a=i(678912),o=i(744207),s=i(9592)},181874:function(e,t,i){i.d(t,{$:function(){return o},D:function(){return a}});var r=i(379012),n=i(903849);function a(e,t,i,a){a.material=(0,n.t0)(e.materials,"drafts",[a.materialId],void 0,r.Wu),(0,n.j)(e.keyframeGraphList,a)}function o(e,t,i,r,a,o){o.materialId=a.material.id,(0,n.af)(e.materials,"drafts",a.material),(0,n.P$)(i,t,a.id),(0,n.SQ)(e.keyframeGraphList,a,o)}},610845:function(e,t,i){i.d(t,{a:function(){return a},g:function(){return o}});var r=i(569566),n=i(903849);function a(e,t,i,a){a.material=(0,n.t0)(e.materials,"videoEffects",[a.materialId],void 0,r.a8),a.keyframes=(0,n.tI)(e.keyframes,"effects",a.keyframeRefs),a.applySegmentId=(0,n.JY)(t,a.materialId),(0,n.j)(e.keyframeGraphList,a)}function o(e,t,i,r,a,o){o.materialId=a.material.id,(0,n.af)(e.materials,"videoEffects",a.material),(0,n.u4)(e.keyframes,"effects",r,a.keyframes),(0,n.SQ)(e.keyframeGraphList,a,o)}},38702:function(e,t,i){i.d(t,{I:function(){return c},c:function(){return u}});var r=i(563091),n=i(280283),a=i(6467),o=i(956156),s=i(602777),l=i(903849),d=i(211561);function c(e,t,i,c){c.material=(0,l.t0)(e.materials,"videos",[c.materialId],void 0,r.Ub),c.materialDraft=(0,l.t0)(e.materials,"drafts",c.extraMaterialRefs,s.cV.MetaTypeCombination),c.speed=(0,l.t0)(e.materials,"speeds",c.extraMaterialRefs,void 0,n.Ug),c.chroma=(0,l.t0)(e.materials,"chromas",c.extraMaterialRefs),c.filter=(0,l.t0)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeFilter),c.beat=(0,l.t0)(e.materials,"beats",c.extraMaterialRefs),c.smartCrop=(0,l.t0)(e.materials,"smartCrops",c.extraMaterialRefs);let u=(0,l.Vm)(e.materials,"videoEffects",c.extraMaterialRefs,s.cV.MetaTypeVideoEffect),m=(0,l.Vm)(e.materials,"videoEffects",c.extraMaterialRefs,s.cV.MetaTypeFaceEffect);c.videoEffects=[...u,...m],c.beauty=(0,l.t0)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeBeauty),c.reshape=(0,l.t0)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeReshape),c.adjust=(0,l.In)(e.materials,c.extraMaterialRefs,c.materialId,c),c.mixMode=(0,l.t0)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeVideoMix),c.transition=(0,l.t0)(e.materials,"transitions",c.extraMaterialRefs),c.videoMask=(0,l.Vm)(e.materials,"commonMask",c.extraMaterialRefs),c.background=(0,l.t0)(e.materials,"canvases",c.extraMaterialRefs,void 0,a.fl),c.voiceChange=(0,l.Vm)(e.materials,"audioEffects",c.extraMaterialRefs),c.realtimeDenoise=(0,l.t0)(e.materials,"realtimeDenoises",c.extraMaterialRefs),c.keyframes=(0,l.tI)(e.keyframes,"videos",c.keyframeRefs),c.stretchLeg=(0,l.t0)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeStretchLeg),c.figures=(0,l.Vm)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeFigure),c.makeupRoot=(0,l.t0)(e.materials,"effects",c.extraMaterialRefs,s.cV.MetaTypeMakeupRoot),c.videoTracking=(0,l.t0)(e.materials,"videoTrackings",c.extraMaterialRefs),c.manualDeformation=(0,l.t0)(e.materials,"manualDeformations",c.extraMaterialRefs);let h=(0,l.Vm)(e.materials,"pluginEffects",c.extraMaterialRefs,s.cV.MetaTypePluginEffect);c.pluginEffects=[...h.filter(e=>{let{id:t}=e;return!i.has(t)})],c.animations=(0,l.t0)(e.materials,"materialAnimations",c.extraMaterialRefs),c.soundChannelMapping=(0,l.t0)(e.materials,"soundChannelMappings",c.extraMaterialRefs,void 0,o.tU),c.greenScreen=(0,l.t0)(e.materials,"greenScreens",c.extraMaterialRefs),c.digitalHuman=(0,l.t0)(e.materials,"digitalHumans",c.extraMaterialRefs),c.vocalSeparation=(0,l.t0)(e.materials,"vocalSeparations",c.extraMaterialRefs,void 0,d.JcE),c.vocalBeautify=(0,l.t0)(e.materials,"vocalBeautifys",c.extraMaterialRefs,void 0,d.jGb),(0,l.j)(e.keyframeGraphList,c)}function u(e,t,i,r,n,a){a.materialId=n.material.id,(0,l.af)(e.materials,"videos",n.material),(0,l.u$)(e.materials,"drafts",i,n.materialDraft),(0,l.u$)(e.materials,"speeds",i,n.speed),(0,l.u$)(e.materials,"chromas",i,n.chroma),(0,l.u$)(e.materials,"effects",i,n.filter),(0,l.u$)(e.materials,"beats",i,n.beat),(0,l.u$)(e.materials,"smartCrops",i,n.smartCrop),(0,l.QN)(e.materials,"videoEffects",i,n.videoEffects),(0,l.u$)(e.materials,"effects",i,n.beauty),(0,l.u$)(e.materials,"effects",i,n.reshape),(0,l.Xb)(e.materials,i,n,a),(0,l.u$)(e.materials,"effects",i,n.mixMode),(0,l.u$)(e.materials,"transitions",i,n.transition),(0,l.QN)(e.materials,"commonMask",i,n.videoMask),(0,l.u$)(e.materials,"canvases",i,n.background),(0,l.QN)(e.materials,"audioEffects",i,n.voiceChange),(0,l.u$)(e.materials,"realtimeDenoises",i,n.realtimeDenoise),(0,l.u4)(e.keyframes,"videos",r,n.keyframes),(0,l.u$)(e.materials,"effects",i,n.stretchLeg),(0,l.QN)(e.materials,"effects",i,n.figures),(0,l.u$)(e.materials,"effects",i,n.makeupRoot),(0,l.u$)(e.materials,"videoTrackings",i,n.videoTracking),(0,l.u$)(e.materials,"manualDeformations",i,n.manualDeformation),(0,l.QN)(e.materials,"pluginEffects",i,n.pluginEffects),(0,l.u$)(e.materials,"materialAnimations",i,n.animations),(0,l.u$)(e.materials,"soundChannelMappings",i,n.soundChannelMapping),(0,l.u$)(e.materials,"greenScreens",i,n.greenScreen),(0,l.P$)(i,t,n.id),(0,l.SQ)(e.keyframeGraphList,n,a),(0,l.u$)(e.materials,"digitalHumans",i,n.digitalHuman),(0,l.u$)(e.materials,"vocalSeparations",i,n.vocalSeparation),(0,l.u$)(e.materials,"vocalBeautifys",i,n.vocalBeautify)}},89172:function(e,t,i){i.d(t,{Q3:function(){return n},Ww:function(){return a},lr:function(){return r},s4:function(){return o}});let r="127.0.0",n="32.0.1",a="15.4.0",o=400000n},646290:function(e,t,i){i.d(t,{e:function(){return m}});var r=i(475028),n=i(690613),a=i(545065),o=i(283751),s=i(932422),l=i(392742),d=i(198544),c=i(340294);let u=(0,r.i)(d.m.UpdateSegmentSubDraftNotExist,"");class m extends s.m{static deserialize(e){let t=new m({...e,metadataDelta:a.UK.deserialize(e.metadataDelta)});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";e.draftId&&(t+=`"draftId":"${e.draftId}",`);let i=a.UK.serialize(e.metadataDelta);return t+=`"metadataDelta":${c.HH.stringify(i)},"version":"${e.version}","type":${e.type}}`}invert(e){let t=new a.UK;return[new m({draftId:this.draftId,metadataDelta:o.T.pick(e.metadata,this.metadataDelta,t)})]}transform(e,t){return[this]}check(e){return e.getDraftById(this.draftId)?(0,n.ly)():u(`subDraft not exist: ${this.draftId}`)}runOnModel(e){return e.getDraftById(this.draftId).updateMetadata(this.metadataDelta)}clone(){return new m({draftId:this.draftId,metadataDelta:this.metadataDelta})}constructor(e){super(),this.type=l.x.SetDocumentMetadata,this.metadataDelta=e.metadataDelta}}},700857:function(e,t,i){i.d(t,{W:function(){return m}});var r=i(475028),n=i(690613),a=i(678912),o=i(283751),s=i(932422),l=i(392742),d=i(198544),c=i(340294);let u=(0,r.i)(d.m.UpdateSegmentSubDraftNotExist,"");class m extends s.m{static deserialize(e){let t=new m({...e,propertyDelta:a.ry.deserialize(e.propertyDelta)});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";e.draftId&&(t+=`"draftId":"${e.draftId}",`);let i=a.ry.serialize(e.propertyDelta);return t+=`"propertyDelta":${c.HH.stringify(i)},"version":"${e.version}","type":${e.type}}`}invert(e){var t;let i=null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e,r=new a.ry;return[new m({draftId:this.draftId,propertyDelta:o.T.pick(i.property,this.propertyDelta,r)})]}transform(e,t){return[this]}check(e){return e.getDraftById(this.draftId)?(0,n.ly)():u(`subDraft not exist: ${this.draftId}`)}runOnModel(e){return e.getDraftById(this.draftId).updateProperty(this.propertyDelta)}clone(){return new m({draftId:this.draftId,propertyDelta:this.propertyDelta})}constructor(e){super(),this.type=l.x.SetDocumentProperty,this.draftId=e.draftId,this.propertyDelta=e.propertyDelta}}},418892:function(e,t,i){i.d(t,{C:function(){return o}});var r=i(330902),n=i(805794),a=i(188670);class o{applyMutations(e,t,i){t.forEach(t=>{this.applyMutation(e,t,i)})}applyMutationGenerator(e,t,i,r,n){return t((t,a)=>{let o=[];r&&(o=t.invert(e));let s=this.applyMutation(e,t,n);return r&&i.unshift(...o),s})}applyMutation(e,t){arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.J.Local;try{let i=t.run(e);if(!i.ok)throw Error(i.toString());return i.value}catch(e){throw n.B.reportError("apply_mutation_error",e.message,e,{type:"lyra_sdk_event",apiType:"data",mutationType:t.type}),e}}follow(e,t,i){try{return(0,a.L)(e,t,i)}catch(e){throw n.B.error("transform mutations error: ","",e),e}}compose(e,t){return[...e,...t]}}},553197:function(e,t,i){i.d(t,{R:function(){return _},a:function(){return T}});var r=i(646290),n=i(700857),a=i(121684),o=i(392742),s=i(313934),l=i(599446),d=i(575016),c=i(129862),u=i(430832),m=i(333217),h=i(900017),f=i(417609),p=i(381119),g=i(419537),y=i(76592);let _={[o.x.UpdateSegment]:c.F,[o.x.SetDocumentProperty]:n.W,[o.x.InsertTrack]:m.c,[o.x.InsertSegment]:l._,[o.x.SetDocumentMetadata]:r.e,[o.x.DeleteTrack]:u.R,[o.x.DeleteSegment]:s.j,[o.x.MoveSegment]:d.B,[o.x.MoveTrack]:h.p,[o.x.UpdateTrack]:f.t,[o.x.SetGroupContainerProperty]:a.r,[o.x.AttachmentInsertMutation]:p.Q,[o.x.AttachmentUpdateMutation]:g.K,[o.x.AttachmentDeleteMutation]:y.h},T=[o.x.SetDocumentProperty,o.x.SetDocumentMetadata,o.x.UpdateSegment]},599446:function(e,t,i){i.d(t,{_:function(){return S}});var r=i(211561),n=i(932422),a=i(198544),o=i(392742),s=i(313934),l=i(475028),d=i(690613),c=i(481631),u=i(340294),m=i(356898),h=i(333217),f=i(699791);let p=(0,l.i)(a.m.InsertSegmentTrackIdNotExist,""),g=(0,l.i)(a.m.InsertSegmentIdDuplicate,""),y=(0,l.i)(a.m.InsertSegmentTargetTimerangeStartInvalid,""),_=(0,l.i)(a.m.InsertSegmentTargetTimerangeDurationInvalid,""),T=(0,l.i)(a.m.InsertSegmentTargetTimerangeOverlap,""),v=(0,l.i)(a.m.InsertSegmentSourceTimerangeStartInvalid,""),I=(0,l.i)(a.m.InsertSegmentSourceTimerangeDurationInvalid,""),w=(0,l.i)(a.m.InsertSegmentMaterialDurationInvalid,"");class S extends n.m{static deserialize(e){let t=new S({draftId:e.draftId,trackId:e.trackId,trackIndex:e.trackIndex,segment:(0,m.OZ)(e.segment)});return t.updateDataVersion(e.version),t}static serialize(e){let t="{";e.draftId&&(t+=`"draftId":"${e.draftId}",`),t+=`"trackId":"${e.trackId}","trackIndex":${e.trackIndex},`;let i=(0,m.VK)(e.segment);return t+=`"segment":${u.HH.stringify(i)},"version":"${e.version}","type":${e.type}}`}invert(e){return[new s.j({draftId:this.draftId,trackId:this.trackId,trackIndex:this.trackIndex,segmentId:this.segment.id,targetTimerange:this.segment.targetTimerange})]}transform(e,t){let i={[o.x.InsertSegment]:this._transformWithInsertSegmentMutation.bind(this,e,t),[o.x.DeleteSegment]:this._transformWithDeleteSegmentMutation.bind(this,e),[o.x.MoveSegment]:this._transformWithMoveSegmentMutation.bind(this,e,t),[o.x.UpdateSegment]:this._transformWithUpdateSegmentMutation.bind(this,e,t),[o.x.InsertTrack]:this._transformWithInsertTrackMutation.bind(this,e,t),[o.x.DeleteTrack]:this._transformWithDeleteTrackMutation.bind(this,e,t),[o.x.MoveTrack]:this._transformWithMoveTrackMutation.bind(this,e,t),[o.x.UpdateTrack]:this._transformWithUpdateTrackMutation.bind(this,e,t)};return i[e.type]?i[e.type]():[this]}check(e){var t;let{trackId:i,segment:n}=this,a=null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e;if(!a.getTrackById(i))return p(`track not exist: ${i}`);if(a.getSegmentByTrackIdAndSegmentId(i,n.id))return g(`id duplicate: ${n.id}`);let{start:o,duration:s}=this.segment.targetTimerange;if(!(o>=0n))return y(`start invalid: ${o}`);if(!(s>0n))return _(`duration invalid: ${s}`);if((0,c.he)(this.segment)||(0,c.Y9)(this.segment)){if("bigint"==typeof this.segment.sourceTimerange.start&&this.segment.sourceTimerange.start<0n)return v(`start invalid: ${this.segment.sourceTimerange.start}`);if((0,c.he)(this.segment)&&this.segment.material.type===r.cVg.MetaTypeVideo||(0,c.Y9)(this.segment)){if("bigint"==typeof this.segment.sourceTimerange.duration&&this.segment.sourceTimerange.duration<=0n)return I(`duration invalid: ${this.segment.sourceTimerange.duration}`);if(!this.segment.material.duration||this.segment.material.duration<=0n)return w(`duration invalid: ${this.segment.material.duration}`)}}return(0,d.ly)()}runOnModel(e){var t;let i=this.segment.clone();(null!==(t=e.getDraftById(this.draftId))&&void 0!==t?t:e).insertSegment(this.trackId,i)}_checkTimerangeOverlap(e){let t=e.getTrackById(this.trackId);if(t.type!==r.pNd.TrackTypeVideo)return(0,d.ly)();let{start:i,duration:n}=this.segment.targetTimerange,a=i+n;for(let e of t.segments){let{start:t,duration:r}=e.targetTimerange,n=t+r;if(t<a&&n>i)return T(`timerange overlap: [${i}, ${a}] [${t}, ${n}]`)}return(0,d.ly)()}_transformWithInsertSegmentMutation(e,t){let{trackId:i,trackIndex:r}=this,{trackId:n}=e;return i!==n?[this]:0===r?this._transformWithInsertSegmentMutationInMainTrack(e,t):this._transformWithInsertSegmentMutationInSecondaryTrack(e,t)}_transformWithInsertSegmentMutationInMainTrack(e,t){let{trackId:i,segment:r,draftId:n,trackIndex:a}=this,{targetTimerange:o}=r,{segment:s}=e,{targetTimerange:l}=s;if(o.start>l.start||o.start===l.start&&t){let e=r.clone(!1);return e.targetTimerange.start+=l.duration,[new S({draftId:n,trackId:i,trackIndex:a,segment:e})]}return[this]}_transformWithInsertSegmentMutationInSecondaryTrack(e,t){let{trackId:i,segment:r,draftId:n,trackIndex:a}=this,{targetTimerange:o}=r;o.start,o.duration;let{segment:s}=e,{targetTimerange:l}=s,d=l.start+l.duration;if((0,f.D)(l,o)||t&&o.start===l.start){let e=d-o.start,t=r.clone(!1);return t.targetTimerange.start+=e,[new S({draftId:n,trackId:i,trackIndex:a,segment:t})]}return[this]}_transformWithDeleteSegmentMutation(e){let{trackId:t,segment:i,draftId:r,trackIndex:n}=this,{targetTimerange:a}=i,{trackId:o,targetTimerange:s}=e;if(t!==o||0!==n)return[this];if(a.start>s.start){let e=i.clone(!1);return e.targetTimerange.start-=s.duration,[new S({draftId:r,trackId:t,trackIndex:n,segment:e})]}return[this]}_transformWithMoveSegmentMutation(e,t){let{trackId:i,segment:r,draftId:n,trackIndex:a}=this,{targetTimerange:o}=r,{srcTrackIndex:s,desTrackIndex:l,srcTargetTimeRanges:d,desTargetTimeRanges:c,srcTrackId:u,desTrackId:m}=e;if(i!==u&&i!==m)return[this];let h=r.clone(!1);return a===s&&0===a&&d.forEach(e=>{o.start>e.start&&(h.targetTimerange.start-=e.duration)}),a===l&&c.forEach(e=>{let i=e.start+e.duration;if(0===a&&(o.start>e.start||o.start===e.start&&t))h.targetTimerange.start+=e.duration;else if(0!==a&&((0,f.D)(e,o)||t&&o.start===e.start)){let e=i-o.start;h.targetTimerange.start+=e}}),[new S({draftId:n,trackId:i,trackIndex:a,segment:h})]}_transformWithUpdateSegmentMutation(e,t){let{trackId:i,segment:r,draftId:n,trackIndex:a}=this,{targetTimerange:o}=r,{segmentDelta:s,trackId:l,segmentId:d,sourceSegmentDelta:c}=e,{targetTimerange:u}=s,{targetTimerange:m}=c;if(i!==l||!u||!m)return[this];o.start,o.duration;let h=u.start+u.duration;if(0===a&&(o.start>u.start||o.start===u.start&&t)){let e=r.clone(!1),t=u.duration-m.duration;return e.targetTimerange.start+=t,[new S({draftId:n,trackId:i,trackIndex:a,segment:e})]}if(0!==a&&((0,f.D)(u,o)||t&&o.start===u.start)){let e=r.clone(!1),t=h-o.start;return e.targetTimerange.start+=t,[new S({draftId:n,trackId:i,trackIndex:a,segment:e})]}return[this]}_transformWithInsertTrackMutation(e,t){let{trackIndex:i,segment:r,draftId:n,trackId:a}=this,{trackIndex:o}=e;return i>=o&&t?[new S({trackId:a,trackIndex:i+1,segment:r,draftId:n})]:[this]}_transformWithDeleteTrackMutation(e,t){let{trackId:i,trackIndex:r,segment:n,draftId:a}=this,{trackId:o,trackIndex:s,trackProperty:l}=e;return i===o?[new h.c({draftId:a,trackIndex:s,trackProperty:{...l,segments:[]}}),this]:r>s&&t?[new S({trackId:i,trackIndex:r-1,segment:n,draftId:a})]:[this]}_transformWithMoveTrackMutation(e,t){return[this]}_transformWithUpdateTrackMutation(e,t){let{trackId:i,draftId:r,trackIndex:n,segment:a}=this,{trackId:o,trackDelta:s}=e;return i!==o?[this]:s.id&&t?[new S({draftId:r,trackId:s.id,trackIndex:n,segment:a})]:s.segments?[]:[this]}clone(){return new S({draftId:this.draftId,trackId:this.trackId,trackIndex:this.trackIndex,segment:this.segment})}constructor(e){super(),this.type=o.x.InsertSegment,this.draftId=e.draftId,this.trackId=e.trackId,this.segment=e.segment,this.trackIndex=e.trackIndex}}},699791:function(e,t,i){i.d(t,{D:function(){return r}});function r(e,t){let{start:i,duration:r}=e,{start:n}=t;return!!i&&!!r&&!!n&&i<n&&i+r>n}},358324:function(e,t,i){i.d(t,{iB:function(){return d},kq:function(){return l},nk:function(){return s},zk:function(){return o}});var r=i(211561),n=i(242905),a=i(342040);function o(e,t){return void 0!==t.duration&&null!==t.duration&&e.editor.setMaxDuration(t.duration),!1}function s(e,t,i){var n,o,s,l,d,c,u,m,h,f,p,g,y,_,T,v,I,w,S,k,x,b;if((null===(n=t.canvasConfig)||void 0===n?void 0:n.domWidth)&&t.canvasConfig.domHeight&&e.player.setCanvasSize(t.canvasConfig.domWidth,t.canvasConfig.domHeight),(null===(s=t.canvasConfig)||void 0===s?void 0:null===(o=s.background)||void 0===o?void 0:o.type)!==void 0||(null===(d=t.canvasConfig)||void 0===d?void 0:null===(l=d.background)||void 0===l?void 0:l.color)!==void 0||(null===(u=t.canvasConfig)||void 0===u?void 0:null===(c=u.background)||void 0===c?void 0:c.image)!==void 0||(null===(h=t.canvasConfig)||void 0===h?void 0:null===(m=h.background)||void 0===m?void 0:m.blur)!==void 0){let t=i.getDraftProperty(),n=null!==(S=a.k.getInstance().pathRecords.get(null!==(w=null===(f=t.canvasConfig.background)||void 0===f?void 0:f.image)&&void 0!==w?w:"")||(null===(p=t.canvasConfig.background)||void 0===p?void 0:p.image))&&void 0!==S?S:"",o=Math.floor((null!==(k=null===(y=t.canvasConfig)||void 0===y?void 0:null===(g=y.background)||void 0===g?void 0:g.blur)&&void 0!==k?k:0)*14+.5),s={type:null!==(x=null===(T=t.canvasConfig)||void 0===T?void 0:null===(_=T.background)||void 0===_?void 0:_.type)&&void 0!==x?x:r.cVg.MetaTypeNone,color:null!==(b=null===(I=t.canvasConfig)||void 0===I?void 0:null===(v=I.background)||void 0===v?void 0:v.color)&&void 0!==b?b:"#000000",image:n,blur:o};e.editor.setBackground(s),e.player.setCanvasBackground(s)}return!1}function l(e,t,i){return e.editor.commit(()=>{let n=i.getAllTracks();for(let i=t;i<n.length;++i){let{type:t,segments:a}=n[i];if(0===i||t===r.pNd.TrackTypeAudio||a.length<=0)continue;let o=a[0],s=e.editor.getClipBase(o.id);if(!s)continue;let l=e.editor.getRenderIndex(o);e.editor.updateTrackIndex(s.trackId,l)}}),!1}function d(e,t,i){return!!t&&(e.editor.commit(()=>{i&&(0,n.u)(e,i),e.editor.removeClip(t)}),!0)}},671006:function(e,t,i){function r(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,n,a]=t;return r.editor.commit(()=>{r.sticker.add(n,a)}),!0}function n(){for(var e,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];let[n,a,o,s]=i,l=s.getSegmentById(a);return n.editor.commit(()=>{void 0!==o.targetTimerange&&n.sticker.update(a,s),(void 0!==o.clip||void 0!==o.commonKeyframes||void 0!==o.targetTimerange)&&n.sticker.updateTransform(a,null==l?void 0:l.clip,s,void 0,o),void 0!==o.animations&&n.sticker.updateAnimations(l),l&&((o.targetTimerange||void 0!==o.trackRenderIndex)&&n.editor.updateTargetTimeRange(l),void 0!==o.visible&&n.editor.updateVisible(l.id,l.visible),void 0!==o.videoTracking&&n.sticker.updateVideoTracking(l,o.videoTracking))}),(null===(e=o.targetTimerange)||void 0===e?void 0:e.start)!==void 0}i.d(t,{G:function(){return n},M:function(){return r}})},716854:function(e,t,i){i.d(t,{Sb:function(){return l},Vt:function(){return m},k6:function(){return u},nz:function(){return s},rt:function(){return d}});var r=i(556784),n=i(481631),a=i(283751),o=i(242905);function s(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,n]=t;return r.editor.commit(()=>{r.textTemplate.add(n)}),!0}function l(){for(var e,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];let[n,a,o,s]=i,l=s.getSegmentById(a);return!!l&&(n.editor.commit(()=>{n.textTemplate.update(l),(o.targetTimerange||void 0!==o.trackRenderIndex)&&n.editor.updateTargetTimeRange(l),void 0!==o.videoTracking&&n.textTemplate.updateVideoTracking(l,o.videoTracking)}),(null===(e=o.targetTimerange)||void 0===e?void 0:e.start)!==void 0)}function d(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[n,a,s,l]=t;return!!a&&(n.editor.commit(()=>{(0,o.u)(n,l),n.editor.removeClip(a),r.I.getCur().remove(a)}),!0)}function c(e,t,i,r){(0,n.Q2)(t)&&i.material&&e.textTemplate.update(t)}function u(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,o,s,l]=t,d=l.getSegmentById(o);if(!d||!(0,n.Q2)(d))return!1;let u=d.clone();return s?(a.T.merge(u,s),r.editor.commit(()=>{c(r,u,s,l)}),!1):(r.editor.commit(()=>{c(r,u,(0,n.xX)(d),l)}),!1)}function m(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,a,o,s]=t,l=s.getSegmentById(a);return!!(l&&(0,n.Q2)(l))&&(r.editor.commit(()=>{c(r,l,(0,n.xX)(l),s)}),!1)}},82288:function(e,t,i){i.d(t,{AG:function(){return s},T:function(){return l},dK:function(){return a},oZ:function(){return d}});var r=i(283751),n=i(481631);function a(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,n,a]=t;return r.editor.commit(()=>{r.text.add(n,a)}),!0}function o(e,t,i,r){if((0,n.Ft)(t)){var a,o;(i.material||i.effect||i.shape)&&e.text.update(t,r,i),void 0!==i.commonKeyframes&&e.text.updateKeyframes(r,t.id,t.id,i),(void 0!==i.targetTimerange||void 0!==i.commonKeyframes)&&e.text.updateTargetTimeRange(t),(void 0!==i.clip||void 0!==i.commonKeyframes||void 0!==i.targetTimerange)&&e.text.updateTransform(t.id,t.clip,r,i),((null===(a=i.material)||void 0===a?void 0:a.text)!==void 0||void 0!==i.animations||(null===(o=i.material)||void 0===o?void 0:o.words)!==void 0)&&e.text.updateAnimations(t),void 0!==i.visible&&e.editor.updateVisible(t.id,t.visible),void 0!==i.videoTracking&&e.text.updateVideoTracking(t,i.videoTracking)}}function s(){for(var e,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];let[n,a,s,l]=i,d=l.getSegmentById(a);return n.editor.commit(()=>{o(n,d,s,l)}),(null===(e=s.targetTimerange)||void 0===e?void 0:e.start)!==void 0}function l(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[n,a,s,l]=t,d=l.getSegmentById(a).clone();return r.T.merge(d,s),n.editor.commit(()=>{o(n,d,s,l)}),!1}function d(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,a,s,l]=t,d=l.getSegmentById(a);return r.editor.commit(()=>{o(r,d,(0,n.xX)(d),l)}),!1}i(127926)},790136:function(e,t,i){i.d(t,{je:function(){return r.je}});var r=i(542240)},587764:function(e,t,i){i.d(t,{$:function(){return u}});var r=i(239648),n=i(632634),a=i(342558),o=i(199039),s=i(396402),l=i(59670),d=i(481631),c=i(690613);class u extends l.D{add(e,t){var i,l,u,m;if(!(0,d.he)(e))return(0,c.wf)(n.FF.segmentInvalid,"no video segment");if(!e.transition)return(0,c.wf)(n.FF.segmentInvalid,"no video transition");let{transition:h}=e,f=t.getTrackBySegmentId(e.id);if(!f)return(0,c.wf)(n.FF.segmentInvalid,"segment not in track");if(!new r.Uo().findNextSegment(f,e))return(0,c.wf)(n.FF.segmentInvalid,"no next segment");let p=(0,o.L)(h,e),g=(0,a.Mv)(this._render.config.layerMode,e);g=(0,a.dM)(this._render.config.layerMode,g);let y=null===(i=this._render.editor)||void 0===i?void 0:i.addTrack(s.u2.VideoTrack,g);if(!y)return(0,c.wf)(n.FF.addTrackFail,"add track failed");(null===(l=this._render.editor)||void 0===l?void 0:l.getTransition(p.id))&&(null===(m=this._render.editor)||void 0===m||m.removeVideoTransition(p.id));let _=h.duration/2n,T=e.targetTimerange.start+e.targetTimerange.duration;return null===(u=this._render.editor)||void 0===u||u.addVideoTransition(y,p,T-_,T+_),(0,c.ly)()}remove(e,t){var i,r;if(!e)return(0,c.wf)(n.FF.segmentInvalid,"vido id is empty");let a=`${e}_transition`;return(null===(i=this._render.editor)||void 0===i?void 0:i.getTransition(a))?(null===(r=this._render.editor)||void 0===r||r.removeVideoTransition(a),(0,c.ly)()):(0,c.wf)(n.FF.removeTransitionFail,"transition not exits")}update(e){var t;if(!(0,d.he)(e))return(0,c.wf)(n.FF.segmentInvalid,"no video segment");if(!e.transition)return(0,c.wf)(n.FF.segmentInvalid,"no video transition");let i=(0,o.L)(e.transition,e);return 0!==(null===(t=this._render.editor)||void 0===t?void 0:t.updateVideoTransition(i))?(0,c.wf)(n.FF.updateTransitionFail,"update transition failed"):(0,c.ly)()}}},860846:function(e,t,i){i.d(t,{$5:function(){return y},DF:function(){return I},FI:function(){return T},Nq:function(){return p},SB:function(){return w},bN:function(){return _},bh:function(){return m},bi:function(){return c},cd:function(){return h},fW:function(){return v},p$:function(){return g},u5:function(){return u}}),i(342558);var r=i(211561),n=i(469997),a=i(396402),o=i(340294),s=i(542240),l=i(438176),d=i(342040);let c=(e,t)=>`${e.id}_effect_${t.id}`,u=e=>`${e.id}_filter`,m=(e,t)=>`${e.id}_single_figure_${t.resourceId}`,h=(e,t)=>`${e.id}_merge_figure_${t}`,f={[n.Ab.BRIGHTNESS]:"brightness",[n.Ab.CONTRAST]:"contrast",[n.Ab.SATURATION]:"saturation",[n.Ab.SHARPENING]:"sharpening",[n.Ab.HIGHLIGHT]:"highlight",[n.Ab.SHADOW]:"shadow",[n.Ab.SHADOW_HIGHLIGHT]:"shadow_highlight",[n.Ab.COLOR_TEMPERATURE]:"color_temperature",[n.Ab.HUE]:"hue",[n.Ab.COLOR_TEMPERATURE_HUE]:"color_temperature_hue",[n.Ab.COLOR_FADE]:"color_fade",[n.Ab.LIGHT_SENSATION]:"light_sensation",[n.Ab.VIGNETTING]:"vignetting",[n.Ab.PARTICLE]:"particle",[n.Ab.LUT]:"lut",[n.Ab.HSL]:"hsl",[n.Ab.VIDEO_COLOR_CURVES]:"color_curves",[n.Ab.VIDEO_PRIMARY_COLOR_WHEELS]:"primary_color_wheels",[n.Ab.VIDEO_LOG_COLOR_WHEELS]:"log_color_wheels",[n.Ab.SMART_COLOR_ADJUST]:"smart_color"},p=(e,t)=>{if(!f[t])throw Error("unknown video adjust type.");return`${e.id}_${f[t]}`},g=e=>{let{filters:t}=e,i=new Set;for(let[e]of t)e.search(/_effect_/)>0&&i.add(e);return i},y=(e,t,i)=>{let{filters:r}=e,n=p(t,i);return r.has(n)},_=(e,t)=>{let{filters:i}=e,r=new Set;for(let[e]of i)e.search(t)>=0&&r.add(e);return r};function T(e){return`${e}_smart_crop_filter`}function v(e,t){let i=`/__opfs_system_root/${t.cache_dir}`;return l.R&&(i=d.k.getInstance().pathRecords.get(t.cache_dir)),{id:e,type:a.UO.PluginFilter,pluginId:"uk.co.thefoundry.AlgorithmPlugin",m_jsonPara:JSON.stringify({params:{param_draft_path:i,param_scenes:t.render_scene,param_unique_key:t.key}}),m_pluginType:0,algorithm_id:"",enable_mask:!1,draftPath:""}}let I=e=>{if(e&r.R6k.cusMattingFlag)return s.mA.MATTING_TYPE_FOLLOW;if(e&r.R6k.aiMattingFlag)return s.mA.MATTING_TYPE_PORTRAIT;if(e&r.R6k.interactiveFlag)return s.mA.MATTING_TYPE_INTERACTIVE;else if(e&r.R6k.tagMattingFlag)return s.mA.MATTING_TYPE_COMBINE;else return s.mA.MATTING_TYPE_NONE},w=(e,t)=>{let i=[];if(Array.isArray(e))for(let t of e){let e={};Array.isArray(t.adjust_params)&&t.adjust_params.forEach(t=>{e={...e,...t}}),i.push({featurePath:t.feature_path,strokeParams:o.HH.stringify({...e,matting_stroke_adjust_color:t.color})})}return o.HH.stringify({name:"",version:"",blendPath:t,strokes:i})}},285474:function(e,t,i){i.d(t,{iE:function(){return l},pd:function(){return s},sk:function(){return o},vT:function(){return d}});var r=i(481631),n=i(342040),a=i(438176);let o=e=>{let{enableRelativeDistance:t,enableScale:i}=e;if(t&&i);else if(t)return 1;else if(i)return 2;return 3};function s(e){let t=function(e){let t=n.k.getInstance(),{tracker:i,trackingClipId:r,editor:o}=e,{infoSticker:s}=o;if(!s)return"";let l=!1;if(a.H){let e=o.clipSequenceMap[r];l=o.changeSequence(e)}let d=s.restoreTrackerData(i.targetSegmentId,t.pathRecords.get(i.dataPath),r,i.dataPath);return""===d&&console.error("****restoreTrackerData failed",i,s),a.H&&o.recoverySequence(l),d}(e),i=function(e,t){let{tracker:i,trackingClipId:r,editor:n}=e,{infoSticker:o}=n;if(!o||!t)return -1;let s=!1;if(a.H){let e=n.clipSequenceMap[r];s=n.changeSequence(e)}let l=o.bindTracker(i.targetSegmentId,t,r);return 0!==l&&console.error(`****bind tracker failed: ${l}`,i.targetSegmentId,t,r),a.H&&n.recoverySequence(s),l}(e,t);return function(e,t){let{trackingMode:i,trackingClipId:r,editor:n}=e,{infoSticker:o}=n;if(!o||0!==t)return -1;let s=!1;if(a.H){let e=n.clipSequenceMap[r];s=n.changeSequence(e)}return o.setTrackerTrackingMode(r,i),a.H&&n.recoverySequence(s),0}(e,i)}function l(e,t){var i;if(!(0,r.P2)(e)&&!(0,r.Ft)(e)&&!(0,r.Q2)(e))return console.error("segment is invalid"),[];if(!(null===(i=e.videoTracking)||void 0===i?void 0:i.trackers))return[];let{trackers:n}=e.videoTracking,a=[],l=o(e.videoTracking);return n.forEach(i=>{let r=s({editor:t,tracker:i,trackingClipId:e.id,trackingMode:l});a.push(r)}),a}async function d(e,t,i){var r;let n=[],a=e.id,{infoSticker:d}=i;if(!d)return Promise.all(n);let c=[...null!==(r=d.trackerMap.get(a))&&void 0!==r?r:[]];if(t){let r=o(t);if(c&&0!==c.length){if(!t.trackers)return;t.trackers.forEach(t=>{!c.find(e=>t.targetSegmentId===e.targetSegmentId)&&s({editor:i,tracker:t,trackingClipId:e.id,trackingMode:r})}),c.forEach(e=>{if(t.trackers&&!t.trackers.find(t=>t.targetSegmentId===e.targetSegmentId)){let t=new Promise(async t=>{await d.unbindTracker(e.targetSegmentId,e.trackerId,a),await d.deleteTracker(e.targetSegmentId,e.trackerId),t(1)});n.push(t)}}),t.trackers.forEach(t=>{let o=c.find(e=>t.targetSegmentId===e.targetSegmentId&&t.dataPath!==e.dataPath);if(o){let l=new Promise(async n=>{await d.unbindTracker(o.targetSegmentId,o.trackerId,a),s({editor:i,tracker:t,trackingClipId:e.id,trackingMode:r}),n(1)});n.push(l)}})}else l(e,i)}else c.forEach(e=>{let t=new Promise(async t=>{await d.unbindTracker(e.targetSegmentId,e.trackerId,a),await d.deleteTracker(e.targetSegmentId,e.trackerId),t(1)});n.push(t)});await Promise.all(n)}},444163:function(e,t,i){i.d(t,{P:function(){return r.P}});var r=i(344603)},632634:function(e,t,i){i.d(t,{FF:function(){return l},JH:function(){return o},de:function(){return s}});var r,n,a,o=((r={})[r.legacy=0]="legacy",r[r.webgl=1]="webgl",r);var s=((n={})[n.legacy=0]="legacy",n[n.track=1]="track",n[n.free=2]="free",n);var l=((a={})[a.editorNotInit=0]="editorNotInit",a[a.segmentInvalid=1]="segmentInvalid",a[a.addTrackFail=2]="addTrackFail",a[a.addClipFail=3]="addClipFail",a[a.updateClipFail=4]="updateClipFail",a[a.removeClipFail=5]="removeClipFail",a[a.addFilterFail=6]="addFilterFail",a[a.updateFilterFail=7]="updateFilterFail",a[a.removeFilterFail=8]="removeFilterFail",a[a.addKeyframeFail=9]="addKeyframeFail",a[a.updateKeyframeFail=10]="updateKeyframeFail",a[a.removeKeyframeFail=11]="removeKeyframeFail",a[a.addTransitionFail=12]="addTransitionFail",a[a.updateTransitionFail=13]="updateTransitionFail",a[a.removeTransitionFail=14]="removeTransitionFail",a)},615098:function(e,t,i){i.d(t,{v:function(){return s}});var r=i(211561),n=i(521987),a=i(481631),o=i(298188);function s(e){if((0,a.he)(e)){let t=(0,o.u)(e);if(t.path)return{path:t.path,sourceTimeRange:new r.tnv({start:t.trimIn,duration:t.trimOut-t.trimIn})}}else{let t=n.m3.getAudioAlgorithmProductionPath(e);if(t.path)return{path:t.path,sourceTimeRange:new r.tnv({start:e.sourceTimerange.start-t.timeRange.start,duration:e.sourceTimerange.duration})}}return{path:e.material.path,sourceTimeRange:e.sourceTimerange.clone()}}},298188:function(e,t,i){i.d(t,{u:function(){return n}});var r=i(521987);function n(e){let t={path:"",trimIn:0n,trimOut:0n};if(!e.visible)return t;let{path:i,timeRange:n}=r.m3.getAudioAlgorithmProductionPath(e);if(i&&n.duration>0n){let s=n.start,l=n.duration;if(s<0n||l<=0)return t;let d=0n;if(r.m3.hasVideoAlgorithm(e)&&!r.m3.hasVideoSpeechToSong(e)){var a,o;d=null!==(o=null===(a=e.material.videoAlgorithm.timeRange)||void 0===a?void 0:a.start)&&void 0!==o?o:0n}return{path:i,trimIn:d-s,trimOut:s+l}}return t}},469997:function(e,t,i){i.d(t,{$$:function(){return r.$$},Ab:function(){return r.Ab},C1:function(){return r.C1},CT:function(){return r.CT},E6:function(){return r.E6},EZ:function(){return r.EZ},F9:function(){return r.F9},HI:function(){return r.HI},KV:function(){return r.KV},NI:function(){return r.NI},Vp:function(){return r.Vp},XP:function(){return r.XP},Z:function(){return r.Z},bn:function(){return r.bn},ci:function(){return r.ci},dI:function(){return r.dI},ez:function(){return r.ez},ge:function(){return r.ge},lA:function(){return r.lA},mD:function(){return r.mD},qR:function(){return r.qR},sx:function(){return r.sx},vT:function(){return r.vT},vW:function(){return r.vW},y:function(){return r.y}});var r=i(367333)},378188:function(e,t,i){i.d(t,{Bt:()=>v,aB:()=>I,Fp:()=>_,oz:()=>C,g5:()=>M,FW:()=>F,bo:()=>P,VC:()=>E,Uo:()=>k,UT:()=>T,PJ:()=>A,Pt:()=>w,so:()=>D,$F:()=>l.$F});var r=i("396402"),n=i("211561"),a=i("469997"),o=i("912224"),s=i("998179"),l=i("729951"),d=i("433188"),c=i("231536"),u=i("481631"),m=i("508115"),h=i("342040"),f=i("361708"),p=i("521987"),g=i("298188");let y=2n*24n*60n*60n*1000n*1000n;function _(e){let t,i;let{material:a}=e;if(f.b.isCombination(e))t=r.AM.Sequence,i=a.hasAudio?r.vG.AudioVideo:r.vG.VideoOnly;else switch(a.type){case n.cVg.MetaTypeVideo:t=r.AM.AudioVideo,i=a.hasAudio?r.vG.AudioVideo:r.vG.VideoOnly;break;case n.cVg.MetaTypeGif:default:t=r.AM.Image,i=r.vG.VideoOnly}let o=(0,m.dM)(e,!1),s="";(0,c.Xl)(o)&&(s=(0,c.o)(o));let l=e.sourceTimerange.start,d=l+e.sourceTimerange.duration;(l<0||l>=y)&&(l=e.targetTimerange.start),(d<=0||d>=y)&&(d=(l=e.targetTimerange.start)+e.targetTimerange.duration);let u=h.k.getInstance().pathRecords.get(o)||o,p=h.k.getInstance().decryptRecords.get(u),_={id:e.id,segment_id:e.id,is_visible:e.visible,type:t,stream_type:i,res:u,decrypt_key:p,clip_file_info_string:s,trim_range:{"in.us":l,"out.us":d}},{path:T,trimIn:v,trimOut:I}=(0,g.u)(e);return T&&(_.bind_audio_info={filePath:h.k.getInstance().pathRecords.get(T),decryptKey:h.k.getInstance().decryptRecords.get(h.k.getInstance().pathRecords.get(T)),trimOffset:{"time.us":v}}),_}function T(e){var t,i,a,o;let s=e.sourceTimerange.start,l=s+e.sourceTimerange.duration,d=r.AM.Audio;f.b.isCombination(e)&&(d=r.AM.Sequence);let{path:c,timeRange:u}=p.m3.getAudioAlgorithmProductionPath(e),m=h.k.getInstance().pathRecords.get(c||e.material.path),g=h.k.getInstance().decryptRecords.get(m);return c&&(s-=u.start,l-=u.start),{id:e.id,segment_id:e.id,is_visible:e.visible,type:d,res:m,decrypt_key:g,trim_range:{"in.us":s,"out.us":l},speed:(null===(t=e.speed)||void 0===t?void 0:t.mode)===n.yY$.SpeedModeNormal?e.speed.speed:void 0,curve_speed:(null===(i=e.speed)||void 0===i?void 0:i.mode)===n.yY$.SpeedModeCurve?null===(a=e.speed.curveSpeed)||void 0===a?void 0:a.speedPoints:void 0,audio_channel_mapping_type:(null===(o=e.soundChannelMapping)||void 0===o?void 0:o.isConfigOpen)?e.soundChannelMapping.audioChannelMapping:void 0}}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=(0,l.cW)(e,t,i,n),o=e.targetTimerange.start+e.offset,s=e.targetTimerange.duration+o;return{filter:a,type:r.AM.Effect,is_visible:e.visible,trim_range:{"in.us":o,"out.us":s},segment_id:e.id}}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.material.version?(0,s.gg)(e,t):(0,s.fT)(e,t)}function w(e,t){let i={};return t.type===r.UO.AmazingEffect?i.res=t.res:t.type===r.UO.InfoSticker?i.res=t.res:t.type===r.UO.VideoAnimation&&(i.res=t.res),i.filter=t,i.id=e,i.type=r.AM.Effect,i.is_visible=t.visible,i}function S(e){let{id:t,res:i,visible:r,offset:n,timeRange:a,filter:o,segmentId:s}=e;return{id:t,res:i,filter:o,type:"EFFECT",is_visible:r,trim_range:{"in.us":n+a.start,"out.us":n+a.start+a.duration},segment_id:s}}function k(e){let{id:t,res:i,param:n,renderIndex:a,visible:o,flag:s,video_id:l}=e;return{id:t,res:i,param:n,visible:o,render_index:BigInt(null!=a?a:-1),filterLayer:BigInt(null!=a?a:-1),flag:null!=s?s:0n,type:"AMAZING_EFFECT",amazing_effect_algorithm_type:"STOP_MOTION",amazing_effect_mode:0,effect_start_offset:0n,effect_end_offset:0n,video_id:l||"",algorithm_result_dir:"",priv:{},amazing_body_type:r.Np.NONE,is_object_lock_filter:!1}}function x(e,t,i,r){let s=function(e){var t,i;let r,{segment:s,material:l,adjustOrder:d,renderIndexTrackModeOn:c}=e,m=(null===(i=s.visible)||void 0===i||i)&&(s.trackAttribute&Number(n.$SW.HideFlag))==0;if(d<o.nW.LUTOrder){let e=(0,a.$$)(d);r=(0,a.vW)(e,l.version)}else r="intensity";let f={};if(null===(t=l.adjustParams)||void 0===t?void 0:t.length)for(let e of l.adjustParams)f[e.name]=e.value;f[r]=l.value;let p=0n,g=h.k.getInstance().pathRecords.get(l.path);l.type===n.cVg.MetaTypeLUT&&(p=BigInt(a.EZ.videoHasLut),g=(0,a.XP)(g),f.feature_enable_alg=!!l.enableSkinToneCorrection,f.feature_outer_lut_path=g);let y=BigInt(c?s.trackRenderIndex:s.renderIndex);return(0,u.E6)(s)&&(y=(0,a.CT)(y,(0,a.Z)(l.type))),k({id:l.id,res:g,param:JSON.stringify(f),renderIndex:y,visible:m,flag:p})}({segment:e,material:t,adjustOrder:o.nW.AdjustOrderCount,renderIndexTrackModeOn:r}),l=e.sourceTimerange;return(!l||l.duration<=0)&&(l=e.targetTimerange.start>=0n?e.targetTimerange:new n.tnv({start:0n,duration:e.targetTimerange.duration})),S({id:i?`${e.id}_${i}`:e.id,res:h.k.getInstance().pathRecords.get(t.path),offset:e.offset,visible:s.visible,timeRange:l,filter:s,segmentId:e.id})}function b(e,t,i,r,o,s){var l;let d,c,m,f,p;let g=(null===(l=e.visible)||void 0===l||l)&&(e.trackAttribute&Number(n.$SW.HideFlag))==0;if(t)switch(t.type){case n.cVg.MetaTypeColorCurves:{let e=(0,a.ez)(t);d=(0,a.Vp)(t.type),c=h.k.getInstance().pathRecords.get(t.path),m=JSON.stringify((0,a.ci)(e)),f=0n,p=t.type;break}case n.cVg.MetaTypePrimaryColorWheels:{let e=(0,a.C1)(t);d=(0,a.Vp)(t.type),c=h.k.getInstance().pathRecords.get(t.path),m=JSON.stringify((0,a.bn)(e)),f=0n,p=t.type;break}case n.cVg.MetaTypeLogColorWheels:{let e=(0,a.E6)(t);d=(0,a.Vp)(t.type),c=e.path,m=JSON.stringify((0,a.HI)(e)),f=void 0,p=t.type;break}case n.cVg.MetaTypeSmartColorAdjust:{let e=(0,a.F9)(t);d=(0,a.Vp)(t.type),c=h.k.getInstance().pathRecords.get(t.path),m=JSON.stringify(e),f=void 0,p=t.type;break}default:return}else if(i){if(!Array.isArray(i)||!i.length)return;let e=s?JSON.parse(s.param):{},t=(0,a.dI)(i,e);if(!t)return;d=(0,a.Vp)(n.cVg.MetaTypeHsl),c=t.hslPath,m=JSON.stringify(t.extraParams),g=g&&t.hslVisible,p=i[0].type}else{if(!r)return;if(!r.length)return;let e=(0,a.ge)(r);if(!r.some(e=>{let{type:t}=e;return[n.cVg.MetaTypeHighlight,n.cVg.MetaTypeShadow,n.cVg.MetaTypeTemperature,n.cVg.MetaTypeHue].includes(t)}))return;d=(0,a.Vp)(r[0].type,"v2"===r[0].version);c=h.k.getInstance().pathRecords.get(r[0].path),m=JSON.stringify(e),f=0n,p=r[0].type}let y=BigInt(o?e.trackRenderIndex:e.renderIndex);return(0,u.E6)(e)&&(y=(0,a.CT)(y,(0,a.Z)(p))),k({id:`${e.id}_${d}`,res:c,param:m,renderIndex:y,visible:g,flag:f})}function M(e,t,i,r){return x(e,t,(0,a.Vp)(i),r)}function C(e,t,i,r){var a;let o;let{offset:s,material:l}=e;switch(t){case n.cVg.MetaTypeHighlight:case n.cVg.MetaTypeShadow:o=b(e,void 0,void 0,[e.material.highlight,e.material.shadow].filter(e=>e&&"v2"===e.version),i);break;case n.cVg.MetaTypeTemperature:case n.cVg.MetaTypeHue:o=b(e,void 0,void 0,[e.material.colorTemperature,e.material.hue].filter(e=>e&&"v2"===e.version),i);break;case n.cVg.MetaTypeHsl:o=b(e,void 0,l.hsl,void 0,i,r);break;case n.cVg.MetaTypeColorCurves:l.colorCurves&&(o=b(e,l.colorCurves,void 0,void 0,i));break;case n.cVg.MetaTypePrimaryColorWheels:l.primaryColorWheels&&(o=b(e,l.primaryColorWheels,void 0,void 0,i));break;case n.cVg.MetaTypeLogColorWheels:l.logColorWheels&&(o=b(e,l.logColorWheels,void 0,void 0,i));break;case n.cVg.MetaTypeSmartColorAdjust:l.smartAdjustColor&&(o=b(e,l.smartAdjustColor,void 0,void 0,i))}if(!!o)return S({id:o.id,res:o.res,offset:s,visible:o.visible,timeRange:null!==(a=e.sourceTimerange)&&void 0!==a?a:{start:0n,duration:e.targetTimerange.duration},filter:o,segmentId:e.id})}function A(e,t){var i,r;let o=new Map,s=[],l=null==t?void 0:t.getDraftProperty().renderIndexTrackModeOn;if(e.material.brightness?o.set(n.Eu.KFTypeBrightness,x(e,e.material.brightness,(0,a.Vp)(n.cVg.MetaTypeBrightness),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeBrightness)}`),e.material.contrast?o.set(n.Eu.KFTypeContrast,x(e,e.material.contrast,(0,a.Vp)(n.cVg.MetaTypeContrast),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeContrast)}`),e.material.saturation?o.set(n.Eu.KFTypeSaturation,x(e,e.material.saturation,(0,a.Vp)(n.cVg.MetaTypeSaturation),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeSaturation)}`),e.material.sharpening?o.set(n.Eu.KFTypeSharpen,x(e,e.material.sharpening,(0,a.Vp)(n.cVg.MetaTypeSharpen),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeSharpen)}`),e.material.fade?o.set(n.Eu.KFTypeFade,x(e,e.material.fade,(0,a.Vp)(n.cVg.MetaTypeFade),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeFade)}`),e.material.lightSensation?o.set(n.Eu.KFTypeLightSensatione,x(e,e.material.lightSensation,(0,a.Vp)(n.cVg.MetaTypeLightSensation),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeLightSensation)}`),e.material.vignetting?o.set(n.Eu.KFTypeVignetting,x(e,e.material.vignetting,(0,a.Vp)(n.cVg.MetaTypeVignetting),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeVignetting)}`),e.material.particle?o.set(n.Eu.KFTypeParticle,x(e,e.material.particle,(0,a.Vp)(n.cVg.MetaTypeParticle),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeParticle)}`),e.material.filter?o.set(n.Eu.KFTypeFilter,x(e,e.material.filter,(0,a.Vp)(n.cVg.MetaTypeFilter),l)):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeFilter)}`),e.material.enableLut&&e.material.lut&&(r=e.material.lut.path,1))o.set(n.Eu.KFTypeLUT,x(e,e.material.lut,(0,a.Vp)(n.cVg.MetaTypeLUT),l));else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeLUT)}`);let d=!1;if(e.material.highlight?"v2"!==e.material.highlight.version?o.set(n.Eu.KFTypeHightLight,x(e,e.material.highlight,(0,a.Vp)(n.cVg.MetaTypeHighlight),l)):(s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHighlight)}`),d=!0):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHighlight)}`),e.material.shadow?"v2"!==e.material.shadow.version?o.set(n.Eu.KFTypeShadow,x(e,e.material.shadow,(0,a.Vp)(n.cVg.MetaTypeShadow),l)):(s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeShadow)}`),d=!0):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeShadow)}`),d){let t=`${n.Eu.KFTypeHightLight}_${n.Eu.KFTypeShadow}`,i=C(e,n.cVg.MetaTypeHighlight,l);i?o.set(t,i):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHighlight,!0)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHighlight,!0)}`);let c=!1;if(e.material.colorTemperature?"v2"!==e.material.colorTemperature.version?o.set(n.Eu.KFTypeTemperature,x(e,e.material.colorTemperature,(0,a.Vp)(n.cVg.MetaTypeTemperature),l)):(s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeTemperature)}`),c=!0):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeTemperature)}`),e.material.hue?"v2"!==e.material.hue.version?o.set(n.Eu.KFTypeHue,x(e,e.material.hue,(0,a.Vp)(n.cVg.MetaTypeHue),l)):(s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHue)}`),c=!0):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHue)}`),c){let t=`${n.Eu.KFTypeTemperature}_${n.Eu.KFTypeHue}`,i=C(e,n.cVg.MetaTypeTemperature,l);i?o.set(t,i):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeTemperature,!0)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeTemperature,!0)}`);if(null===(i=e.material.hsl)||void 0===i?void 0:i.length){let t=C(e,n.cVg.MetaTypeHsl,l);t?o.set(n.Eu.KFTypeNone,t):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHsl)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeHsl)}`);if(e.material.colorCurves){let t=C(e,n.cVg.MetaTypeColorCurves,l);t?o.set(n.Eu.KFTypeNone,t):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeColorCurves)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeColorCurves)}`);if(e.material.primaryColorWheels){let t=C(e,n.cVg.MetaTypePrimaryColorWheels,l);t?o.set(n.Eu.KFTypePrimaryColorWheelIntensity,t):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypePrimaryColorWheels)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypePrimaryColorWheels)}`);if(e.material.logColorWheels){let t=C(e,n.cVg.MetaTypeLogColorWheels,l);t?o.set(n.Eu.KFTypeLogColorWheelIntensity,t):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeLogColorWheels)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeLogColorWheels)}`);if(e.material.smartAdjustColor){let t=C(e,n.cVg.MetaTypeSmartColorAdjust,l);t?o.set(n.Eu.KFTypeSmartColorAdjust,t):s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeSmartColorAdjust)}`)}else s.push(`${e.id}_${(0,a.Vp)(n.cVg.MetaTypeSmartColorAdjust)}`);return{clips:o,removes:s}}function E(e){return[`${e}_${(0,a.Vp)(n.cVg.MetaTypeBrightness)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeContrast)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeSaturation)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeSharpen)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeFade)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeLightSensation)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeVignetting)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeParticle)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeFilter)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeLUT)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeHighlight)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeShadow)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeHighlight,!0)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeTemperature)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeHue)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeTemperature,!0)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeHsl)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeColorCurves)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypePrimaryColorWheels)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeLogColorWheels)}`,`${e}_${(0,a.Vp)(n.cVg.MetaTypeSmartColorAdjust)}`]}function F(e){return x(e,e.material)}function P(e){return x(e,e.material)}let D=e=>{let t;if((0,u.P2)(e)){let{material:i,targetTimerange:r,videoTracking:a}=e,{path:o,unicode:s}=i,l=new n.tnv({start:e.offset+r.start,duration:r.duration}),c={segmentId:e.id,utf8code:s,material:h.k.getInstance().pathRecords.get(o),timerange:l,pinPaths:(0,d.wL)(a),width:0,height:0,isHandwirte:!1,visible:e.visible};t=s?(0,d.WA)(c):(0,d.u4)(c)}else if((0,u.P7)(e)){let{material:i,targetTimerange:r,videoTracking:a}=e,{path:o}=i,s=new n.tnv({start:e.offset+r.start,duration:r.duration}),l={segmentId:e.id,material:h.k.getInstance().pathRecords.get(o),timerange:s,pinPaths:(0,d.wL)(a),width:0,height:0,utf8code:"",isHandwirte:!1,visible:e.visible};t=(0,d.vU)(l)}return t}},408506:function(e,t,i){i.d(t,{C:function(){return r.C}});var r=i(884238);i(309863)},944819:function(e,t,i){i.d(t,{l:function(){return s}});var r=i(805794),n=i(216917),a=i(337609),o=i(940105);class s extends n.w{get createdPromise(){return this._createdPromise}setLogLevel(e){return(0,a.kB)(this._vesdkBind.setLogConfig(e),0)}setLogToConsole(e){return(0,a.kB)(this._utils.setLogToConsole(e),0)}registerStatisticsListener(e){return this._utils.registerStatisticsListener(e)}transCodeAudioFile(e,t,i,r,n,o,s){return(0,a.kB)(this._utils.transCodeAudioFile(e,t,i,r,n,o,s),0)}getAudioChannelWave(e,t,i,r,n){return(0,a.kB)(this._utils.getAudioChannelWave(e,t,i,r,n),[])}setMetaData(e,t,i){return(0,a.kB)(this._utils.setMetaData(e,t,i),0)}getMetaData(e){return(0,a.kB)(this._utils.getMetaData(e),"")}getMediaFileInfoJson(e,t){return(0,a.kB)(this._utils.getMediaFileInfoJson(e,t),"")}async getMediaFileInfo(e,t){return!this._created&&await this._createdPromise,(0,a.kB)(this._utils.getMediaFileInfo(e,t),"{}")}getMediaFileInfoSync(e,t){if(!this._created)throw Error("veUtils not created yet");return this._utils.getMediaFileInfoSync(e,t)}getImageSize(){}zoomImage(e,t,i,r,n,o,s){return(0,a.kB)(this._utils.zoomImage(e,t,i,r,n,o,s),0)}getGIFThumbnail(e,t){return(0,a.kB)(this._utils.getGIFThumbnail(e,t),0)}getGifMetaData(e){return(0,a.kB)(this._utils.getGifMetaData(e),"")}convertToHighGif(e,t){return(0,a.kB)(this._utils.convertToHighGif(e,t),0)}isSupportPreciseTrim(e){return(0,a.kB)(this._utils.isSupportPreciseTrim(e),!1)}getFrameIndexByTimestamp(e,t){return(0,a.kB)(this._utils.getFrameIndexByTimestamp(e,t),0)}fileEncrypted(e){return(0,a.kB)(this._utils.fileEncrypted(e),!1)}getMimeType(e){return(0,a.kB)(this._utils.getMimeType(e),0)}writeJPEG2file(e,t,i,r,n){return(0,a.kB)(this._utils.writeJPEG2file(e,t,i,r,n),0)}checkVideoContainBFrame(e){return(0,a.kB)(this._utils.checkVideoContainBFrame(e),!1)}checkMediaisVaild(e){return(0,a.kB)(this._utils.checkMediaisVaild(e),0)}getTemplateParam(e){return(0,a.kB)(this._utils.getTemplateParam(e),"")}scriptStandaloneInit(e,t){try{return this._utils.scriptStandaloneInit(e,t)}catch(i){throw r.B.info("[render]scriptStandaloneInit",JSON.stringify({guid:e,config:t})),i}}scriptStandaloneRelease(e){try{return this._utils.scriptStandaloneRelease(e)}catch(t){throw r.B.info("[render]scriptStandaloneRelease",JSON.stringify({guid:e})),t}}scriptStandaloneSetParams(e,t){try{return this._utils.scriptStandaloneSetParams(e,t)}catch(i){throw r.B.info("[render]scriptStandaloneSetParams",JSON.stringify({guid:e,actionJson:t})),i}}scriptStandaloneGetParams(e){try{return this._utils.scriptStandaloneGetParams(e)}catch(t){throw r.B.info("[render]scriptStandaloneGetParams",JSON.stringify({guid:e})),t}}scriptSegmentPreload(e){return this._utils.scriptSegmentPreload(e)}interpolationCubicBezier(e,t,i,r,n,a,o,s,l){return this._utils.interpolationCubicBezier(e,t,i,r,n,a,o,s,l)}getInfoStickerData(e){return this._utils.getInfoStickerData(e)}getLetterSegment(e){return(0,a.kB)(this._utils.getLetterSegment(e),"")}createAlgorithm(e){return this._createHelper.createAlgorithm(e)}createVeCurveSpeedUtils(){return this._createHelper.createVeCurveSpeedUtils()}createVeDiscreteCurveSpeedUtils(){return this._createHelper.createVeDiscreteCurveSpeedUtils()}createSpeechTrackingUtils(){return this._createHelper.createSpeechTrackingUtils()}createSizeUtils(){return this._createHelper.createSizeUtils()}createSpComposerFilterOperationHelper(){return this._createHelper.createSpComposerFilterOperationHelper()}createSpAudioProcessor(){return this._createHelper.createSpAudioProcessor()}createRenderTaskManager(){return this._createHelper.createRenderTaskManager()}createAudioBeatTracking(){return this._createHelper.createAudioBeatTracking()}createEditor(e){return this._createHelper.createEditor(e)}createMattingControl(){return this._createHelper.createMattingControl()}createPluginManager(){return this._createHelper.createPluginManager()}createSubtitleReader(e){return this._createHelper.createSubtitleReader(e)}createSubtitleWriter(e){return this._createHelper.createSubtitleWriter(e)}checkIsQuickImportSupport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(0,a.kB)(this._utils.checkIsQuickImportSupport(e,t),!1)}getQuickImportInfo(e,t){return(0,a.kB)(this._utils.getQuickImportInfo(e,t),"")}checkHDVideoCanFastImport(e,t,i){return(0,a.kB)(this._utils.checkHDVideoCanFastImport(e,t,i),!1)}getHWCodecMaxSize(){return(0,a.kB)(this._utils.getHWCodecMaxSize(),0)}isSupportStreamVideo(e,t,i){return(0,a.kB)(this._utils.isSupportStreamVideo(e,t,i),!1)}putAssetUrl(e,t,i,r,n,a,o,s,l){return this._created?this._utils.putAssetUrl(e,t,i,r,n,a,o,s,l):(console.error("putAssetUrl: VEUtils is not created!"),-1)}clearResource(e){return(0,a.kB)(this._utils.clearResource(e),0)}startPreload(e,t){return this._created?this._utils.startPreload(e,t):(console.error("startPreload: VEUtils is not created!"),-1)}getKeyFrameParam(e,t){return(0,a.kB)(this._utils.getKeyFrameParam(e,t),"")}async setGlobalAllowedPaths(e){let t=new Module.VectorString;e.forEach(e=>{t.push_back(e)});let i=await (0,a.kB)(this._utils.setGlobalAllowedPaths(t),0);return t.delete(),i}getSpGlobalConfig(){return this._globalConfig}checkIsSupportGL3(){return(0,a.kB)(this._utils.checkIsSupportGL3(),!1)}setFrameCacheDiskDir(e){return(0,a.kB)(this._utils.setFrameCacheDiskDir(e),0)}mergeEffectResource(e,t){return(0,a.kB)(this._utils.mergeEffectResource(e,t),0)}getEffectVersion(){return this._utils.getEffectVersion()}getEditorCount(){return(0,a.kB)(this._utils.getEditorCount(),0)}preInitVESDKCtx(){return(0,a.kB)(this._utils.preInitVESDKCtx(),0)}checkInitVESDKCtx(){return(0,a.kB)(this._utils.checkInitVESDKCtx(),0)}peekEffectResource(e){let t=new Module.VectorString;e.forEach(e=>{t.push_back(e)});let i=this._utils.peekEffectResource(t);return t.delete(),i}convertRichTextXml2Json(e){return o.Q.xmlToJson(e)}estimateExportGIFSize(e){return(0,a.kB)(this._utils.estimateExportGIFSize(e),0)}convertCaptionSplitLinePage(e){return this._utils.convertCaptionSplitLinePage(e)}constructor(e){super(),this._created=!1;let{vesdkBind:t,utils:i,createHelper:r,globalConfig:n}=e;this._vesdkBind=t,this._utils=i,this._createHelper=r,this._globalConfig=n,this._createdPromise=Promise.resolve(),this._createdPromise.then(()=>{this._created=!0})}}},481890:function(e,t,i){i.d(t,{A:function(){return a},z:function(){return o}});var r,n,a=((r={}).Local="local",r.Collab="collab",r);var o=((n={}).Undo="undo",n.Redo="redo",n)},54488:function(e,t,i){i.d(t,{Z:function(){return a}});var r=i(401597);class n extends r.X{reverse(){let{undoCommand:e,redoCommand:t,canUndoRedo:i,operateType:r,executeCommand:a,isCollaborate:o}=this;return new n({undoCommand:t,redoCommand:e,canUndoRedo:i,operateType:r,executeCommand:a,isCollaborate:o})}execute(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.executeCommand(this.undoCommand,e,t);t&&(this.redoCommand=i)}constructor(e){super(e),this.isCollaborate=!0===e.isCollaborate,this.canUndoRedo=!this.isCollaborate&&this.canUndoRedo}}let a=n},698159:function(e,t,i){i.d(t,{W:function(){return r.W},l:function(){return r.l}});var r=i(448218)},448218:function(e,t,i){i.d(t,{W:function(){return l},l:function(){return s}});var r=i(553197),n=i(392742),a=i(481631),o=i(283751);function s(e,t,i,r){var s,l,d,c;let u=e.getSegmentById(t),m=(0,a.xX)({__segment_struct_type:u.__segment_struct_type});o.T.pick(u,i,m);let h=null!==(d=null!=r?r:null===(s=e.getTrackBySegmentId(t,[]))||void 0===s?void 0:s.id)&&void 0!==d?d:"",f=e.getTrackIndexById(h);return{type:n.x.UpdateSegment,params:{draftId:e.getDraftId(),segmentId:t,segmentDelta:i,trackId:null!==(c=null!=r?r:null===(l=e.getTrackBySegmentId(t,[]))||void 0===l?void 0:l.id)&&void 0!==c?c:"",sourceSegmentDelta:m,trackIndex:f}}}let l=(e,t)=>{let i;if(!!e&&!0!==e)for(let n of i=e instanceof Array?e:[e]){if(!n)continue;let e=r.R[n.type];e&&t(new e(n.params))}}},21510:function(e,t,i){i.d(t,{Vw:function(){return l},ed:function(){return n},lA:function(){return s},ud:function(){return o}});var r=i(573461);let n=(e,t)=>{let[i,r]=e,[n,a]=t;return!(r<n||i>a)},a=(e,t)=>{let i=r.pM.max([e[0],t[0]],"bigint"),n=r.pM.min([e[1],t[1]],"bigint");return n<i?0n:n-i};function o(e,t){var i,r,n,o;if(!t)return e.targetDuration;let s=null!==(n=null===(i=t.sourceTimerange)||void 0===i?void 0:i.start)&&void 0!==n?n:e.targetStart;return a([s,s+(null!==(o=null===(r=t.sourceTimerange)||void 0===r?void 0:r.duration)&&void 0!==o?o:e.targetDuration)],[e.targetStart,e.targetStart+e.targetDuration])}let s=(e,t)=>n(e,t)&&(e[1]>t[1]||e[0]<t[0]),l=(e,t)=>{if(s(e,t))switch(!0){case e[0]<t[0]:return"left";case e[1]>t[1]:return"right"}}},160849:function(e,t,i){i.d(t,{YY:function(){return I},bV:function(){return v},k:function(){return w}});var r=i(711999),n=i(737889),a=i(691989),o=i(314409),s=i(676177),l=i(211561),d=i(283751),c=i(481631),u=i(129862),m=i(698159),h=i(695780),f=i(217201),p=i(361708),g=i(881337),y=i(879388),_=i(287165),T=i(671922);let v={updateCombination(e,t,i,r){let n=e.getDraftId(),{materialDraft:a}=t;if(!(null==a?void 0:a.draft))return;let o=new l.NOn,s=new l.rdD({draft:i,type:l.cVg.MetaTypeCombination,combinationId:(0,_.p)()});o.materialDraft=s,o.reverse=!1;let m=(0,c.xX)({__segment_struct_type:t.__segment_struct_type});if(d.T.pick(t,o,m),r(new u.F({draftId:n,trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:o,sourceSegmentDelta:m})),t.reverse){let i={isReverse:!1,segId:t.id,reversePath:""};(0,T.I)(e,i,r);let a=e.getSegmentById(t.id),s=(0,c.xX)({__segment_struct_type:a.__segment_struct_type}),h=new l.K2q;h.path="",h.reverseIntensifiesPath="",s.material=h,m=(0,c.xX)({__segment_struct_type:t.__segment_struct_type}),d.T.pick(t,o,m),r(new u.F({draftId:n,trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:s,sourceSegmentDelta:m}))}},updateCombinationForVideoOrAudio(e,t,i){let r=e.getDraftId();if(!t)return;let{materialDraft:n}=t;if(!n||!n.draft)return;n.combinationId=(0,_.p)();let a=(0,c.xX)({__segment_struct_type:t.__segment_struct_type});if(t.__segment_struct_type===l.Ocy.SegmentVideo){let n=new l.K2q;n.path="",n.reversePath="",a.material=n,a.reverse=!1;let o=(0,c.xX)({__segment_struct_type:t.__segment_struct_type});d.T.pick(t,a,o),i(new u.F({draftId:r,trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:a,sourceSegmentDelta:o}))}else if(t.__segment_struct_type===l.Ocy.SegmentAudio){let n=new l.yB$;n.path="",a.material=n;let o=(0,c.xX)({__segment_struct_type:t.__segment_struct_type});d.T.pick(t,a,o),i(new u.F({draftId:r,trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:a,sourceSegmentDelta:o}))}},addIntegratedVideo(e,t,i,n,a){let o;let{size:d,trackIndex:c,name:u,clip:h,startTime:_,duration:T}=i,v=0===d.width||0===d.height,I={videos:[],trackIndex:c,materialDraft:t,allowDefaultHdr:!0},w=(0,g.lFK)({segmentId:i.segmentId,materialName:u,type:l.cVg.MetaTypeVideo,path:"",hasAudio:p.b.hasAudio(t.draft)});if(v){let e,i,r,n;w.size.width=t.draft.property.canvasConfig.width,w.size.width=w.size.width?w.size.width:720,w.size.height=t.draft.property.canvasConfig.height,w.size.height=w.size.height?w.size.height:1280;w.size.width=(e=w.size.width,(e+(i=2)-1)/i*i);w.size.height=(r=w.size.height,(r+(n=2)-1)/n*n)}else w.size.width=d.width,w.size.height=d.height;if(!v&&h&&(w.clip.transformX=h.transformX,w.clip.transformY=h.transformY,w.clip.scaleX=h.scaleX,w.clip.scaleY=h.scaleY,w.clip.rotation=h.rotation,w.clip.flipVertical=h.flipVertical,w.clip.flipHorizontal=h.flipHorizontal),w.startTime=_,w.duration=T,w.sourceStartTime=0n,w.sourceDuration=T,w.copyBackground=!1,w.extraTypeOption=l.Yzk.IsCombinationVideo,I.videos.push(w),0!==I.trackIndex&&1===I.videos.length){let t=e.getAllTracks();new y.W().moveConflictSegment(e,{targetStartTime:I.videos[0].startTime,targetDuration:I.videos[0].duration,targetTrackIndex:I.trackIndex,type:l.pNd.TrackTypeVideo,targetSegmentId:""},t,n,a)}let S=[w.size.width,w.size.height],{ratio:k}=e.getDraftProperty().draftCanvasSizeConfig.ensureDraftCanvasSizeParam;(0,r.F)(S,k,!0,e,n);let x=s.M.insertVideoSegmentsHelper(I,e,n),b=I.trackIndex===f.fm&&e.getDraftProperty().videoMute,M=[];for(let t of x)b&&M.push((0,m.l)(e,t.id,new l.NOn({volume:0})));return(0,m.W)(M,n),1===x.length&&(o=x[0]),o}},I=e=>{let t=[],i=e.getDraftId(),r=new o.$({muted:!0,draftId:i}),s=e.getTracksByTypes([l.pNd.TrackTypeAudio,l.pNd.TrackTypeVideo]).map(e=>e.id).map(e=>new a.f({muted:!0,trackId:e}));t.push(r,...s);let d=e.getSegmentsByTrackTypes([l.pNd.TrackTypeAudio]);return d.length&&t.push(new n.v({segIds:d.map(e=>{let{id:t}=e;return t}),draftId:i})),t},w=(e,t)=>{let i=e.getSegmentsByTrackTypes([l.pNd.TrackTypeVideo]),r=h.Q.getMutableMaterials(e),n=new Map;for(let e of i)if((0,c.he)(e)){let t=e.material.id;if(t){if(!r.has(t))continue;n.set(t,e)}}for(let e of t){if(!n.has(e.id))continue;let t=n.get(e.id);if(t){let i=t.material;i.path=e.path,i.type="AudioVideo"===e.mediaType||"Video"===e.mediaType?l.cVg.MetaTypeVideo:l.cVg.MetaTypePhoto,i.hasAudio="AudioVideo"===e.mediaType}}}},27545:function(e,t,i){i.d(t,{F:()=>r});function r(e){return"object"==typeof e&&null!==e}},540261:function(e,t,i){i.d(t,{A:function(){return n}});var r=i(211890);class n{static bezier3(e,t,i,r,n){let a=1-e;return t*a*a*a+3*i*e*a*a+3*r*e*e*a+n*e*e*e}solveCurveX(e){if(e<0||1e-6>Math.abs(e))return 0;if(e>1||1e-6>Math.abs(e-1))return 1;let t=e;for(let i=0;i<8;i++){let i=this.sampleCurveX(t)-e;if(.001>Math.abs(i))return t;let r=this.sampleCurveDerivativeX(t);if(1e-6>Math.abs(r))break;t=Math.max(0,Math.min(1,t-i/r))}let i=0,r=1;for(;i<r&&Math.abs(r-i)>1e-6;){let t=(r-i)*.5+i,n=this.sampleCurveX(t);if(.001>Math.abs(n-e))return t;e>n?i=t:r=t}return t>1&&(t=1),t}sampleCurveX(e){return((this._a.x*e+this._b.x)*e+this._c.x)*e}sampleCurveDerivativeX(e){return(3*this._a.x*e+2*this._b.x)*e+this._c.x}constructor(e,t){this._a=new r.Sh(1,1).minus(t.times(3)).plus(e.times(3)),this._b=t.times(3).minus(e.times(6)),this._c=e.times(3)}}},746966:function(e,t,i){i.d(t,{n:function(){return r.n},p:function(){return r.p}});var r=i(233706)},233706:function(e,t,i){i.d(t,{n:function(){return function e(t,i){for(let n of Object.keys(i)){if(void 0===t[n]||typeof t[n]!=typeof i[n])return!1;if(r(t[n])){if(t[n]!==i[n])return!1;continue}if("object"==typeof t[n]){if(!e(t[n],i[n]))return!1;continue}else{if(t[n]!==i[n])return!1;continue}}return!0}},p:function(){return function e(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let a of Object.keys(i)){if(void 0!==t[a])n&&null===i[a]?delete t[a]:r(t[a])||r(i[a])||Array.isArray(t[a])?t[a]=i[a]:"object"==typeof t[a]&&"object"==typeof i[a]?t[a]=e(t[a],i[a]):t[a]=i[a]}return t}}});let r=e=>{let t=Object.prototype.toString.call(e);return["[object String]","[object Number]","[object Boolean]","[object Symbol]","[object Null]","[object Undefined]"].includes(t)}},356898:function(e,t,i){i.d(t,{GM:function(){return o},OZ:function(){return n},TJ:function(){return s},VK:function(){return a}});var r=i(211561);function n(e){let t;switch(e.__segment_struct_type){case r.Ocy.SegmentTailLeader:t=r.wIf.deserialize(e);break;case r.Ocy.SegmentVideo:t=r._6D.deserialize(e);break;case r.Ocy.SegmentAudio:t=r.M_W.deserialize(e);break;case r.Ocy.SegmentVideoEffect:t=r.nkD.deserialize(e);break;case r.Ocy.SegmentFilter:t=r.wSc.deserialize(e);break;case r.Ocy.SegmentPictureAdjust:t=r.MM7.deserialize(e);break;case r.Ocy.SegmentImageSticker:t=r.GfO.deserialize(e);break;case r.Ocy.SegmentSticker:t=r.S8D.deserialize(e);break;case r.Ocy.SegmentTextTemplate:t=r.pVX.deserialize(e);break;case r.Ocy.SegmentText:t=r.Fyg.deserialize(e);break;case r.Ocy.SegmentComposition:t=r._$4.deserialize(e);break;case r.Ocy.SegmentAdcube:t=r.C6D.deserialize(e);break;case r.Ocy.SegmentPluginEffect:t=r.LZ8.deserialize(e);break;case r.Ocy.SegmentHandwrite:t=r.x_X.deserialize(e);break;case r.Ocy.SegmentShape:t=r.B62.deserialize(e);break;default:throw Error(`unrecognized segment type ${e.__segment_struct_type}`)}return t}function a(e){let t;switch(e.__segment_struct_type){case r.Ocy.SegmentTailLeader:t=r.wIf.serialize(e);break;case r.Ocy.SegmentVideo:t=r._6D.serialize(e);break;case r.Ocy.SegmentAudio:t=r.M_W.serialize(e);break;case r.Ocy.SegmentVideoEffect:t=r.nkD.serialize(e);break;case r.Ocy.SegmentFilter:t=r.wSc.serialize(e);break;case r.Ocy.SegmentPictureAdjust:t=r.MM7.serialize(e);break;case r.Ocy.SegmentImageSticker:t=r.GfO.serialize(e);break;case r.Ocy.SegmentSticker:t=r.S8D.serialize(e);break;case r.Ocy.SegmentTextTemplate:t=r.pVX.serialize(e);break;case r.Ocy.SegmentText:t=r.Fyg.serialize(e);break;case r.Ocy.SegmentComposition:t=r._$4.serialize(e);break;case r.Ocy.SegmentAdcube:t=r.C6D.serialize(e);break;case r.Ocy.SegmentPluginEffect:t=r.LZ8.serialize(e);break;case r.Ocy.SegmentHandwrite:t=r.x_X.serialize(e);break;case r.Ocy.SegmentShape:t=r.B62.serialize(e);break;default:throw Error(`unrecognized segment type ${e.__segment_struct_type}`)}return t.__segment_struct_type=e.__segment_struct_type,t}let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(e.__segment_struct_type){case r.Ocy.SegmentTailLeader:return r.ZlS.deserialize(e);case r.Ocy.SegmentVideo:return r.NOn.deserialize(e);case r.Ocy.SegmentAudio:return r.CCx.deserialize(e);case r.Ocy.SegmentVideoEffect:return r.LtW.deserialize(e);case r.Ocy.SegmentFilter:return r.M_b.deserialize(e);case r.Ocy.SegmentPictureAdjust:return r.MYy.deserialize(e);case r.Ocy.SegmentImageSticker:return r.AO$.deserialize(e);case r.Ocy.SegmentSticker:return r.rkU.deserialize(e);case r.Ocy.SegmentTextTemplate:return r.kph.deserialize(e);case r.Ocy.SegmentText:return r.xKN.deserialize(e);case r.Ocy.SegmentComposition:return r.$u6.deserialize(e);case r.Ocy.SegmentAdcube:return r.Ngh.deserialize(e);case r.Ocy.SegmentPluginEffect:return r.HCN.deserialize(e);case r.Ocy.SegmentHandwrite:return r.go0.deserialize(e);case r.Ocy.SegmentShape:return r.Fm.deserialize(e);default:throw Error(`unrecognized segment type ${e.__segment_struct_type}`)}},s=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(t.__segment_struct_type){case r.Ocy.SegmentTailLeader:e=r.ZlS.serialize(t);break;case r.Ocy.SegmentVideo:e=r.NOn.serialize(t);break;case r.Ocy.SegmentAudio:e=r.CCx.serialize(t);break;case r.Ocy.SegmentVideoEffect:e=r.LtW.serialize(t);break;case r.Ocy.SegmentFilter:e=r.M_b.serialize(t);break;case r.Ocy.SegmentPictureAdjust:e=r.MYy.serialize(t);break;case r.Ocy.SegmentImageSticker:e=r.AO$.serialize(t);break;case r.Ocy.SegmentSticker:e=r.rkU.serialize(t);break;case r.Ocy.SegmentTextTemplate:e=r.kph.serialize(t);break;case r.Ocy.SegmentText:e=r.xKN.serialize(t);break;case r.Ocy.SegmentComposition:e=r.$u6.serialize(t);break;case r.Ocy.SegmentAdcube:e=r.Ngh.serialize(t);break;case r.Ocy.SegmentPluginEffect:e=r.HCN.serialize(t);break;case r.Ocy.SegmentHandwrite:e=r.go0.serialize(t);break;case r.Ocy.SegmentShape:e=r.Fm.serialize(t);break;default:throw Error(`unrecognized segment type ${t.__segment_struct_type}`)}return e.__segment_struct_type=t.__segment_struct_type,e}},955072:function(e,t,i){i.d(t,{A:function(){return a}});var r=i(436858),n=i(6342);class a{getDuration(){return this._videoDocument.getDraftMetadata().duration}getDraftDuration(){let e=0n,{tracks:t}=this._videoDocument;for(let i of t){let t=this._videoDocument.getTrackDuration(i);t>e&&(e=t)}return e}getDraftStartTime(){let e=BigInt(Number.MAX_SAFE_INTEGER),{tracks:t}=this._videoDocument;for(let i of t){let t=this._videoDocument.getTrackStartTime(i);t<e&&(e=t)}return e}getDraftId(){return this._videoDocument.getDraftMetadata().id}getDraftName(){return this._videoDocument.property.name}getCover(){let{retouchCover:e}=this._videoDocument.property;if(!!e)return{imagePath:e.imagePath,graphicDraftPath:e.retouchWebPath}}getCanvasConfig(){return this._videoDocument.property.canvasConfig}getDraftProperty(){return this._videoDocument.property}getDraftMetadata(){return this._videoDocument.metadata}getDraftDroupContainer(){return this._videoDocument.groupContainer}getDefaultCanvasSize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.AA,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ks,i=e,n=t;return this.getDraftProperty().draftCanvasSizeConfig.abEnableResolution720&&(i*=1.5,n*=1.5),{width:i,height:n}}getUsedAbilities(){let e=[];for(let t of this._videoDocument.tracks)for(let i of t.segments)n.W.filter(t=>!e.includes(t.ability)).forEach(t=>{t.check(i)&&e.push(t.ability)});return e}constructor(e){this._videoDocument=e}}},356787:function(e,t,i){i(211561)},329410:function(e,t,i){i.d(t,{Z:()=>c});var r=i("522960"),n=i("132662"),a=i("585235"),o=i("508278"),s=i("822667"),l=i("383933");class d{constructor(e){this.query=new l.L(e)}}class c{constructor(e){this.draft=new r.Z(e),this.track=new n.Z(e),this.segment=new a.Z(e),this.keyframe=new o.ZP(e),this.subDraft=new s.Z(e),this.attachment=new d(e)}}},16708:function(e,t,i){i.d(t,{xb:function(){return h}});var r=i(211561),n=i(283751),a=i(481631),o=i(280700),s=i(129862),l=i(698159),d=i(217201),c=i(239648);let u=(e,t,i,n)=>{let a=e.getAllSegments();for(let o=0;o<a.length;o++)if(a[o].__segment_struct_type===r.Ocy.SegmentVideoEffect){let r=a[o];if(!r)continue;if(r.applySegmentId===t.id){let[t,a,o,s]=d.c8.removeSegment(e,r.id,[e.getAllTracks()[r.renderIndex].type],n);(0,l.W)(s,i),!n.keepEmptyTracks&&(0,l.W)(d.c8.clearEmptyTrack(e,e.getAllTracks()[r.renderIndex],r.renderIndex),i),0!==r.renderIndex&&!n.keepEmptyTracks&&(0,l.W)(d.c8.clearEmptyTrack(e,e.getAllTracks()[0],0),i)}}},m=(e,t,i,n)=>{var a;let s=!1;t.__segment_struct_type===r.Ocy.SegmentVideo&&(0===t.renderIndex?s=!0:(u(e,t,i,n),t.transition&&new c.Uo().showClearUselessTransitionToast()));let m=null===(a=(0,o.Cm)(e.getAllTracks(),t.id))||void 0===a?void 0:a.trackIndex;if(void 0!==m){let[,,,r]=d.c8.removeSegment(e,t.id,[e.getAllTracks()[m].type],n);(0,l.W)(r,i),!n.keepEmptyTracks&&(0,l.W)(d.c8.clearEmptyTrack(e,e.getAllTracks()[m],m),i),0!==m&&!n.keepEmptyTracks&&(0,l.W)(d.c8.clearEmptyTrack(e,e.getAllTracks()[0],0),i)}return s};function h(e,t,i,o){let{segIds:u}=t,h=u.length,f=new Set,p=new Map,g=[];for(let t=h-1;t>=0;t--)e.enumSegmentsRecursion((r,n)=>{let s;if(n.id!==u[t])return;let l=e.getTrackBySegmentId(n.id);if(l){let e=new c.Uo().findPrevSegment(l,n);e&&(0,a.he)(e)&&e.transition&&g.push(e)}let d=[...r],h=!1;for(;;){if(0!==r.length){let t=e.getMaterialDraft(n);if(!(null==t?void 0:t.draft))break;s=t.draft.clone(),f.add(d[d.length-1])}else s=e;h=m(e,n,i,o);break}if(s){var y;p.set(s,null!==(y=p.get(s))&&void 0!==y?y:h)}return!0});for(let[t,r]of p.entries())(0,l.W)(d.c8.removeEmptyRenderLayerIfNeeded(e),i);(0,l.W)(new c.Uo().clearUselessTransitionAndAdjustTrackStartTime(e),i),g.forEach(t=>{let o=e.getSegmentById(t.id),l=e.getTrackBySegmentId(t.id);if(o&&(0,a.he)(o)&&o.transition){let d=new r.TBZ(o.transition),c=new r.NOn;c.transition=d;let u=(0,a.xX)({__segment_struct_type:o.__segment_struct_type});n.T.pick(o,c,u),i(new s.F({segmentId:t.id,trackId:l.id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentDelta:c,sourceSegmentDelta:u}))}})}},507194:function(e,t,i){i.d(t,{X:function(){return a}});var r=i(448218),n=i(217201);function a(e,t,i){let{segmentId:a,clipTime:o,clipType:s}=t,l=e.getSegmentById(a),{duration:d}=l.targetTimerange;if(n.c8.updateSegmentTimeRange(e,a,o,s,[],!0,!1,i),!t.record)return;let c=n.c8.updateStickerAnimationDurationBySegment(e,l,d);c&&(0,r.W)(c,i)}},350902:function(e,t,i){i.d(t,{E3:function(){return l},Fl:function(){return s},cc:function(){return u}});var r,n=i(211561),a=i(722169),o=i(93735);var s=((r={})[r.SameGroup=0]="SameGroup",r[r.Contains=1]="Contains",r[r.Component=2]="Component",r[r.None=3]="None",r);function l(e,t){let i=[...e||[]],r=[...t||[]];if(!i.length||!r.length)return 3;let n=i.filter(e=>!r.includes(e)),a=r.filter(e=>!i.includes(e));if(!n.length&&!a.length)return 0;if(!n.length&&a.length)return 2;if(n.length&&!a.length)return 1;return 3}let d=(e,t)=>e.subType!==n.DeX.MetaSubTypeExclusion&&e.subType!==n.DeX.MetaSubTypeExclusionFace||t.subType!==n.DeX.MetaSubTypeExclusion&&t.subType!==n.DeX.MetaSubTypeExclusionFace?3:l(e.exclusionGroup,t.exclusionGroup),c=(e,t)=>{let i=d(e,t);if(3===i)return!1;let r=e.faceAdjustParams||[],a=t.faceAdjustParams||[],o=[...a],s=!a.every(e=>"-1"!==e.faceId),l=1===r.length&&"-1"===r[0].faceId,c=a.findIndex(e=>"-1"===e.faceId),u=(null==a?void 0:a[c])||{};switch(i){case 0:case 1:let m=!0;for(let e of r){let{faceId:i,disablePart:r}=e,{exclusionGroup:d}=t,h=function(e,t){let i=!0;for(let r of t)if(!e.includes(r)){i=!1;break}return i}(r,d);if(s&&!l){if(m=!1,"-1"===i||h)continue;if(a.find(e=>e.faceId===i))o.splice(c,1,new n.m4H({...u,enable:!1}));else{let e={enable:!1,faceId:i,disablePart:(null==u?void 0:u.disablePart)||[],adjustParams:(null==u?void 0:u.adjustParams)||[]};o.push(new n.m4H(e))}}else{let e=a.length||0;for(let t=e-1;t>=0;t--)(i===a[t].faceId||l)&&!h?o.splice(t,1):m=!1}}return t.faceAdjustParams=o,m;case 2:if(s&&!l)for(let e of r){let{faceId:t}=e;if(!a.find(e=>e.faceId===t)){let e={enable:u.enable,faceId:t,disablePart:(null==u?void 0:u.disablePart)||[],adjustParams:(null==u?void 0:u.adjustParams)||[]};o.push(new n.m4H(e))}}let{exclusionGroup:h}=e;for(let e of r){let{faceId:t}=e;for(let e of a){let{faceId:i,disablePart:r}=e;if(i!==t&&"-1"!==t)continue;let a=[...r];for(let e of h){if(!r.includes(e))a.push(e)}let s={...e,disablePart:a},l=o.findIndex(e=>e.faceId===i);l>-1&&o.splice(l,1,new n.m4H(s))}}t.faceAdjustParams=o}return!1},u=(e,t)=>{let i=(0,a.cloneDeep)(t);for(let t of e){let e=i.length;for(let r=e-1;r>=0;r--){let e=i[r];(0,o.UN)(e,t)?i.splice(r,1):c(t,e)&&i.splice(r,1)}i.push((0,o.yK)(t))}return i}},222298:function(e,t,i){i.d(t,{W:function(){return n}});var r=i(211561);let n=e=>{let{subType:t}=e,i=0===e.value,n=e.adjustParams.every(e=>0===e.value),a=e.faceAdjustParams.every(e=>{let{adjustParams:t}=e;return t.every(e=>0===e.value)});switch(t){case r.DeX.MetaSubTypeAutoBeauty:return i&&n;case r.DeX.MetaSubTypeExclusionFace:case r.DeX.MetaSubTypeExclusion:return i&&n&&a;default:return i}}},807844:function(e,t,i){i.d(t,{E0:function(){return a},Z_:function(){return s},zI:function(){return o}});var r=i(211561);let n=e=>{let t=new Map;for(let i of e)t.set(i.name,i.value);return t},a=e=>{if(e.subType!==r.DeX.MetaSubTypeManualZoom)return null;let t=new r.TkD,i=n(e.adjustParams);return t.x=i.get("x"),t.y=i.get("y"),t.radius=i.get("r"),t.intensity=e.value,t},o=e=>{if(e.subType!==r.DeX.MetaSubTypeManualStretch)return null;let t=new r.anD,i=n(e.adjustParams);return t.upper=i.get("upper"),t.bottom=i.get("bottom"),t.intensity=e.value,t},s=e=>{if(e.subType!==r.DeX.MetaSubTypeManualSlim)return null;let t=new r.zs3,i=n(e.adjustParams);return t.x=i.get("x"),t.y=i.get("y"),t.width=i.get("width"),t.height=i.get("height"),t.rotation=i.get("rotation"),t.intensity=e.value,t}},320149:function(e,t,i){i.d(t,{q:function(){return a}});var r=i(211561);let n={[r.VAL.Anim_None]:r.VAL.Anim_None,[r.VAL.Anim_In]:r.VAL.Anim_In,[r.VAL.Anim_Out]:r.VAL.Anim_Out,[r.VAL.Anim_Loop]:r.VAL.Anim_Loop,[r.VAL.Anim_Caption]:r.VAL.Anim_Caption,[r.VAL.Anim_Group]:r.VAL.Anim_Group};class a{static animType(e){if(null!==e){for(let t of Object.keys(n))if(n[t]===e)return t}return r.VAL.Anim_None}static cstrType(e){let t=n[e];if(void 0!==t)return t;throw Error(`please input a correct animType ${e}`)}static matchAnimType(e){return Object.values(n).includes(e)}}},247817:function(e,t,i){i.d(t,{E:function(){return n}});var r=i(211561);let n=e=>{var t,i,n,a,o,s,l;let d=e=>{let t=new r.KS6;return t.x=e.x,t.y=e.y,t},c=e=>{let t=[];for(let i of e){let e=new r.XcK;e.anchor=d(i.anchor),e.leftControl=d(i.leftControl),e.rightControl=d(i.rightControl),t.push(e)}return t},u=new r.yFe;return u.luma=c(null===(t=e.colorCurvesParams)||void 0===t?void 0:t.luma),u.red=c(null===(i=e.colorCurvesParams)||void 0===i?void 0:i.red),u.green=c(null===(n=e.colorCurvesParams)||void 0===n?void 0:n.green),u.blue=c(null===(a=e.colorCurvesParams)||void 0===a?void 0:a.blue),u.resourceId=null===(o=e.colorCurvesParams)||void 0===o?void 0:o.resourceId,u.panel=null===(s=e.colorCurvesParams)||void 0===s?void 0:s.panel,u.path=null===(l=e.colorCurvesParams)||void 0===l?void 0:l.path,u}},194460:function(e,t,i){i.d(t,{t:function(){return a},y:function(){return o}});var r=i(211561),n=i(392742);let a=(e,t,i)=>{let a=e.getGroupFromSegment(t.id),o=[];if(!a)return[];a.clone().groupMembers.push(i.id);let s=new r.k_B;return s.groups=[a],o.push({type:n.x.SetGroupContainerProperty,params:{groupContainerDelta:s}}),o},o=(e,t)=>{let i=e.getGroupBySegmentId(t);if(i){let e=i.groupMembers,r=e.findIndex(e=>e===t);r>=0&&e.splice(r,1)}}},190499:function(e,t,i){i.d(t,{nz:function(){return s},zI:function(){return d}});var r=i(211561),n=i(481631),a=i(469997),o=i(879566);function s(e){switch(e){case r.Eu.KFTypeShadow:return a.NI;case r.Eu.KFTypeHightLight:return a.y;case r.Eu.KFTypeHue:return a.vT;case r.Eu.KFTypeTemperature:return a.mD;default:return""}}let l={KFTypePositionX:"px",KFTypePositionY:"py",KFTypeScale:"s",KFTypeScaleX:"sx",KFTypeScaleY:"sy",KFTypeRotation:"rz",KFTypeAlpha:"o",KFTypeFilter:"intensity",KFTypeBrightness:"intensity",KFTypeContrast:"intensity",KFTypeSaturation:"intensity",KFTypeSharpen:"intensity",KFTypeHightLight:"intensity",KFTypeShadow:"intensity",KFTypeTemperature:"intensity",KFTypeHue:"intensity",KFTypeFade:"intensity",KFTypeLightSensatione:"intensity",KFTypeVignetting:"intensity",KFTypeParticle:"intensity",KFTypeLUT:"intensity",KFTypePrimaryColorWheelIntensity:"Intensity",KFTypeLogColorWheelIntensity:"Intensity",KFTypeSmartColorAdjust:"effects_adjust_intensity",KFTypeChromaIntensity:"intensity",KFTypeChromaShadow:"shadow",KFTypeChromaEdgeSmooth:"edge_smooth",KFTypeChromaSpill:"spill",KFTypeMaskPostionX:"centerX",KFTypeMaskPostionY:"centerY",KFTypeMaskSizeX:"width",KFTypeMaskSizeY:"height",KFTypeMaskRotation:"rotation",KFTypeMaskFeather:"feather",KFTypeMaskRoundCorner:"roundCorner",KFTypeCommonMaskPositionX:"centerX",KFTypeCommonMaskPositionY:"centerY",KFTypeCommonMaskSizeWidth:"width",KFTypeCommonMaskSizeHeight:"height",KFTypeCommonMaskRotation:"rotation",KFTypeCommonMaskFeather:"feather",KFTypeCommonMaskRoundCorner:"roundCorner",KFTypeBorderWidth:"ow",KFTypeTextAlpha:"to",KFTypeTextColor:"tc",KFTypeBackgroundAlpha:"bo",KFTypeBackgroundColor:"bc",KFTypeShadowColor:"sc",KFTypeShadowAlpha:"so",KFTypeShadowSmoothing:"ss",KFTypeShadowAngle:"sa",KFTypeShadowDistance:"sd",KFTypeTextCurveAngle:"taca",KFTypeBorderColor:"oc",KFTypeBorderAlpha:"oo",KFTypeGlobalAlpha:"tg",KFTypeBloomColor:"tbc",KFTypeBloomAlpha:"tbo",KFTypeBloomStrength:"tbs",KFTypeBloomRange:"tbr",KFTypeBloomDirX:"tbx",KFTypeBloomDirY:"tby"};function d(e,t){var i;let a=function(e,t){if((0,n.Ft)(e)&&t===r.Eu.KFTypeShadowSmoothing)return o.hM.isUsingOldTextShadowSmooth(e.material.content)?"ss":"sdf"}(e,t);return null!==(i=null!=a?a:l[t])&&void 0!==i?i:t}},717501:function(e,t,i){i.d(t,{v:function(){return a}});var r=i(881337),n=i(602777);class a{execute(e,t,i,r,n){let a=[];return(null==r?void 0:r.length)?a=r:a.push(r),this.doExecute(e,t,i,a,n)}doExecute(e,t,i,r,n){let a=!1;for(let o of(this.executeNormal(t,i,n),r))a=a||this.executeInner(e,t,i,o,n);return a}executeInner(e,t,i,r,n){let a=this.getKeyframeValues(i,r);return!!this.addKeyframe(t,i,r,a)||!1}addKeyframe(e,t,i,a){if(!a.length)return;let o=(0,r.TIP)();o.flags=BigInt(n.yP.KFDataParamFlag_datas|n.yP.KFDataParamFlag_playHead),o.datas=a;let s=(0,r.v$N)();return s.segId=t.id,s.keyframeType=i,s.dataParam=o,!0}constructor(e){this.params=e}}},749417:function(e,t,i){i.d(t,{Qk:function(){return y},cf:function(){return T},um:function(){return v},zW:function(){return g}});var r=i(508278),n=i(211561),a=i(481631),o=i(396402),s=i(185400),l=i(13242),d=i(342558),c=i(287165),u=i(340294),m=i(567142),h=i(701897),f=i(176791);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,c.p)();return`${e}_${t}_${i}`}function g(e){let[t,i,r]=e.split("_");return[t,i,r]}function y(e,t,i){let[r,n]=g(e);return i?r===t&&n===i:r===t}function _(e,t,i){if(0!==i.length){if(1===i.length){e[t]=i[0];return}e[t]=i}}function T(e,t){let i=[],r=t.graphData,a=t.timeOffset-e.timeOffset,o=t.datas.map((t,i)=>t-e.datas[i]),s=r.length,l=t=>e.datas.map((e,i)=>e+o[i]*t),d=t=>e.timeOffset+u.pM.times(a,t,"bigint"),c=[];for(let a=0;a<s;++a){let o=r[a].point,u=d(o.x),m=l(o.y);if(0===r[a].type){let r;if(0===a?(r=e).curveType===n.wHM.KeyframeCurveTypeLine&&(r.curveType=n.wHM.KeyframeCurveTypeCurveOut):a===s-1?(r=t).curveType===n.wHM.KeyframeCurveTypeLine&&(r.curveType=n.wHM.KeyframeCurveTypeCurveIn):r={curveType:n.wHM.KeyframeCurveTypeCurveInOut,timeOffset:u,datas:m,graphData:[],leftControl:{x:0,y:0},leftGraphDataControlValue:[],leftGraphDataTimeOffset:0n,rightControl:{x:0,y:0},rightGraphDataControlValue:[],rightGraphDataTimeOffset:0n},i.length){let e=i[i.length-1];if(1===c.length){let t=c[0],i=e.datas.map((e,i)=>Number(e)/3+2*t.datas[i]/3),n=1n*e.timeOffset/3n+2n*t.timeOffset/3n;e.rightGraphDataControlValue=i.map((t,i)=>t-e.datas[i]),e.rightGraphDataTimeOffset=n-e.timeOffset;let a=t.datas.map((e,t)=>2*e/3+Number(r.datas[t])/3),o=2n*t.timeOffset/3n+1n*r.timeOffset/3n;r.leftGraphDataControlValue=a.map((e,t)=>e-r.datas[t]),r.leftGraphDataTimeOffset=o-r.timeOffset}else 2===c.length&&(e.rightGraphDataControlValue=c[0].datas.map((t,i)=>t-e.datas[i]),e.rightGraphDataTimeOffset=c[0].timeOffset-e.timeOffset,r.leftGraphDataControlValue=c[1].datas.map((e,t)=>e-r.datas[t]),r.leftGraphDataTimeOffset=c[1].timeOffset-r.timeOffset)}i.push(r),c=[]}else c.push({curveType:n.wHM.KeyframeCurveTypeLine,timeOffset:u,datas:m,graphData:[],leftControl:{x:0,y:0},leftGraphDataControlValue:[],leftGraphDataTimeOffset:0n,rightControl:{x:0,y:0},rightGraphDataControlValue:[],rightGraphDataTimeOffset:0n})}return i}class v{static cloneDeep(e){return e.point?{...e,point:{...e.point}}:{...e,datas:[...e.datas],leftControl:{...e.leftControl},rightControl:{...e.rightControl},graphData:e.graphData.map(e=>v.cloneDeep(e)),leftGraphDataControlValue:[...e.leftGraphDataControlValue],rightGraphDataControlValue:[...e.rightGraphDataControlValue]}}static convertKeyframes(e,t){return e.keyframeList.map(e=>v.convertKeyframe(e,t))}static convertKeyframe(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i={curveType:e.curveType,datas:[...e.values],timeOffset:e.timeOffset,leftControl:{x:0,y:0},rightControl:{x:0,y:0},graphData:[],leftGraphDataControlValue:[],leftGraphDataTimeOffset:0n,rightGraphDataControlValue:[],rightGraphDataTimeOffset:0n};return i.curveType!==n.wHM.KeyframeCurveTypeLine&&(i.leftControl={x:e.leftControl.x,y:e.leftControl.y},i.rightControl={x:e.rightControl.x,y:e.rightControl.y}),t&&e.graph&&(i.graphData=v.toKeyframeGraphPointList(e.graph)),i}static toKeyframeGraphPointList(e){let t=[];for(let i of e.graphPoints)t.push({point:i.point,type:i.type});return t}static repairKeyframesTimeOffsetToRelativeSeqTime(e,t){var i;if(!((0,a.he)(t)||(0,a.Y9)(t)))return;let o=t.sourceTimerange,s=t.speed,l=null!==(i=s.speed)&&void 0!==i?i:1;if(s&&s.mode!==n.yY$.SpeedModeNormal&&s.curveSpeed){let i=[],n=[];for(let e of s.curveSpeed.speedPoints)i.push(e.x),n.push(e.y);let a=t.targetTimerange,l=new m.H;for(let t of(l.setCurveSpeed(i,n),l.setSeqDuration(a.duration),e)){let e=t.timeOffset-o.start;e>=0&&e<=o.duration?(t.timeOffset=BigInt(l.mapTrimDeltaToSeqDelta(e)),!(0,r.H8)(t.leftControl.x,0)&&(t.leftControl.x=l.mapTrimDeltaToSeqDelta(e+(0,h.iW)(t.leftControl.x)-t.timeOffset)),!(0,r.H8)(t.rightControl.x,0)&&(t.rightControl.x=Number(l.mapTrimDeltaToSeqDelta(e+(0,h.iW)(t.rightControl.x)-t.timeOffset)))):e<0?(t.timeOffset=0n,t.leftControl.x=0,!(0,r.H8)(t.rightControl.x,0)&&(t.rightControl.x=Number(l.mapTrimDeltaToSeqDelta((0,h.iW)(t.rightControl.x))))):(t.timeOffset=a.duration,t.rightControl.x=0,!(0,r.H8)(t.leftControl.x,0)&&(t.leftControl.x=Number(l.mapTrimDeltaToSeqDelta((0,h.iW)(t.leftControl.x)))))}}else for(let t of e){let e=t.timeOffset-o.start;t.timeOffset=u.pM.div(e,l,"bigint"),t.leftControl.x=u.pM.minus(u.pM.div(u.pM.plus(t.leftControl.x,e,"bigint"),l),t.timeOffset),t.rightControl.x=u.pM.minus(u.pM.div(u.pM.plus(t.rightControl.x,e,"bigint"),l),t.timeOffset)}}static repairKeyframesValues(e,t,i){if([n.Eu.KFTypeTextColor,n.Eu.KFTypeBackgroundColor,n.Eu.KFTypeShadowColor,n.Eu.KFTypeBorderColor,n.Eu.KFTypeBloomColor].includes(e)){for(let e of t)(0,u.SI)(e.datas,3,0);return}if(e===n.Eu.KFTypeCommonMaskFeather)for(let e of t)for(let t=0;t<e.datas.length;t++)e.datas[t]=e.datas[t]*e.datas[t];let r=-1,o=null,s=null;if((0,a.P2)(i)||(0,a.P7)(i)||(0,a.Ft)(i)||(0,a.WX)(i))switch(e){case n.Eu.KFTypeRotation:o=e=>0-e,r=0;break;case n.Eu.KFTypeShadowSmoothing:o=e=>e/18,r=0;break;case n.Eu.KFTypeShadowDistance:o=e=>e/100,r=0;break;case n.Eu.KFTypeShadowAngle:o=e=>e*Math.PI/180,r=0;break;case n.Eu.KFTypeScale:(0,a.P2)(i)&&i.material.unicode&&(s=e=>{(0,u.SI)(e,2,1),e[0]*=.5,e[1]*=.5});case n.Eu.KFTypeScaleX:case n.Eu.KFTypeScaleY:(0,a.P7)(i)&&1!==i.material.initialScale&&(o=e=>e*i.material.initialScale,r=0)}else if((0,a.he)(i)){if(e===n.Eu.KFTypePositionX);else if(e===n.Eu.KFTypePositionY)o=e=>-e,r=0;else if(e===n.Eu.KFTypeScale)s=e=>{(0,u.SI)(e,1,1),e[0]=e[0]*i.material.cropScale};else if(e===n.Eu.KFTypeCommonMaskSizeHeight){let e=(0,f.P2)(i);if(!e||!e.config)return;r=0,o=(e,t)=>{var r,a;let o=i.commonKeyframes.find(e=>e.propertyType===n.Eu.KFTypeCommonMaskSizeWidth),s=(0,d.j3)(i,[(null==o?void 0:null===(r=o.keyframeList[t])||void 0===r?void 0:r.values[0])||0,e],!(null==o?void 0:null===(a=o.keyframeList[t])||void 0===a?void 0:a.values[0]));return s?s[1]:e}}else if(e===n.Eu.KFTypeScaleX||e===n.Eu.KFTypeScaleY){r=0;let e=1;i.material.cropScale&&(e=i.material.cropScale),o=t=>t*e}}(s||o)&&t.forEach((e,t)=>{if(null==s||s(e.datas),!!o&&!(e.datas.length<=r))e.leftControl.y=o(e.leftControl.y,t),e.rightControl.y=o(e.rightControl.y,t),e.datas[r]=o(e.datas[r],t)})}static makeAudioEffectKeyframe(e,t,i){let r=[];if(!("SegmentVideo"===t.__segment_struct_type||"SegmentAudio"===t.__segment_struct_type))return r;let a=t.voiceChange;if(!a||0===a.length)return r;for(let o of a){let a=o.audioAdjustParams;for(let o of i){let i={curveType:n.wHM.KeyframeCurveTypeLine,timeOffset:o,leftControl:{x:0,y:0},rightControl:{x:0,y:0},datas:[],leftGraphDataControlValue:[],leftGraphDataTimeOffset:0n,rightGraphDataControlValue:[],rightGraphDataTimeOffset:0n,graphData:[]};if(a.length>0&&a[0]){let r=l.U.getPropertyValuesByTimeOffset(e,t,n.Eu.KFTypeEffectAdjustParam1,o);i.datas.push(r[0])}if(a.length>1&&a[1]){let r=l.U.getPropertyValuesByTimeOffset(e,t,n.Eu.KFTypeEffectAdjustParam2,o);i.datas.push(r[0])}if(a.length>2&&a[2]){let r=l.U.getPropertyValuesByTimeOffset(e,t,n.Eu.KFTypeEffectAdjustParam3,o);i.datas.push(r[0])}r.push(i)}}return r}static convertAudioEffectKeyframe(e,t,i,r){let n=t.timeOffset+i+r;return{type:o.Q.SAMIProcessorKeyframe,time_offset:{"time.us":n},property:n.toString(),params:t.datas,json:"",id:p(e),priv:{}}}static convertAudioKeyframe(e,t,i,r){if(t.datas.length<1)throw Error("Invalid keyframe params");let n=t.timeOffset+i+r;return{type:o.Q.AudioKeyframe,time_offset:{"time.us":n},volume:t.datas[0],property:n.toString(),json:JSON.stringify({volume:t.datas[0],curve:"curve"}),id:p(e),priv:{}}}static convertAudioCommonKeyframeList(e,t,i,r){let a;if(e===n.Eu.KFTypeVolume)a=v.convertAudioKeyframe;else{if(!s.gb.includes(e))return[];a=v.convertAudioEffectKeyframe}let o=[];for(let n of t)o.push(a(e,n,i,r));return o}static convertCommonKeyframe(e,t,i,r,a,s,l){if(0===r.length)return;let d=[],c=-1n;for(let e of r){if(!(e.timeOffset<0)&&!!e.graphData)if(e.graphData.length>=4&&d.length>0){let t=T(d[d.length-1],e);if(t.length)for(let e of(d.pop(),d.length&&(c=d[d.length-1].timeOffset),t))e.datas.length>0&&e.timeOffset>=c&&(d.push(e),c=e.timeOffset)}else e.datas.length>0&&e.timeOffset>=c&&(d.push(e),c=e.timeOffset)}if(d.length<=0)return;let m=[];for(let e of d)m.push(function(e,t,i){let r={};_(r,"v",t.datas),r.t=t.timeOffset+i,r.h=0;let a=t.curveType===n.wHM.KeyframeCurveTypeLine;if(r.it=a?"linear":"cubic",!a){if(0===t.leftGraphDataControlValue.length){r.vti=t.leftControl.x;let e=[t.leftControl.y];t.datas.length>1&&(0,u.SI)(e,t.datas.length,e[0]),_(r,"vi",e)}else r.vti=t.leftGraphDataTimeOffset,_(r,"vi",t.leftGraphDataControlValue)}if(0===t.rightGraphDataControlValue.length){r.vto=t.rightControl.x;let e=[t.rightControl.y];t.datas.length>1&&(0,u.SI)(e,t.datas.length,e[0]),_(r,"vo",e)}else r.vto=t.rightGraphDataTimeOffset,_(r,"vo",t.rightGraphDataControlValue);return r}(0,e,l));let h=function(e,t){let i={};return i.v="2.0.0",i.s=e,i.e=t,i.t=0,i}(a,s);return h.k={[t]:m},{type:o.Q.VideoKeyframe,property:t,json:u.HH.stringify(h),alpha:1,position_x:0,position_y:0,rotation:0,scale:1,curve_speed:"",time_offset:{"time.us":0n},id:p(i,t,e),priv:{}}}static convertLockedKeyframe(e,t){let{position:i,rotation:r,scale:a,timeOffset:o}=e,{x:s,y:l}=i,{x:d,y:c}=a,u=new n.$2f({timeOffset:o});return u.values=[t?0-s:s,l,0,d,c,1,0,0,r],u}}},13242:function(e,t,i){i.d(t,{U:function(){return v}});var r=i(211561),n=i(853585),a=i(91118),o=i(829813),s=i(131137),l=i(837832),d=i(65582),c=i(354696),u=i(701456),m=i(508278),h=i(127926),f=i(35276),p=i(749417),g=i(423193),y=i(527730),_=i(481631),T=i(340294);class v{static isFreeCurve(e){return[r.wHM.KeyframeFreeCurveTypeCurveIn,r.wHM.KeyframeFreeCurveTypeCurveInOut,r.wHM.KeyframeFreeCurveTypeCurveOut].includes(e)}static setPropertyValues(e,t,i){if(0!==i.length){if((0,_.he)(e))return n.I.setSegmentProperty(e,t,i);if((0,_.Y9)(e))return o.r.setSegmentProperty(e,t,i);if((0,_.E6)(e))return a.R.setSegmentProperty(e,t,i);else if((0,_.Si)(e))return s.S.setSegmentProperty(e,t,i);else if((0,_.P2)(e))return l.r.setSegmentProperty(e,t,i);else if((0,_.P7)(e))return l.w.setSegmentProperty(e,t,i);else if((0,_.WX)(e))return d.p.setSegmentProperty(e,t,i);else if((0,_.Ft)(e))return c.K.setSegmentProperty(e,t,i);else if((0,_.w5)(e))return u.o.setSegmentProperty(e,t,i)}}static getPropertyValuesByTimeOffset(e,t,i,n){var a;let o=null!==(a=(0,m.sZ)(t,i))&&void 0!==a?a:new r.koq;return this._getPropertyValuesByTimeOffset(e,t,o,i,n-1000n,n+1000n)}static getPropertyValues(e,t,i,r){let n=new f.b().getKeyframeTimeOffsetByTimeline(e,t,r);return this.getPropertyValuesByTimeOffset(e,t,i,n)}static getKeyframeValueFromTimeline(e,t,i,r,n){if(!t)return n;let a=this.getPropertyValues(e,t,i,r);return g.O.unPack(a,n)}static isValidValue(e,t,i,n){let a=this._getPropertyValuesByTimeOffset(e,t,new r.koq,i,0n,0n);if(n.some((e,t)=>a[t]!==e))return!0;let o=h.OL.findKeyframes(t,i);if(!o)return!1;for(let e of o.keyframeList)if(e.curveType!==r.wHM.KeyframeCurveTypeLine||n.some((t,i)=>e.values[i]!==t))return!0;return!1}static calLockedKeyframe(e,t,i){let n,a,o,s,l,d;if(!i)return t;if(!t||e>=i.timeOffset)return i;if(e<=t.timeOffset)return t;let c=new r.Hpt,u=T.pM.div(e-t.timeOffset,i.timeOffset-t.timeOffset,"number");c.timeOffset=e;c.rotation=(n=t.rotation,n+u*(i.rotation-n));let m=new r.wx7;m.x=(a=t.position.x,a+u*(i.position.x-a));m.y=(o=t.position.y,o+u*(i.position.y-o)),c.position=m;let h=new r.Ciz;h.x=(s=t.scale.x,s+u*(i.scale.x-s));h.y=(l=t.scale.y,l+u*(i.scale.y-l)),c.scale=h;return c.rotation=(d=t.rotation,d+u*(i.rotation-d)),c}static _getPropertyValuesByTimeOffset(e,t,i,r,n,a){let o=new f.b;if(i.keyframeList.length>0){let{keyframe:r,next:s,prev:l}=h.OL.findKeyframeByTimeOffset(i,n,a);if(r)return r.values.concat();if(!l&&s)return s.values.concat();else{if(l&&!s)return l.values.concat();if(!l||!s||l.values.length!==s.values.length)return[];let i=o.getRelativeSeqTimeByKeyframeTimeOffset(e,t,(n+a)/2n),r=o.getRelativeSeqTimeByKeyframeTimeOffset(e,t,l.timeOffset),d=o.getRelativeSeqTimeByKeyframeTimeOffset(e,t,s.timeOffset);return this._calPropertyValues(t,l,s,i,r,d).concat()}}return this._getSegmentProperty(t,r)}static _getSegmentProperty(e,t){if((0,_.he)(e))return n.I.getSegmentProperty(e,t);if((0,_.Y9)(e))return o.r.getSegmentProperty(e,t);if((0,_.E6)(e))return a.R.getSegmentProperty(e,t);else if((0,_.Si)(e))return s.S.getSegmentProperty(e,t);else if((0,_.P2)(e))return l.r.getSegmentProperty(e,t);else if((0,_.P7)(e))return l.w.getSegmentProperty(e,t);else if((0,_.WX)(e))return d.p.getSegmentProperty(e,t);else if((0,_.Ft)(e))return c.K.getSegmentProperty(e,t);else if((0,_.w5)(e))return u.o.getSegmentProperty(e,t);else if((0,_.Q2)(e))return y.s.getBaseProperty(e,t);else return[]}static _calPropertyValues(e,t,i,n,a,o){let s=o-a;if(t.curveType===r.wHM.KeyframeCurveTypeLine&&i.curveType===r.wHM.KeyframeCurveTypeLine){let e=T.pM.div(n-a,s),r=i.values.map((e,i)=>e-t.values[i]);return t.values.map((t,i)=>t+T.pM.times(r[i],e))}let l=p.um.convertKeyframe(t),d=p.um.convertKeyframe(i,!0),c=(0,p.cf)(l,d);0===c.length&&(c=[l,d]),p.um.repairKeyframesTimeOffsetToRelativeSeqTime(c,e);let u=l;for(let e of c){if(e.timeOffset>=n){s=e.timeOffset-a;let t=T.pM.div(n-a,s);return f.j.calCubicPropertyValues(u,e,t)}a=e.timeOffset,u=e}return i.values}}},98819:function(e,t,i){i.d(t,{_:function(){return f}});var r=i(602777),n=i(211561),a=i(508278),o=i(35276),s=i(13242),l=i(129862),d=i(982811),c=i(127926),u=i(481631),m=i(283751),h=i(800788);let f={splitKeyframesByTimeRange(e,t,i,r,a,h){if(!t||!i||0===t.commonKeyframes.length)return;let f=new o.b,p=d.Y.getInstance().getCaptureContextInfo();if(!p)return;let g=t.clone(),y=i.clone();p.playHead=r;let _=BigInt(p.captureWidth/2*1e3/p.trackPxPerMs);0n===_&&(_=c.OL.gKeyframeTimeTorlerance);let T=f.getKeyframeTimeOffsetByTimeline(e,g,p.playHead),v=f.getKeyframeTimeOffsetByTimeline(e,g,p.playHead-_),I=f.getKeyframeTimeOffsetByTimeline(e,g,p.playHead+_),w=-1n;for(let t of(!("SegmentVideo"===g.__segment_struct_type||"SegmentAudio"===g.__segment_struct_type)&&(w=r-g.targetTimerange.start),g.commonKeyframes)){if(!t)continue;let i=t.keyframeList;if(0===i.length)continue;let r=t.propertyType,a=c.OL.splitKeyframe(t,v,I),{left:o,cur:d}=a,{right:f}=a;if(d||f.length>0&&o.length>0){let t=new n.$2f;if(d)t=d.clone();else{let i=o.length>0?o[o.length-1]:null,n=f.length>0?f[0]:null;t.timeOffset=T,t.curveType=c.OL.calCurverType(i,n),t.values=s.U.getPropertyValuesByTimeOffset(e,g,r,T)}o.push(t),f.unshift(t)}if(0===o.length){let t=d?d.values:i[0].values,n=s.U.setPropertyValues(g,r,t);if(n){let t=(0,u.xX)({__segment_struct_type:g.__segment_struct_type});m.T.pick(g,n,t),h(new l.F({trackId:e.getTrackBySegmentId(g.id).id,trackIndex:e.getTrackIndexBySegmentId(g.id),segmentId:g.id,segmentDelta:n,sourceSegmentDelta:t}))}}t.keyframeList=o;let p=c.OL.findKeyframes(y,r);if(0===f.length){let t=d?d.values:i[i.length-1].values,n=s.U.setPropertyValues(y,r,t);if(n){let t=(0,u.xX)({__segment_struct_type:y.__segment_struct_type});m.T.pick(y,n,t),h(new l.F({trackId:e.getTrackBySegmentId(y.id).id,trackIndex:e.getTrackIndexBySegmentId(y.id),segmentId:y.id,segmentDelta:n,sourceSegmentDelta:t}))}}else if(f=c.OL.cloneKeyframeList(f),w!==-1n)for(let e of f)e.timeOffset=e.timeOffset-w;p&&(p.keyframeList=f)}let S=(0,u.xX)({__segment_struct_type:t.__segment_struct_type});S.commonKeyframes=g.commonKeyframes;let k=(0,u.xX)({__segment_struct_type:g.__segment_struct_type});m.T.pick(g,S,k),h(new l.F({trackId:e.getTrackBySegmentId(g.id).id,trackIndex:e.getTrackIndexBySegmentId(g.id),segmentId:g.id,segmentDelta:S,sourceSegmentDelta:k}));let x=(0,u.xX)({__segment_struct_type:i.__segment_struct_type});return x.commonKeyframes=y.commonKeyframes,k=(0,u.xX)({__segment_struct_type:y.__segment_struct_type}),m.T.pick(y,x,k),h(new l.F({trackId:e.getTrackBySegmentId(y.id).id,trackIndex:e.getTrackIndexBySegmentId(y.id),segmentId:y.id,segmentDelta:x,sourceSegmentDelta:k})),{cloneSegment:g,cloneSplitSegment:y}},deleteKeyframesByTimeRange(e,t,i,r,n,a,o,d){if(null===t)throw Error("Segment cannot be null");for(let c of t.commonKeyframes){let h=c.keyframeList;if(!h||0===h.length)continue;let f=this.deleteOneTypeKeyframesByTimeRange(e,t,i,r,n,c,a,o);if(f&&0===h.length){let i=s.U.setPropertyValues(t,c.propertyType,f.values);if(i){let r=(0,u.xX)({__segment_struct_type:t.__segment_struct_type});m.T.pick(t,i,r),d(new l.F({trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:i,sourceSegmentDelta:r}))}}let p=h.findIndex(e=>e.id===c.id);p>=0&&(h.splice(p,1),this.repairKeyframeControlPoints(h))}let c=(0,u.xX)({__segment_struct_type:t.__segment_struct_type});c.commonKeyframes=t.commonKeyframes;let h=(0,u.xX)({__segment_struct_type:t.__segment_struct_type});m.T.pick(t,c,h),d(new l.F({trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:c,sourceSegmentDelta:h}))},deleteOneTypeKeyframesByTimeRange(e,t,i,s,l,d,c,u){let m=new o.b;if(null===d)return null;let h=d.keyframeList,f=null;if(!u){if(c&&i===r.ZX.ClipStart){let e=t.targetTimerange;for(let t=0;t<h.length;++t){let i=h[t],r=i.timeOffset;r-=e.start-l.start,i.timeOffset=r}}return null}let p=t.targetTimerange,g=m.getKeyframeTimeOffsetByTimeline(e,t,l.start),y=m.getKeyframeTimeOffsetByTimeline(e,t,p.start),_=m.getKeyframeTimeOffsetByTimeline(e,t,p.start+p.duration);for(let e=0;e<h.length;){let o=h[e],s=o.timeOffset;if(c&&i===r.ZX.ClipStart){var T,v;((null===(T=t.material)||void 0===T?void 0:T.type)===n.cVg.MetaTypePhoto||(null===(v=t.material)||void 0===v?void 0:v.type)===n.cVg.MetaTypeGif)&&y===g?s+=p.duration-l.duration:s-=y-g,o.timeOffset=s}s!==y&&(0,a.H8)(s,y)?(s=y,o.timeOffset=s):s!==_&&(0,a.H8)(s,_)&&(s=_,o.timeOffset=s),s<y?(i===r.ZX.ClipStart?f=o:i===r.ZX.ClipDuration&&null===f&&(f=o),h.splice(e,1)):s>_?(i===r.ZX.ClipStart?f=o:i===r.ZX.ClipDuration&&null===f&&(f=o),h.splice(e,1)):++e}return f},repairKeyframeControlPoints(e){if(!e||0===e.length)return;if(1===e.length){let t=e[0];t&&(t.curveType=n.wHM.KeyframeCurveTypeLine);return}let t=e[0];if(t){let e=t.curveType;e!==n.wHM.KeyframeCurveTypeLine&&(s.U.isFreeCurve(e)?t.curveType=n.wHM.KeyframeFreeCurveTypeCurveIn:t.curveType=n.wHM.KeyframeCurveTypeCurveIn)}let i=e[e.length-1];if(i){let e=i.curveType;e!==n.wHM.KeyframeCurveTypeLine&&(s.U.isFreeCurve(e)?i.curveType=n.wHM.KeyframeFreeCurveTypeCurveOut:i.curveType=n.wHM.KeyframeCurveTypeCurveOut)}},splitLockedKeyframesByTimerange(e,t,i,r,a,m){var f,p,g;if(!i||!(0,u.he)(t)||!(0,u.he)(i))return;let{objectLocked:y}=t.material;if(!y)return;let{keyframes:_,lockedTimeRanges:T}=y,v=_.map(e=>e.clone());if(!v||0===v.length)return;let I=d.Y.getInstance().getCaptureContextInfo();if(!I)return;I.playHead=r;let w=new n.NOn;w.material=new n.K2q,w.material.objectLocked=new n.BnV;let S=new n.NOn;S.material=new n.K2q,S.material.objectLocked=new n.BnV;let k=BigInt(I.captureWidth/2*1e3/I.trackPxPerMs);0n===k&&(k=c.OL.gKeyframeTimeTorlerance);let x=new o.b,b=x.getKeyframeTimeOffsetByTimeline(e,t,I.playHead),M=x.getKeyframeTimeOffsetByTimeline(e,t,I.playHead-k),C=x.getKeyframeTimeOffsetByTimeline(e,t,I.playHead+k),A=[],E=[],F=null;for(let e of v)e.timeOffset>=M&&e.timeOffset<=C?(e.timeOffset=BigInt(M+(C-M)/2n),!F&&(F=e)):e.timeOffset<M?((0,h.Y2)(0===E.length),A.push(e)):E.push(e);if(F||E.length&&A.length){let e;if(F)e=F;else{let t=A.length?A[A.length-1]:void 0,i=E.length?E[0]:void 0;e=s.U.calLockedKeyframe(b,t,i)}e&&(A.push(e),E.splice(0,0,e.clone()))}let P=[];for(let e of T)if(e.start+e.duration<=b)P.push(e);else if(e.start<b&&e.start+e.duration>b){let t=new n.tnv;t.start=e.start,t.duration=b-e.start,P.push(t)}A.length?w.material.objectLocked=void 0:(w.material.objectLocked.keyframes=v,w.material.objectLocked.lockedTimeRanges=P);let D=[];for(let e of null!==(g=null===(p=i.material)||void 0===p?void 0:null===(f=p.objectLocked)||void 0===f?void 0:f.lockedTimeRanges)&&void 0!==g?g:[])if(e.start>b){let t=new n.tnv;t.start=e.start,t.duration=e.duration,D.push(t)}else if(e.start+e.duration>b){let t=new n.tnv;t.start=b,t.duration=e.start+e.duration-b,D.push(t)}E.length?S.material.objectLocked=void 0:(S.material.objectLocked.keyframes=E,S.material.objectLocked.lockedTimeRanges=D);let z=(0,u.xX)({__segment_struct_type:t.__segment_struct_type});m(new l.F({trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:t.id,segmentDelta:w,sourceSegmentDelta:z})),m(new l.F({trackId:e.getTrackBySegmentId(i.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),segmentId:i.id,segmentDelta:S,sourceSegmentDelta:z}))}}},829813:function(e,t,i){i.d(t,{r:function(){return a}});var r=i(211561),n=i(453138);let a={setSegmentAudioProperty(e,t,i){let a=new r.CCx;if(t===r.Eu.KFTypeVolume)a.volume=i;else if(t===r.Eu.KFTypeEffectAdjustParam1)a=n.P.setEffectAdjustParam(e,0,i);else if(t===r.Eu.KFTypeEffectAdjustParam2)a=n.P.setEffectAdjustParam(e,1,i);else{if(t!==r.Eu.KFTypeEffectAdjustParam3)return;a=n.P.setEffectAdjustParam(e,2,i)}return a},setSegmentProperty(e,t,i){if(!t||t===r.Eu.KFTypeLastVolume||!i.length)return;let n=this.setSegmentAudioProperty(e,t,i[0]);if(n)return n},getSegmentProperty(e,t){let i;if(t!==r.Eu.KFTypeNone){var n,a,o,s,l,d,c,u,m,h,f,p,g,y,_;t===r.Eu.KFTypeVolume?i=e.volume:t===r.Eu.KFTypeEffectAdjustParam1?i=null!==(l=null===(s=e.voiceChange)||void 0===s?void 0:null===(o=s[0])||void 0===o?void 0:null===(a=o.audioAdjustParams)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:n.value)&&void 0!==l?l:1:t===r.Eu.KFTypeEffectAdjustParam2?i=null!==(h=null===(m=e.voiceChange)||void 0===m?void 0:null===(u=m[0])||void 0===u?void 0:null===(c=u.audioAdjustParams)||void 0===c?void 0:null===(d=c[1])||void 0===d?void 0:d.value)&&void 0!==h?h:1:t===r.Eu.KFTypeEffectAdjustParam3&&(i=null!==(_=null===(y=e.voiceChange)||void 0===y?void 0:null===(g=y[0])||void 0===g?void 0:null===(p=g.audioAdjustParams)||void 0===p?void 0:null===(f=p[2])||void 0===f?void 0:f.value)&&void 0!==_?_:1)}return void 0!==i?[i]:[]}}},527730:function(e,t,i){i.d(t,{s:function(){return a}});var r=i(211561),n=i(481631);let a={setBaseProperty(e,t,i){let{clip:a}=e;if(!a)return;let o=(0,n.xX)({__segment_struct_type:e.__segment_struct_type});if(o.clip=new r.tLq,t===r.Eu.KFTypePositionX)o.clip.transform=new r.jPZ,[o.clip.transform.x]=i;else if(t===r.Eu.KFTypePositionY)o.clip.transform=new r.jPZ,[o.clip.transform.y]=i;else if(t===r.Eu.KFTypeScaleX)o.clip.scale=new r.o_k,[o.clip.scale.x]=i;else if(t===r.Eu.KFTypeScaleY)o.clip.scale=new r.o_k,[o.clip.scale.y]=i;else{if(t!==r.Eu.KFTypeRotation)return;[o.clip.rotation]=i}return o},getBaseProperty(e,t){var i,n,a,o,s;let l=[];if(t===r.Eu.KFTypePositionX){let t=null===(i=e.clip)||void 0===i?void 0:i.transform;void 0!==t&&l.push(t.x)}else if(t===r.Eu.KFTypePositionY){let t=null===(n=e.clip)||void 0===n?void 0:n.transform;void 0!==t&&l.push(t.y)}else if(t===r.Eu.KFTypeScaleX){let t=null===(a=e.clip)||void 0===a?void 0:a.scale;void 0!==t&&l.push(t.x)}else if(t===r.Eu.KFTypeScaleY){let t=null===(o=e.clip)||void 0===o?void 0:o.scale;void 0!==t&&l.push(t.y)}else if(t===r.Eu.KFTypeRotation){let t=null===(s=e.clip)||void 0===s?void 0:s.rotation;void 0!==t&&l.push(t)}return l}}},952819:function(e,t,i){i.d(t,{b:function(){return d}});var r=i(211561),n=i(481631),a=i(717501),o=i(129862),s=i(501452),l=i(283751);class d extends a.v{executeNormal(e,t,i){let{segId:a,intensity:s}=this.params,d=e.getSegmentById(a);if(!d||!(0,n.he)(d))return;let c=t.chroma?new r.VJQ(t.chroma).clone():new r.VJQ;c.intensityValue=s;let u=new r.NOn;u.chroma=new r.Xkj(c);let m=(0,n.xX)({__segment_struct_type:d.__segment_struct_type});l.T.pick(d,u,m),i(new o.F({trackId:e.getTrackBySegmentId(d.id).id,segmentId:a,segmentDelta:u,trackIndex:e.getTrackIndexBySegmentId(d.id),sourceSegmentDelta:m}))}getKeyframeValues(){return[this.params.intensity]}executeInner(e,t,i,r,n){if(e.isKeyframe){let e=s.y.execute({draftView:t,segment:i,keyframeType:r,values:this.getKeyframeValues()});e&&n(new o.F(e))}return!0}}},30279:function(e,t,i){i.d(t,{h:function(){return l}});var r=i(800788),n=i(436858),a=i(234075),o=i.n(a);let s=e=>{try{return new URL(e)}catch(e){return!1}},l=new class e{getFileName(e){var t,i,r,n;let a=/^(.*\/)?(.*?)(\..*?)?(\?.*)?$/,o=s(e),l=null;if(o){let e=o.pathname.split("/").filter(Boolean).pop();e&&(l=a.exec(e))}return!l&&(l=a.exec(e)),{name:null!==(t=null==l?void 0:l[2])&&void 0!==t?t:"",ext:null!==(i=null==l?void 0:l[3])&&void 0!==i?i:"",fullName:`${null!==(r=null==l?void 0:l[2])&&void 0!==r?r:""}${null!==(n=null==l?void 0:l[3])&&void 0!==n?n:""}`}}genFilePath(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._workspace,{ext:r}=this.getFileName(t);return o().join(i,`${e}${null!=r?r:""}`)}genEffectPath(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.genFilePath(e,t,n.gy)}genMaterialPath(e,t){return this.genFilePath(e,t)}genModelPath(e,t){return t?this.genFilePath(t,"",o().join(n.Yz,e)):(console.warn(`model ${e} not found`),e)}isPathStream(e){return void 0!==e&&(e.startsWith("http")||e.startsWith("asset_id://"))}isPathQuickImport(e){return void 0!==e&&e.startsWith("blob:")}isPathLocal(e){return!this.isPathStream(e)&&!this.isPathQuickImport(e)}toAbsolutePath(e){return this._workspace&&!e.startsWith(this._workspace)&&this.isPathLocal(e)?o().join(this._workspace,e):e}toRelativePath(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._workspace&&e.startsWith(this._workspace)&&this.isPathLocal(e)){var i;return`${t?"/":""}${o().relative(null!==(i=this._workspace)&&void 0!==i?i:"/",e)}`}return e}toLocalPath(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{transform:i}=t,n="";if(this.isPathLocal(e))n=e;else{if(!this.isPathStream(e))return e;(0,r.ss)("Editor should not handle material streaming")}switch(i){case"absolute":return this.toAbsolutePath(n);case"relative":return this.toRelativePath(n);default:return n}}isPathEqual(e,t){let i=this.toLocalPath(e,{transform:"absolute"});return i===this.toLocalPath(t,{transform:"absolute"})}normalizePath(e){return e?e.replace(/^\/__opfs_system_root\/editor/,"").replace(/\.[a-zA-Z0-9]+$/,""):""}normalizePathKeepSuffix(e){return o().join("/",e.replace(/^\/__opfs_system_root\/editor/,""))}genRelativeFilePath(e){if(e.fileId){let t=this.genFileFolder(e),{ext:i}=e;return i=i&&!i.startsWith(".")?`.${i}`:"",o().join(t,`${e.fileId}${i}`)}if(e.md5){let t=this.genFileFolder(e),{ext:i}=e;return i=i&&!i.startsWith(".")?`.${i}`:"",o().join(t,`${e.md5}${i}`)}return""}constructor(e){this.isPathIncompleteQuickImport=e=>void 0!==e&&e.startsWith("/.quick-import/"),this.genFileFolder=e=>{if(e.md5||e.fileId)switch(e.groupType){case"video":case"image":return"videos";case"audio":return"audios";default:return""}else if(e.type&&(e.type.startsWith("video")||e.type.startsWith("image")))return"videos";else if(e.type&&e.type.startsWith("audio"))return"audios";else return""},this._workspace=e}}(n.qm)},712616:function(e,t,i){i.d(t,{i:function(){return b},o:function(){return S}});var r=i(487108),n=i(21816),a=i(211561),o=i(879566),s=i(223729),l=i(90844),d=i(351603),c=i(287165),u=i(881337),m=i(666652),h=i(698159),f=i(129862),p=i(481631),g=i(93735),y=i(843363),_=i(320149),T=i(701897),v=i(217201),I=i(283751),w=i(929576);let S=async function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t||!i)return;let[a,s]=await (0,r.mL)(e,i,n);if(!a)throw Error(`[sticker] richText: ${t.content} to cmd : ${i.iOpCode}`);t.baseContent=s,t.content=s,t.text=o.hM.getOriginContentFromContent(s)},k=(e,t)=>0n===e||!!(e&1n<<BigInt(t)),x=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.PbZ.FrameFlag;e.checkFlag=t?e.checkFlag|Number(i):e.checkFlag&~Number(i)};class b{static async updateRichTextEffect(e,t,i,o){if(!e)return;let{material:s}=e;if(i){let t=s.text,i=(0,r.rs)(a.XHM.ModifyRichTextStyleToAll,o,t);s.richTextCommand=i,await S(e.id,s,i)}else{let i=(0,r.nx)(n.p.TextEffect,t);s.richTextCommand=i,await S(e.id,s,i)}let l=s.content;this.modifyRichTextEffects(e,l,t)}static modifyRichTextEffects(e,t,i){let r=this.getUpdatedRichTextEffects(t,e.effects,i);e.effects=r}static getUpdatedRichTextEffects(e,t,i){let{effectIdPathsOut:r}=o.hM.getAllFontAndEffectIdsFromText(e),n=new Map;for(let e of r){let t=new a.eAb;t.type=a.cVg.MetaTypeTextEffect,t.resourceId=e.id,t.path=e.path,n.set(e.id,t)}for(let e of null!=t?t:[])n.has(e.resourceId)&&n.set(e.resourceId,e);if((null==i?void 0:i.resId)&&n.has(i.resId)){let e=(0,g.PD)(i);e.type===a.cVg.MetaTypeTextEffect&&n.set(i.resId,e)}return Array.from(n.values())}static updateRichTextSegment(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1n;if(this.setTimeRange(e.targetTimerange,t.timeRange),this.setClip(e.clip,t.clip),this.setRichTextMaterial(e,t.material,t.textEffect,t.bloomMaterial,i),t.textEffect.path){let{content:i}=e.material,{textEffect:r}=t;this.modifyRichTextEffects(e,i,r)}t.shapeEffect.path&&this.updateTextShape(e,t.shapeEffect)}static async setRichTextMaterial(e,t,i,n){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1n,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],m=arguments.length>6?arguments[6]:void 0,h=e.id;!e.material&&(e.material=new a.jG3);let f=e.material,p=null!=m?m:S,g=k(c,a.XHM.ModifyTextAll),y=null;if(g||k(c,a.XHM.ModifyLayerWeight),(g||k(c,a.XHM.ModifyInitialScale))&&(f.initialScale=t.initialScale),(g||k(c,a.XHM.ModifyStyleName))&&(f.styleName=t.styleName),(g||k(c,a.XHM.ModifyUseEffectDefaultColor))&&(f.useEffectDefaultColor=t.useEffectDefaultColor),(g||k(c,a.XHM.ModifyShapeFlipX))&&(f.shapeClipX=t.shapeClipX),(g||k(c,a.XHM.ModifyShapeFlipY))&&(f.shapeClipY=t.shapeClipY),(g||k(c,a.XHM.ModifyTTSAutoUpdate))&&(f.ttsAutoUpdate=t.ttsAutoUpdate),(g||k(c,a.XHM.ModifyFontSourcePlatform))&&(f.fontSourcePlatform=t.fontSourcePlatform),g||k(c,a.XHM.ModifyFixedWidth)?(f.fixedWidth=t.fixedWidth,f.fixedHeight=-1,!g&&(y=(0,r.O3)(a.XHM.ModifyFixedWidth,t))):(g||k(c,a.XHM.ModifyFixedHeight))&&(f.fixedHeight=t.fixedHeight,f.fixedWidth=-1,!g&&(y=(0,r.O3)(a.XHM.ModifyFixedHeight,t))),!g&&k(c,a.XHM.ModifyAlignment)&&k(c,a.XHM.ModifyTypesetting)&&k(c,a.XHM.ModifyLetterSpacing)&&k(c,a.XHM.ModifyLineSpacing)){f.alignment=t.alignment,f.typesetting=t.typesetting,f.letterSpacing=t.letterSpacing,f.lineSpacing=t.lineSpacing,(y=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM;let e={typeSettingKind:t.typesetting,typeSettingAlign:t.alignment,letterSpacing:t.letterSpacing,lineSpacing:t.lineSpacing};y.iParam5=JSON.stringify(e)}else(g||k(c,a.XHM.ModifyAlignment)&&k(c,a.XHM.ModifyTypesetting))&&(f.alignment=t.alignment,f.typesetting=t.typesetting,!g&&(y=(0,r.O3)(a.XHM.ModifyAlignment,t))),(g||k(c,a.XHM.ModifyLetterSpacing))&&(f.letterSpacing=t.letterSpacing,!g&&(y=(0,r.O3)(a.XHM.ModifyLetterSpacing,t))),(g||k(c,a.XHM.ModifyLineSpacing))&&(f.lineSpacing=t.lineSpacing,!g&&(y=(0,r.O3)(a.XHM.ModifyLineSpacing,t)));if((g||k(c,a.XHM.ModifyGlobalAlpha))&&(f.globalAlpha=t.globalAlpha,!g&&(y=(0,r.O3)(a.XHM.ModifyGlobalAlpha,t))),!g&&k(c,a.XHM.ModifyTextBgColor)&&k(c,a.XHM.ModifyTextBgAlpha)&&k(c,a.XHM.ModifyTextBgRoundRadiusScale)&&k(c,a.XHM.ModifyTextBgWidthAndHeight)&&k(c,a.XHM.ModifyTextBgVerticalAndHorizontalOffset)){let e=!0;k(c,a.XHM.ModifyCheckFlag)&&(e=e&&!!(t.checkFlag&Number(a.PbZ.FrameFlag))),k(c,a.XHM.ModifyTextBackgroundStyle)&&(e=e&&t.bgStyle!==a.M4l.TextBackgroundStyleNone,f.backgroundStyle=t.bgStyle),x(f,e),f.backgroundColor=t.bgColor,f.backgroundAlpha=t.bgAlpha,f.backgroundRoundRadius=t.bgRoundRadiusScale,f.backgroundWidth=t.bgWidth,f.backgroundHeight=t.bgHeight,f.backgroundHorizontalOffset=t.bgHorizontalOffset,f.backgroundVerticalOffset=t.bgVerticalOffset,(y=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM;let i={};i.canvas=e;let r=(0,T.PS)(t.bgColor);r[3]=t.bgAlpha,i.canvasColor=r,i.canvasRoundCorner=t.bgRoundRadiusScale>0,i.canvasRoundRadiusScale=t.bgRoundRadiusScale,i.canvasWHCustomized=[t.bgWidth,t.bgHeight],i.canvasOffsetCustomized=[t.bgHorizontalOffset,t.bgVerticalOffset],k(c,a.XHM.ModifyTextBackgroundStyle)&&(i.canvasWrapped=f.backgroundStyle===a.M4l.TextBackgroundStyleWrap),y.iParam5=JSON.stringify(i),await p(h,f,y,u)}else if(!g&&k(c,a.XHM.ModifyTextBgColor)&&k(c,a.XHM.ModifyTextBackgroundStyle)){f.backgroundStyle=t.bgStyle,f.backgroundColor=t.bgColor;let e=(0,T.PS)(t.bgColor);e[3]=f.backgroundAlpha;let i=t.bgStyle!==a.M4l.TextBackgroundStyleNone,r={};r.canvas=i,r.canvasColor=e,r.canvasWrapped=f.backgroundStyle===a.M4l.TextBackgroundStyleWrap,x(f,i),(y=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM,y.iParam5=JSON.stringify(r)}else(g||k(c,a.XHM.ModifyTextBgColor))&&(f.backgroundColor=t.bgColor,x(f,!!t.bgColor),!g&&(t.bgAlpha=f.backgroundAlpha,y=(0,r.O3)(a.XHM.ModifyTextBgColor,t),f.ktvColor&&(y=(0,r.J_)()))),(g||k(c,a.XHM.ModifyTextBackgroundStyle))&&(f.backgroundStyle=t.bgStyle,!g&&(t.bgStyle=f.backgroundStyle,y=(0,r.O3)(a.XHM.ModifyTextBackgroundStyle,t))),(g||k(c,a.XHM.ModifyTextBgAlpha))&&(f.backgroundAlpha=t.bgAlpha,!g&&(t.bgColor=f.backgroundColor,y=(0,r.O3)(a.XHM.ModifyTextBgAlpha,t),f.ktvColor&&(y=(0,r.J_)()))),(g||k(c,a.XHM.ModifyTextBgRoundRadiusScale))&&(f.backgroundRoundRadius=t.bgRoundRadiusScale,!g&&(y=(0,r.O3)(a.XHM.ModifyTextBgRoundRadiusScale,t))),(g||k(c,a.XHM.ModifyTextBgWidthAndHeight))&&(f.backgroundWidth=t.bgWidth,f.backgroundHeight=t.bgHeight,!g&&(y=(0,r.O3)(a.XHM.ModifyTextBgWidthAndHeight,t))),(g||k(c,a.XHM.ModifyTextBgVerticalAndHorizontalOffset))&&(f.backgroundHorizontalOffset=t.bgHorizontalOffset,f.backgroundVerticalOffset=t.bgVerticalOffset,!g&&(y=(0,r.O3)(a.XHM.ModifyTextBgVerticalAndHorizontalOffset,t)));if((g||k(c,a.XHM.ModifyCheckFlag))&&(f.checkFlag=t.checkFlag),(g||k(c,a.XHM.ModifyTextPreset))&&(f.presetId=t.presetId,f.presetName=t.presetName,f.presetCategory=t.presetCategory,f.presetCategoryId=t.presetCategoryId,f.presetIndex=t.presetIndex),g){let e,n;f.hasShadow=t.hasShadow,f.shadowColor=t.shadowColor,f.shadowAlpha=t.shadowAlpha,f.shadowAngle=t.shadowAngle,f.shadowSmoothing=t.shadowSmoothing,f.shadowDistance=t.shadowDistance;let s=(0,d.IN)(t.shadowDistance,t.shadowAngle);f.shadowPoint.x=s.x,f.shadowPoint.y=s.y,f.boldWidth=t.boldWidth,f.italicDegree=t.italicDegree,f.underline=t.hasUnderline,f.underlineWidth=t.underlineWidth,f.underlineOffset=t.underlineOffset,t.isRichText?(e=t.content,n=""===f.text?"":o.hM.getOriginContentFromContent(e)):(n=t.content,e=(0,r.DZ)(t,i)),!k(c,a.XHM.ModifyRichTextStyleToAll)&&(f.text=n,f.content=e),f.textColor=t.textColor,f.textSize=t.textSize,f.fontSize=t.fontSize,f.textAlpha=t.textAlpha,f.borderColor=t.borderColor,f.borderWidth=t.borderWidth,f.fontPath=t.fontPath,f.fontResourceId=t.fontResId;let l=[];for(let e of t.fonts){let t=new a.LhI;t.id=e.id,t.title=e.title,t.path=e.path,t.effectId=e.effectId,t.resourceId=e.resourceId,t.categoryId=e.categoryId,t.categoryName=e.categoryName,t.sourcePlatform=e.sourcePlatform,l.push(t)}f.fonts=l}else{if(k(c,a.XHM.ModifyRichTextStyleToAll)&&(k(c,a.XHM.ModifyFontSizeSyncToAll)?(f.fontSize=t.fontSize,y=(0,r.O3)(a.XHM.ModifyFontSize,t)):y=(0,r.rs)(a.XHM.ModifyRichTextStyleToAll,t.replaceStyleRichText,f.text),await p(h,f,y,u)),k(c,a.XHM.ModifyContent)){if(t.isRichText)f.content=t.content,f.text=o.hM.getOriginContentFromContent(t.content);else{var _;let e=t.replaceStyleRichText;if(""===e&&(e=f.baseContent||f.content),y=(0,r.O3)(a.XHM.ModifyContent,t,e),null===(_=f.subtitleKeywords)||void 0===_?void 0:_.range.length){let e=w.O.updateKeywordsConfigOnTextChange(t.content,f.text,f.subtitleKeywords);f.subtitleKeywords=e;let i=(0,r.P_)(e);y=(0,r.Sw)([i,y])}await p(h,f,y,u),f.isBlankText=""===e}}if(k(c,a.XHM.ModifyTextColor)&&(f.textColor=t.textColor,y=(0,r.O3)(a.XHM.ModifyTextColor,t),await p(h,f,y,u),f.ktvColor&&(f.ktvColor=(0,d.Jw)(t.textColor),y=(0,r.J_)())),k(c,a.XHM.ModifyTextAlpha)&&(f.textAlpha=t.textAlpha,y=(0,r.O3)(a.XHM.ModifyTextAlpha,t),await p(h,f,y,u),f.ktvColor&&(y=(0,r.J_)())),k(c,a.XHM.ModifyTextBorderColor)&&k(c,a.XHM.ModifyTextBorderWidth)){f.borderColor=t.borderColor,f.borderWidth=t.borderWidth,(y=new s.B).iOpCode=l.wI.CT_EDIT_OUTLINE,y.iParam1=t.borderColor?1:0;let e=(0,T.PS)(f.borderColor);e.pop();let i={outlineColor:e,outlineAlpha:t.borderColor?1:0,outlineWidth:f.borderWidth};y.iParam5=JSON.stringify(i),await p(h,f,y,u),f.ktvColor&&(y=(0,r.J_)())}else k(c,a.XHM.ModifyTextBorderColor)&&(f.borderColor=t.borderColor,y=(0,r.O3)(a.XHM.ModifyTextBorderColor,t),await p(h,f,y,u),f.ktvColor&&(y=(0,r.J_)())),k(c,a.XHM.ModifyTextBorderWidth)&&(f.borderWidth=t.borderWidth,y=(0,r.O3)(a.XHM.ModifyTextBorderWidth,t),await p(h,f,y,u),f.ktvColor&&(y=(0,r.J_)()));let e=k(c,a.XHM.ModifyHasShadow),i=k(c,a.XHM.ModifyShadowColor);if(e||i){(y=new s.B).iOpCode=l.wI.CT_EDIT_SHADOW,y.iParam1=t.hasShadow?1:0,k(c,a.XHM.ModifyShadowAlpha)&&(f.shadowAlpha=t.shadowAlpha),k(c,a.XHM.ModifyShadowSmoothing)&&(f.shadowSmoothing=t.shadowSmoothing),k(c,a.XHM.ModifyShadowDistance)&&(f.shadowDistance=t.shadowDistance),k(c,a.XHM.ModifyShadowAngle)&&(f.shadowAngle=t.shadowAngle);let n=(0,d.IN)(f.shadowDistance,f.shadowAngle),m={shadowOffset:[n.x/18,n.y/18],shadowAngle:f.shadowAngle};if(o.hM.isUsingOldTextShadowSmooth(f.content)?m.shadowSmoothing=f.shadowSmoothing/18:m.shadowDiffuse=f.shadowSmoothing/18,e){f.hasShadow=t.hasShadow;let e=t.hasShadow?t.shadowAlpha:0;f.shadowAlpha=e,m.shadowAlpha=e}if(i){f.shadowColor=t.shadowColor;let e=(0,T.PS)(t.shadowColor);m.shadowColor=e}y.iParam5=JSON.stringify(m),await p(h,f,y,u),(""!==f.ktvColor||k(c,a.XHM.ModifyRichTextStyleToAll))&&(y=(0,r.J_)())}else if(k(c,a.XHM.ModifyShadowAlpha))f.shadowAlpha=t.shadowAlpha,y=(0,r.O3)(a.XHM.ModifyShadowAlpha,t),await p(h,f,y,u);else if(k(c,a.XHM.ModifyShadowSmoothing)){f.shadowSmoothing=t.shadowSmoothing;let e=o.hM.isUsingOldTextShadowSmooth(f.content);y=(0,r.O3)(a.XHM.ModifyShadowSmoothing,{...t,shadowSmoothingUseDiffuse:!e}),await p(h,f,y,u)}else if(k(c,a.XHM.ModifyShadowAngle)||k(c,a.XHM.ModifyShadowDistance)){let e=(0,d.IN)(t.shadowDistance,t.shadowAngle);f.shadowPoint.x=e.x,f.shadowPoint.y=e.y,f.shadowDistance=t.shadowDistance,f.shadowAngle=t.shadowAngle,y=(0,r.O3)(a.XHM.ModifyShadowDistance,t),await p(h,f,y,u)}k(c,a.XHM.ModifyFontSize)&&(f.fontSize=t.fontSize,y=(0,r.O3)(a.XHM.ModifyFontSize,t),await p(h,f,y,u)),k(c,a.XHM.ModifyFontPath)&&k(c,a.XHM.ModifyFontResId)&&(f.fontPath=t.fontPath,f.fontResourceId=t.fontResId,b.modifyTextFontProps(f,t,c),y=(0,r.O3)(a.XHM.ModifyFontPath,t),await p(h,f,y,u),b.modifyRichTextFonts(f,t)),k(c,a.XHM.ModifyBoldWidth)&&(f.boldWidth=t.boldWidth,y=(0,r.O3)(a.XHM.ModifyBoldWidth,t),await p(h,f,y,u)),k(c,a.XHM.ModifyItalicDegree)&&(f.italicDegree=t.italicDegree,y=(0,r.O3)(a.XHM.ModifyItalicDegree,t),await p(h,f,y,u)),(k(c,a.XHM.ModifyUnderline)||k(c,a.XHM.ModifyUnderlineWidth)||k(c,a.XHM.ModifyUnderlineOffset))&&(f.underline=t.hasUnderline,y=(0,r.O3)(a.XHM.ModifyUnderline,t),await p(h,f,y,u)),k(c,a.XHM.ModifyAlignment)&&(null===y&&(f.alignment=t.alignment,y=(0,r.O3)(a.XHM.ModifyAlignment,t)),await p(h,f,y,u))}let v=b.handleBloomFlag(g,e,c,n);v&&(y=v),!y&&(y=new s.B),f.richTextCommand=y}static modifyTextFontProps(e,t,i){k(i,a.XHM.ModifyFontId)&&(e.fontId=t.fontId),k(i,a.XHM.ModifyFontSourcePlatform)&&(e.fontSourcePlatform=t.fontSourcePlatform),k(i,a.XHM.ModifyFontTitle)&&(e.fontTitle=t.fontTitle)}static modifyRichTextFonts(e,t){if(!e)return;let i=e.fonts.concat();if(!i)return;if(t.fontId||t.fontResId){for(let e of i)if(e.effectId&&e.effectId===t.fontId||e.resourceId&&e.resourceId===t.fontResId)return;let e=new a.LhI({id:(0,c.p)(),effectId:""===t.fontId?t.fontResId:t.fontId,resourceId:t.fontResId,path:t.fontPath,title:t.fontTitle,categoryId:t.fontCategoryId,categoryName:t.fontCategoryName,teamId:t.fontTeamId,sourcePlatform:t.fontSourcePlatform});i.push(e)}let r=o.hM.getFontIdsFromText(e.content);e.fonts=i.filter(e=>r.has(e.resourceId))}static handleBloomFlag(e,t,i,r){if(e){if(!r.path)return t.bloom=void 0,null;!t.bloom&&(t.bloom=new a.eAb);let{bloom:e}=t;e.type=a.cVg.MetaTypeBloom,e.resourceId=r.resId,e.thirdResourceId=r.thirdResourceId,e.sourcePlatform=r.sourcePlatform,e.effectId=r.effectId,e.path=r.path,e.panelId=r.panelId,e.categoryId=r.categoryId,e.categoryName=r.categoryName,e.name=r.name;let i=new a.zAG;return i.color=r.bloomActionParams.color,i.strength=r.bloomActionParams.strength,i.range=r.bloomActionParams.range,i.dirX=r.bloomActionParams.dirX,i.dirY=r.bloomActionParams.dirY,e.bloomParams=i,null}if(!b.hasBloomFlag(i))return null;let n={};!t.bloom&&(t.bloom=new a.eAb);let{bloom:o}=t;o.type=a.cVg.MetaTypeBloom,!o.bloomParams&&(o.bloomParams=new a.zAG);let{bloomParams:d}=o;if(k(i,a.XHM.ModifyBloomPath)&&(o.resourceId=r.resId,o.effectId=r.effectId,o.thirdResourceId=r.thirdResourceId,o.sourcePlatform=r.sourcePlatform,o.path=r.path,o.panelId=r.panelId,o.categoryId=r.categoryId,o.name=r.name,o.categoryName=r.categoryName,n.bloomPath=r.path),k(i,a.XHM.ModifyBloomColor)){if(d.color=r.bloomActionParams.color,r.bloomActionParams.color){let e=(0,T.PS)(r.bloomActionParams.color);r.bloomActionParams.color&&(e[3]=1),n.bloomColor=e,n.bloomColorCustomized=!0}else n.bloomColorCustomized=!1}k(i,a.XHM.ModifyBloomStrength)&&(d.strength=r.bloomActionParams.strength,n.bloomStrength=r.bloomActionParams.strength),k(i,a.XHM.ModifyBloomRange)&&(d.range=r.bloomActionParams.range,n.bloomRange=r.bloomActionParams.range),k(i,a.XHM.ModifyBloomDirX)&&(d.dirX=r.bloomActionParams.dirX,n.bloomDirX=r.bloomActionParams.dirX),k(i,a.XHM.ModifyBloomDirY)&&(d.dirY=r.bloomActionParams.dirY,n.bloomDirY=r.bloomActionParams.dirY),o.bloomParams=d,!o.path&&(t.bloom=void 0);let c=new s.B;return c.iParam5=JSON.stringify(n),c.iOpCode=l.wI.CT_EDIT_TEXT_PARAM,c}static hasBloomFlag(e){return k(e,a.XHM.ModifyBloomColor)||k(e,a.XHM.ModifyBloomStrength)||k(e,a.XHM.ModifyBloomRange)||k(e,a.XHM.ModifyBloomDirX)||k(e,a.XHM.ModifyBloomDirY)||k(e,a.XHM.ModifyBloomPath)}static updateTextSubtitleFontSize(e,t,i,r){if((0,p.Ft)(e)){if(i&&r){let n=new a.xKN,o=new a.edz;o.fontSize=t,n.material=o;let s=(0,p.xX)({__segment_struct_type:e.__segment_struct_type});I.T.pick(e,n,s),i(new f.F({segmentDelta:n,segmentId:e.id,trackId:r.getTrackBySegmentId(e.id).id,trackIndex:r.getTrackIndexBySegmentId(e.id),sourceSegmentDelta:s}))}else e.material.fontSize=t}}static updateTextAnims(e,t,i,r){if(0===t.length)this.removeTextAnims(e,[a.VAL.Anim_In,a.VAL.Anim_Out,a.VAL.Anim_Loop],i,r);else for(let n of t)this.updateTextAnim(e,n,i,r)}static removeTextAnims(e,t,i,r){let n=this.getOrMakeAnimationsIfNeed(e,i,r);if(!n||0===n.animations.length)return;let a=[];for(let e of n.animations){let i=_.q.animType(e.type);!t.includes(i)&&a.push(e)}this.setAnimations(e,a,i,r)}static getOrMakeAnimationsIfNeed(e,t,i){if(!e.animations){let r=(0,p.zg)(e);r.animations=new a.PA(new a.ZPj);let n=(0,p.xX)({__segment_struct_type:e.__segment_struct_type});I.T.pick(e,r,n),t(new f.F({trackId:i.getTrackBySegmentId(e.id).id,trackIndex:i.getTrackIndexBySegmentId(e.id),segmentId:e.id,segmentDelta:r,sourceSegmentDelta:n}))}return e.animations}static getAnimations(e){if((0,p.Ft)(e)||(0,p.P2)(e)||(0,p.P7)(e)||(0,p.WX)(e)||(0,p.he)(e))return e.animations?e.animations:null;return null}static setAnimations(e,t,i,r){if(this.getOrMakeAnimationsIfNeed(e,i,r),t.length>0){let n=new a.ZPj({animations:t}),o=v.c8.updateStickerAnimationDuration(r,n,e.targetTimerange.duration,e);o.length&&(0,h.W)(o,i)}else{let n=new a.NOn;n.animations=new a.PA,n.animations.animations=t;let o=(0,p.xX)({__segment_struct_type:e.__segment_struct_type});I.T.pick(e,n,o),i(new f.F({segmentDelta:n,segmentId:e.id,trackId:r.getTrackBySegmentId(e.id).id,trackIndex:r.getTrackIndexBySegmentId(e.id),sourceSegmentDelta:o}))}}static updateTextAnim(e,t,i,r){let n=this.getOrMakeAnimationsIfNeed(e,i,r),o=[];if(o.push(this.makeStickerAnim(t)),!(t.type===a.VAL.Anim_Caption&&""!==t.resourceId))for(let e of n.animations){let i=_.q.animType(e.type);t.type!==i&&i!==a.VAL.Anim_Caption&&o.push(e)}this.setAnimations(e,o,i,r)}static updateTextAnimParams(e,t,i,r){let n=new a.ZPj;for(let o of(e.animations&&(n=e.animations),n.animations))o.type===t&&(o.duration=i,(null==r?void 0:r.direction)||(null==r?void 0:r.animMode)?o.animAdjustParams=new a.Hcd({animMode:null==r?void 0:r.animMode,direction:null==r?void 0:r.direction}):o.animAdjustParams=void 0)}static makeStickerAnim(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sticker",i=new a.FJA;return i.name=e.name,i.path=e.path,i.type=_.q.cstrType(e.type),i.duration=e.duration,i.start=e.start,i.categoryName=e.categoryName,i.categoryId=e.categoryId,i.resourceId=e.resourceId,i.thirdResourceId=e.thirdResourceId,i.sourcePlatform=e.sourcePlatform,i.platform=e.platform,i.effectId=e.effectId,i.materialType=t,i}static updateTextShape(e,t){if(t.path){let i=(0,g.PD)(t);e.shape=i}else e.shape&&(e.shape.path="",e.shape.effectId="",e.shape.name="",e.shape.resourceId="");let i=(0,r.nx)(n.p.TextShape,t);e.material.richTextCommand=i}static setTimeRange(e,t){if(!!e)e.start=BigInt(t.start),e.duration=BigInt(t.duration)}static setClip(e,t){if(!!e)e.flip.vertical=t.flipVertical,e.flip.horizontal=t.flipHorizontal,e.scale.x=t.scaleX,e.scale.y=t.scaleY,e.transform.x=t.transformX,e.transform.y=t.transformY,e.rotation=t.rotation}static makeTextMaterial(){let e=new a.jG3;return e.id=(0,c.p)(),e}static translateModifyFlags(e){return e===a.XHM.ModifyTextAll?0n:1n<<BigInt(e)}static makeRichTextSegment(e,t,i){let r=new a.Fyg;r.clip=new a.bXy,r.renderIndex=i;let n=this.makeTextMaterial();r.material=n,n.type=t,n.content=e.material.content,n.text=o.hM.getOriginContentFromContent(e.material.content),n.groupId=e.material.groupId,n.language=e.material.language,n.isBlankText=e.material.isBlankText,n.textPresetResourceId=e.textPresetResourceId,n.backgroundColor=e.material.bgColor,n.backgroundStyle=e.material.bgStyle,n.backgroundRoundRadius=e.material.bgRoundRadiusScale,n.fontSize=e.material.fontSize,n.backgroundWidth=e.material.bgWidth,n.backgroundHeight=e.material.bgHeight,n.textColor=e.material.textColor,""!==e.material.materialId&&(n.id=e.material.materialId);let s=1n;s|=this.translateModifyFlags(a.XHM.ModifyCheckFlag),this.updateRichTextSegment(r,e,s);let l=new a.H1R;for(let t of e.material.words)l.text.push(t.text),l.startTime.push(t.startTime),l.endTime.push(t.endTime);return n.words=l,n.subType=e.material.subType,n.addType=e.material.addType,n.forceApplyLineMaxWidth=e.material.forceApplyLineMaxWidth,r}static textFlagType(e){return e===a.cVg.MetaTypeLyrics?a.w9k.FlagTextLyric:e===a.cVg.MetaTypeSubtitle?a.w9k.FlagTextSubtitle:a.w9k.FlagNone}static combineModifyFlags(e){let t=0n;for(let i of e)t=BigInt(t)|this.translateModifyFlags(i);return t}static forceApplyToAll(e){return!!(k(e,a.XHM.ModifyRichTextStyleToAll)&&(k(e,a.XHM.ModifyStyleName)||k(e,a.XHM.ModifyTextColor)||k(e,a.XHM.ModifyTextAlpha)||k(e,a.XHM.ModifyTextBorderColor)||k(e,a.XHM.ModifyTextBorderWidth)||k(e,a.XHM.ModifyShadowColor)||k(e,a.XHM.ModifyShadowAlpha)||k(e,a.XHM.ModifyShadowSmoothing)||k(e,a.XHM.ModifyShadowAngle)||k(e,a.XHM.ModifyShadowDistance)||k(e,a.XHM.ModifyFontTitle)||k(e,a.XHM.ModifyFontPath)||k(e,a.XHM.ModifyFontSize)||k(e,a.XHM.ModifyFontName)||k(e,a.XHM.ModifyFontId)||k(e,a.XHM.ModifyFontResId)||k(e,a.XHM.ModifyFontCategoryName)||k(e,a.XHM.ModifyFontCategoryId)||k(e,a.XHM.ModifyFontSourcePlatform)||k(e,a.XHM.ModifyBoldWidth)||k(e,a.XHM.ModifyItalicDegree)||k(e,a.XHM.ModifyUnderline)||k(e,a.XHM.ModifyUnderlineWidth)||k(e,a.XHM.ModifyUnderlineOffset)||k(e,a.XHM.ModifyCheckFlag)||k(e,a.XHM.ModifyBloomColor)||k(e,a.XHM.ModifyBloomStrength)||k(e,a.XHM.ModifyBloomRange)||k(e,a.XHM.ModifyBloomDirX)||k(e,a.XHM.ModifyBloomDirY)||k(e,a.XHM.ModifyBloomPath)))||!1}static isApplyTextPresetStyleFlag(e){return k(e,a.XHM.ModifyStyleName)}static updateTextMaterial(e,t,i,r){if(!!e)this.setTextMaterial(e.material,t,r),this.setBloomMaterial(e.bloom,i,r)}static setTextMaterial(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1n;if(!e)return;let r=k(i,a.XHM.ModifyTextAll);if((r||k(i,a.XHM.ModifyContent))&&(e.content=t.content,t.isRichText?e.text=o.hM.getOriginContentFromContent(t.content):e.text=t.content),(r||k(i,a.XHM.ModifyAlignment))&&(e.alignment=t.alignment),(r||k(i,a.XHM.ModifyTypesetting))&&(e.typesetting=t.typesetting),r||k(i,a.XHM.ModifyLayerWeight),(r||k(i,a.XHM.ModifyInitialScale))&&(e.initialScale=t.initialScale),(r||k(i,a.XHM.ModifyStyleName))&&(e.styleName=t.styleName),(r||k(i,a.XHM.ModifyTextColor))&&(e.textColor=t.textColor,e.ktvColor&&(e.ktvColor=(0,d.Jw)(t.textColor))),(r||k(i,a.XHM.ModifyTextAlpha))&&(e.textAlpha=t.textAlpha),(r||k(i,a.XHM.ModifyTextBgColor))&&(x(e,""!==t.bgColor,a.PbZ.FrameFlag),e.backgroundColor=t.bgColor),(r||k(i,a.XHM.ModifyTextBgAlpha))&&(e.backgroundAlpha=t.bgAlpha),(r||k(i,a.XHM.ModifyTextBorderColor))&&(e.borderColor=t.borderColor),(r||k(i,a.XHM.ModifyTextBorderWidth))&&(e.borderWidth=t.borderWidth),(r||k(i,a.XHM.ModifyLetterSpacing))&&(e.letterSpacing=t.letterSpacing),(r||k(i,a.XHM.ModifyLineSpacing))&&(e.lineSpacing=t.lineSpacing),(r||k(i,a.XHM.ModifyTextBackgroundStyle))&&(e.backgroundStyle=t.bgStyle),(r||k(i,a.XHM.ModifyHasShadow))&&(e.hasShadow=t.hasShadow),(r||k(i,a.XHM.ModifyShadowColor))&&(e.shadowColor=t.shadowColor),(r||k(i,a.XHM.ModifyShadowAlpha))&&(e.shadowAlpha=t.shadowAlpha),(r||k(i,a.XHM.ModifyShadowAngle))&&(e.shadowAngle=t.shadowAngle),r||k(i,a.XHM.ModifyTextCurveAngle)){var n;let i=null!==(n=e.textCurve)&&void 0!==n?n:new a.b9B;i.enable=t.hasCurve,i.angle=t.curveAngle,e.textCurve=i}if((r||k(i,a.XHM.ModifyShadowSmoothing))&&(e.shadowSmoothing=t.shadowSmoothing),r||k(i,a.XHM.ModifyShadowDistance)){e.shadowDistance=t.shadowDistance;let i=(0,d.IN)(e.shadowDistance,e.shadowAngle);e.shadowPoint.x=i.x,e.shadowPoint.y=i.y}if(r||k(i,a.XHM.ModifyShadowAngle)||k(i,a.XHM.ModifyShadowDistance)){let t=(0,d.IN)(e.shadowDistance,e.shadowAngle);e.shadowPoint.x=t.x,e.shadowPoint.y=t.y}(r||k(i,a.XHM.ModifyTTSAutoUpdate))&&(e.ttsAutoUpdate=t.ttsAutoUpdate),(r||k(i,a.XHM.ModifyUseEffectDefaultColor))&&(e.useEffectDefaultColor=t.useEffectDefaultColor),(r||k(i,a.XHM.ModifyShapeFlipX))&&(e.shapeClipX=t.shapeClipX),(r||k(i,a.XHM.ModifyShapeFlipY))&&(e.shapeClipY=t.shapeClipY),(r||k(i,a.XHM.ModifyFontTitle))&&(e.fontTitle=t.fontTitle),(r||k(i,a.XHM.ModifyFontPath))&&(e.fontPath=t.fontPath),(r||k(i,a.XHM.ModifyFontSize))&&(e.fontSize=t.fontSize),r||k(i,a.XHM.ModifyFontName),(r||k(i,a.XHM.ModifyFontId))&&(e.fontId=t.fontId),(r||k(i,a.XHM.ModifyFontResId))&&(e.fontResourceId=t.fontResId),(r||k(i,a.XHM.ModifyFontCategoryName))&&(e.fontCategoryName=t.fontCategoryName),(r||k(i,a.XHM.ModifyFontCategoryId))&&(e.fontCategoryId=t.fontCategoryId),(r||k(i,a.XHM.ModifyFontSourcePlatform))&&(e.fontSourcePlatform=t.fontSourcePlatform,e.fontTeamId=t.fontTeamId),(r||k(i,a.XHM.ModifyBoldWidth))&&(e.boldWidth=t.boldWidth),(r||k(i,a.XHM.ModifyItalicDegree))&&(e.italicDegree=t.italicDegree),(r||k(i,a.XHM.ModifyUnderline))&&(e.underline=t.hasUnderline),(r||k(i,a.XHM.ModifyUnderlineWidth))&&(e.underlineWidth=t.underlineWidth),(r||k(i,a.XHM.ModifyUnderlineOffset))&&(e.underlineOffset=t.underlineOffset),(r||k(i,a.XHM.ModifyCheckFlag))&&(e.checkFlag=t.checkFlag),(r||k(i,a.XHM.ModifyTextBgRoundRadiusScale))&&(e.backgroundRoundRadius=t.bgRoundRadiusScale),(r||k(i,a.XHM.ModifyTextBgWidthAndHeight))&&(e.backgroundWidth=t.bgWidth,e.backgroundHeight=t.bgHeight),(r||k(i,a.XHM.ModifyTextBgVerticalAndHorizontalOffset))&&(e.backgroundHorizontalOffset=t.bgHorizontalOffset,e.backgroundVerticalOffset=t.bgVerticalOffset),t.words&&t.words.length>0&&(e.words=new a.H1R({startTime:t.words.map(e=>e.startTime),endTime:t.words.map(e=>e.endTime),text:t.words.map(e=>e.text)}))}static syncRichTextResources(e,t){e.effects=t.effects,e.material.fonts=t.material.fonts}static setBloomMaterial(e,t,i){if(!e)return;!e.bloomParams&&(e.bloomParams=new a.zAG);let r=k(i,a.XHM.ModifyTextAll);(r||k(i,a.XHM.ModifyBloomColor))&&(e.bloomParams.color=t.bloomActionParams.color),(r||k(i,a.XHM.ModifyBloomDirX))&&(e.bloomParams.dirX=t.bloomActionParams.dirX),(r||k(i,a.XHM.ModifyBloomDirY))&&(e.bloomParams.dirY=t.bloomActionParams.dirY),(r||k(i,a.XHM.ModifyBloomRange))&&(e.bloomParams.range=t.bloomActionParams.range),(r||k(i,a.XHM.ModifyBloomStrength))&&(e.bloomParams.strength=t.bloomActionParams.strength)}static async updateRichTextStyle(e,t,i,r){await this._updateRichTextStyle(e,t,i,e.material,r);let n=e.material.content;this.modifyRichTextEffects(e,n)}static resetTextSegment(e,t,i,n){let o=(0,u.aMe)({});o.segId=e.id,o.timeRange.start=e.targetTimerange.start,o.timeRange.duration=e.targetTimerange.duration,o.material=t,o.bloomMaterial=i,(e.material.type===a.cVg.MetaTypeSubtitle||e.material.type===a.cVg.MetaTypeLyrics)&&(o.material.fontSize=5,o.clip.transformX=0,o.clip.transformY=-.73,!n&&(o.material.fontSize=8,o.clip.transformY=-.56)),this.setTimeRange(e.targetTimerange,o.timeRange),this.setClip(e.clip,o.clip),this.setRichTextMaterial(e,o.material,o.textEffect,o.bloomMaterial),e.material.richTextCommand=(0,r.CA)(),e.shape&&(e.shape.path="",e.shape.effectId="",e.shape.name="",e.shape.resourceId="")}static makeTextSegment(e,t,i){let r=new a.Fyg,n=new a.bXy;return r.clip=n,r.material=this.makeTextMaterial(),r.renderIndex=i,r.material.type=t,""!==e.material.materialId&&(r.material.id=e.material.materialId),this.updateTextSegment(r,e),r.material.subType=e.material.subType,r.material.addType=e.material.addType,r.material.recognizeType=e.material.recognizeType,r}static updateTextSegment(e,t){this.setTimeRange(e.targetTimerange,t.timeRange),this.setClip(e.clip,t.clip),this.setTextMaterial(e.material,t.material),this.updateTextEffect(e,t.textEffect),this.updateTextShape(e,t.shapeEffect)}static updateTextEffect(e,t){if(!!e)if(""!==t.path){let i=(0,g.PD)(t);e.effect=i}else e.effect&&(e.effect.path="",e.effect.effectId="",e.effect.name="",e.effect.resourceId="")}static textSegmentReuseStyle(e,t,i){if(!e||""===t)return!1;let{material:n}=e;if(!n)return!1;let o=n.content;return""!==o&&((0,r.rs)(a.XHM.ModifyRichTextStyleToAll,o,t),!0)}static makeStickerSegment(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=new a.S8D;n.id=(0,c.p)(),n.renderIndex=i,n.adaptionModel=r;let o=new a.bXy({flip:new a.BWs({vertical:e.clip.flipVertical,horizontal:e.clip.flipHorizontal}),scale:new a.Ciz({x:e.clip.scaleX,y:e.clip.scaleY}),rotation:e.clip.rotation,transform:new a.wx7({x:e.clip.transformX,y:e.clip.transformY})});n.clip=o;let s=new a.cJv;s.id=(0,c.p)(),s.type=t,s.path=e.material.path,s.iconUrl=e.material.iconUrl,s.previewCoverUrl=e.material.previewCoverUrl,s.stickerId=e.material.stickerId,s.resourceId=e.material.resourceId,s.name=e.material.name,s.categoryId=e.material.categoryId,s.categoryName=e.material.categoryName,s.platform=e.material.platform,s.unicode=e.material.unicode,s.sourcePlatform=e.material.sourcePlatform,s.formulaId=e.material.formulaId,s.teamId=e.material.teamId,s.requestId=e.material.requestId;let l=(0,y.i)(e.timeRange.start,e.timeRange.duration);for(let t of(n.targetTimerange=l,e.animations));return n}static makeImageStickerSegment(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=new a.S8D;n.id=(0,c.p)(),n.renderIndex=i,n.adaptionModel=r;let o=new a.bXy;o.flip.vertical=e.clip.flipVertical,o.flip.horizontal=e.clip.flipHorizontal,o.scale.x=e.clip.scaleX,o.scale.y=e.clip.scaleY,o.rotation=e.clip.rotation,o.transform.x=e.clip.transformX,o.transform.y=e.clip.transformY;let s=new a._ZT;s.id=(0,c.p)(),s.type=t,s.path=e.material.path,s.width=e.material.width,s.height=e.material.height,s.initialScale=e.material.initScale;let l=(0,y.i)(e.timeRange.start,e.timeRange.duration);for(let t of(n.targetTimerange=l,e.animations));return n}static updateTextKtvColorBySegment(e,t,i,r){let n=new a.xKN;n.material=new a.edz,n.material.ktvColor=b.getTextUpdatedKtvColor(e.material,r),n.material.richTextCommand=new s.B;let o=(0,p.xX)({__segment_struct_type:e.__segment_struct_type});I.T.pick(e,n,o),t(new f.F({trackId:i.getTrackBySegmentId(e.id).id,segmentId:e.id,segmentDelta:n,trackIndex:i.getTrackIndexBySegmentId(e.id),sourceSegmentDelta:o}))}static getTextUpdatedKtvColor(e,t){return t||(0,d.Jw)(e.textColor)||"#0022FFFF"}static updateTextKtvColor(e,t){if(t)e.ktvColor=t;else{let{textColor:t}=e;e.ktvColor=(0,d.Jw)(t)}}static updateKtvColor(e){let t={ktvColor:"",ktvShadowColor:"",ktvOutlineColor:""};if(!e.ktvColor||e.ktvColor.length<6)return t;t.ktvColor=e.ktvColor;let i=e.content,r={begin:0,end:e.text.length},n=o.hM.getShadowEnable(i,r);if(null==n?void 0:n[0]){let e=o.hM.getColorRGBStyles(i,r,m.J.SHADOW_COLOR),n=o.hM.getColorAlphaStyles(i,r,m.J.SHADOW_COLOR),a=e.colors;if(a.length>0){let e=n.alphas?n.alphas[0]:255,{r:i,g:r,b:o}=(0,T.nA)(a[0]);t.ktvShadowColor=(0,d.Xl)([i,r,o,e],t.ktvColor)}}let a=o.hM.getOutlineEnable(i,r);if(a.length>0&&a[0]){let e=o.hM.getColorRGBStyles(i,r,m.J.STOKE_COLOR).colors;if(e){let{r:i,g:r,b:n}=(0,T.nA)(e[0]);t.ktvOutlineColor=(0,d.Xl)([i,r,n,255],t.ktvColor)}}return t}static setRichTextMaterialForTextTemplate(e,t,i,n,c,u){let m=k(u,a.XHM.ModifyTextAll),h=null;if((m||k(u,a.XHM.ModifyInitialScale))&&(e.initialScale=t.initialScale),(m||k(u,a.XHM.ModifyStyleName))&&(e.styleName=t.styleName),(m||k(u,a.XHM.ModifyUseEffectDefaultColor))&&(e.useEffectDefaultColor=t.useEffectDefaultColor),(m||k(u,a.XHM.ModifyShapeFlipX))&&(e.shapeClipX=t.shapeClipX),(m||k(u,a.XHM.ModifyShapeFlipY))&&(e.shapeClipY=t.shapeClipY),(m||k(u,a.XHM.ModifyTTSAutoUpdate))&&(e.ttsAutoUpdate=t.ttsAutoUpdate),!m&&k(u,a.XHM.ModifyAlignment)&&k(u,a.XHM.ModifyTypesetting)&&k(u,a.XHM.ModifyLetterSpacing)&&k(u,a.XHM.ModifyLineSpacing)){e.alignment=t.alignment,e.typesetting=t.typesetting,e.letterSpacing=t.letterSpacing,e.lineSpacing=t.lineSpacing,(h=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM;let i={};i.typeSettingKind=t.typesetting,i.typeSettingAlign=t.alignment,i.letterSpacing=t.letterSpacing,i.lineSpacing=t.lineSpacing,h.iParam5=JSON.stringify(i),n(e,h)}else m||k(u,a.XHM.ModifyAlignment)&&k(u,a.XHM.ModifyTypesetting)?(e.alignment=t.alignment,e.typesetting=t.typesetting,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyAlignment,t))):(m||k(u,a.XHM.ModifyAlignment))&&(e.alignment=t.alignment,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyAlignment,t))),(m||k(u,a.XHM.ModifyLetterSpacing))&&(e.letterSpacing=t.letterSpacing,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyLetterSpacing,t))),(m||k(u,a.XHM.ModifyLineSpacing))&&(e.lineSpacing=t.lineSpacing,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyLineSpacing,t)));if((m||k(u,a.XHM.ModifyGlobalAlpha))&&(e.globalAlpha=t.globalAlpha,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyGlobalAlpha,t))),!m&&k(u,a.XHM.ModifyTextBgColor)&&k(u,a.XHM.ModifyTextBgAlpha)&&k(u,a.XHM.ModifyTextBgRoundRadiusScale)&&k(u,a.XHM.ModifyTextBgWidthAndHeight)&&k(u,a.XHM.ModifyTextBgVerticalAndHorizontalOffset)){let i={},r=!0;k(u,a.XHM.ModifyCheckFlag)&&(r=r&&!!(t.checkFlag&Number(a.PbZ.FrameFlag))),k(u,a.XHM.ModifyTextBackgroundStyle)&&(r=r&&t.bgStyle!==a.M4l.TextBackgroundStyleNone,e.backgroundStyle=t.bgStyle),x(e,r),i.canvas=r,e.backgroundColor=t.bgColor,e.backgroundAlpha=t.bgAlpha,e.backgroundRoundRadius=t.bgRoundRadiusScale,e.backgroundWidth=t.bgWidth,e.backgroundHeight=t.bgHeight,e.backgroundHorizontalOffset=t.bgHorizontalOffset,e.backgroundVerticalOffset=t.bgVerticalOffset,(h=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM;let o=(0,T.PS)(t.bgColor);o[3]=t.bgAlpha,i.canvasColor=o,i.canvasRoundCorner=e.backgroundRoundRadius>0,i.canvasRoundRadiusScale=e.backgroundRoundRadius,i.canvasWHCustomized=[e.backgroundWidth,e.backgroundHeight],i.canvasOffsetCustomized=[e.backgroundHorizontalOffset,e.backgroundVerticalOffset],k(u,a.XHM.ModifyTextBackgroundStyle)&&(i.canvasWrapped=e.backgroundStyle===a.M4l.TextBackgroundStyleWrap),h.iParam5=JSON.stringify(i),n(e,h)}else if(!m&&k(u,a.XHM.ModifyCheckFlag)&&(k(u,a.XHM.ModifyTextBgColor)||k(u,a.XHM.ModifyTextBgAlpha))){let i=!!(t.checkFlag&Number(a.PbZ.FrameFlag));x(e,i),e.backgroundColor=t.bgColor,e.backgroundAlpha=t.bgAlpha,(h=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM;let r={};r.canvas=i;let o=(0,T.PS)(t.bgColor);o[3]=t.bgAlpha,r.canvasColor=o,h.iParam5=JSON.stringify(r),n(e,h)}else if(!m&&k(u,a.XHM.ModifyTextBgColor)&&k(u,a.XHM.ModifyTextBgAlpha)){x(e,!!t.bgColor),e.backgroundColor=t.bgColor,e.backgroundAlpha=t.bgAlpha,(h=new s.B).iOpCode=l.wI.CT_EDIT_TEXT_PARAM;let i={},r=(0,T.PS)(t.bgColor);r[3]=t.bgAlpha,i.canvasColor=r,h.iParam5=JSON.stringify(i),n(e,h)}else(m||k(u,a.XHM.ModifyTextBgColor))&&(e.backgroundColor=t.bgColor,x(e,!!t.bgColor),!m&&(h=(0,r.O3)(a.XHM.ModifyTextBgColor,{...t,bgAlpha:e.backgroundAlpha}),n(e,h),e.ktvColor&&c(e,h=(0,r.J_)()))),(m||k(u,a.XHM.ModifyTextBackgroundStyle))&&(e.backgroundStyle=t.bgStyle,!m&&(h=(0,r.O3)(a.XHM.ModifyTextBackgroundStyle,{...t,bgStyle:e.backgroundStyle}))),(m||k(u,a.XHM.ModifyTextBgAlpha))&&(e.backgroundAlpha=t.bgAlpha,!m&&(h=(0,r.O3)(a.XHM.ModifyTextBgAlpha,{...t,bgColor:e.backgroundColor}),n(e,h),e.ktvColor&&c(e,h=(0,r.J_)()))),(m||k(u,a.XHM.ModifyTextBgRoundRadiusScale))&&(e.backgroundRoundRadius=t.bgRoundRadiusScale,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyTextBgRoundRadiusScale,t))),(m||k(u,a.XHM.ModifyTextBgWidthAndHeight))&&(e.backgroundWidth=t.bgWidth,e.backgroundHeight=t.bgHeight,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyTextBgWidthAndHeight,t))),(m||k(u,a.XHM.ModifyTextBgVerticalAndHorizontalOffset))&&(e.backgroundHorizontalOffset=t.bgHorizontalOffset,e.backgroundVerticalOffset=t.bgVerticalOffset,!m&&n(e,h=(0,r.O3)(a.XHM.ModifyTextBgVerticalAndHorizontalOffset,t)));if((m||k(u,a.XHM.ModifyCheckFlag))&&(e.checkFlag=t.checkFlag),m){let n,s;e.hasShadow=t.hasShadow,e.shadowColor=t.shadowColor,e.shadowAlpha=t.shadowAlpha,e.shadowAngle=t.shadowAngle,e.shadowSmoothing=t.shadowSmoothing,e.shadowDistance=t.shadowDistance,e.shadowPoint=(0,d.IN)(e.shadowDistance,e.shadowAngle),e.boldWidth=t.boldWidth,e.italicDegree=t.italicDegree,e.underline=t.hasUnderline,e.underlineWidth=t.underlineWidth,e.underlineOffset=t.underlineOffset,t.isRichText?(n=t.content,s=e.isBlankText?"":o.hM.getOriginContentFromContent(n)):(s=t.content,n=(0,r.DZ)(t,i)),e.text=s,e.content=n,e.textColor=t.textColor,e.textSize=t.textSize,e.fontSize=t.fontSize,e.textAlpha=t.textAlpha,e.borderColor=t.borderColor,e.borderWidth=t.borderWidth,e.fontPath=t.fontPath,e.fontResourceId=t.fontResId;let l=[];for(let e of t.fonts){let t=new a.LhI({id:e.id,title:e.title,path:e.path,effectId:e.effectId,resourceId:e.resourceId,categoryId:e.categoryId,categoryName:e.categoryName,sourcePlatform:e.sourcePlatform});l.push(t)}e.fonts=l}else{if(k(u,a.XHM.ModifyRichTextStyleToAll)&&(k(u,a.XHM.ModifyFontSizeSyncToAll)?(e.fontSize=t.fontSize,h=(0,r.O3)(a.XHM.ModifyFontSize,t)):h=(0,r.rs)(a.XHM.ModifyRichTextStyleToAll,t.replaceStyleRichText,e.text),n(e,h)),k(u,a.XHM.ModifyContent)){if(t.isRichText)e.content=t.content,e.text=o.hM.getOriginContentFromContent(t.content);else{var f;let i=null!==(f=t.replaceStyleRichText)&&void 0!==f?f:e.content;n(e,h=(0,r.O3)(a.XHM.ModifyContent,t,i)),e.richTextCommand=h}}if(k(u,a.XHM.ModifyTextColor)&&(e.textColor=t.textColor,n(e,h=(0,r.O3)(a.XHM.ModifyTextColor,t)),e.ktvColor&&(e.ktvColor=(0,d.Jw)(t.textColor),c(e,h=(0,r.J_)()))),k(u,a.XHM.ModifyTextAlpha)&&(e.textAlpha=t.textAlpha,n(e,h=(0,r.O3)(a.XHM.ModifyTextAlpha,t)),e.ktvColor&&c(e,h=(0,r.J_)())),k(u,a.XHM.ModifyTextBorderColor)&&k(u,a.XHM.ModifyTextBorderWidth)){let{borderColor:i}=t;e.borderColor=i,e.borderWidth=t.borderWidth,(h=new s.B).iOpCode=l.wI.CT_EDIT_OUTLINE,h.iParam1=i?1:0;let a={},o=(0,T.PS)(e.borderColor);o.pop(),a.outlineColor=o,a.outlineAlpha=i?1:0,a.outlineWidth=e.borderWidth,h.iParam5=JSON.stringify(a),n(e,h),e.ktvColor&&c(e,h=(0,r.J_)())}else k(u,a.XHM.ModifyTextBorderColor)?(e.borderColor=t.borderColor,n(e,h=(0,r.O3)(a.XHM.ModifyTextBorderColor,t)),e.ktvColor&&c(e,h=(0,r.J_)())):k(u,a.XHM.ModifyTextBorderWidth)&&(e.borderWidth=t.borderWidth,n(e,h=(0,r.O3)(a.XHM.ModifyTextBorderWidth,t)),e.ktvColor&&c(e,h=(0,r.J_)()));if(k(u,a.XHM.ModifyHasShadow)&&k(u,a.XHM.ModifyShadowColor)&&k(u,a.XHM.ModifyShadowAlpha)&&k(u,a.XHM.ModifyShadowSmoothing)&&k(u,a.XHM.ModifyShadowAngle)&&k(u,a.XHM.ModifyShadowDistance)){e.hasShadow=t.hasShadow,e.shadowColor=t.shadowColor,e.shadowAlpha=t.shadowAlpha,e.shadowAngle=t.shadowAngle,e.shadowSmoothing=t.shadowSmoothing,e.shadowDistance=t.shadowDistance,e.shadowPoint=(0,d.IN)(e.shadowDistance,e.shadowAngle),(h=new s.B).iOpCode=l.wI.CT_EDIT_SHADOW,h.iParam1=t.hasShadow?1:0;let i={shadowColor:(0,T.PS)(e.shadowColor),shadowAlpha:e.shadowAlpha,shadowOffset:[e.shadowPoint.x/18,e.shadowPoint.y/18],shadowAngle:e.shadowAngle};o.hM.isUsingOldTextShadowSmooth(e.content)?i.shadowSmoothing=e.shadowSmoothing/18:i.shadowDiffuse=e.shadowSmoothing/18,h.iParam5=JSON.stringify(i),n(e,h),e.ktvColor&&c(e,h=(0,r.J_)())}else if(k(u,a.XHM.ModifyHasShadow)&&k(u,a.XHM.ModifyShadowColor)){e.hasShadow=t.hasShadow,e.shadowColor=t.shadowColor,(h=new s.B).iOpCode=l.wI.CT_EDIT_SHADOW,h.iParam1=e.hasShadow?1:0;let i=(0,d.IN)(e.shadowDistance,e.shadowAngle),a={shadowOffset:[i.x/18,i.y/18],shadowAngle:e.shadowAngle,shadowAlpha:e.shadowAlpha,shadowColor:(0,T.PS)(t.shadowColor)};o.hM.isUsingOldTextShadowSmooth(e.content)?a.shadowSmoothing=e.shadowSmoothing/18:a.shadowDiffuse=e.shadowSmoothing/18,h.iParam5=JSON.stringify(a),n(e,h),e.ktvColor&&c(e,h=(0,r.J_)())}else if(k(u,a.XHM.ModifyHasShadow))e.hasShadow=t.hasShadow,t.shadowColor?(e.shadowColor=t.shadowColor,e.shadowAlpha=t.shadowAlpha,e.shadowAngle=t.shadowAngle,e.shadowSmoothing=t.shadowSmoothing,e.shadowDistance=t.shadowDistance,e.shadowPoint=(0,d.IN)(e.shadowDistance,e.shadowAngle)):e.shadowAlpha=0,n(e,h=(0,r.O3)(a.XHM.ModifyHasShadow,t)),e.ktvColor&&c(e,h=(0,r.J_)());else if(k(u,a.XHM.ModifyShadowColor))e.shadowColor=t.shadowColor,n(e,h=(0,r.O3)(a.XHM.ModifyShadowColor,t)),e.ktvColor&&c(e,h=(0,r.J_)());else if(k(u,a.XHM.ModifyShadowAlpha))e.shadowAlpha=t.shadowAlpha,n(e,h=(0,r.O3)(a.XHM.ModifyShadowAlpha,t)),e.ktvColor&&c(e,h=(0,r.J_)());else if(k(u,a.XHM.ModifyShadowSmoothing)){e.shadowSmoothing=t.shadowSmoothing;let i=o.hM.isUsingOldTextShadowSmooth(e.content);n(e,h=(0,r.O3)(a.XHM.ModifyShadowSmoothing,{...t,shadowSmoothingUseDiffuse:!i}))}else(k(u,a.XHM.ModifyShadowAngle)||k(u,a.XHM.ModifyShadowDistance))&&(e.shadowPoint=(0,d.IN)(t.shadowDistance,t.shadowAngle),e.shadowDistance=t.shadowDistance,e.shadowAngle=t.shadowAngle,n(e,h=(0,r.O3)(a.XHM.ModifyShadowDistance,t)));k(u,a.XHM.ModifyFontSize)&&(e.fontSize=t.fontSize,n(e,h=(0,r.O3)(a.XHM.ModifyFontSize,t))),k(u,a.XHM.ModifyFontPath)&&k(u,a.XHM.ModifyFontResId)&&(e.fontPath=t.fontPath,e.fontResourceId=t.fontResId,b.modifyTextFontProps(e,t,u),n(e,h=(0,r.O3)(a.XHM.ModifyFontPath,t)),b.modifyRichTextFonts(e,t)),k(u,a.XHM.ModifyBoldWidth)&&(e.boldWidth=t.boldWidth,n(e,h=(0,r.O3)(a.XHM.ModifyBoldWidth,t))),k(u,a.XHM.ModifyItalicDegree)&&(e.italicDegree=t.italicDegree,n(e,h=(0,r.O3)(a.XHM.ModifyItalicDegree,t))),(k(u,a.XHM.ModifyUnderline)||k(u,a.XHM.ModifyUnderlineWidth)||k(u,a.XHM.ModifyUnderlineOffset))&&(e.underline=t.hasUnderline,n(e,h=(0,r.O3)(a.XHM.ModifyUnderline,t)))}!h&&(h=new s.B),e.richTextCommand=h}static removeConflictKeyframeProperty(e){}static updateRichTextStyleForTextTemplate(e,t,i,n,o,c){if(t.styleName=i.styleName,k(c,a.XHM.ModifyTextPreset)&&(t.presetId=i.presetId,t.presetName=i.presetName,t.presetCategory=i.presetCategory,t.presetCategoryId=i.presetCategoryId,t.presetIndex=i.presetIndex),k(c,a.XHM.ModifyFontResId)){t.fontResourceId=i.fontResId,t.fontPath=i.fontPath,t.fontSourcePlatform=i.fontSourcePlatform;let e=[];for(let t of i.fonts){let i=new a.LhI({id:t.id,title:t.title,path:t.path,effectId:t.effectId,resourceId:t.resourceId,categoryId:t.categoryId,categoryName:t.categoryName,sourcePlatform:t.sourcePlatform});e.push(i)}t.fonts=e}if(k(c,a.XHM.ModifyRichTextStyleToAll)){let n=(0,r.rs)(a.XHM.ModifyRichTextStyleToAll,i.replaceStyleRichText,i.content||t.text);x(t,!!i.bgColor),t.backgroundStyle=i.bgStyle,t.backgroundColor=i.bgColor,t.backgroundAlpha=i.bgAlpha,t.backgroundWidth=i.bgWidth,t.backgroundHeight=i.bgHeight,t.backgroundRoundRadius=i.bgRoundRadiusScale,t.backgroundHorizontalOffset=i.bgHorizontalOffset,t.backgroundVerticalOffset=i.bgVerticalOffset,t.globalAlpha=i.globalAlpha,o(e,t,n),t.richTextCommand=(0,r.J_)();return}let u={};if(k(c,a.XHM.ModifyUseEffectDefaultColor)&&(t.useEffectDefaultColor=i.useEffectDefaultColor),k(c,a.XHM.ModifyFontSourcePlatform)&&(t.fontSourcePlatform=i.fontSourcePlatform),i.bgColor&&i.bgStyle!==a.M4l.TextBackgroundStyleNone){x(t,!0),t.backgroundColor=i.bgColor,t.backgroundAlpha=i.bgAlpha;let e=(0,T.PS)(i.bgColor);e[3]=i.bgAlpha,u.canvasColor=e,u.canvas=!0,k(c,a.XHM.ModifyTextBgRoundRadiusScale)&&(t.backgroundRoundRadius=i.bgRoundRadiusScale,u.canvasRoundCorner=i.bgRoundRadiusScale>0,u.canvasRoundRadiusScale=i.bgRoundRadiusScale),k(c,a.XHM.ModifyTextBgWidthAndHeight)&&(t.backgroundWidth=i.bgWidth,t.backgroundHeight=i.bgHeight,u.canvasWHCustomized=[i.bgWidth,i.bgHeight]),k(c,a.XHM.ModifyTextBgVerticalAndHorizontalOffset)&&(t.backgroundHorizontalOffset=i.bgHorizontalOffset,t.backgroundVerticalOffset=i.bgVerticalOffset,u.canvasOffsetCustomized=[i.bgHorizontalOffset,i.bgVerticalOffset]),k(c,a.XHM.ModifyTextBackgroundStyle)&&(t.backgroundStyle=i.bgStyle,u.canvasWrapped=i.bgStyle===a.M4l.TextBackgroundStyleWrap)}else x(t,!1),t.backgroundColor="",t.backgroundAlpha=1,t.backgroundStyle=a.M4l.TextBackgroundStyleNone,u.canvas=!1,u.canvasWrapped=!1,t.backgroundWidth=i.bgWidth,t.backgroundHeight=i.bgHeight,u.canvasWHCustomized=[i.bgWidth,i.bgHeight],t.backgroundRoundRadius=i.bgRoundRadiusScale,u.canvasRoundCorner=!1,u.canvasRoundRadiusScale=i.bgRoundRadiusScale,t.backgroundHorizontalOffset=i.bgHorizontalOffset,t.backgroundVerticalOffset=i.bgVerticalOffset,u.canvasOffsetCustomized=[i.bgHorizontalOffset,i.bgVerticalOffset];let m="TEXT_PRESET_STYLE";t.textColor=i.textColor,t.ktvColor&&(t.ktvColor=(0,d.Jw)(i.textColor));let h=(0,d.IN)(i.shadowDistance,i.shadowAngle);t.hasShadow=i.hasShadow,t.shadowColor=i.shadowColor,t.shadowAngle=i.shadowAngle,t.shadowDistance=i.shadowDistance,t.shadowAlpha=i.shadowAlpha,t.shadowPoint=h,t.shadowSmoothing=i.shadowSmoothing;let f=i.hasShadow?i.shadowColor:"",{borderColor:p,borderWidth:g,shadowAlpha:y,shadowSmoothing:_}=i;t.borderColor=i.borderColor,t.borderWidth=i.borderWidth,m=(0,r.sm)(m,i.textColor),m=(0,r.ao)(m,p,g),m=(0,r.fv)(m,f,y,h.x,h.y,_),u.richText=m;let{ktvColor:v}=t;if(v){if(u.ktvColor=(0,T.PS)(v),t.borderColor){let e=(0,d.Rc)(t.borderColor,v);u.ktvOutlineColor=(0,T.PS)(e)}if(f){let e=(0,d.Mv)(f,t.shadowAlpha,v);u.ktvShadowColor=(0,T.PS)(e)}}let I=new s.B;I.iOpCode=l.wI.CT_EDIT_TEXT_PRESET_STYLE_PARAM,I.iParam5=JSON.stringify(u),t.richTextCommand=I,o(e,t,I)}static async _updateRichTextStyle(e,t,i,n,o){if(!n)return;let{material:c}=e;if(c.styleName=t.styleName,k(i,a.XHM.ModifyTextPreset)&&(c.presetId=t.presetId,c.presetName=t.presetName,c.presetCategory=t.presetCategory,c.presetCategoryId=t.presetCategoryId,c.presetIndex=t.presetIndex),k(i,a.XHM.ModifyRichTextStyleToAll)){let i=(0,r.rs)(a.XHM.ModifyRichTextStyleToAll,t.replaceStyleRichText,c.text);x(c,""!==t.bgColor),c.backgroundColor=t.bgColor,c.backgroundAlpha=t.bgAlpha,await o(e.id,c,i),c.richTextCommand=(0,r.J_)();return}let u={};if(k(i,a.XHM.ModifyUseEffectDefaultColor)&&(c.useEffectDefaultColor=t.useEffectDefaultColor),k(i,a.XHM.ModifyFontSourcePlatform)&&(c.fontSourcePlatform=t.fontSourcePlatform),""!==t.bgColor&&t.bgStyle!==a.M4l.TextBackgroundStyleNone){x(c,!0),c.backgroundColor=t.bgColor,c.backgroundAlpha=t.bgAlpha;let e=(0,T.PS)(t.bgColor);e[3]=t.bgAlpha,u.canvasColor=e,u.canvas=!0,k(i,a.XHM.ModifyTextBgRoundRadiusScale)&&(c.backgroundRoundRadius=t.bgRoundRadiusScale,u.canvasRoundCorner=t.bgRoundRadiusScale>0,u.canvasRoundRadiusScale=t.bgRoundRadiusScale),k(i,a.XHM.ModifyTextBgWidthAndHeight)&&(c.backgroundWidth=t.bgWidth,c.backgroundHeight=t.bgHeight,u.canvasWHCustomized=[t.bgWidth,t.bgHeight]),k(i,a.XHM.ModifyTextBgVerticalAndHorizontalOffset)&&(c.backgroundHorizontalOffset=t.bgHorizontalOffset,c.backgroundVerticalOffset=t.bgVerticalOffset,u.canvasOffsetCustomized=[t.bgHorizontalOffset,t.bgVerticalOffset]),k(i,a.XHM.ModifyTextBackgroundStyle)&&(c.backgroundStyle=t.bgStyle,u.canvasWrapped=t.bgStyle===a.M4l.TextBackgroundStyleWrap)}else x(c,!1),c.backgroundColor="",c.backgroundAlpha=1,c.backgroundStyle=a.M4l.TextBackgroundStyleNone,u.canvas=!1,u.canvasWrapped=!1,c.backgroundWidth=t.bgWidth,c.backgroundHeight=t.bgHeight,u.canvasWHCustomized=[t.bgWidth,t.bgHeight],c.backgroundRoundRadius=t.bgRoundRadiusScale,u.canvasRoundCorner=!1,u.canvasRoundRadiusScale=t.bgRoundRadiusScale,c.backgroundHorizontalOffset=t.bgHorizontalOffset,c.backgroundVerticalOffset=t.bgVerticalOffset,u.canvasOffsetCustomized=[t.bgHorizontalOffset,t.bgVerticalOffset];let m="TEXT_PRESET_STYLE";{c.textColor=t.textColor,""!==c.ktvColor&&(c.ktvColor=(0,d.Jw)(t.textColor));let e=(0,d.IN)(t.shadowDistance,t.shadowAngle);c.hasShadow=t.hasShadow,c.shadowColor=t.shadowColor,c.shadowAngle=t.shadowAngle,c.shadowDistance=t.shadowDistance,c.shadowAlpha=t.shadowAlpha,c.shadowPoint=new a._OS(e),c.shadowSmoothing=t.shadowSmoothing;let i=t.hasShadow,{borderWidth:n}=t,o=i?t.shadowColor:"";i&&""!==t.shadowColor&&(c.hasShadow=!0);let{shadowAlpha:s}=t,l=e.x,h=e.y,f=t.shadowSmoothing;if(c.borderColor=t.borderColor,c.borderWidth=t.borderWidth,m=(0,r.sm)(m,t.textColor),m=(0,r.ao)(m,t.borderColor,n),m=(0,r.fv)(m,o,s,l,h,f),""!==c.ktvColor){let{ktvColor:e}=c;""!==e&&(u.ktvColor=(0,T.PS)(e));let t=c.borderColor;if(""!==t){let i=(0,d.Rc)(t,e);u.ktvOutlineColor=(0,T.PS)(i)}if(""!==o){let t=(0,d.Mv)(o,c.shadowAlpha,e);u.ktvShadowColor=(0,T.PS)(t)}}u.richText=m}let h=new s.B;h.iOpCode=l.wI.CT_EDIT_TEXT_PRESET_STYLE_PARAM,h.iParam5=JSON.stringify(u),c.richTextCommand=h,await o(e.id,c,h)}}},351603:function(e,t,i){i.d(t,{EW:function(){return c},IN:function(){return d},Jw:function(){return u},Mv:function(){return p},Rc:function(){return f},Xl:function(){return h},iL:function(){return l}});var r=i(211561),n=i(701897),a=i(153021),o=i(573461);let s=100/18,l=(e,t)=>{let i=new r._OS;return i.x=e,i.y=t,i},d=(e,t)=>l(...(0,o.R$)(e/s,t)),c=e=>{let t=(0,o.PM)(e.x,e.y);return t[0]*=s,t},u=e=>{if(!e||e.length<6)return"";let[t,i,r,o]=(0,n.eF)(e),[s]=a.p.rgbToHsv(t,i,r);(s+=232/360)>1&&(s-=1);let[l,d,c]=a.p.hsvToRgb(s,1,1);return`#${l.toString(16).padStart(2,"0")}${d.toString(16).padStart(2,"0")}${c.toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}`},m=e=>{let t=(0,n.Ip)(e);return a.p.rgbToHsv((0xff000000&t)>>>24,(0xff0000&t)>>>16,(65280&t)>>>8)},h=(e,t)=>{if(e.length<3||!t||t.length<6)return"";let i=e[0],r=e[1],n=e[2],o=e.length>3?e[3]:255,s=a.p.rgbToHsv(i,r,n),l=m(t),d=(s[0]+l[0])/2,c=a.p.hsvToRgb(d,s[1],s[2]);return`#${c[0].toString(16).padStart(2,"0")}${c[1].toString(16).padStart(2,"0")}${c[2].toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}`},f=(e,t)=>!e||!t||e.length<6||t.length<6?e:h((0,n.eF)(e),t),p=(e,t,i)=>{let r=(0,n.Ip)(e);return h([(0xff000000&r)>>>24,(0xff0000&r)>>>16,(65280&r)>>>8,Math.round(255*t)],i)}},556784:function(e,t,i){i.d(t,{I:function(){return c}});var r=i(998179),n=i(879566),a=i(109671),o=i(187198),s=i(312473),l=i(340294);class d{static get(){return!d._instance&&(d._instance=new d),d._instance}clearMgrStack(){this.mgrStack=[]}addAllowPath(e){return this.allowPaths.add(e),Array.from(this.allowPaths)}constructor(){this.cachePreload_=new Map,this.mgrStack=[],this.allowPaths=new Set}}class c{static push(e){d.get().mgrStack.push(e)}static pop(){d.get().mgrStack.pop()}static reset(){d.get().mgrStack.length=0}static getCur(){let{mgrStack:e}=d.get();if(0===e.length){let e=new c;return c.push(e),e}return e[e.length-1]}static preload(e,t,i,r,n,o){let l=r.map(e=>({...e,type:"system-fonts"===e.type?"fonts":e.type})),c=d.get(),u=c.cachePreload_.get(e);if(u)return(u.w!==n||u.h!==o)&&(!u.contentJson&&(u.contentJson=JSON.parse(u.content)),u.contentJson.globals.screen_size=[n,o],u.content=JSON.stringify(u.contentJson),u.w=n,u.h=o,u.config=(0,a.pG)(e,t,i,l,n,o)),{content:u.content,config:u.config};let m=(0,a.pG)(e,t,i,l,n,o),h=s.p.CreateVEUtils(),f=c.addAllowPath(e);h.setGlobalAllowedPaths(f);let p=h.scriptSegmentPreload(m);return p&&c.cachePreload_.set(e,{w:n,h:o,config:m,content:p}),{content:p,config:m}}static getDefaultRichTexts(e){let t=d.get(),i=e.replace(/\\/g,"/"),r=t.cachePreload_.get(i);if(!r)return[];if(r.defaultRichTexts)return r.defaultRichTexts;let n=JSON.parse(r.content),a=c.parseDefaultTexts(n,!0);return r.defaultRichTexts=a,a}static parseDefaultTexts(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.children?e.children.filter(e=>"text"===e.type&&e.text_params).map(e=>{var t,i;return null!==(i=null===(t=e.text_params)||void 0===t?void 0:t.richText)&&void 0!==i?i:""}).map(e=>t?e:n.hM.getOriginContentFromContent(e)):[]}init(){return!!this._veUtils||(this._veUtils=s.p.CreateVEUtils(),!!this._veUtils)}veUtilsIsNull(){return void 0===this._veUtils}rootPath(){return""}appendSuffix(e){return`${e}${this._suffix}`}getCanvasSize(){return[this._canvasWidth,this._canvasHeight]}setCanvasSize(e,t){if(this._canvasWidth!==e||this._canvasHeight!==t)for(let[i,r]of(this._canvasWidth=e,this._canvasHeight=t,this._newTextTemplateInfoMap.entries())){let r={globals:{screen_size:[e,t]}};this.setParams(i,JSON.stringify(r),!0)}}isLoaded(e){return!!this.findNewTextTemplateInfo(e)}findNewTextTemplateInfo(e){return this._newTextTemplateInfoMap.get(e)}takeNewTextTemplateInfo(e){let t=this._newTextTemplateInfoMap.get(e);return t&&this._newTextTemplateInfoMap.delete(e),t}setNewTextTemplateInfo(e,t){this._newTextTemplateInfoMap.set(e,t)}remove(e){let t=this.takeNewTextTemplateInfo(e);(null==t?void 0:t.bInit)&&this._veUtils.scriptStandaloneRelease(this.appendSuffix(e))}ensureInit(e,t,i,r){if(!this.init())return!1;let n=this.findNewTextTemplateInfo(e);if(n){if(n.path===i)return!0;this.remove(e)}let a=c.preload(i,this.rootPath(),new o.Tn().getTextStickerFallbackFontPathList(),r,this._canvasWidth,this._canvasHeight);return this._veUtils.scriptStandaloneInit(this.appendSuffix(e),a.content),this.setNewTextTemplateInfo(e,{path:i,bInit:!0,segId:e,bNeedUpdateFullContentJson:!0}),!0}buildRestoreCmd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.init())return"";let i=(0,r.BW)(e,t);return(0,a.QX)(i,e.clip,this._canvasWidth,this._canvasHeight)}buildRestoreCmdFromClip(e){if(!this.init())return"";let t=e.filter.rawJson,i=l.HH.parse(t);if(!i.root||!e)return t;let r=i.root.position[0]*this._canvasWidth*.5,n=i.root.position[1]*this._canvasHeight*.5;return i.root={...i.root,position:[r,n,0],scale:i.root.scale,rotation:i.root.rotation},l.HH.stringify(i)}executeCmd(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this.setParams(e,t,i)}getFullContent(e){let t=this.findNewTextTemplateInfo(e);if(t)return this.flushFullContentJson(t),t.fullContentJson}setCurEditSegId(e){this._curEditSegId=e}getBoundingBoxWithOldFormat(e){let t=this.findNewTextTemplateInfo(e);return t?(this.flushFullContentJson(t),t.fullContentJson)?(0,a.Oo)(t.fullContentJson,20):"":""}flushFullContentJson(e){if(!this.init()||!(null==e?void 0:e.bNeedUpdateFullContentJson))return!1;let t=this._veUtils.scriptStandaloneGetParams(this.appendSuffix(e.segId));return t&&(e.fullContentJson=JSON.parse(t),e.bNeedUpdateFullContentJson=!1),!!t}setParams(e,t,i){if(!this.init())return;let r=this.findNewTextTemplateInfo(e);if(!r)return;let n=this._veUtils.scriptStandaloneSetParams(this.appendSuffix(e),t);return i&&(r.bNeedUpdateFullContentJson=!0),n}constructor(){this._newTextTemplateInfoMap=new Map,this._suffix="",this._veUtils=s.p.CreateVEUtils(),this._curEditSegId="",this._canvasWidth=1920,this._canvasHeight=1080}}},300820:function(e,t,i){i.d(t,{D:function(){return a},Q:function(){return o}});var r=i(962679),n=i(556784);function a(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(0,r.E)(e),a=n.I.getCur(),o=a.findNewTextTemplateInfo(e.id);if(!a.ensureInit(e.id,i.resourceId,i.path,i.dependResources))return;let s=a.buildRestoreCmd(e,t);s&&a.executeCmd(e.id,s,!0)&&!o&&a.executeCmd(e.id,s,!0)}function o(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=JSON.parse(e.res),i=t.path,r={segmentId:e.id,resourceId:"",path:i,dependResources:t.depend_resource_list},a=n.I.getCur(),o=a.findNewTextTemplateInfo(e.id);if(!a.ensureInit(e.id,r.resourceId,r.path,r.dependResources))return;let s=a.buildRestoreCmdFromClip(e);s&&a.executeCmd(e.id,s,!0)&&!o&&a.executeCmd(e.id,s,!0)}},166392:function(e,t,i){i.d(t,{v:function(){return l}});var r=i(290719),n=i(481631),a=i(712616),o=i(211561),s=i(283751);let l=async(e,t)=>{let i=e.getDraftId(),l=e.getSegmentById(t.segId);if(!l||!(0,n.Ft)(l))return[];let d=[],c=l.clone();await a.i.updateRichTextEffect(c,t.effect,!1,"");let u=new o.xKN({effect:c.effect,effects:c.effects});u.material=new o.edz(c.material),u.material.useEffectDefaultColor=t.useEffectDefaultColor;let m=e.getTrackBySegmentId(l.id);if(m){let t=(0,n.xX)({__segment_struct_type:l.__segment_struct_type});s.T.pick(l,u,t),d.push({draftId:i,trackId:m.id,trackIndex:e.getTrackIndexById(m.id),segmentId:c.id,segmentDelta:u,sourceSegmentDelta:t})}let{segId:h,syncToAll:f,segmentIds:p}=t,g=c.material.content,y=(0,r.o)(e,h,f,p),_=f||p.length>0,T=y.filter(e=>e.id!==c.id&&(0,n.Ft)(e));return(await Promise.all(T.map(async e=>{let i=e.clone();return await a.i.updateRichTextEffect(i,t.effect,_,g),i}))).forEach(r=>{let a=new o.xKN({effect:r.effect,effects:r.effects});a.material=new o.edz(r.material),a.material.useEffectDefaultColor=t.useEffectDefaultColor;let l=e.getTrackBySegmentId(r.id),c=(0,n.xX)({__segment_struct_type:r.__segment_struct_type});s.T.pick(r,a,c),l&&d.push({draftId:i,trackId:l.id,trackIndex:e.getTrackIndexBySegmentId(r.id),segmentId:r.id,segmentDelta:a,sourceSegmentDelta:c})}),d}},397560:function(e,t,i){i.d(t,{G:function(){return r}});class r{get id(){return this._id}set id(e){this._id=e}get isExecutable(){return this._isExecutable}set isExecutable(e){this._isExecutable=e}get exeState(){return this._exeState}set exeState(e){this._isExecutable&&(this._exeState=e)}get isDirty(){return this._isDirty}markAsDirty(){this._isExecutable&&0===this._exeState&&(this._exeState=2),this._isDirty=!0}resetIsDirty(){this._isExecutable&&(this._exeState=0),this._isDirty=!1}copyDirtyState(e){e._isDirty=this._isDirty,e._exeState=this._exeState}setDirtyState(e){this._isDirty=e.isDirty,this._exeState=e.exeState}constructor(e,t){this._id="",this._isExecutable=!1,this._exeState=0,this._isDirty=!1,this._id=e,this._isExecutable=t}}},21816:function(e,t,i){i.d(t,{p:function(){return n}});var r,n=((r={})[r.TextEffect=0]="TextEffect",r[r.TextShape=1]="TextShape",r)},321895:function(e,t,i){i.d(t,{Nm:function(){return d},Ye:function(){return c},Yw:function(){return n},e6:function(){return r},je:function(){return u},x1:function(){return a}});class r{constructor(e=0,t=0){this.start=e,this.length=t}}class n{constructor(e=0,t=0){this.x=e,this.y=t}}class a{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.w=i,this.h=r}}var o,s,l,d=((o={})[o.Left=0]="Left",o[o.Right=1]="Right",o[o.Up=2]="Up",o[o.Down=3]="Down",o);var c=((s={})[s.Front=0]="Front",s[s.Behind=1]="Behind",s);var u=((l={})[l.All=0]="All",l[l.Selected=1]="Selected",l)},90844:function(e,t,i){i.d(t,{kT:function(){return a},wI:function(){return n}});var r,n=((r={})[r.CT_ENTER_EDIT_STATE=0]="CT_ENTER_EDIT_STATE",r[r.CT_EXIT_EDIT_STATE=1]="CT_EXIT_EDIT_STATE",r[r.CT_INPUT_STR=2]="CT_INPUT_STR",r[r.CT_INPUT_RICH_STR=3]="CT_INPUT_RICH_STR",r[r.CT_BACK_DELETE=4]="CT_BACK_DELETE",r[r.CT_FORWARD_DELETE=5]="CT_FORWARD_DELETE",r[r.CT_START_COMPOSE=6]="CT_START_COMPOSE",r[r.CT_PREEDIT_COMPOSE=7]="CT_PREEDIT_COMPOSE",r[r.CT_END_COMPOSE=8]="CT_END_COMPOSE",r[r.CT_MOVE_CURSOR_LR=16]="CT_MOVE_CURSOR_LR",r[r.CT_MOVE_CURSOR_UPDOWN=17]="CT_MOVE_CURSOR_UPDOWN",r[r.CT_MOVE_CURSOR_LINE_BEGIN_END=18]="CT_MOVE_CURSOR_LINE_BEGIN_END",r[r.CT_MOVE_CURSOR_BY_INDEX=19]="CT_MOVE_CURSOR_BY_INDEX",r[r.CT_MOVE_CURSOR_BY_POS=20]="CT_MOVE_CURSOR_BY_POS",r[r.CT_MOVE_SELECT_HANDLE_BY_POS=21]="CT_MOVE_SELECT_HANDLE_BY_POS",r[r.CT_SELECT_CONTENT=32]="CT_SELECT_CONTENT",r[r.CT_SELECT_LR_CONTENT=33]="CT_SELECT_LR_CONTENT",r[r.CT_SELECT_UPDOWN_CONTENT=34]="CT_SELECT_UPDOWN_CONTENT",r[r.CT_SELECT_MOUSE_CONTENT=35]="CT_SELECT_MOUSE_CONTENT",r[r.CT_SELECT_ALL_CONTENT=36]="CT_SELECT_ALL_CONTENT",r[r.CT_EDIT_FONT=48]="CT_EDIT_FONT",r[r.CT_EDIT_COLOR=49]="CT_EDIT_COLOR",r[r.CT_EDIT_ALPHA=50]="CT_EDIT_ALPHA",r[r.CT_EDIT_BGCOLOR=51]="CT_EDIT_BGCOLOR",r[r.CT_EDIT_BG_ALPHA=52]="CT_EDIT_BG_ALPHA",r[r.CT_EDIT_SIZE=53]="CT_EDIT_SIZE",r[r.CT_EDIT_BOLD=54]="CT_EDIT_BOLD",r[r.CT_EDIT_ITALIC=55]="CT_EDIT_ITALIC",r[r.CT_EDIT_UNDERLINE=56]="CT_EDIT_UNDERLINE",r[r.CT_EDIT_OUTLINE=57]="CT_EDIT_OUTLINE",r[r.CT_EDIT_OUTLINE_COLOR=58]="CT_EDIT_OUTLINE_COLOR",r[r.CT_EDIT_OUTLINE_ALPHA=59]="CT_EDIT_OUTLINE_ALPHA",r[r.CT_EDIT_OUTLINE_WIDTH=60]="CT_EDIT_OUTLINE_WIDTH",r[r.CT_EDIT_SHADOW=61]="CT_EDIT_SHADOW",r[r.CT_EDIT_SHADOW_COLOR=62]="CT_EDIT_SHADOW_COLOR",r[r.CT_EDIT_SHADOW_ALPHA=63]="CT_EDIT_SHADOW_ALPHA",r[r.CT_EDIT_SHADOW_SMOOTH=64]="CT_EDIT_SHADOW_SMOOTH",r[r.CT_EDIT_SHADOW_OFFSET=65]="CT_EDIT_SHADOW_OFFSET",r[r.CT_EDIT_EFFECT_STYLE=66]="CT_EDIT_EFFECT_STYLE",r[r.CT_EDIT_TEXT_PRESET_STYLE_PARAM=67]="CT_EDIT_TEXT_PRESET_STYLE_PARAM",r[r.CT_EDIT_TEXT_PARAM=68]="CT_EDIT_TEXT_PARAM",r[r.CT_EDIT_TEMPLATE_TEXT_STYLE=69]="CT_EDIT_TEMPLATE_TEXT_STYLE",r[r.CT_EDIT_RESET_TEXT_CONTEXT=70]="CT_EDIT_RESET_TEXT_CONTEXT",r[r.CT_EDIT_DEFAULT_STYLE=71]="CT_EDIT_DEFAULT_STYLE",r[r.CT_EDIT_CONVERT_CASE=72]="CT_EDIT_CONVERT_CASE",r[r.CT_EDIT_FILL=73]="CT_EDIT_FILL",r[r.CT_EDIT_KEY_WORD_INFO=78]="CT_EDIT_KEY_WORD_INFO",r[r.CT_COMMAND_BATCH_PROCESS=128]="CT_COMMAND_BATCH_PROCESS",r[r.CT_GET_PLAIN_STR=256]="CT_GET_PLAIN_STR",r[r.CT_GET_RICH_STR=257]="CT_GET_RICH_STR",r[r.CT_GET_CURSOR_RECT=258]="CT_GET_CURSOR_RECT",r[r.CT_GET_CURSOR_CHAR_INDEX=259]="CT_GET_CURSOR_CHAR_INDEX",r[r.CT_GET_CHAR_RECT=260]="CT_GET_CHAR_RECT",r[r.CT_GET_SELECT_RANGE=261]="CT_GET_SELECT_RANGE",r[r.CT_GET_ERROR_INFO=262]="CT_GET_ERROR_INFO",r[r.CT_GET_EDIT_CONTEXT_INFO=263]="CT_GET_EDIT_CONTEXT_INFO",r[r.CT_GET_SELECT_HANDLE_RECT=264]="CT_GET_SELECT_HANDLE_RECT",r[r.CT_GET_TEXT_RECT=265]="CT_GET_TEXT_RECT",r[r.CT_GET_TEXT_ORIGINAL_SIZE=266]="CT_GET_TEXT_ORIGINAL_SIZE",r[r.CT_GET_TEXT_BASE_STYLE=267]="CT_GET_TEXT_BASE_STYLE",r[r.CT_NONE=512]="CT_NONE",r);class a{constructor(){this.iOpCode=-1,this.iParam1=0,this.iParam2=0,this.iParam3=0,this.iParam4=0,this.pParam5=""}}},464314:function(e,t,i){i.d(t,{$:function(){return s}});var r=i(321895),n=i(90844),a=i(879566),o=i(389628);class s{static CmdForCode(e){let t=new n.kT;return t.iOpCode=e,t}static CmdDirectionValue(e){return e===r.Nm.Left||e===r.Nm.Up?-1:1}async getCursorRect(){let e=s.CmdForCode(n.wI.CT_GET_CURSOR_RECT),t=await this.getRichTextParam(e),i=new r.x1;return i.x=t.iParam1,i.y=t.iParam2,i.w=t.iParam3,i.h=t.iParam4,i}async initOutLineEditOpen(e){let t=s.CmdForCode(n.wI.CT_EDIT_OUTLINE);return t.iParam1=1,e&&(t.pParam5=JSON.stringify({outlineColor:[0,0,0],outlineAlpha:1,outlineWidth:.06})),await this.executeCmd(t),!0}selectAll(){let e=s.CmdForCode(n.wI.CT_SELECT_ALL_CONTENT);return this.executeCmd(e)}moveCursor(e){let t=e===r.Nm.Left||e===r.Nm.Right?n.wI.CT_MOVE_CURSOR_LR:n.wI.CT_MOVE_CURSOR_UPDOWN,i=s.CmdForCode(t);return i.iParam1=s.CmdDirectionValue(e),this.executeCmd(i)}moveCursorByIndex(e,t){let i=s.CmdForCode(n.wI.CT_MOVE_CURSOR_BY_INDEX);return i.iParam1=e,i.iParam2=t===r.Ye.Front?-1:1,this.executeCmd(i)}moveCursorByPos(e){let t=s.CmdForCode(n.wI.CT_MOVE_CURSOR_BY_POS);return t.iParam1=e.x,t.iParam2=e.y,this.executeCmd(t)}moveCursorToLineHead(){let e=s.CmdForCode(n.wI.CT_MOVE_CURSOR_LINE_BEGIN_END);return e.iParam1=-1,this.executeCmd(e)}moveCursorToLineEnd(){let e=s.CmdForCode(n.wI.CT_MOVE_CURSOR_LINE_BEGIN_END);return e.iParam1=1,this.executeCmd(e)}moveCursorAndSelect(e){let t=e===r.Nm.Left||e===r.Nm.Right?n.wI.CT_SELECT_LR_CONTENT:n.wI.CT_SELECT_UPDOWN_CONTENT,i=s.CmdForCode(t);return i.iParam1=s.CmdDirectionValue(e),this.executeCmd(i)}getEditingId(){return this._editingId}async getCharIndex(e){let t=s.CmdForCode(n.wI.CT_GET_CURSOR_CHAR_INDEX);return t.iParam1=e===r.Ye.Front?-1:1,(await this.getRichTextCmd(t)).iParam1}selectToPos(e){let t=s.CmdForCode(n.wI.CT_SELECT_MOUSE_CONTENT);return t.iParam1=e.x,t.iParam2=e.y,this.executeCmd(t)}async selectToLineHead(){let e=await this.getCursorRect();return this.selectToPos({x:-1,y:e.y+e.h/2})}async selectToLineEnd(){let e=await this.getCursorRect();return this.selectToPos({x:1,y:e.y+e.h/2})}selectToHead(){return this.selectToPos({x:-1,y:1})}selectToEnd(){return this.selectToPos({x:1,y:-1})}async hasSelection(){return 0!==(await this.getSelectRange()).length}async selectWord(){let e=await this.getPlainStr(r.je.All),t=await this.getCharIndex(r.Ye.Front),i=(0,a.wQ)(e,t,!1),n=(0,a.eF)(e,t,!1);return this.selectContent(new r.e6(i,n-i+1))}async selectWordByDirection(e){let t=e===r.Nm.Left,i=await this.getSelectRange(),n=t?i.start+i.length-1:i.start,o=t?i.start-1:i.start+i.length,s=await this.getPlainStr(r.je.All),l=t?(0,a.wQ)(s,o):(0,a.eF)(s,o);return t&&n>l&&([n,l]=[l,n]),this.selectContent(new r.e6(n,l-n+1))}async moveCursorByWordBoundary(e){let t=e===r.Nm.Left?r.Ye.Front:r.Ye.Behind,i=await this.getCharIndex(t),n=await this.getPlainStr(r.je.All),o=e===r.Nm.Left?(0,a.wQ)(n,i):(0,a.eF)(n,i);return this.moveCursorByIndex(o,t)}startCompose(e){let t=s.CmdForCode(n.wI.CT_START_COMPOSE);return e&&(t.pParam5=e),this.executeCmd(t)}preEditCompose(e){let t=s.CmdForCode(n.wI.CT_PREEDIT_COMPOSE);return e&&(t.pParam5=e),this.executeCmd(t)}endCompose(e){let t=s.CmdForCode(n.wI.CT_END_COMPOSE);return e&&(t.pParam5=e),this.executeCmd(t)}selectContent(e){let t=s.CmdForCode(n.wI.CT_SELECT_CONTENT);return t.iParam1=e.start,t.iParam2=e.length,this.executeCmd(t)}async getSelectRange(){let e=s.CmdForCode(n.wI.CT_GET_SELECT_RANGE),t=await this.getRichTextCmd(e);return 1e-6>Math.abs(t.iParam1)||1e-6>Math.abs(t.iParam1-1)?new r.e6(0,0):new r.e6(t.iParam2,t.iParam3-t.iParam2)}async getRichStr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.je.All,t=s.CmdForCode(n.wI.CT_GET_RICH_STR);return t.iParam1=e===r.je.All?0:1,t.iParam4=1,t.pParam5='{"getJson":true}',(await this.getRichTextCmd(t)).pParam5}async getPlainStr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.je.All,t=s.CmdForCode(n.wI.CT_GET_PLAIN_STR);return t.iParam1=e===r.je.All?0:1,(await this.getRichTextCmd(t)).pParam5}backDelete(){let e=s.CmdForCode(n.wI.CT_BACK_DELETE);return this.executeCmd(e)}forwardDelete(){let e=s.CmdForCode(n.wI.CT_FORWARD_DELETE);return this.executeCmd(e)}inputStr(e){let t=s.CmdForCode(n.wI.CT_INPUT_STR);return t.pParam5=e,this.executeCmd(t)}setRichText(e){let t=s.CmdForCode(n.wI.CT_EDIT_TEXT_PARAM);return t.iParam1=1,t.pParam5=`{ "richText": "${e}" }`,this.executeCmd(t)}async hasUncommittedChange(e){let t=o.h.getInstance().getSnapshot(e);if(!t)return!1;let i=await this.getRichStr(r.je.All);return t.content!==i}async captureSnapshot(e){let t=await this.getCharIndex(r.Ye.Behind),i=await this.getSelectRange(),n={cursorIndex:t,selectionRange:i,content:await this.getRichStr(r.je.All)};return o.h.getInstance().setSnapshot(e,n),n}async restoreSnapshot(e){let t=o.h.getInstance().getSnapshot(e);return t?(await this.setRichText(t.content),t.selectionRange.length>0?await this.selectContent(t.selectionRange):await this.moveCursorByIndex(t.cursorIndex,r.Ye.Front),t):t}clearSnapshots(){o.h.getInstance().clearSnapshots()}constructor(){this._textStyle="",this._editingId=""}}},849250:function(e,t,i){i.d(t,{d:function(){return n}});var r=i(211890);class n{static SkipWhiteSpace(e){if(""===e.string){e.moveToEnd();return}for(;e.char()&&n.IsWhiteSpace(e.char());){;e.move()}}static IsWhiteSpace(e){return" "===e||"	"===e||"\r"===e}static Strstart(e,t){if(""===e.string||""===t)return!1;let i=e.string.length;return!(i<t.length)&&e.string.startsWith(t,e.index)}static IsThai(e,t){let i=e.codePointAt(t);return void 0!==i&&(i>=3584&&i<=3642||i>=3647&&i<=3675)}static convert2Vector4f(e){let t=new r.lT,i=e.split(/[(\s,)]/).filter(Boolean).map(e=>parseFloat(e));return i.length>=4&&t.Set(i[0],i[1],i[2],i[3]),t}static convert2Vector2f(e){let t=new r.Sh(0,0),i=e.split(/[(\s,)]/).filter(Boolean).map(e=>parseFloat(e));return i.length>=2&&t.set(i[0],i[1]),t}}},10011:function(e,t,i){i.d(t,{q:function(){return n}});var r=i(275102);class n{parseFromString(e){return null!==this._mPElemRoot&&(this._mPElemRoot=null),this._mPElemRoot=new r.j(this,null,""),!!this._mPElemRoot.parseFrom(e)||(this._mPElemRoot=null,!1)}getRootElement(){return this._mPElemRoot}constructor(){this._mPElemRoot=null}}},176791:function(e,t,i){i.d(t,{P2:function(){return _.P2},bf:function(){return P},wK:function(){return V}});var r=i(211561),n=i(268468),a=i(881337),o=i(602777),s=i(280700),l=i(81649),d=i(448218),c=i(287165),u=i(203447),m=i(239648),h=i(712616),f=i(129862),p=i(156975),g=i(49667),y=i(481631),_=i(508115),T=i(363397),v=i(843363),I=i(187198),w=i(217201),S=i(78975),k=i(912224),x=i(320149),b=i(340294),M=i(805794),C=i(20315),A=i(593642),E=i(283751),F=i(270519);let P=1,D="smart_crop",z=e=>e<0n?-1n*e:e;class N{constructor(e,t){this.segmentId=e,this.transition=t}}class V{handleVideoAnimations(e,t){let i=x.q.animType(e.type);e.panel="video",i!==r.VAL.Anim_In||t.inAnim?i!==r.VAL.Anim_Out||t.outAnim?i===r.VAL.Anim_Group&&!t.groupAnim&&(t.groupAnim=e):t.outAnim=e:t.inAnim=e}updateAnimTimeRangeToEnd(e,t,i){if(!i)return;let r=i.start+e,n=i.start+i.duration+e,a=!1;if(t>r&&t<n?r=t:t>=n&&(a=!0),a)i.start=0n,i.duration=0n;else{let e=r-t,a=n-r;i.start=e,i.duration=a}}parseSmartCropKey(e){let t=e.indexOf(D);if(-1===t)return console.error(`parse_smart_crop_key: cache_path = ${e}`),"";let i=t+D.length+1;if(e.length<i+1)return console.error(`parse_smart_crop_key: cache_path = ${e}`),"";let r=e.indexOf("/",i);return -1===r||r<i?(console.error(`parse_smart_crop_key: cache_path = ${e}`),""):e.substring(i,r)}updateAnimTimeRangeToStart(e,t,i,r){if(!r)return;let n=r.start+e,a=n+r.duration,o=e+i,s=!1;if(o<a&&o>n?a=o:o<=n&&(s=!0),s)r.start=0n,r.duration=0n;else{let t=a-n;r.start=n-e,r.duration=t}}calculateCropScale(e,t,i){let r=e.width,n=e.height,a=t.width,o=t.height,s=(0,T.Cy)(r,n,a,o),l=a*(i.upperRightX-i.upperLeftX),d=o*(i.upperRightY-i.upperLeftY),c=a*(i.lowerLeftX-i.upperLeftX),u=o*(i.lowerLeftY-i.upperLeftY),m=Math.sqrt(l*l+d*d),h=Math.sqrt(c*c+u*u),f=(0,T.Cy)(s[0],s[1],m,h),p=-1;return p=m/h>r/n?f[0]/r:f[1]/n}muteAllKeyframes(e,t){let i=e.commonKeyframes,r=[];for(let e of i)(!t&&"KFTypeLastVolume"===e.propertyType||t&&"KFTypeVolume"===e.propertyType)&&r.push(e);let n=i.filter(e=>!(t&&"KFTypeLastVolume"===e.propertyType||!t&&"KFTypeVolume"===e.propertyType));for(let e of r){let i=e.clone(!0);t?i.propertyType="KFTypeLastVolume":i.propertyType="KFTypeVolume",n.push(i)}if(t)for(let e of r)for(let t of e.keyframeList)t.values=[0];return n}reApplyGlobalVideoEffects(e,t){for(let d of e.getSegmentsByTrackTypes([r.pNd.TrackTypeVideoEffect])){if(!!(0,y.w5)(d)){if(0===d.material.applyTargetType){var i,n,a,o,s,l;let e=t.targetTimerange.start,r=t.targetTimerange.start+t.targetTimerange.duration,c=null!==(o=null===(i=d.material.timeRange)||void 0===i?void 0:i.start)&&void 0!==o?o:0n;if(e>(null!==(s=null===(n=d.material.timeRange)||void 0===n?void 0:n.start)&&void 0!==s?s:0n)+(null!==(l=null===(a=d.material.timeRange)||void 0===a?void 0:a.duration)&&void 0!==l?l:0n)||r<c)continue}}}}updateVideoSpecialByTimeRange(e,t,i,n,a,o,c){let{trackId:u,trackIndex:h}=(0,s.Cm)(e.getAllTracks(),t.id);if(!(0,y.he)(t))return;if(t.material.audioFade){let e=new r.NOn,i=new r.K2q,n=new r.lMN,{duration:a}=t.targetTimerange,{audioFade:s}=t.material;if(s.fadeInDuration&&s.fadeInDuration>a&&(n.fadeInDuration=a),s.fadeOutDuration&&s.fadeOutDuration>a&&(n.fadeOutDuration=a),i.audioFade=n,e.material=i,Object.keys(e.material.audioFade).length){let i=(0,y.xX)({__segment_struct_type:t.__segment_struct_type});E.T.pick(t,e,i),o(new f.F({segmentId:t.id,trackId:u,trackIndex:h,segmentDelta:e,sourceSegmentDelta:i}))}}let p=e.getAllTracks()[h];(0,d.W)(new m.Uo().adjustVideoSegmentTransition(e,p,t,void 0,void 0),o);let g=e.isMainTrack(p);(!e.getDraftProperty().maintrackAdsorb||!g)&&(0,d.W)(new m.Uo().adjustVideoSegmentTransitionMaintrackAdsorbOff(e,p,t,i),o),(0,d.W)(this.updateVideoEffectTimeRange(e,t,n,i),o);let _=t.targetTimerange.start;if((0,d.W)(w.c8.adjustTrackTargetStartTime(e,p),o),a){let i=t.targetTimerange.start,n=t.targetTimerange.duration,a=e.getDraftProperty().maintrackAdsorb;if(g&&a&&i>_){let a=i-_,s=new l.O1(e.getDraftProperty().fps),d=s.gen(i).tail,u=s.gen(i+n).tail,m=new Map;for(let[i,n]of(e.enumSegmentsRecursion((e,i,r)=>{if(!(null==i?void 0:i.targetTimerange)||i.id===t.id||!r)return;let n=i.targetTimerange.start,a=i.targetTimerange.duration+n,o=s.gen(n).tail,l=s.gen(a).tail;(o>=d&&o<u||o<=d&&l>d)&&(m.has(r)?m.get(r).push(i):m.set(r,[i]))}),m)){let l=[];for(let e of n){if(!e||e.id===t.id)continue;let n=(0,y.xX)({__segment_struct_type:t.__segment_struct_type}),s=new r.zel;s.start=e.targetTimerange.start+a,s.duration=e.targetTimerange.duration,n.targetTimerange=s;let d=(0,y.xX)({__segment_struct_type:t.__segment_struct_type});E.T.pick(t,n,d),o(new f.F({segmentId:e.id,trackId:i.id,segmentDelta:n,trackIndex:h,sourceSegmentDelta:d})),l.push(e.id)}for(let r of n)for(let n of i.segments){if(!n||l.includes(n.id))continue;let i=r.targetTimerange.start,a=r.targetTimerange.duration+i,d=s.gen(i).tail,u=s.gen(a).tail,m=s.gen(n.targetTimerange.start).tail,h=s.gen(n.targetTimerange.start+n.targetTimerange.duration).tail;(d>=m&&d<h||d<=m&&u>m)&&w.c8.addSegmentToMatchTrack(e,t,p,!0,o,c)}}}}(0,d.W)(w.c8.updateDraftDurationIfNeeded(e),o)}createVideoMaterial(e,t,i,n,a,o){let s=new r.UbL;return s.matting=new r.v5b,s.crop=new r.oIP,s.path=e,s.type=t,s.width=Number(n.width),s.height=Number(n.height),s.duration=t===r.cVg.MetaTypeVideo?i:new I.Tn().getMaterialPhotoMaxDuration(),s.hasAudio=a,s.materialName=o,s}createVideoSegment(e,t,i,n,a,o,s,l){var d,u,m,h;let f=(0,v.i)(null!==(d=n.start)&&void 0!==d?d:0n,null!==(u=n.duration)&&void 0!==u?u:0n),p=(0,v.i)(null!==(m=a.start)&&void 0!==m?m:0n,null!==(h=a.duration)&&void 0!==h?h:0n),g=new r.bXy;g.rotation=o.rotation;let y=new r.BWs;y.vertical=o.flipVertical,y.horizontal=o.flipHorizontal,g.flip=y;let _=new r.Ciz;_.x=o.scaleX,_.y=o.scaleY,g.scale=_;let T=new r.wx7;return T.x=o.transformX,T.y=o.transformY,g.transform=T,new r._6D({id:l||(0,c.p)(),material:e,sourceTimerange:f,targetTimerange:p,renderIndex:i,clip:g,materialDraft:s})}storeTransitions(e,t,i){let r=e.getMainTrack();if(!r)return[];let n=[],{segments:a}=r;for(let e=0;e<a.length;e++){if(a[e].id===t.id&&2&i){let e=this.createTransitionInfo(t);e&&n.push(e)}if(e>0&&1&i){let t=a[e-1],i=this.createTransitionInfo(t);i&&n.push(i)}if(e+1<a.length&&4&i){let t=a[e+1],i=this.createTransitionInfo(t);i&&n.push(i)}}return n}restoreTransitions(e,t){let i=[];for(let n of t){let t=e.getSegmentById(n.segmentId);if(!!t&&!!(0,y.he)(t))if(n.transition){let a=n.transition.clone(),o=new r.NOn;o.transition=new r.TBZ(a),i.push((0,d.l)(e,t.id,o))}else{let n=new r.NOn;n.transition=null,i.push((0,d.l)(e,t.id,n))}}return i}createTransitionInfo(e){if(e&&(0,y.MR)(e))return null;if(!(0,y.he)(e))return;let{transition:t}=e;if(!t)return null;let i=t.clone();return new N(e.id,i)}resetSplitCurveSpeed(e,t,i,r,n,a,o,s){let l=new u.C,d=l.splitCurveSpeedPoints(BigInt(e),BigInt(t),BigInt(i),o,s),c=d[0],m=d[1];l.getCurveAveSpeed(c),l.getCurveAveSpeed(m)}copyAutoBeautyAlgorithm(e){if(!e||!(0,y.he)(e))return M.B.log("copyAutoBeautyAlgorithm: segment_video is null"),!1;let t=e.material.id;for(let i of e.figures){if(i.subType!==r.DeX.MetaSubTypeAutoBeauty&&i.subType!==r.DeX.MetaSubTypeExclusionFace||!i.algorithmArtifactPath)continue;let e=i.algorithmArtifactPath,n=p.Z.VideoFigureAlgorithmArtifact.updatePath(e,t);i.algorithmArtifactPath=n,S.P.instance.createFolder(n),S.P.instance.copyFile(`${e}/FreidBuffer.dat`,`${n}/FreidBuffer.dat`)}return!1}copyManualDeformationAlgorithmList(e,t,i,n,a){if(!t||!(0,y.he)(t))return M.B.log("copyManualDeformationAlgorithmList: segment_video is null"),!1;let{material:o}=t;if(!o)return M.B.log("copyManualDeformationAlgorithmList: material is null"),!1;let s=o.id,{manualDeformation:l}=t;if(l){let o=l.faceRecognitionAlgorithmPath;if(o){let l=p.Z.VideoFigureAlgorithmArtifact.updatePath(o,s);if(o!==l){let s=new r.NOn,d=new r.Kr8;d.faceRecognitionAlgorithmPath=l,s.manualDeformation=d;let c=(0,y.xX)({__segment_struct_type:t.__segment_struct_type});if(E.T.pick(t,s,c),a(new f.F({segmentId:t.id,segmentDelta:s,trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),sourceSegmentDelta:c})),n){let e=i,t=i;e+=`/${o}`,t+=`/${l}`,S.P.instance.createFolder(t),S.P.instance.copyFile(e,t)}}}let d=l.manualDeformationPaths,c=l.vertexListPath;M.B.log(`copyManualDeformationAlgorithmList: origin_algorithm_dir_path ${c}`);let u=c.lastIndexOf("/"),m=`${c.substring(0,u)}/${t.id}`;if(M.B.log(`copyManualDeformationAlgorithmList: new_algorithm_dir_path, ${m}`),c&&m&&c!==m){let n=new r.NOn,o=new r.Kr8;o.vertexListPath=m,n.manualDeformation=o;let s=(0,y.xX)({__segment_struct_type:t.__segment_struct_type});for(let r of(E.T.pick(t,n,s),a(new f.F({segmentId:t.id,segmentDelta:n,trackId:e.getTrackBySegmentId(t.id).id,trackIndex:e.getTrackIndexBySegmentId(t.id),sourceSegmentDelta:s})),c=S.P.instance.combineFilePath(i,c),m=S.P.instance.combineFilePath(i,m),S.P.instance.createFolder(m),d)){let e=`${c}/${r.vertexListName}`,t=`${m}/${r.vertexListName}`;M.B.log(`copyManualDeformationAlgorithmList:
            copy file src_file_path = ${e}, dst_file_path = ${t}`),S.P.instance.copyFile(e,t)}}}return M.B.log("copyManualDeformationAlgorithmList: manual_deformation is null"),!1}getSourceTime(e,t,i){let r=t.sourceTimerange,n=t.targetTimerange,a=BigInt(e)-n.start;if(a<0||!r||(null==r?void 0:r.start)<0n||!(0,y.he)(t))return;let o=0n,{speed:s}=t;if(s){var d;let{curveSpeed:e}=s;o=(null==e?void 0:null===(d=e.speedPoints)||void 0===d?void 0:d.length)?BigInt(new u.C().mapSeqDeltaToTrimDelta(a,n.duration,e.speedPoints)):b.pM.times(t.speed.speed,a,"bigint")}return g.vc.FEATURE_FRAME_TIME_AUTO_ALIGNMENT&&(o=new l.O1(i).gen(o).round),r.start+o}updateAnimationValueIfNeeded(e,t,i,r,n){if(!!(0,y.he)(t)&&!!t.animations)this.updateVideoAnimationsWithTimeRange(n,t,e,r),this.updateVideoAnimationsWithTimeRange(n,i,e,r)}updateVideoAnimationsWithTimeRange(e,t,i,r){if(!t||!(0,y.he)(t))return;let n=h.i.getOrMakeAnimationsIfNeed(t,r,e);if(!n||0===n.animations.length)return;let a={inAnim:null,outAnim:null,groupAnim:null};for(let e of n.animations){let t=e.clone();this.handleVideoAnimations(t,a)}let o=[],s=1/t.speed.speed,l=t.sourceTimerange,d=b.pM.times(l.start,s,"bigint"),c=b.pM.times(l.duration,s,"bigint"),u=d+c,m=b.pM.times(i.start,s,"bigint"),f=b.pM.times(i.duration,s,"bigint"),p=m+f;if(m!==d){let e=d-m;e>0?(this.updateAnimTimeRangeToEnd(m,d,a.inAnim),this.updateAnimTimeRangeToEnd(m,d,a.groupAnim),this.updateAnimTimeRangeToEnd(m,d,a.outAnim)):a.outAnim&&(a.outAnim.start=a.outAnim.start+z(e))}else{let e=u-p;e>0?a.outAnim&&(a.outAnim.start=a.outAnim.start+z(e)):(this.updateAnimTimeRangeToStart(d,f,c,a.inAnim),this.updateAnimTimeRangeToStart(d,f,c,a.groupAnim),this.updateAnimTimeRangeToStart(d,f,c,a.outAnim))}a.inAnim&&a.inAnim.duration>0&&o.push(a.inAnim),a.outAnim&&a.outAnim.duration>0&&o.push(a.outAnim),a.groupAnim&&a.groupAnim.duration>0&&o.push(a.groupAnim),h.i.setAnimations(t,o,r,e)}splitLeftSegmentVideoEffects(e,t,i,n){var a;if(!(0,y.he)(i))return[];let o=null!==(a=i.videoEffects)&&void 0!==a?a:[];if(0===o.length)return[];let s=[],l=[];for(let e of o){let{timeRange:i}=e;if(!i){l.push(e);continue}let{applyTimeRange:r}=e,a=r?r.start:0n,o=r?r.duration:i.duration,s=t.start+i.start+a,d=s+o;if(n<=s)continue;if(n>=d){l.push(e);continue}let c=e.clone();c.timeRange.duration=n-(t.start+i.start),c.applyTimeRange&&(c.applyTimeRange.duration=n-s),l.push(c)}let c=new r.NOn;return c.videoEffects=l.map(e=>e.clone()),s.push((0,d.l)(e,i.id,c)),s}splitRightSegmentVideoEffects(e,t,i,n){var a;if(!(0,y.he)(i))return[];let o=[],s=null!==(a=i.videoEffects)&&void 0!==a?a:[],l=[];for(let e of s){let{timeRange:i}=e;if(!i){l.push(e);continue}let{applyTimeRange:r}=e,a=r?r.start:0n,o=r?r.duration:i.duration,s=t.start+i.start+a,d=s+o,c=e.clone();if(n<=s){c.timeRange.start=i.start-t.duration,l.push(c);continue}if(!(n>=d))c.timeRange.start=0n,c.timeRange.duration=s+o-n,c.applyTimeRange=void 0,l.push(c)}let c=new r.NOn;return c.videoEffects=l,o.push((0,d.l)(e,i.id,c)),o}splitVideoEffectsTimeRange(e,t,i,r,n){if(!(0,y.he)(i)||!(0,y.he)(r))return[];let a=this.splitLeftSegmentVideoEffects(e,t,i,n);return[...a,...this.splitRightSegmentVideoEffects(e,t,r,n)]}freezeVideoEffectsTimeRange(e,t,i,n,a){let o=[];if(t&&n&&(o=this.splitVideoEffectsTimeRange(e,t.targetTimerange,t,n,a)),!i||!(0,y.he)(i))return[];let s=[];if(i){var l;for(let e of null!==(l=i.videoEffects)&&void 0!==l?l:[]){let{timeRange:i}=e;if(!i){s.push(e);continue}let{applyTimeRange:r}=e,n=r?r.start:0n,o=r?r.duration:i.duration,l=t?t.targetTimerange.start+i.start+n:0n,d=l+o;if(a<=l||a>=d)continue;let c=e.clone();c.applyTimeRange=void 0,c.timeRange=void 0,s.push(c)}}let c=new r.NOn;return c.videoEffects=s,o.push((0,d.l)(e,i.id,c)),o}updateVideoEffectTimeRange(e,t,i,n){var a;if(!(0,y.he)(t))return[];let s=t.targetTimerange,l=0n;l=n===o.ZX.ClipStart?i.duration-t.targetTimerange.duration:t.targetTimerange.duration-i.duration;let c=null!==(a=t.videoEffects)&&void 0!==a?a:[],u=[];for(let e of c){let t=e.clone(),{timeRange:i}=t;if(!i){u.push(t);continue}let{applyTimeRange:r}=t,a=r?r.start:0n,d=r?r.duration:i.duration;if(n===o.ZX.ClipStart){let e=i.start-l,t=e+a;t<0&&(e-=t,i.duration=i.duration+t,r&&(r.duration=r.duration+t)),i.start=e}if(d=r?r.duration:i.duration,i.start+a+d>s.duration&&(i.duration=s.duration-i.start,r&&(r.duration=i.duration-r.start)),!((d=r?r.duration:i.duration)<=0))u.push(t)}let m=new r.NOn;return m.videoEffects=u,[(0,d.l)(e,t.id,m)]}clearVideoEffectKeyframes(e,t){var i;if(!(0,y.he)(t))return[];let n=(null!==(i=t.videoEffects)&&void 0!==i?i:[]).map(e=>e.clone());for(let e of n)e.commonKeyframes=[];let a=new r.NOn;return a.videoEffects=n,[(0,d.l)(e,t.id,a)]}clearGlobalEffectKeyframes(e,t){if(!t||!(0,y.w5)(t))return[];let i=(0,y.xX)({__segment_struct_type:t.__segment_struct_type,commonKeyframes:[]});return[(0,d.l)(e,t.id,i)]}freezeMattingTimeRange(e,t){return this.copyMattingData(e,t,e.id)}copyMattingData(e,t,i){var n,a,o,s,l,d,c;if(!(0,y.he)(e)||!(0,y.he)(t))return[];if((null==e?void 0:null===(a=e.material)||void 0===a?void 0:null===(n=a.matting)||void 0===n?void 0:n.flag)&&(null==e?void 0:null===(s=e.material)||void 0===s?void 0:null===(o=s.matting)||void 0===o?void 0:o.flag)&BigInt(r.R6k.cusMattingFlag)&&(null==t?void 0:t.id)){let r=t.id,n=(0,p.u)(null==e?void 0:null===(d=e.material)||void 0===d?void 0:null===(l=d.matting)||void 0===l?void 0:l.path,i),a=(0,p.u)(null==t?void 0:null===(c=t.material)||void 0===c?void 0:c.matting.path,r);S.P.instance.isExist(n)&&S.P.instance.copyFile(n,a)}}splitMattingTimeRange(e,t,i,n,a){var o,s,l,d;if(!!(0,y.he)(t)){if((null==t?void 0:null===(s=t.material)||void 0===s?void 0:null===(o=s.matting)||void 0===o?void 0:o.flag)&&(null==t?void 0:null===(d=t.material)||void 0===d?void 0:null===(l=d.matting)||void 0===l?void 0:l.flag)&&r.R6k.cusMattingFlag){let e=t.id,r=i.id,n=(0,p.u)(t.material.matting.path,e),a=(0,p.u)(t.material.matting.path,r);S.P.instance.isExist(n)&&S.P.instance.copyFile(n,a)}}}updateAudioFadeInOutValueIfNeeded(e,t,i){if(!(0,y.he)(e)||!(0,y.he)(t))return;let{audioFade:n}=e.material,a=t.material.audioFade;if(!n||!a)return;let o=[],s=new r.NOn;if(s.material=new r.K2q,s.material.audioFade=new r.lMN,s.material.audioFade.fadeOutDuration=0n,o.push((0,d.l)(i,e.id,s)),a.fadeInDuration=0n,n.fadeInDuration>e.targetTimerange.duration){let t=new r.NOn;t.material=new r.K2q,t.material.audioFade=new r.lMN,t.material.audioFade.fadeOutDuration=e.targetTimerange.duration,o.push((0,d.l)(i,e.id,t))}return a.fadeOutDuration>t.targetTimerange.duration&&(a.fadeOutDuration=t.targetTimerange.duration),o}updateCheckFlag(e,t){if(!!(0,y.he)(e)&&!!(0,y.he)(t))e.material&&t.material&&(t.material.checkFlag=e.material.checkFlag)}getVideoRenderIndexInfo(e,t,i){let n=-1,a=-1,o=e.getTracksByTypesAndFlag([r.pNd.TrackTypeVideo],r.w9k.FlagSubVideo),s=e.getSegmentById(t);if(!s||!(0,y.he)(s))return[n,a];let l=[];for(let e of o){let{segments:t}=e;for(let e=0;e<t.length;++e){let r=t[e];if(!r)continue;let n=r.targetTimerange;if(!n)continue;let a=n.start,o=a+n.duration,s=!1;if(e<t.length-1){let i=t[e+1];if(i){let e=i.targetTimerange;s=!!e&&o===e.start}}(0,y.he)(r)&&a<=i&&(s?o>i:o>=i)&&r&&l.push(r)}l.sort((e,t)=>e.renderIndex-t.renderIndex);let r=new k.eK().buildRenderLayersWithSegments(l);a=r.size;let o=0;for(let e of r.entries()){if(e[0]===s.renderIndex){n=o;break}o++}}return[a,n]}setVideoHdrMode(e,t){if(!(null==e?void 0:e.material)||!(0,y.he)(e))return;let{material:i}=e,n=new r.bEb;n.mode=r.bZ2.HDRDisplayModeDefault;let a=new r.NOn;return a.hdrSettings=new r.GmC(n),a.material=new r.K2q,a.material.checkFlag=i.checkFlag|Number(r.FC7.HDRSettingsFlag)|Number(r.FC7.BeautyBody),(0,d.l)(t,e.id,a)}createPlaceholderVideoSegment(e,t){let i=new r.tnv((0,a.xrB)({}));i.start=0n,i.duration=e.duration;let n=(0,a.cBb)({});n.width=720,n.height=1280;let o=(0,a.cE6)({}),s=this.createVideoMaterial(t,r.cVg.MetaTypeVideo,e.duration,n,!1,"");return this.createVideoSegment(s,w.fm,k.AG,i,e,o)}insertVideoSegments(e,t,i){let n=[],a=i.getMainTrack(),o=null;if(t===w.fm&&a&&a.segments.length&&e.length){let t=i.getSegmentInsertIndexByStartTime(a,BigInt(e[0].startTime)),r=-1;r=t>0?t-1:t;let n=a.segments;if(r>=0&&r<n.length){let e=n[r];e&&(0,y.he)(e)&&(o=e.background)}}for(let a of e){var s,l,d,c,u;let e,{sourceDuration:m}=a;m<=0&&(m=a.duration);let h=new r.tnv;h.start=BigInt(a.sourceStartTime),h.duration=m;let f=new r.tnv;f.start=BigInt(a.startTime),f.duration=m,e=k.eK.prototype.renderIndexMode(i)===r.IDM.RenderIndexModeFree?k.eK.prototype.nextVideoRenderIndex(t,i):k.eK.prototype.nextVideoRenderIndexWithTimeRange(t,(0,v.i)(f.start,f.duration),i);let p={width:a.size.width,height:a.size.height},g=new V().createVideoMaterial(a.path,a.type,a.duration,p,a.hasAudio,null!==(s=a.materialName)&&void 0!==s?s:"");g.mediaPath=a.mediaPath,g.localId=a.localId,g.teamId=a.teamId,g.sourcePlatform=a.sourcePlatform,g.formulaId=a.formulaId,g.categoryId=null!==(l=a.categoryId)&&void 0!==l?l:"",g.categoryName=null!==(d=a.categoryName)&&void 0!==d?d:"",g.materialId=null!==(c=a.materialId)&&void 0!==c?c:"",g.materialName=null!==(u=a.materialName)&&void 0!==u?u:"",g.localMaterialId=a.localMaterialId,g.originMaterialId=a.originMaterialId;let _=new V().createVideoSegment(g,t,e,h,f,a.clip);if(a.segmentId&&(_.id=a.segmentId),a.copyBackground&&o&&(0,y.he)(_)){let e=o.clone();_.background=e}let T=new r.bEb;T.mode=r.bZ2.HDRDisplayModeDefault,_.hdrSettings=T,g.checkFlag=g.checkFlag|Number(r.FC7.HDRSettingsFlag)|Number(r.FC7.BeautyBody),n.push(_)}return n}fixMaterialDraftTrackingTargetId(e,t,i,n){if(t&&i&&(0,y.he)(t)&&(0,y.he)(i)){let a=t.materialDraft,o=i.materialDraft?i.materialDraft.clone():void 0;if(a&&o){let t=a.draft.getAllSegments(),s=o.draft.getAllSegments();if(t.length===s.length){let a=new Map;for(let e=0;e<s.length;e++)a.set(t[e].id,s[e].id);for(let t of s){let i=e.getVideoTracking(t);if(i)for(let e of[...i.trackers]){let t=e.targetSegmentId;a.has(t)&&(e.targetSegmentId=a.get(e.targetSegmentId))}}if(n){let t=new r.NOn({materialDraft:o}),a=(0,y.xX)({__segment_struct_type:i.__segment_struct_type});E.T.pick(i,t,a),n(new f.F({segmentDelta:t,segmentId:i.id,trackId:e.getTrackBySegmentId(i.id).id,trackIndex:e.getTrackIndexBySegmentId(i.id),sourceSegmentDelta:a}))}}}return o}}createTailLeaderMaterial(e){let t=new r.W99;return t.type=r.cVg.MetaTypeTailLeader,t.text=e,t}createTailLeaderSegment(e,t){let i=new r.wIf;return i.id=(0,c.p)(),i.material=e,i.targetTimerange=(0,v.i)(t.start,t.duration),i}removeVideoSegmentEffects(e,t){if(!t||!(0,y.he)(t))return[];let i=new r.NOn;return i.videoEffects=[],(0,d.l)(e,t.id,i)}fixSegmentMaterialDraftMutableConfig(e,t,i,n){if(!t||!i||!(0,y.he)(t)||!(0,y.he)(i)||!t.materialDraft||!i.materialDraft)return;let a=t.materialDraft,o=i.materialDraft.clone(),s=a.draft,l=o.draft;if(this.fixMaterialDraftMutableConfig(s,l),n){let t=new r.NOn,a=new r.rdD({draft:l});t.materialDraft=a;let o=(0,y.xX)({__segment_struct_type:i.__segment_struct_type});E.T.pick(i,t,o),n(new f.F({segmentDelta:t,segmentId:i.id,trackId:e.getTrackBySegmentId(i.id).id,trackIndex:e.getTrackIndexBySegmentId(i.id),sourceSegmentDelta:o}))}return o}fixMaterialDraftMutableConfig(e,t){if(!e||!t)return;let i=e.property.mutableConfig,r=t.property.mutableConfig;if(!i||!r)return;let n=i.mutableMaterials,a=r.mutableMaterials;if(n.length===a.length&&!(n.length<=0))for(let i=0;i<n.length;++i){let r=n[i].id,[o,s,l]=this._findMaterialIndex(e,r);if(o<0||s<0)continue;let{tracks:d}=t;if(o>=d.length||s>d[o].segments.length)continue;let c=d[o].segments[s],u="";if(l>=0&&(0,y.Q2)(c)){let e=c.material.textInfoResources;l>=e.length||(u=e[l].textMaterial.id)}else((0,y.he)(c)||(0,y.Ft)(c))&&(u=c.material.id);a[i].id=u}}fixVideoTrackingConfig(e,t){if(!e||!t)return;let i={},r=e.getAllSegments(),n=t.getAllSegments();if(!!r.length&&!!n.length&&n.length===r.length)r.forEach((e,t)=>{i[e.id]=t}),n.filter(e=>e.videoTracking).forEach(e=>{let{videoTracking:{trackers:t=[]}={}}=e;t.forEach(e=>{let t=i[e.targetSegmentId];e.targetSegmentId=n[t].id})})}getVideoMaskDelta(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!(0,y.he)(e)||!t)return;if(!t.resourceType&&!t.path&&t.width<1e-6&&t.height<1e-6){let e=new r.NOn;return i?(e.digitalHuman=new r.Zgq,e.digitalHuman.mask=null):e.videoMask=null,e}let n=e.videoMask&&e.videoMask.length>0?e.videoMask[0].clone():new r.Q$U;if(void 0===t.resourceId||(n.resourceId=t.resourceId),void 0===t.resourceType||(n.resourceType=t.resourceType),void 0===t.name||(n.name=t.name),void 0===t.path||(n.path=t.path),void 0===t.sourcePlatform||(n.sourcePlatform=t.sourcePlatform),void 0===t.positionInfo||(n.positionInfo=t.positionInfo),void 0===t.width||(n.config.width=t.width),void 0===t.height||(n.config.height=t.height),void 0===t.centerX||(n.config.centerX=t.centerX),void 0===t.centerY||(n.config.centerY=t.centerY),void 0===t.rotation||(n.config.rotation=t.rotation),void 0===t.feather||(n.config.feather=t.feather),void 0===t.roundCorner||(n.config.roundCorner=t.roundCorner),void 0===t.invert||(n.config.invert=t.invert),void 0===t.aspectRatio||(n.config.aspectRatio=t.aspectRatio),!i)return new r.NOn({videoMask:[n]});{let e=new r.NOn;return e.digitalHuman=new r.Zgq({mask:n}),e}}updateVideoEffects(e,t){if(!(0,y.he)(e))return;let i=new r.NOn;return i.isToneModify=!1,i.beauty=void 0,i.manualDeformation=void 0,i.figures=[],i.reshape=void 0,i.material=new r.K2q,i.material.crop=new r.V_m(new r.oIP),i.material.cropScale=1,i.material.cropRatio=r.j8m.CropRatioFree,i.clip=new r.tLq(new r.bXy),i.reverse=!1,i.intensifiesAudio=!1,i.cartoon=!1,i.material.matting=new r.zh9(new r.v5b),t.isSegmentInTrack(t.getMainTrack(),e.id)&&t.getDraftProperty().videoMute?i.volume=0:i.volume=1,i.voiceChange=void 0,i.figures=[],i.manualDeformation=void 0,i.material.stable=void 0,(0,d.l)(t,e.id,i)}templateReplaceResetVideoEffects(e,t){if(!e||!(0,y.he)(e))return;let i=new r.NOn;return i.beauty=void 0,i.manualDeformation=void 0,i.figures=[],i.reshape=void 0,i.material=new r.K2q,i.material.crop=new r.V_m(new r.oIP),i.material.cropRatio=r.j8m.CropRatioFree,i.material.cropScale=1,(0,d.l)(t,e.id,i)}updateGameplayForVideo(e,t,i,n){if(!(null==t?void 0:t.material)||!(0,y.he)(t))return;let{material:a}=t,o=new r.NOn;if(o.material=new r.K2q,a.type!==n){o.material.type=n;let i=t.clip?t.clip.clone():new r.bXy,a=this.updateVideoEffects(t,e);a&&[].push(a),o.clip=new r.tLq(i)}else o.reverse=!1,o.intensifiesAudio=!1,this.reApplyGlobalVideoEffects(e,t);i.width>0&&i.height>0&&(o.material.width=i.width,o.material.height=i.height);let s=(0,F.Mn)(t.material);if(!s)return;let l=s?s.clone():new r.JdR;l.algorithmType=i.algorithmType,l.gameplayName=i.gameplayName,l.algorithm=i.algorithm,l.path=i.path,l.reshape=i.reshape,l.abilityFlag=i.abilityFlag,i.gameplaySourceTimerange&&(l.gameplaySourceTimerange=i.gameplaySourceTimerange);let c=new r.gee;c.stopmotionFirstRenderTime=i.adjustableConfig.stopmotionFirstRenderTime,c.stopmotionGapDuration=i.adjustableConfig.stopmotionGapDuration,c.lightwaveRepeatDuration=i.adjustableConfig.lightwaveRepeatDuration,c.prompt=i.adjustableConfig.prompt,c.strength=i.adjustableConfig.strength,l.adjustableConfig=c,!o.videoAlgorithm&&(o.videoAlgorithm=new r.OHm),o.videoAlgorithm.gameplayConfigs=[l];let u=a.videoAlgorithm.algorithms.find(e=>e.algorithmId===(null==s?void 0:s.algorithmId));return u&&(u.type=i.algorithmType),o.videoAlgorithm.algorithms=a.videoAlgorithm.algorithms,(0,d.l)(e,t.id,o)}alignVideoAnimation(e){if(!e||!(0,y.he)(e))return;let t=e.animations;if(!t)return;let{animations:i}=t;if(0===i.length)return;let n=null,a=null,o=null;for(let e of i){let t=x.q.animType(e.type);t===r.VAL.Anim_In?n=e:t===r.VAL.Anim_Out?a=e:t===r.VAL.Anim_Group&&(o=e)}let s=0n;if(n&&(s=n.start+n.duration),o){if(o.start<s){let e=s-o.start;o.start=s,o.duration=o.duration-e}s=o.start+o.duration}if(a&&a.start<s){let e=s-a.start;a.start=s,a.duration=a.duration-e}}updateVideoAnimationsWithTrans(e,t,i,r,n){if(!e||!(0,y.he)(e))return;let{transition:a}=e;if(!a||!a.isOverlap)return;if(!!t)this.updateVideoAnimationsWithTransAndNewDuration(e,t,a.duration,i,r,n)}updateVideoAnimationsWithTransAndNewDuration(e,t,i,n,a,o){if(!e||!t||!(0,y.he)(e)||!(0,y.he)(t))return;let{transition:s}=e;if(!s||!s.isOverlap)return;let l=(n-i)/2n,d=h.i.getOrMakeAnimationsIfNeed(t,a,o);if(d&&!d.animations.length){for(let e of d.animations){if(!e)continue;let t=x.q.animType(e.type);if(t===r.VAL.Anim_Out||t===r.VAL.Anim_Group){let t=e.start;e.start=t+l}}0n===n&&this.alignVideoAnimation(t)}let c=h.i.getOrMakeAnimationsIfNeed(e,a,o);if(c&&!c.animations.length){for(let e of c.animations){if(!!e){if(x.q.animType(e.type)===r.VAL.Anim_Out){let t=e.start;e.start=t+l}}}0n===n&&this.alignVideoAnimation(e)}}makeStickerAnimationFrom(e,t){let i=new r.FJA;return i.id=e.effectId,i.categoryId=e.categoryId,i.categoryName=e.categoryName,i.type=x.q.cstrType(t),i.duration=BigInt(e.value),i.path=e.path,i.platform=e.platform,i.resourceId=e.resourceId,i.thirdResourceId=e.thirdResourceId,i.sourcePlatform=e.sourcePlatform,i.name=e.name,i.panel="video",i}addVideoAnimations(e,t,i,r){let n=new V,a=h.i.getOrMakeAnimationsIfNeed(t,r,e);if(!a)return;let o=[],s={inAnim:null,outAnim:null,groupAnim:null},l=h.i.makeStickerAnim(i,"video");if(n.handleVideoAnimations(l,s),a&&a.animations.length)for(let e of a.animations)l=e.clone(),n.handleVideoAnimations(l,s);if(s.inAnim&&o.push(s.inAnim),s.outAnim&&o.push(s.outAnim),s.groupAnim){var d;s.inAnim&&s.groupAnim.start<s.inAnim.duration&&(s.groupAnim.start=s.inAnim.duration),s.groupAnim.duration+s.groupAnim.start>(null==t?void 0:null===(d=t.targetTimerange)||void 0===d?void 0:d.duration)&&(s.groupAnim.duration=t.targetTimerange.duration-s.groupAnim.start),s.outAnim&&s.groupAnim.start+s.groupAnim.duration>s.outAnim.start&&(s.groupAnim.duration=s.outAnim.start-s.groupAnim.start),o.push(s.groupAnim)}h.i.setAnimations(t,o,r,e)}updateVideoMattingPathByVideoAlgorithm(e,t){var i,n;if(!!e&&!!(0,y.he)(e)){if(null==e?void 0:null===(n=e.material)||void 0===n?void 0:null===(i=n.matting)||void 0===i?void 0:i.path){let i=new r.NOn;return(i.material=new r.K2q,e.material.matting.flag&BigInt(r.R6k.cusMattingFlag))?(i.material.matting=new r.zh9(new r.v5b),(0,d.l)(t,e.id,i)):(i.material.matting=new r.zh9,i.material.matting.path=(0,_.ur)(e),(0,d.l)(t,e.id,i))}}}videoSegmentMergeFigureHandle(e,t,i,n,a,o,s,l){if(!!(0,y.he)(s)){if(t===r.SbQ.Merge_Face)for(let t of(S.P.instance.deleteFileOrDir(o+""),l))this.copyFigureManualDeformation(e,s,t,a,o,i,n);if(t===r.SbQ.Merge_Face||t===r.SbQ.Merge_Body)for(let e of l){if(!(0,y.he)(e))return;for(let a of(e.figures=[],s.figures)){let s=a.clone(),l=o+""+e.id;if(s.algorithmArtifactPath=l,i&&t===r.SbQ.Merge_Face){let{value:e}=s;for(let t of s.adjustParams)""!==n&&t.name===n&&(e=t.value);s.adjustParams=[],s.value=e,s.faceAdjustParams}e.figures.push(s)}}}}copyFigureManualDeformation(e,t,i,n,a,o,s){if(!(0,y.he)(t))return;let{manualDeformation:l}=t;if(!l)return;l=l.clone();let{faceRecognitionAlgorithmPath:c}=l,u=a+(""+i.id);l.faceRecognitionAlgorithmPath=u,S.P.instance.createFolder(u),S.P.instance.copyFile(`${c}/FreidBuffer.dat`,`${u}/FreidBuffer.dat`);let{vertexListPath:m}=l;if(!m){let e=`${a}/materials/manual_deformation_algorithm/${i.id}`;l.vertexListPath=e,S.P.instance.copyFileOrDir(m,e)}if(o){let{manualDeformationPaths:e}=l,t=Number(g.kM.GLOBAL_FACE_ID),i=null,n=e.find(e=>e.faceId===Number(s))?Number(s):t;for(let a of e)if(a.faceId===n){(i=new r.unI).faceId=t,i.vertexListName=a.vertexListName;break}i&&(l.manualDeformationPaths=[],l.manualDeformationPaths.push(i))}let h=new r.NOn,f=new r.Kr8(l);return h.manualDeformation=f,(0,d.l)(e,i.id,h)}videoSegmentKeyframesMergeAdjustHandle(e,t,i){}copyMaterialEffect(e){return e.clone()}videoSegmentMergeAdjustHandle(e,t,i,n,a,o){if(!(0,y.he)(a))return[];let s=[];if(t===r.SbQ.Merge_Adjust){let t=a.adjust;for(let i of o){var l;if(!(0,y.he)(i))continue;if(!t){i.adjust=void 0;let t=new r.NOn;t.adjust=null,s.push((0,d.l)(e,i.id,t));continue}let n=(null!==(l=i.adjust)&&void 0!==l?l:new r.sq5).clone();if(t.brightness?(n.brightness=this.copyMaterialEffect(t.brightness),this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeBrightness,t.brightness.value)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeBrightness,0),n.brightness=void 0),t.contrast?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeContrast,t.contrast.value),n.contrast=this.copyMaterialEffect(t.contrast)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeContrast,0),n.contrast=void 0),t.saturation?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeSaturation,t.saturation.value),n.saturation=this.copyMaterialEffect(t.saturation)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeSaturation,0),n.saturation=void 0),t.sharpening?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeSaturation,t.sharpening.value),n.sharpening=this.copyMaterialEffect(t.sharpening)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeSaturation,0),n.sharpening=void 0),t.highlight?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeHighlight,t.highlight.value),n.highlight=this.copyMaterialEffect(t.highlight)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeHighlight,0),n.highlight=void 0),t.shadow?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeShadow,t.shadow.value),n.shadow=this.copyMaterialEffect(t.shadow)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeShadow,0),n.shadow=void 0),t.colorTemperature?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeTemperature,t.colorTemperature.value),n.colorTemperature=this.copyMaterialEffect(t.colorTemperature)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeTemperature,0),n.colorTemperature=void 0),t.hue?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeHue,t.hue.value),n.hue=this.copyMaterialEffect(t.hue)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeHue,0),n.hue=void 0),t.fade?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeFade,t.fade.value),n.fade=this.copyMaterialEffect(t.fade)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeFade,0),n.fade=void 0),t.lightSensation?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeLightSensation,t.lightSensation.value),n.lightSensation=this.copyMaterialEffect(t.lightSensation)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeLightSensation,0),n.lightSensation=void 0),t.vignetting?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeVignetting,t.vignetting.value),n.vignetting=this.copyMaterialEffect(t.vignetting)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeVignetting,0),n.vignetting=void 0),t.particle?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeParticle,t.particle.value),n.particle=this.copyMaterialEffect(t.particle)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeParticle,0),n.particle=void 0),t.lut?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeLUT,t.lut.value),n.lut=this.copyMaterialEffect(t.lut)):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeLUT,0),n.lut=void 0),t.filter?n.filter=this.copyMaterialEffect(t.filter):n.filter=void 0,t.hsl&&t.hsl.length>0){let e=(t.hsl||[]).map(e=>e.clone());n.hsl=e}else{let{hsl:e}=n;if(e&&e.length>0)for(let t of e)t&&(t.hue=0,t.saturation=0,t.lightness=0);n.hsl=e}let{colorCurves:a}=t;a?n.colorCurves=a.clone():n.colorCurves=void 0;let{primaryColorWheels:o}=t;o?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypePrimaryColorWheels,o.intensity),n.primaryColorWheels=o.clone()):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypePrimaryColorWheels,0),n.primaryColorWheels=void 0);let{logColorWheels:c}=t;c?(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeLogColorWheels,c.intensity),n.logColorWheels=c.clone()):(this.videoSegmentKeyframesMergeAdjustHandle(i,r.cVg.MetaTypeLogColorWheels,0),n.logColorWheels=void 0),n.enableLut=t.enableLut,n.enableAdjust=t.enableAdjust,n.enableColorCurves=t.enableColorCurves,n.enableColorWheels=t.enableColorWheels;let u=t.adjustPresetResourceId;u?n.adjustPresetResourceId=u:n.adjustPresetResourceId="";let m=new r.NOn;m.adjust=new r.cNp(n),s.push((0,d.l)(e,i.id,m))}}return s}fixVideoCurveSpeedResourceId(e,t,i){let n=[];if(t&&i&&(0,y.he)(t)&&(0,y.he)(i)){let a=t.speed,o=i.speed;if(a&&o&&a.curveSpeed&&o.curveSpeed){let t=new r.NOn,o=new r.Zk4;o.curveSpeed=new r._Xo(a.curveSpeed),t.speed=o,n.push((0,d.l)(e,i.id,t))}let s=i.materialDraft,l=t.materialDraft;if(l&&s&&l.draft&&s.draft){let t=l.draft.tracks,i=s.draft.tracks;if(t.length!==i.length||0===t.length)return n;for(let a=0;a<t.length;a++){let o=t[a];if(o.type!==r.pNd.TrackTypeVideo)continue;let s=i[a],l=o.segments,d=s.segments;if(l.length===d.length&&0!==l.length)for(let t=0;t<l.length;t++){let i=l[t],r=d[t];n.push(...this.fixVideoCurveSpeedResourceId(e,i,r))}}}}return n}getIsHdrByPath(e){let t=!1,i=e.toLowerCase();return -1!==i.lastIndexOf(".")&&(-1!==(i=i.substring(0,i.lastIndexOf("."))).indexOf("-pq")||-1!==i.indexOf("_pq")||-1!==i.indexOf("-hlg")||-1!==i.indexOf("_hlg"))&&(t=!0),t}_findMaterialIndex(e,t){let i=!1,r=-1,n=-1,a=-1,{tracks:o}=e;for(r=0;r<o.length;++r){let{segments:e}=o[r];for(n=0;n<e.length;++n){let r=e[n];if((0,y.he)(r)||(0,y.Ft)(r)){if(r.material.id===t){i=!0;break}}else if((0,y.Q2)(r)){for(let e of(a=0,r.material.textInfoResources)){if(e.textMaterial.id===t){i=!0;break}a++}if(i)break}}if(i)break}return!i&&(r=-1,n=-1,a=-1),[r,n,a]}getDigitalHumanMaterialDraft(e,t){let[i]=e,s=new r.WuX;s.draft.metadata.id=(0,A.Rl)(),s.draft.property.canvasConfig=new r.VJv({width:i.size.width,height:i.size.height}),s.combinationId=(0,A.Rl)(),s.type=o.cV.MetaTypeCombination;let l=new V().insertVideoSegments(e,0,s.draft);for(let i of(l.forEach((t,i)=>{let a=e[i];void 0!==a.volume&&(t.volume=a.volume),t.background.color="#00000000",void 0!==a.duration&&(t.targetTimerange.duration=a.duration),void 0!==a.startTime&&(t.targetTimerange.start=a.startTime),s.draft.tracks.push(new n.fQ({id:(0,A.Rl)(),type:r.pNd.TrackTypeVideo,flag:r.w9k.FlagNone})),s.draft.tracks[i].segments.push(t),a.type===o.cV.MetaTypeVideo&&t.targetTimerange.duration>t.sourceTimerange.duration&&(t.speed.speed=b.pM.div(t.sourceTimerange.duration,t.targetTimerange.duration,"number"))}),t)){var d,c,u,m,h,f,p,g,y,_,T,v,I,w,S,k,x,M,E,F,P;let e=C.Ry.createSegmentAudio((0,a.a0p)(i.ttsParam));i.ttsParam.segmentId&&(e.id=i.ttsParam.segmentId),e.material.resourceId=null!==(v=null===(d=i.ttsParam.text)||void 0===d?void 0:d.resourceId)&&void 0!==v?v:"",e.volume=null!==(I=null===(c=i.ttsParam.text)||void 0===c?void 0:c.volume)&&void 0!==I?I:1;let{trackIndex:t,needToInsert:o}=s.draft.findTrackIndexToInsert(r.pNd.TrackTypeAudio,e.targetTimerange.start,e.targetTimerange.duration);o&&s.draft.tracks.push(new n.fQ({id:(0,A.Rl)(),type:r.pNd.TrackTypeAudio,flag:r.w9k.FlagNone})),e.material.toneType=null!==(w=null===(u=i.ttsParam.text)||void 0===u?void 0:u.toneType)&&void 0!==w?w:"",e.material.toneEffectId=null!==(S=null===(m=i.ttsParam.text)||void 0===m?void 0:m.toneEffectId)&&void 0!==S?S:"",e.material.toneEffectName=null!==(k=null===(h=i.ttsParam.text)||void 0===h?void 0:h.toneEffectName)&&void 0!==k?k:"",e.material.categoryId=null!==(x=null===(f=i.ttsParam.text)||void 0===f?void 0:f.toneCategoryId)&&void 0!==x?x:"",e.material.categoryName=null!==(M=null===(p=i.ttsParam.text)||void 0===p?void 0:p.toneCategoryName)&&void 0!==M?M:"",e.material.toneSpeaker=null!==(E=null===(g=i.ttsParam.text)||void 0===g?void 0:g.toneSpeaker)&&void 0!==E?E:"",e.material.tonePlatform=null!==(F=null===(y=i.ttsParam.text)||void 0===y?void 0:y.tonePlatform)&&void 0!==F?F:"",e.material.isAiCloneTone=!!(null===(_=i.ttsParam.text)||void 0===_?void 0:_.isAiCloneTone),e.material.textId=null!==(P=null===(T=i.ttsParam.text)||void 0===T?void 0:T.textSegmentId)&&void 0!==P?P:"",s.draft.tracks[t].segments.push(e)}return{materialDraft:s,digitalHumanPreviewVideoSegments:l}}}},239648:function(e,t,i){i.d(t,{Uo:function(){return m}});var r=i(211561),n=i(280700),a=i(392742),o=i(448218),s=i(81649),l=i(481631),d=i(912224),c=i(217201),u=i(283751);class m{setVideoSegmentTransiton(e,t,i,n,a){let s;if(!(0,l.he)(i))return;let d="";if(n){let e=this.findPrevSegment(t,i);if(!e)return;d=e.id,s=n}a&&(d=i.id,s=a);let c=new r.NOn;return c.transition=new r.TBZ(s),[(0,o.l)(e,d,c)]}adjustVideoSegmentTransition(e,t,i,r,n){let a=[];if(!(0,l.he)(i))return[];if(!r&&!n)return this.adjustVideoSegmentTransitionNoOrigin(e,t,i);let o=i.targetTimerange.duration,s=!1,d=this.findPrevSegment(t,i),c=[];d&&(0,l.he)(d)&&(c=this.adjustVideoTransitionByDuration(e,d,o))[0]&&!d.transition&&(s=!0);let u=this.adjustVideoTransitionByDuration(e,i,o);return u[0]&&!i.transition&&(s=!0),s&&this.showClearUselessTransitionToastIfNeeded(t),c[1]&&a.push(c[1]),u[1]&&a.push(u[1]),a}adjustVideoSegmentTransitionNoOrigin(e,t,i){let r=i.targetTimerange.duration,n=this.findPrevSegment(t,i),a=[];if(n){let t=this.adjustVideoTransitionByDuration(e,n,r);t[1]&&a.push(t[1])}let o=this.adjustVideoTransitionByDuration(e,i,r);return o[1]&&a.push(o[1]),a}adjustVideoSpeedSegmentTransition(e,t,i,n,a,s){let d=[];if(!n||!a)return this.adjustVideoSpeedSegmentTransitionNoOrigin(e,t,i,s);let c=this.adjustVideoSegmentTransition(e,t,i,n,a);if(d.push(...c),!s&&i&&(0,l.he)(i)&&i.transition){let n=new r.NOn;n.transition=null,d.push((0,o.l)(e,i.id,n)),this.showClearUselessTransitionToastIfNeeded(t)}return d}adjustVideoSpeedSegmentTransitionNoOrigin(e,t,i,n){let a=[],s=this.adjustVideoSegmentTransition(e,t,i);if(a.push(...s),!n&&i&&(0,l.he)(i)&&i.transition){let n=new r.NOn;n.transition=null,a.push((0,o.l)(e,i.id,n,t.id)),this.showClearUselessTransitionToastIfNeeded(t)}return a}adjustVideoTransitionByDuration(e,t,i){if(!(0,l.he)(t))return[void 0,void 0];let o=t.transition,d=(0,n.Cm)(e.getAllTracks(),t.id),c=null;if(!o)return[void 0,void 0];let m=i/2n/100n*100n;if(m=new s.O1(e.getDraftProperty().fps/2).gen(m).head,c=Object.assign({},o),i<2e5){let i=new r.NOn;i.transition=null;let n=(0,l.xX)({__segment_struct_type:t.__segment_struct_type});return u.T.pick(t,i,n),[c,{type:a.x.UpdateSegment,params:{draftId:e.getDraftId(),trackId:d.trackId,segmentId:t.id,segmentDelta:i,sourceSegmentDelta:n,trackIndex:d.trackIndex}}]}if(o.duration>m){let i=new r.NOn;i.transition=new r.TBZ,i.transition.duration=m;let n=(0,l.xX)({__segment_struct_type:t.__segment_struct_type});return u.T.pick(t,i,n),[c,{type:a.x.UpdateSegment,params:{draftId:e.getDraftId(),trackId:d.trackId,segmentId:t.id,segmentDelta:i,sourceSegmentDelta:n,trackIndex:d.trackIndex}}]}return[void 0,void 0]}adjustVideoSegmentTransitionMaintrackAdsorbOff(e,t,i,n){let a=[];if(!(0,l.he)(i))return[];if(0===n){let n=this.findPrevSegment(t,i);if(n&&(0,l.he)(n)&&n.transition){let s=n.transition.duration,l=n.targetTimerange.start+n.targetTimerange.duration-s/2n,d=i.targetTimerange.start;if(d>l+s){let i=new r.NOn;i.transition=null,a.push((0,o.l)(e,n.id,i)),this.showClearUselessTransitionToastIfNeeded(t)}else{let t=new r.NOn;t.targetTimerange=new r.zel,t.targetTimerange.start=d-(d-l+s/2n),t.targetTimerange.duration=i.targetTimerange.duration,a.push((0,o.l)(e,i.id,t)),a.push(...c.c8.updateDraftDurationIfNeeded(e))}}}else if(1===n){let n=this.findNextSegment(t,i);if(n&&i.transition){let s=i.transition.duration,{targetTimerange:l}=i,d=l.start+l.duration-s/2n,u=n.targetTimerange.start;if(u>d+s){let n=new r.NOn;n.transition=null,a.push((0,o.l)(e,i.id,n)),this.showClearUselessTransitionToastIfNeeded(t)}else{let t=new r.NOn;t.targetTimerange=new r.zel,t.targetTimerange.start=u-(u-d+s/2n),t.targetTimerange.duration=n.targetTimerange.duration,a.push((0,o.l)(e,n.id,t)),a.push(...c.c8.updateDraftDurationIfNeeded(e))}}}return a}findPrevSegment(e,t){if(!e)return null;let i=null,r=null;for(let n of e.segments){if(n.id===t.id){i=r;break}r=n}return i?i:null}findNextSegment(e,t){if(!t)return null;let i=null,r=!1;for(let n of e.segments){if(r){i=n;break}n.id===t.id&&(r=!0)}return i&&(0,l.he)(i)?i:null}clearUselessTransition(e,t){if(!e||!t||t.type!==r.pNd.TrackTypeVideo)return[];let{segments:i}=t;if(i.length<=0)return[];let n=[];if(i.length<=1){let a=i[0];if(!a||!(0,l.he)(a))return[];if(a.transition){let i=new r.NOn;i.transition=null,n.push((0,o.l)(e,a.id,i)),this.showClearUselessTransitionToastIfNeeded(t)}return n}let a=!1,s=i[i.length-1];if(s&&(0,l.he)(s)&&s.transition){let t=new r.NOn;t.transition=null,n.push((0,o.l)(e,s.id,t)),a=!0}for(let t=0;t<i.length-1;t++){let s=null,c=null;if(t<i.length&&(s=i[t]),t+1<i.length&&(c=i[t+1]),!s||!(0,l.he)(s)||!c||!(0,l.he)(c))continue;let u=s.targetTimerange.duration,m=c.targetTimerange.duration,h=u<m?u:m,f=this.adjustVideoTransitionByDuration(e,s,h);if(f[1]&&n.push(f[1]),!s.transition)continue;let p=s.transition.duration/2n,g=s.targetTimerange.start+s.targetTimerange.duration,y=g-p+s.transition.duration,_=c.targetTimerange.start;if(!e.getDraftProperty().renderIndexTrackModeOn&&s.renderIndex!==c.renderIndex){let t=d.eK.prototype.ensureInSameRenderLayer(e,s,c);if(t)t instanceof Array&&n.push(...t);else{let t=new r.NOn;t.transition=null,n.push((0,o.l)(e,s.id,t)),a=!0}}if(_>y){let t=new r.NOn;t.transition=null,n.push((0,o.l)(e,s.id,t)),a=!0}else if(c.targetTimerange.start!==g){let t=new r.NOn;t.targetTimerange=new r.zel,t.targetTimerange.start=g,t.targetTimerange.duration=c.targetTimerange.duration,n.push((0,o.l)(e,c.id,t))}if(c.transition&&t+1===i.length-1){let t=new r.NOn;t.transition=null,n.push((0,o.l)(e,c.id,t)),a=!0}}return a&&this.showClearUselessTransitionToastIfNeeded(t),n}clearTracksUselessTransition(e,t){let i=[];for(let n of t){if(n.type===r.pNd.TrackTypeVideo)i.push(...this.clearUselessTransition(e,n))}return i}clearUselessTransitionAndAdjustTrackStartTime(e){let t=e.getTracksByTypes([r.pNd.TrackTypeVideo]),i=[];for(let n of t){let t=!1;for(let e of n.segments)if((0,l.he)(e)&&e.transition){t=!0;break}if(n.type!==r.pNd.TrackTypeVideo||!t)continue;i.push(...this.clearUselessTransition(e,n));let a=c.c8.adjustTrackTargetStartTime(e,n);a&&i.push(...a)}return i}clearUselessTransitionAndAdjustDuration(e,t,i){let r=[];for(let[n,a]of t.entries()){if(!n)continue;let t=[],s=c.c8.adjustTrackTargetStartTime(e,n);for(let l of(Array.isArray(s)&&t.push(...s),t.push(...this.clearUselessTransition(e,n)),(0,o.W)(t,i),a)){if(!l)continue;let t=this.findNextSegment(n,l);if(t){let i=0n;i=t.targetTimerange.duration;let n=this.adjustVideoTransitionByDuration(e,l,i);n[1]&&r.push(n[1])}}let l=c.c8.adjustTrackTargetStartTime(e,n);(null==l?void 0:l.length)&&r.push(...l)}return r}showClearUselessTransitionToastIfNeeded(e){e.flag===r.w9k.FlagSubVideo&&this.showClearUselessTransitionToast()}showClearUselessTransitionToast(){}}},203447:function(e,t,i){i.d(t,{C:function(){return m}});var r=i(211561),n=i(81649),a=i(448218),o=i(49667),s=i(481631),l=i(567142),d=i(340294);let c=e=>!(0===e||Number.isNaN(e))&&!!Number.isFinite(e)&&!0,u=(e,t,i)=>Math.pow(1-i,3)*e+3*Math.pow(1-i,2)*i*e+3*(1-i)*Math.pow(i,2)*t+Math.pow(i,3)*t;class m{getCurveSpeedUtils(){return new l.H}getCurveAveSpeed(e){if(e.length<2)return 1;let t=[],i=[];for(let r of e)t.push(r.x),i.push(r.y);let r=this.getCurveSpeedUtils();return r.setCurveSpeed(t,i),r.getAveCurveSpeed()}adjustVideoAnimationDuration(e,t,i){if(!(0,s.he)(t))return;let{animations:n,targetTimerange:o}=t;if(n){let s=n.animations.map(e=>e.clone()),l=o.duration;for(let e of s){let t=d.pM.max([d.pM.times(e.duration,i,"bigint"),100000n],"bigint");l-t<0?t=0n:l-=t,e.duration=t,e.start=d.pM.times(e.start,i,"bigint")}let c=new r.NOn,u=new r.PA;return u.animations=s,c.animations=u,(0,a.l)(e,t.id,c)}}adjustVideoEffectsTimeRange(e,t,i){var n;if(!(0,s.he)(t))return;let o=(null!==(n=t.videoEffects)&&void 0!==n?n:[]).map(e=>e.clone());for(let t of o)this.adjustTimeRangeWithSpeed(e,t.timeRange,i),this.adjustTimeRangeWithSpeed(e,t.applyTimeRange,i);let l=new r.NOn;return l.videoEffects=o,(0,a.l)(e,t.id,l)}adjustTimeRangeWithSpeed(e,t,i){let r=new n.O1(e.getDraftProperty().fps);if(!t)return;let a=d.pM.times(t.start,i,"bigint"),s=d.pM.times(t.start+t.duration,i,"bigint");o.vc.FEATURE_FRAME_TIME_AUTO_ALIGNMENT&&(a=r.gen(a).round,s=r.gen(s).round),t.start=a,t.duration=s-a}splitCurveSpeedPoints(e,t,i,n,a){let o=[],s=[],{speedPoints:l}=n;if(e<1e-6||0===l.length)return[o,l];let m=BigInt(this.mapSeqDeltaToTrimDelta(e,i,l)),h=d.pM.div(m,t,"number"),f=[],p=[];for(let e of l)e.x<h?f.push(e):p.push(e);if(0===f.length||0===p.length)return[o,l];if(!c(1/h)){let e=new r.nR_;e.x=0,e.y=l[0].y,o.push(e);let t=new r.nR_;return t.x=1,t.y=l[0].y,o.push(t),[o,n.speedPoints]}if(!c(1/(1-h))){let e=new r.nR_;e.x=0,e.y=l[l.length-1].y,s.push(e);let t=new r.nR_;return t.x=1,t.y=l[l.length-1].y,s.push(t),[n.speedPoints,s]}let g=f[f.length-1],y=p[0],_=(h-g.x)/(y.x-g.x),T=u(g.y,y.y,_),v=1/h;for(let e of f){let t=new r.nR_;t.x=e.x*v,t.y=e.y,o.push(t)}let I=1/(1-h);for(let e of p){let t=new r.nR_;t.x=(e.x-h)*I,t.y=e.y,s.push(t)}if(o.length>0){let e=new r.nR_;e.x=1,e.y=T,o.push(e)}if(s.length>0){let e=new r.nR_;e.x=0,e.y=T,s.unshift(e)}return[o,s]}mapSeqDeltaToTrimDelta(e,t,i){if(0===i.length)return-1n;let r=[],n=[];for(let e of i)r.push(e.x),n.push(e.y);let a=this.getCurveSpeedUtils();return a.setCurveSpeed(r,n),a.setSeqDuration(t),a.mapSeqDeltaToTrimDelta(e)}mapTrimDeltaToSeqDelta(e,t,i){if(0===i.length)return-1n;let r=[],n=[];for(let e of i)r.push(e.x),n.push(e.y);let a=this.getCurveSpeedUtils();return a.setCurveSpeed(r,n),a.setSeqDuration(t),a.mapTrimDeltaToSeqDelta(e)}constructor(){this._utils=null}}}}]);