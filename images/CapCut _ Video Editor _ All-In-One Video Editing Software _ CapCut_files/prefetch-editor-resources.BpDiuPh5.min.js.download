!function(){"use strict";let e,r="1.0.1.5131",t=[],o=!1,s=(e,r)=>{window.ccWebSlardar?window.ccWebSlardar(e,r):(t.push({method:e,params:r}),o||(o=!0,(()=>{let e=10,r=setInterval(()=>{e--,window.ccWebSlardar?(t.forEach(e=>{let{method:r,params:t}=e;window.ccWebSlardar(r,t)}),t=[],clearInterval(r)):e||clearInterval(r)},1e3)})()))},a={info:(...e)=>{console.info("[side-code]",...e)},report:(e,t,o)=>{console.info("[side-code]",e,t),s("sendEvent",{name:e,categories:{side_code_scm:r,...t},metrics:o})},error:(...e)=>{console.error("[side-code]",...e),s("captureException",{error:e})}},n=async(e,r,t)=>{var o;let s;if((e=>{let r=localStorage.getItem("prefetch_versions");return null!==r&&r.includes(e)})(r)||!Array.isArray(e))return;t.report("side_code_prefetch_resource_begin",{version:r,resourceCount:e.length});let a=0;if(e.length>0)for(let r of e)try{await fetch(r)}catch(e){a+=1,t.error(e)}t.report("side_code_prefetch_resource_success",{version:r,failedResourceCount:a,resourceCount:e.length}),o=r,null===(s=localStorage.getItem("prefetch_versions"))&&(s="#"),(s=`${o};${s}`).length>1e3&&s.slice(0,s.lastIndexOf(";")),localStorage.setItem("prefetch_versions",s)};var c,i=((e=i||{}).editor_page_resource="/editor-page-resource.json",e.editor_wasm_resource="/editor-wasm-resource.json",e);let l=async e=>{let r=await fetch(i.editor_page_resource,{credentials:"same-origin"}),t=r.headers.get("content-type");if(200!==r.status||"string"!=typeof t||!t.includes("application/json"))return[];let{list:o,scm:s}=await r.json(),a=Array.isArray(o)?o.length:0;return e.report("side_code_get_page_resource_success",{length:a,resource_list_scm:s}),a>0&&await n(o,`editor_page_${s}`,e),o},d=async e=>{let r=await fetch(i.editor_wasm_resource,{credentials:"same-origin"}),t=r.headers.get("content-type");if(200!==r.status||"string"!=typeof t||!t.includes("application/json"))return[];let{list:o,scm:s}=await r.json(),a=Array.isArray(o)?o.length:0;return e.report("side_code_get_wasm_resource_success",{length:a,resource_list_scm:s}),a>0&&await n(o,`editor_wasm_${s}`,e),o},{searchParams:_}=new URL(window.location.href),u=!!_.get("debug_prefetcher"),f=u?1e4:6e5,p=null,w=async(e,r,t=!0)=>{try{e.report("side_code_start_prefetch",{times:r});let o=performance.now();if(p){let t=performance.now()-o;e.report("side_code_end_prefetch",{times:r,duration:t,newTask:"false"})}else{(p=Promise.all([l(e),d(e)])).finally(()=>{p=null}),await p;let t=performance.now()-o;e.report("side_code_end_prefetch",{times:r,duration:t,newTask:"true"})}t&&setTimeout(()=>w(a,r+1),f)}catch(t){p=null,e.report("side_code_failed_prefetch",{times:r}),e.error(t)}};setTimeout(()=>{w(a,1),a.info("SCM",r)},u?1e4:12e4),null==(c=null==window?void 0:window.addEventListener)||c.call(window,"beforeunload",()=>{w(a,-1,!1),a.info("prefetch before unload, SCM:",r)})}();