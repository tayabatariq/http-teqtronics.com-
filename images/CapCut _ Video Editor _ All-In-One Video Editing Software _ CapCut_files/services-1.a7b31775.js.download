"use strict";(globalThis.__LOADABLE_LOADED_CHUNKS__=globalThis.__LOADABLE_LOADED_CHUNKS__||[]).push([["8386"],{438536:function(e,t,r){r.d(t,{Z:function(){return i}});let i={"guide-wapper":"guide-wapper-ihMVbx",guideWapper:"guide-wapper-ihMVbx","pointer-events-none":"pointer-events-none-NnQ5mP",pointerEventsNone:"pointer-events-none-NnQ5mP","guide-trigger":"guide-trigger-T3rAuT",guideTrigger:"guide-trigger-T3rAuT","service-guide-container":"service-guide-container-jKixgM",serviceGuideContainer:"service-guide-container-jKixgM","guide-close-icon":"guide-close-icon-UuoP3H",guideCloseIcon:"guide-close-icon-UuoP3H","guide-placeholder-without-mask":"guide-placeholder-without-mask-J7PqcH",guidePlaceholderWithoutMask:"guide-placeholder-without-mask-J7PqcH","guide-placeholder":"guide-placeholder-MklTIf",guidePlaceholder:"guide-placeholder-MklTIf","guide-placeholder-after":"guide-placeholder-after-VK4ZN9",guidePlaceholderAfter:"guide-placeholder-after-VK4ZN9","guide-placeholder-before":"guide-placeholder-before-SKrDXi",guidePlaceholderBefore:"guide-placeholder-before-SKrDXi","hover-tips-triangle":"hover-tips-triangle-bSBPjR",hoverTipsTriangle:"hover-tips-triangle-bSBPjR"}},941865:function(e,t,r){r.d(t,{Z:function(){return i}}),r(772322),r(218571);let i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDggMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGlkPSJQb2x5Z29uIDEiIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2JfNDYxMl8xOTAyOSkiPgo8cGF0aCBkPSJNMC42NzIxNDcgMTAuNTA1MkMtMC4yMjQwNDggMTEuMzAwOCAtMC4yMjQwNDggMTIuNjk5MiAwLjY3MjE0NyAxMy40OTQ4TDUuNjg4MjMgMTguNDU5NEM3LjE2NzYgMTkuOTIzNiA4IDIxLjkxODYgOCAyNEw4IDYuOTkzODJlLTA3QzggMi4wODE0NCA3LjE2NzYxIDQuMDc2NDQgNS42ODgyMyA1LjU0MDYyTDAuNjcyMTQ3IDEwLjUwNTJaIiBmaWxsPSIjM0I0NTU5Ii8+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfYl80NjEyXzE5MDI5IiB4PSItMjAiIHk9Ii0yMCIgd2lkdGg9IjQ4IiBoZWlnaHQ9IjY0IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUdhdXNzaWFuQmx1ciBpbj0iQmFja2dyb3VuZEltYWdlRml4IiBzdGREZXZpYXRpb249IjEwIi8+CjxmZUNvbXBvc2l0ZSBpbjI9IlNvdXJjZUFscGhhIiBvcGVyYXRvcj0iaW4iIHJlc3VsdD0iZWZmZWN0MV9iYWNrZ3JvdW5kQmx1cl80NjEyXzE5MDI5Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9iYWNrZ3JvdW5kQmx1cl80NjEyXzE5MDI5IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo="},442758:function(e,t,r){r.d(t,{b:function(){return n}});var i=r(433679);class n{createAudioPlayer(e){return new i.D(e)}}},498166:function(e,t,r){r.d(t,{g:function(){return o}});var i=r(402655),n=r(929818);class o extends i.JT{createContextView(e,t){let{id:r,component:i}=e,o=this._idToContextView.get(r);return o&&o.unmount(),(o=new n.R(e,t)).mount(),this._idToContextView.set(r,o),o.onUnmount(()=>{o&&this._idToContextView.delete(o.id)}),o}unmountContextView(e){return this._unmountContextView(e)}_unmountContextView(e){let t=this._idToContextView.get(e);t&&t.unmount()}getContextViewById(e){return this._idToContextView.get(e)}constructor(...e){super(...e),this._idToContextView=new Map}}},250851:function(e,t,r){r.d(t,{r:function(){return i}});let i=(0,r(335290).yh)("upload-link-service")},587232:function(e,t,r){r.d(t,{S:()=>v});var i=r("789786"),n=r("587892"),o=r("402655"),s=r("690613"),a=r("800788"),c=r("82797"),u=r("714619"),l=r("426020"),d=r("127830"),_=r("866006"),h=r("315401");class p extends o.JT{get url(){return this._params.url}async _getUploadFileAndCount(){await this._mutex.acquire();try{let e=await this._params.uploadLinkRepository.getUploadInfo({workspaceId:this._params.workspaceId});if(!e.ok)return;let t=e.value.fileCount;if(this._params.url!==e.value.uploadLink&&(this._params.url=e.value.uploadLink,this._onDidLinkUpdate.fire(this._params.workspaceId)),t>this._uploadAssetsCount){let e=t-this._uploadAssetsCount,r=await this._params.userMaterialsService.getMaterials((0,_.ib)({count:Math.floor(11*Math.random())+t,assetSource:h.ZS.ALL,orderBy:"modify_time",order:"desc",workspaceId:this._params.workspaceId},[]));if(!r.ok)return;let i=[],n=r.value.value.reduce((r,n,o)=>r.length>=e||o>=t?r:((0,a.Y2)(n.assetType===d.pS.Material&&n.sourceType===l.ov.EverCloud),n.updatedAt>=this._latestUpdatedAt&&(r.push(n),this._uploadAssetsCount++),i.push(n.updatedAt),r),[]);this._latestUpdatedAt=Math.max(...i,this._latestUpdatedAt),this._onDidUpload.fire({workspaceId:this._params.workspaceId,uploadedCount:this._uploadAssetsRecorder.size,newUploadedCount:n.length,newUploadMaterialIds:n.map(e=>((0,a.Y2)(e.sourceType===l.ov.EverCloud),e.assetId))})}}finally{this._mutex.release()}}dispose(){r.g.clearInterval(this._timer),super.dispose()}constructor(e){var t;super(),this._params=e,this._uploadAssetsRecorder=new Set,this._uploadAssetsCount=0,this._latestUpdatedAt=0,this._mutex=new u.w,this._onDidUpload=this._store.add(new n.Q),this.onDidUpload=this._onDidUpload.event,this._onDidLinkUpdate=this._store.add(new n.Q),this.onDidLinkUpdate=this._onDidLinkUpdate.event,this._timer=setInterval(()=>{this._getUploadFileAndCount()},null!==(t=this._params.loopDuration)&&void 0!==t?t:3e3)}}var g=r("273238");class v extends o.JT{async registerUploadLink(e){var t=this;(0,a.Y2)(!this._registerUploadTask.has(e.workspaceId),"this workspace link is register, pleace check the logic");let r=await this._uploadLinkRepository.registerUploadLink({workspaceId:e.workspaceId});if(!r.ok)return r;let i=new p({workspaceId:e.workspaceId,url:r.value,userMaterialsService:this._userMaterialsService,uploadLinkRepository:this._uploadLinkRepository});return i.onDidLinkUpdate(function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];t._onDidLinkUpdate.fire(...r)}),i.onDidUpload(function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];t._onDidUpload.fire(...r)}),this._registerUploadTask.set(e.workspaceId,i),(0,s.oW)({url:r.value})}getRegisteredUploadLink(e){let t=this._registerUploadTask.get(e);return t?(0,s.oW)({url:t.url}):(0,s.wf)(-1,"not found register link")}unRegisterUploadLink(e){let t=this._registerUploadTask.get(e);(0,a.Y2)(t,"this workspace link is not register, please check the logic"),t.dispose(),this._registerUploadTask.delete(e)}constructor(e){super(),this._userMaterialsService=e,this._uploadLinkRepository=new c.n,this._registerUploadTask=new Map,this._onDidLinkUpdate=this._store.add(new n.Q),this.onDidLinkUpdate=this._onDidLinkUpdate.event,this._onDidUpload=this._store.add(new n.Q),this.onDidUpload=this._onDidUpload.event}}v=(0,i.gn)([(0,i.fM)(0,g.b),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===g.b?Object:g.b])],v)},672621:function(e,t,r){r.d(t,{b:function(){return i}});let i={GET_MATERIAL_LIST:"/lv/v1/asset/list",GET_MATERIALS_BY_IDS:"/lv/v1/asset/detail",COPY_ASSET:"/lv/v1/asset/copy",DELETE_MATERIALS:"/lv/v1/asset/delete",QUERY_PROCESS:"/lv/v1/asset/query_process",CREATE_ASSET:"/lv/v1/asset/create",GET_ASSET_QUERY:"/lv/v1/asset/query",LABEL_AS_EXPORTED:"/lv/v1/asset/label_as_exported",PROMOTE_ASSET:"/lv/v1/ever_photo/promote_asset",RENAME_ASSET:"/lv/v1/asset/rename"}},273238:function(e,t,r){r.d(t,{F:function(){return o},b:function(){return s}});var i,n=r(335290);var o=((i={})[i.Insufficient=2408]="Insufficient",i);let s=(0,n.yh)("userMaterialsService")},28392:function(e,t,r){r.d(t,{x:function(){return b}});var i=r(789786),n=r(55449),o=r(587892),s=r(402655),a=r(434316),c=r(800788),u=r(961087),l=r(690465),d=r(782350),_=r(396190),h=r(31463),p=r(685795),g=r(200247),v=r(596112),f=r(521840),m=r(154881),y=r(374904),w=r(885692),k=r(315401);class b extends s.JT{onReady(e){let t=!1;this.isReady&&setTimeout(()=>{if(!t)e()});let r=this._onReady.event(e);return{dispose:()=>{t=!0,r.dispose()}}}get isReady(){return this._initAwaitLocker.hasBeenDone}getBaseEvercloud(){return m.m7}async getEvercloudInstance(e){await this._initAwaitLocker.awaitForInit();let t=this.workspaceService.getWorkspace(e);return m.m7.getSdkInstance({spaceId:t.space_id,dcName:t.space_idc,netconf:{base:t.space_host,media:t.space_res_host}})}disposeEvercloudInstance(e){let t=this.workspaceService.getWorkspace(e);m.m7.destroySdk(t.space_id)}async getMaterials(e){await this._initAwaitLocker.awaitForInit();let t=this.workspaceService.getWorkspace(e.config.workspaceId);return e.config.spaceId=t.space_id,this._userMaterialsRepository.getMaterials(e)}async getUserAssets(e){return await this._initAwaitLocker.awaitForInit(),this._userMaterialsRepository.getUserAssets(e)}async getOriginalUserAssets(e){return await this._initAwaitLocker.awaitForInit(),this._userMaterialsRepository.getOriginalUserAssets(e)}getMaterialsByIds(e){let t=e.fetchMode===k.$d.WaitForSync?{retryTimes:1,delay:1e3}:void 0;return(0,f.a)(()=>this._userMaterialsRepository.getMaterialsByIds(e),t)}tryGetMaterialsByIds(e){return this._userMaterialsRepository.tryGetMaterialsByIds(e)}copyMaterialToWorkspace(e){return this._userMaterialsRepository.copyMaterialToWorkspace(e)}copyAsset(e){return this._userMaterialsRepository.copyAsset(e)}deleteMaterials(e){return this._userMaterialsRepository.deleteMaterials(e)}renameAsset(e){return this._userMaterialsRepository.renameAsset(e)}createAsset(e){return this._userMaterialsRepository.createAsset(e)}labelAssetsAsExported(e){return this._userMaterialsRepository.labelAssetsAsExported(e)}promoteAsset(e){return this._userMaterialsRepository.promoteAsset(e)}_initWithLoginState(){var e=this;(0,c.Y2)(!this._initAwaitLocker.isIniting||!this._initAwaitLocker.hasBeenDone,"bootstrap is call more than once"),this._initAwaitLocker.startToInit();let t=this.accountService.userProfile;m.m7.setOptions({is_boe:!1,user_dc_name:this._httpApiSettingService.userLocationInfo.idcEnum,reqDomain:{web_domain:this._httpApiSettingService.getRequestURL({domainType:l.Y.DEFAULT,path:""})},user_id:t.uid,level:"error",disable_start_sync_loop:!0,log_report:{log_to_console_only:!1,report_src_file:!0}}),m.m7.setTeaReporter({event:function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];e.reporterService.reportBusinessEvent(...r)},getVar:(e,t,r)=>this.teaAdapterService.getABTestVar(e,t).then(e=>(r(e),e))}),!m.m7.slardarReporter&&m.m7.setSlardarReporter(e=>{let{level:t=p.T.INFO,content:r,extra:i,type:n,eventName:o}=e;n&&"log"!==n?"event"===n&&this._slardarService.sendEvent(o,i):this._slardarService.sendLog(t,r,i)}),!this._initAwaitLocker.hasBeenDone&&this._initAwaitLocker.initDone(),this._onReady.fire()}async _initWithUnLoginState(){m.m7.setNoSignOptions({uniqueId:await this.teaAdapterService.getWebId(),userRegion:this._httpApiSettingService.userLocationInfo.region,isBoe:!this.environmentService.isProd,newIdc:this._httpApiSettingService.userLocationInfo.idc,reqDomain:{web_domain:this._httpApiSettingService.getRequestURL({domainType:l.Y.DEFAULT,path:""})},imgUploader:{getSliceFunc:e=>e>1048576e3?0xa00000:5242880}}),!this.accountService.hasLogin&&(!this._initAwaitLocker.hasBeenDone&&this._initAwaitLocker.initDone(),this._onReady.fire())}constructor(e,t,r,i,n,s,c,l,d){super(),this._instantiationService=t,this.accountService=r,this.workspaceService=i,this.environmentService=n,this.reporterService=s,this.teaAdapterService=c,this._httpApiSettingService=l,this._slardarService=d,this._onReady=this._store.add(new o.Q),this._initAwaitLocker=new u.G,e&&m.m7.prefetchWasmCode(),m.m7.setCachePlugin(new y.dV),this._userMaterialsRepository=this._instantiationService.createInstance(w.A),i.initialize((0,a.fC)()),i.available?this._initWithLoginState():i.onDidWorkspaceChange(()=>{this._initWithLoginState()}),this._initWithUnLoginState()}}b=(0,i.gn)([(0,i.fM)(1,n.T),(0,i.fM)(2,g.D),(0,i.fM)(3,d.W),(0,i.fM)(4,_.Y),(0,i.fM)(5,h.m),(0,i.fM)(6,v.w),(0,i.fM)(7,l.x),(0,i.fM)(8,p.L),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Boolean,void 0===n.T?Object:n.T,void 0===g.D?Object:g.D,void 0===d.W?Object:d.W,void 0===_.Y?Object:_.Y,void 0===h.m?Object:h.m,void 0===v.w?Object:v.w,void 0===l.x?Object:l.x,void 0===p.L?Object:p.L])],b)},34159:function(e,t,r){r.d(t,{V:()=>p});var i=r("800788"),n=r("374904"),o=r("532611"),s=r("426020"),a=r("73435"),c=r("180685"),u=r("127830");function l(e){var t,r;let i;return(0,o.jL)(null!==(t=null==e?void 0:e.meta)&&void 0!==t?t:{})&&(i=e.meta.key),{sourceType:s.ov.EverCloud,assetType:u.pS.Material,url:null!==(r=e.downloadUrl)&&void 0!==r?r:"",meta:e.sourceData.meta,key:e.md5,assetId:e.id,filename:e.name,fileType:s.YB.File,owner:e.owner,md5:e.md5,mime:e.mime,size:e.size,updatedAt:e.updatedAt,subType:e.subType,decryptKey:i}}function d(e){var t,r,i;let o=(null==e?void 0:e.previewUrl)?{url:e.previewUrl,key:e.previewKey}:(0,a.i)(e.width,e.height),u=(null==e?void 0:e.sprit)?function(e){var t;if(!!e&&null!==e.detail_infos&&(null==e?void 0:null===(t=e.common_info)||void 0===t?void 0:t.single_frame_height)!==0)return{common:{singleFrameHeight:e.common_info.single_frame_height,singleFrameWidth:e.common_info.single_frame_width,totalSetNum:e.common_info.total_set_num},details:e.detail_infos.map(e=>({frameCount:e.frame_count,imageWidth:e.image_width,imageHeight:e.image_height,url:e.url,encryptedBucketKey:"",encryptedKey:e.encrypt_key}))}}(e.sprit):(0,c.y)({url:null!==(r=e.previewUrl)&&void 0!==r?r:"",key:e.previewKey,width:e.width,height:e.height});return{...l(e),fileType:s.YB.Video,cover:o,width:e.width,height:e.height,duration:(null!==(i=e.duration)&&void 0!==i?i:0)/1e3,thumb:u,isVideoTranscoding:0===e.transcodeStatus,isVideoCompletion:null===(t=e.filterList)||void 0===t?void 0:t.includes(n.VW.FILM_ASSET)}}function _(e){let t=Object.entries(e.imageTranscodeInfo||{}).reduce((e,t)=>{let[r,i]=t,{width:n,height:o,preview_url:s,key:a,status_code:c}=i;return 0===c&&s&&(e[r.endsWith("p")||"origin"===r?r:`${r}p`]={url:s,width:n,height:o,key:a}),e},{}),r=(()=>{var r;if(e.previewUrl)return{url:e.previewUrl,key:e.previewKey};let i=null===(r=Object.values(t))||void 0===r?void 0:r[0];return i?{url:i.url,key:i.key}:(0,a.i)(e.width,e.height)})();return{...l(e),fileType:s.YB.Image,cover:r,width:e.width,height:e.height,isImgTranscoding:e.imageAsyncResize,imgTranscodeInfo:t}}function h(e){var t;return{...l(e),fileType:s.YB.Audio,duration:(null!==(t=e.duration)&&void 0!==t?t:0)/1e3,isAudioTranscoding:0===e.transcodeStatus}}function p(e){if((0,o.Ii)(e)){if((0,o.JI)(null==e?void 0:e.meta))switch(e.type){case"image":return _(e);case"video":return d(e);case"audio":return h(e)}return l(e)}return e instanceof n.qZ?d(e):e instanceof n.Lt?h(e):e instanceof n.or?_(e):e instanceof n.Is?l(e):void(0,i.ss)("no expect file type")}},838348:function(e,t,r){r.d(t,{C:function(){return c}});var i=r(800788),n=r(426020),o=r(127830),s=r(748177);function a(e){return e.replace("http:","https:")}function c(e){return e.video?function(e){var t,r;return{sourceType:n.ov.PublicSpace,assetType:o.pS.Material,vid:null===(t=e.video)||void 0===t?void 0:t.source,filename:e.video.file_name,fileType:n.YB.Video,mime:e.video.mime,subType:(0,s.m)(e.video.file_name),size:e.video.size,cover:{url:e.video.cover},width:e.video.width,height:e.video.height,duration:e.video.duration,isVideoTranscoding:!1,videoTranscodeInfo:e.video.video_infos.reduce((e,t)=>(e[t.definition]={url:a(t.url),key:t.key},e),{}),thumb:(null===(r=e.video)||void 0===r?void 0:r.thumb)?{common:{singleFrameHeight:e.video.thumb.common_info.single_frame_height,singleFrameWidth:e.video.thumb.common_info.single_frame_width,totalSetNum:e.video.thumb.common_info.total_set_num},details:e.video.thumb.detail_infos.map(e=>({frameCount:e.frame_count,imageWidth:e.image_width,imageHeight:e.image_height,url:a(e.url)}))}:void 0}}(e):e.audio?function(e){var t;let r=e.audio.audio_infos[0];return{vid:null===(t=e.audio)||void 0===t?void 0:t.source,sourceType:n.ov.PublicSpace,assetType:o.pS.Material,filename:e.audio.file_name,subType:(0,s.m)(e.audio.file_name),fileType:n.YB.Audio,size:e.audio.size,duration:e.audio.duration,isAudioTranscoding:!1,audioTranscodeInfo:{"128kb":{url:a(r.url),key:r.key}}}}(e):e.image?function(e){var t;let r=e=>({url:a(e)});return{sourceType:n.ov.PublicSpace,assetType:o.pS.Material,vid:null===(t=e.image)||void 0===t?void 0:t.source,fileType:n.YB.Image,size:e.image.size,isImgTranscoding:!1,cover:{url:r(e.image.image_360p_url).url},imgTranscodeInfo:{"360p":r(e.image.image_360p_url),"720p":r(e.image.image_720p_url),"1080p":r(e.image.image_1080p_url),origin:r(e.image.origin)}}}(e):void(0,i.ss)("un expect file type")}},319525:function(e,t,r){r.d(t,{U:function(){return n}});var i=r(374904);function n(e){return(null==e?void 0:e.length)?(null==e?void 0:e.map(e=>i.NF[e].accept)).join(","):i.NF.allAccept}},58344:function(e,t,r){r.d(t,{H:function(){return n}});var i=r(702049);let n={get domain(){return i._L.getVar("web_domain")},baseURL:"/lv/v1",urlMap:{GET_VOD_TOKEN:"/upload_sign"}}},757907:function(e,t,r){r.d(t,{L:function(){return i}});let i=(0,r(335290).yh)("vod-service")},8441:function(e,t,r){r.d(t,{V:function(){return o}});var i=r(690613),n=r(36955);class o{async getVodToken(e){try{let t=await this._repository.getVodToken(e);return(0,i.oW)(t)}catch(e){return(0,i.wf)(-1,"data-service getVodToken api failed")}}constructor(){this._repository=new n.h}}},963727:function(e,t,r){r.d(t,{e:function(){return l},i:function(){return u}});var i=r(265445),n=r(999268),o=r(335290),s=r(800007),a=r(108628);async function c(){let e=new s.C;try{await e.load({coreURL:await (0,a.Wn)(new URL(r(538572),r.b).href,"text/javascript"),wasmURL:await (0,a.Wn)(new URL(r(931068),r.b).href,"application/wasm"),classWorkerURL:await (0,a.Wn)(new URL(r(616838),r.b).href,"text/javascript")})}finally{return e}}let u=(0,o.yh)("ffmpeg-driver-service");class l{async acquire(){await this._ensureSdk();let{unlock:e}=await (0,i.CQ)(this._runMutex);return{ffmpeg:this._sdk,release:e}}async _ensureSdk(){if(!this._sdk){if(!this._initMutex.tryLock()){await this._initMutex.lockShared(),this._initMutex.unLockShared();return}this._sdk=await c(),this._initMutex.unLock()}}constructor(){this._runMutex=new n.L,this._initMutex=new n.L}}},225698:function(e,t,r){r.d(t,{w:function(){return i}});let i=(0,r(335290).yh)("file-md5-calc-service")},688923:function(e,t,r){r.d(t,{q:function(){return s}});var i=r(789786),n=r(177010),o=r(55449);class s extends n.c{async _getModule(){return(await r.e("1990").then(r.bind(r,195954))).FileMd5CalcService}_getStaticArguments(){return[this._options]}constructor(e,t){super(t),this._options=e}}s=(0,i.gn)([(0,i.fM)(1,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof FileMd5CalcServiceOptions?Object:FileMd5CalcServiceOptions,void 0===o.T?Object:o.T])],s)},45942:function(e,t,r){r.d(t,{T:function(){return n}});var i=r(177010);class n extends i.c{async _getModule(){return(await r.e("2448").then(r.bind(r,87372))).GraphicToolkitService}}},176022:function(e,t,r){r.d(t,{W:function(){return s},c:function(){return o}});var i,n=r(335290);var o=((i={}).CancelBtn="CancelBtn",i.CancelLable="CancelLable",i.ConfirmBtn="ConfirmBtn",i.ConfirmLabel="ConfirmLabel",i.CloseIcon="CloseIcon",i.VisibleChange="VisibleChange",i.ClickMask="ClickMask",i.ClickFocus="ClickFocus",i.ClickTarget="ClickTarget",i);let s=(0,n.yh)("guide")},799587:function(e,t,r){r.d(t,{YE:function(){return c},nq:function(){return s},pX:function(){return a}});let i=e=>{if("[object Window]"!==e.toString()){let{ownerDocument:t}=e;return t&&t.defaultView||window}return e},n=e=>(!function(e){let t=i(e).Element;return e instanceof t||e instanceof Element}(e)?e.document:e.ownerDocument)||window.document,o=e=>n(e).documentElement,s=e=>"string"==typeof e?document.querySelector(e):"function"==typeof e?e():e,a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=s(e);if(!i)return null;let n=o(i),{scrollWidth:a,scrollTop:c}=n,{scrollHeight:u}=n;u=Math.min(u,n.getBoundingClientRect().height),n.style.overflow="hidden";let l=i.getBoundingClientRect(),{height:d,width:_,left:h}=l,p=l.top+(r?0:c);return t?{width:a,height:u,borderTopWidth:Math.max(p,0),borderBottomWidth:Math.max(u-d-p,0),borderRightWidth:Math.max(a-_-h,0),borderLeftWidth:Math.max(h,0)}:{width:_,height:d,left:h,top:p}};function c(e){return!(0===e.width&&0===e.height&&0===e.left&&0===e.top)}},114021:function(e,t,r){r.d(t,{o:function(){return o}});var i=r(786377),n=r(783055);let o=e=>{let{locale:t}=e;return new n.uL({locale:t,countryCode:void 0,getBrowserLang:()=>window.navigator.language,cookieGetter:i.Z.get.bind(i.Z),cookieSetter:i.Z.set.bind(i.Z)})}},554170:function(e,t,r){r.d(t,{E:function(){return l}});var i=r(789786),n=r(587892),o=r(402655),s=r(800788),a=r(691805),c=r(246457);let u="input_preference";class l extends o.JT{getInputPreference(){let e;let t=this.storageService.keyValue.query(u);return t.ok&&t.value?((0,s.ZB)(t.value),e=t.value):(e=a.Q.Ltr,this.storageService.keyValue.set(u,e)),e}setInputPreference(e){this.storageService.keyValue.set(u,e),this._onDidInputPreferenceChange.fire(e)}constructor(e){super(),this.storageService=e,this._onDidInputPreferenceChange=this._register(new n.Q),this.onDidInputPreferenceChange=this._onDidInputPreferenceChange.event}}l=(0,i.gn)([(0,i.fM)(0,c.d),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===c.d?Object:c.d])],l)},163003:function(e,t,r){r.d(t,{b:function(){return n}});var i=r(641547);class n extends i.m{dispose(){this._keybindingService.removeContext(this),super.dispose()}constructor(e,t,r={}){super(t,r),this._keybindingService=e}}},134392:function(e,t,r){r.d(t,{d:function(){return i}});let i=(0,r(335290).yh)("keybinding")},691065:function(e,t,r){r.d(t,{g:function(){return s}});var i=r(402655),n=r(597623),o=r(893354);class s extends i.JT{success(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addNotification(e,n.zb.Success,t,r)}info(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addNotification(e,n.zb.Info,t,r)}warning(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addNotification(e,n.zb.Warning,t,r)}error(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addNotification(e,n.zb.Error,t,r)}normal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addNotification(e,n.zb.Normal,t,r)}loading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addNotification(e,n.zb.Loading,t,r)}updateLoading(e,t,r){o.Z[n.zb.Loading]({id:e,content:t,...r})}close(e,t){this._removeNotificationFromList(e)}_addNotification(e,t,r,i){let n=this._findDuplicated(e);n?n.close():this._notificationList.length===this._maxNotifications&&this._notificationList[0].close();let s=Date.now(),a=o.Z[t]({content:e,onClose:()=>this._onClose(s),...i,style:r.style}),c=()=>{this._isNotificationExisted(s)&&(a(),this._removeNotificationFromList(s))};return this._notificationList.push({message:e,severity:t,id:s,close:c}),{closeNotification:c,id:s}}_findDuplicated(e){return this._notificationList.find(t=>t.message===e)}constructor(...e){super(...e),this._notificationList=[],this._maxNotifications=n.DT,this._isNotificationExisted=e=>-1!==this._notificationList.findIndex(t=>t.id===e),this._removeNotificationFromList=e=>{this._notificationList=this._notificationList.filter(t=>t.id!==e)},this._onClose=e=>{this._removeNotificationFromList(e)}}}},546723:function(e,t,r){r.d(t,{Tf:function(){return i},Yd:function(){return o},fs:function(){return n}});let i=["Meta","FrameInfo","LongTaskInfo","Named","Analysis"],n=["longTasks","frameTimes"],o={id:"performance-monitor",prefix:"performance-monitor"}},993757:function(e,t,r){r.d(t,{$:function(){return o}});var i=r(800788),n=r(461571);class o{setDraftPermission(e){this._draftPermission=e}getDraftPermission(){return(0,i.ZB)(this._draftPermission),this._draftPermission}constructor(){this._draftPermission=n.O.readonly}}},745299:function(e,t,r){r.d(t,{F:function(){return o},S:function(){return s}});var i,n=r(335290);var o=((i={})[i.Unknown=1]="Unknown",i[i.Cancel=2]="Cancel",i);let s=(0,n.yh)("public-space-upload")},763580:function(e,t,r){r.d(t,{u:function(){return c}});var i=r(789786),n=r(402655),o=r(690613),s=r(745299),a=r(273238);class c extends n.JT{upload(e){try{let t=Object.assign({},{times:0},e.retry),r=this._userMaterialsService.getBaseEvercloud(),i=`${e.file.name}-${Date.now().valueOf}-${Math.floor(1e3*Math.random())}`,n=0,a=()=>new Promise(async t=>{let a=await r.uploadAssetNoLogin({file:e.file,skipDuplicate:!0});this._uploadTaskMap.set(i,a),a.onProgress=t=>{let{done:r,total:i}=t;if(i){var o;n=Math.max(n,r/i),null===(o=e.onProgress)||void 0===o||o.call(e,n)}},a.onFinish=r=>{if(this._uploadTaskMap.delete(i),"success"===r.status&&(e.onFinish((0,o.oW)({fileId:r.fileId,uri:r.uri,vid:null==a?void 0:a.vid})),t((0,o.ly)())),"cancel"===r.status&&(e.onFinish((0,o.wf)(s.F.Cancel,"cancel upload")),t((0,o.ly)())),"error"===r.status){var n;let{code:i,msg:a}=null!==(n=r.errInfo)&&void 0!==n?n:{},c=null!=i?i:s.F.Unknown,u=(0,o.wf)(c,null!=a?a:"unknown failure.");[s.F.Cancel].includes(c)&&(e.onFinish(u),t((0,o.ly)())),t(u)}}}),c=async r=>{let n=await a();if(!n.ok){if(r>=t.times){e.onFinish(n),this._uploadTaskMap.delete(i);return}c(r+1);return}this._uploadTaskMap.delete(i)};return c(0),Promise.resolve((0,o.oW)(i))}catch(e){return Promise.resolve((0,o.wf)(s.F.Unknown,"upload Asset failure"))}}cancel(e){var t;return this._uploadTaskMap.has(e)?(null===(t=this._uploadTaskMap.get(e))||void 0===t||t.cancel(),(0,o.ly)()):(0,o.wf)(-1,"not found task")}constructor(e){super(),this._userMaterialsService=e,this._uploadTaskMap=new Map}}c=(0,i.gn)([(0,i.fM)(0,a.b),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===a.b?Object:a.b])],c)},460254:function(e,t,r){r.d(t,{r:function(){return o}});var i,n=r(127830);var o=((i={})[i.Video=n._g.Video]="Video",i[i.Photo=n._g.Photo]="Photo",i[i.Audio=n._g.Audio]="Audio",i[i.Gif=n._g.Gif]="Gif",i[i.Sticker=n._g.Sticker]="Sticker",i[i.Filter=n._g.Filter]="Filter",i[i.AdjustmentPreset=n._g.AdjustmentPreset]="AdjustmentPreset",i[i.Transition=n._g.Transition]="Transition",i[i.TextTemplate=n._g.TextTemplate]="TextTemplate",i[i.VideoTemplate=n._g.VideoTemplate]="VideoTemplate",i[i.TextPreset=n._g.TextPreset]="TextPreset",i[i.Effects=n._g.Effects]="Effects",i[i.UserAudio=n._g.UserAudio]="UserAudio",i[i.UserVideo=n._g.UserVideo]="UserVideo",i[i.UserPhoto=n._g.UserPhoto]="UserPhoto",i[i.DigitalHuman=n._g.DigitalHuman]="DigitalHuman",i.UserDigitalHuman="UserDigitalHuman",i[i.VideoDreamina=n._g.VideoDreamina]="VideoDreamina",i[i.DreaminaUserAiVideo=n._g.DreaminaUserAiVideo]="DreaminaUserAiVideo",i[i.DreaminaUserAiPhoto=n._g.PhotoDreamina]="DreaminaUserAiPhoto",i.BasicText="BasicText",i.BrandText="BrandText",i)},605405:function(e,t,r){r.d(t,{t:()=>C});var i=r("789786"),n=r("772322"),o=r("587892"),s=r("402655"),a=r("214312"),c=r("218571"),u=r("670933");let l=(0,u.Pi)(e=>{let{initialCoord:t,source:r,store:i,containerRect:o,render:s}=e,{isSnapshotVisible:a,offset:u,disabledScale:l,snapshotRect:d,snapshotStyles:_,currentPosition:h}=i,p=h?{x:h.clientX,y:h.clientY}:{x:0,y:0},g={x:t.x-o.x,y:t.y-o.y},v=(0,c.useMemo)(()=>({x:p.x-g.x,y:p.y-g.y}),[p]);return(0,n.jsx)("div",{className:"drag-snapshot-box",style:(()=>{let e,t,{width:r,height:i}=o,n=`translate(${v.x}px, ${v.y}px)`,s=null!=d?d:{width:r,height:i};if(l)r=s.width,i=s.height;else{let r={x:s.width/o.width,y:s.height/o.height};e=`${g.x}px ${g.y}px`,t=`scale(${r.x}, ${r.y})`}return u&&(n=`translate(${p.x+u.x}px, ${p.y+u.y}px)`),{width:`${r}px`,height:`${i}px`,transform:`${n} ${t||""}`,transformOrigin:e,display:a?"block":"none",pointerEvents:"none",...null!=_?_:{}}})(),children:s({currentHoverTarget:i.currentHoverDropArea,snapshotRect:d})})});var d=r("260963"),_=r("407899"),h=r("593642"),p=r("800788"),g=r("651725");class v extends s.JT{get id(){return this._id}get element(){return this._delegate.dropTarget}get dropArea(){return this._delegate.dropArea}get isBeingHovered(){return this._isBeingHovered}get dropPriority(){var e;return null!==(e=this._delegate.dropPriority)&&void 0!==e?e:"default"}setIsBeingHovered(e){this._isBeingHovered=e}setDropAreaManually(e){this._delegate.dropArea=e}triggerDragStart(e){var t;(0,p.ZB)(this._dragObservableState.dataTransfer);let{callbacks:r}=this._delegate;null===(t=r.onDragStart)||void 0===t||t.call(r,e,this._dragObservableState.dataTransfer)}triggerDrag(e){var t;(0,p.ZB)(this._dragObservableState.dataTransfer);let{callbacks:r}=this._delegate;null===(t=r.onDrag)||void 0===t||t.call(r,e,this._dragObservableState.dataTransfer)}triggerDragEnter(e){var t;(0,p.ZB)(this._dragObservableState.dataTransfer);let{dropArea:r,callbacks:i}=this._delegate;this._isBeingHovered=!0,this._setDropEffect(),this._setHoverSnapshotProps(),(0,d.z)(()=>{this._dragObservableState.currentHoverDropArea=r,this._dragObservableState.isHover=!0}),null===(t=i.onDragEnter)||void 0===t||t.call(i,e,this._dragObservableState.dataTransfer)}triggerDragOver(e){var t,r;(0,p.ZB)(this._dragObservableState.dataTransfer),null===(t=(r=this._delegate.callbacks).onDragOver)||void 0===t||t.call(r,e,this._dragObservableState.dataTransfer)}triggerDragLeave(e){var t;(0,p.ZB)(this._dragObservableState.dataTransfer);let{callbacks:r}=this._delegate;this._isBeingHovered=!1,this._resetDropEffect(),this._resetHoverSnapshotProps(),(0,d.z)(()=>{this._dragObservableState.currentHoverDropArea=void 0,this._dragObservableState.isHover=!1}),null===(t=r.onDragLeave)||void 0===t||t.call(r,e,this._dragObservableState.dataTransfer)}triggerDrop(e){(0,p.ZB)(this._dragObservableState.dataTransfer),(0,d.z)(()=>{this._dragObservableState.currentHoverDropArea=void 0});let t=this._getDropContext(e);this._delegate.callbacks.onDrop(e,this._dragObservableState.dataTransfer,t)}triggerDragEnd(e){var t,r;(0,p.ZB)(this._dragObservableState.dataTransfer),(0,d.z)(()=>{this._dragObservableState.currentHoverDropArea=void 0}),null===(t=(r=this._delegate.callbacks).onDragEnd)||void 0===t||t.call(r,e,this._dragObservableState.dataTransfer)}dispose(){this._shouldDisposeEvent.fire(),super.dispose()}_setHoverSnapshotProps(){let{snapshotRect:e,snapshotStyles:t,offset:r,disabledScale:i}=this._dragObservableState;this._prevSnapshotRect=e,this._prevSnapshotStyles=t,this._prevOffset=r,this._prevDisabledScale=i,(0,d.z)(()=>{var n,o,s,a,c,u,l,d,_,h;this._dragObservableState.snapshotRect=null!==(l=null===(n=(o=this._delegate).setHoverSnapshotRect)||void 0===n?void 0:n.call(o,this._dragObservableState.dataTransfer))&&void 0!==l?l:e,this._dragObservableState.snapshotStyles=null!==(d=null===(s=(a=this._delegate).setHoverSnapshotStyles)||void 0===s?void 0:s.call(a,this._dragObservableState.dataTransfer))&&void 0!==d?d:t,this._dragObservableState.offset=null!==(_=null===(c=(u=this._delegate).setHoverSnapshotOffset)||void 0===c?void 0:c.call(u,this._dragObservableState.dataTransfer))&&void 0!==_?_:r,this._dragObservableState.disabledScale=null!==(h=this._delegate.disabledScale)&&void 0!==h?h:i})}_resetHoverSnapshotProps(){(0,d.z)(()=>{this._dragObservableState.snapshotRect=this._prevSnapshotRect,this._dragObservableState.snapshotStyles=this._prevSnapshotStyles,this._dragObservableState.offset=this._prevOffset,this._dragObservableState.disabledScale=this._prevDisabledScale})}_setDropEffect(){var e,t,r;let{dropEffect:i}=this._dragObservableState;this._prevDropEffect=i;let n=null!==(r=null===(e=(t=this._delegate).setDropEffect)||void 0===e?void 0:e.call(t,this._dragObservableState.dataTransfer))&&void 0!==r?r:i;(0,d.z)(()=>{this._dragObservableState.dropEffect=n})}_resetDropEffect(){(0,d.z)(()=>{this._dragObservableState.dropEffect=this._prevDropEffect})}_getDropContext(e){let t;let{snapshotRect:r,disabledScale:i,containerRect:n,initialCoord:o,offset:s}=this._dragObservableState,{width:a,height:c}=n,u=null!=r?r:{width:a,height:c},l={x:o.x-n.x,y:o.y-n.y};return{dropPosition:t=i?s?{x:o.x+s.x,y:o.y+s.y}:{x:e.clientX-l.x,y:e.clientY-l.y}:(0,g.e)({container:{...n,x:e.clientX-l.x,y:e.clientY-l.y},transformOrigin:{x:e.clientX,y:e.clientY},scaleFactor:{x:u.width/a,y:u.height/c}})}}constructor(e,t){super(),this._delegate=e,this._dragObservableState=t,this._id=(0,h.Rl)(),this._shouldDisposeEvent=new o.Q,this.shouldDisposeEvent=this._shouldDisposeEvent.event}}let f={low:1,default:100,high:1e3,supreme:1e4},m="sidebarDndMousePressTag",y="sidebar-dnd-snapshot-identifier",w=new DOMRect,k={clientX:-1e3,clientY:-1e3},b={x:0,y:0};class S extends s.JT{get dropTargets(){return this._dropTargets}get currentHoverTarget(){return this._currentHoverTarget}createDropTarget(e,t){let r=new v(e,t);return this._dropTargets.push(r),this._register(r.shouldDisposeEvent(()=>{this._removeDropTarget(r)})),r}move(e){this._dropTargets.forEach(t=>t.triggerDrag(e));let t=this._getHoveredTarget({x:e.clientX,y:e.clientY});if(this._currentHoverTarget&&!t){this._currentHoverTarget.triggerDragLeave(e),this._currentHoverTarget=void 0;return}if(this._currentHoverTarget&&t){this._currentHoverTarget.id===t.id?this._currentHoverTarget.triggerDragOver(e):(this._currentHoverTarget.triggerDragLeave(e),this._currentHoverTarget=t,this._currentHoverTarget.triggerDragEnter(e));return}if(!this._currentHoverTarget&&t){this._currentHoverTarget=t,this._currentHoverTarget.triggerDragEnter(e);return}}_getHoveredTarget(e){let t=this._dropTargets.filter(t=>{let{x:r,y:i,width:n,height:o}=t.element.getBoundingClientRect();return e.x>=r&&e.y>=i&&e.x<=r+n&&e.y<=i+o});return t.length<=1?t.length?t[0]:void 0:this._filterHoverTargetByPriority(t)}_filterHoverTargetByPriority(e){let t=Number.MIN_SAFE_INTEGER,r=e[0];return e.forEach(e=>{f[e.dropPriority]>t&&(r=e,t=f[e.dropPriority])}),r}_removeDropTarget(e){let t=this._dropTargets.findIndex(t=>t.id===e.id);-1!==t&&this._dropTargets.splice(t,1)}dispose(){this._dropTargets.forEach(e=>{e.dispose()}),super.dispose()}constructor(...e){super(...e),this._dropTargets=[]}}var R=r("756024");class C extends s.JT{get isDragging(){return this._dragObservableState.isDragging}dragStart(e){this._dragStartOptions=e;let{e:t}=e;if(0===t.button&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey)(this._dragObservableState.isDragging||window[m])&&this._stopDragContext(),window[m]=!0,this._dragStartTimestamp=Date.now(),this._initialMousePosition={x:t.clientX,y:t.clientY},this._bindSimulatedDragEvents()}createDropTarget(e){return this._dndObserver.createDropTarget(e,this._dragObservableState)}showSnapshot(){(0,d.z)(()=>{this._dragObservableState.isSnapshotVisible=!0})}hideSnapshot(){(0,d.z)(()=>{this._dragObservableState.isSnapshotVisible=!1})}setDropEffectManually(e){if(!e){console.error(`dropeffect is invalid: ${e}`);return}(0,d.z)(()=>{this._dragObservableState.dropEffect=e})}setHoverSnapshotRectManually(e){if(!e){console.error(`rect is invalid: ${e}`);return}(0,d.z)(()=>{this._dragObservableState.snapshotRect=e})}dispose(){this._dndObserver.dispose(),super.dispose()}_bindSimulatedDragEvents(){let e=this._getEventBindings().map(e=>{let{eventName:t,fn:r,useCapture:i=!0}=e;return(0,_.n)(window,t,r,i)});this._disposableEventBindingRefs=e}_unbindSimulatedDragEvents(){this._disposableEventBindingRefs.forEach(e=>{e.dispose()})}_stopDragContext(){if(this._unbindSimulatedDragEvents(),this._checkIfSnapshotExisted()){var e;null===(e=this._disposableSnapshot)||void 0===e||e.dispose()}this._initialMousePosition=void 0,this._disposableSnapshot=void 0,(0,d.z)(()=>{this._dragObservableState.isDragging=!1,this._dragObservableState.isHover=!1,this._dragObservableState.currentHoverDropArea=void 0,this._dragObservableState.currentPosition=k,this._dragObservableState.isSnapshotVisible=!0,this._dragObservableState.snapshotRect=void 0,this._dragObservableState.dropEffect="default",this._dragObservableState.containerRect=w,this._dragObservableState.initialCoord=b}),this._clearInvalidSnapshotByClassName()}_getEventBindings(){return[{eventName:"mouseup",fn:e=>{if(window[m]=!1,!this._dragObservableState.isDragging||this._checkIfIsClickBehavior()){if(this._dragObservableState.isDragging)try{this._dndObserver.dropTargets.forEach(t=>{t.triggerDragEnd(e)}),this._onDragEnd.fire(e,this._dragObservableState.dataTransfer)}catch(e){throw this._stopDragContext(),R.t.error(`[SidebarDnDService]trigger mouseup error: ${e}`),e}this._stopDragContext();return}e.preventDefault();try{var t,r,i,n;if(this._checkTriggerDropNecessary(e)){let{currentHoverTarget:t}=this._dndObserver;null==t||t.triggerDrop(e),t&&(null===(n=this._dragStartOptions)||void 0===n||null===(i=n.onDrop)||void 0===i||i.call(n,e,t.dropArea))}this._dndObserver.dropTargets.forEach(t=>{t.triggerDragEnd(e)}),this._onDragEnd.fire(e,this._dragObservableState.dataTransfer),null===(r=this._dragStartOptions)||void 0===r||null===(t=r.onDragEnd)||void 0===t||t.call(r,e)}catch(e){throw R.t.error(`[SidebarDnDService]trigger mouseup error: ${e}`),e}finally{this._stopDragContext()}},useCapture:!0},{eventName:"mousemove",fn:e=>{try{if(!window[m]&&this._clearInvalidSnapshotByClassName(),this._dragObservableState.isDragging){let{clientX:t,clientY:r}=e;this._dndObserver.move(e),(0,d.z)(()=>{this._dragObservableState.currentPosition={clientX:t,clientY:r}})}else{var t,r,i,n;if(this._disposableSnapshot&&this._disposableSnapshot.dispose(),!this._checkIfShouldTriggerDragStart(e))return;requestAnimationFrame(()=>{this._createSnapshot(this._dragStartOptions)}),(0,d.z)(()=>{var e;this._dragObservableState.isDragging=!0,this._dragObservableState.dataTransfer=null===(e=this._dragStartOptions)||void 0===e?void 0:e.dataTransfer}),this._dndObserver.dropTargets.forEach(t=>{t.triggerDragStart(e)}),(null===(t=this._dragStartOptions)||void 0===t?void 0:t.dataTransfer)&&this._onDragStart.fire(e,null===(n=this._dragStartOptions)||void 0===n?void 0:n.dataTransfer),null===(i=this._dragStartOptions)||void 0===i||null===(r=i.onDragStart)||void 0===r||r.call(i,e)}}catch(e){throw R.t.error(`[SidebarDnDService]trigger mousemove error: ${e}`),this._stopDragContext(),Error()}}},{eventName:"mouseleave",fn:e=>{},useCapture:!0}]}_checkTriggerDropNecessary(e){let t=document.querySelector(".lv-layout-sider");if(t){let{x:r,y:i,width:n,height:o}=t.getBoundingClientRect(),{clientX:s,clientY:a}=e;if(s>=r&&s<=r+n&&a>=i&&a<=i+o)return!1}return!0}_clearInvalidSnapshotByClassName(){let e=document.getElementsByClassName(y);if(null==e?void 0:e.length)for(let t of e)document.body.removeChild(t)}_checkIfSnapshotExisted(){return 0!==document.getElementsByClassName(y).length}_checkIfIsClickBehavior(){if(Date.now()-this._dragStartTimestamp<=300)return!0}_checkIfShouldTriggerDragStart(e){if(this._initialMousePosition){let{x:t,y:r}=this._initialMousePosition,{clientX:i,clientY:n}=e;if(Math.abs(t-i)>1||Math.abs(r-n)>1)return!0}return!1}_checkIfMouseStayInWindow(e){let t=document.body.getBoundingClientRect(),{clientX:r,clientY:i}=e;return!!(r>0)&&!!(r<t.width)&&!!(i>0)&&!!(i<t.height)||!1}_createSnapshotContainer(){let e=document.createElement("div");return e.setAttribute("style","position: fixed; top: 0px; left: 0px; z-index: 100000"),e.setAttribute("class",y),e}_createSnapshot(e){var t;let{sourceElement:r,renderSnapshot:i,e:o}=e,s=this._createSnapshotContainer(),{clientX:a,clientY:c}=o,u=null!==(t=e.customContainerRect)&&void 0!==t?t:r.getBoundingClientRect();(0,d.z)(()=>{this._dragObservableState.containerRect=u,this._dragObservableState.initialCoord={x:a,y:c}});let _=this._contextViewService.createContextView({id:"side-bar-dnd",component:(0,n.jsx)(l,{source:r,render:i,containerRect:u,store:this._dragObservableState,initialCoord:{x:a,y:c}})},s);this._disposableSnapshot={dispose:()=>{_.unmount()}}}constructor(e){super(),this._contextViewService=e,this._dragStartTimestamp=0,this._dragObservableState=(0,d.LO)({isDragging:!1,isHover:!1,isSnapshotVisible:!0,currentHoverDropArea:void 0,dataTransfer:void 0,snapshotRect:void 0,snapshotStyles:void 0,offset:void 0,disabledScale:!1,dropEffect:"default",currentPosition:k,containerRect:w,initialCoord:b}),this._disposableEventBindingRefs=[],this._onDragStart=new o.Q,this.onDragStart=this._onDragStart.event,this._onDragEnd=new o.Q,this.onDragEnd=this._onDragEnd.event,this._dndObserver=new S,(0,d.EH)(()=>{var e;document.body.style.cursor=null!==(e=this._dragObservableState.dropEffect)&&void 0!==e?e:"default"})}}C=(0,i.gn)([(0,i.fM)(0,a.u),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===a.u?Object:a.u])],C)},453991:function(e,t,r){r.d(t,{T:function(){return n}});var i=r(800788);class n{getDatabase(e){if(this._pool.has(e))return Promise.resolve(this._pool.get(e));if(this._connectingRequest.has(e))return this._connectingRequest.get(e);let t=this._schemas.get(e),r=new Promise((r,i)=>{let n=indexedDB.open(e,t.version);n.onupgradeneeded=()=>{try{let t=n.result;this._initTable(t,e,n.transaction)}catch(e){i(e)}},n.onerror=e=>{i(e)},n.onblocked=e=>{i(e)},n.onsuccess=()=>{try{let t=n.result;this._listenDbEvent(t),this._pool.set(e,t),r(t)}catch(e){i(e)}}}).finally(()=>{this._connectingRequest.delete(e)});return this._connectingRequest.set(e,r),r}_initTable(e,t,r){let n=this._schemas.get(t);(0,i.ZB)(n);let o=new Set;for(let t of e.objectStoreNames)o.add(t);for(let[t,s]of n.tables){if(o.has(t)){(0,i.ZB)(r,"need transaction when db upgrade.");let e=r.objectStore(t);this._createIndex(e,s.index);continue}let n=e.createObjectStore(t,{keyPath:s.key});this._createIndex(n,s.index)}}_createIndex(e,t){let r=new Set;for(let t of e.indexNames)r.add(t);for(let n of t){var i;if(!r.has(n.name))e.createIndex(n.name,null!==(i=n.keyPath)&&void 0!==i?i:n.name,{unique:n.unique})}}_removeCache(e){for(let[t,r]of this._pool)if(r===e){this._pool.delete(t);return}}_listenDbEvent(e){e.onversionchange=()=>{e.close(),this._removeCache(e)},e.onabort=()=>{e.close(),this._removeCache(e)},e.onerror=()=>{e.close(),this._removeCache(e)},e.onclose=()=>{this._removeCache(e)}}constructor(e){this._schemas=e,this._pool=new Map,this._connectingRequest=new Map}}},668380:function(e,t,r){r.d(t,{T:function(){return c}});var i=r(789786),n=r(690613),o=r(566669),s=r(887383),a=r(652725);class c{set(e,t,r){return new Promise(async i=>{try{let a=this._database.transaction(this._storeName,"readwrite",r);a.onabort=()=>{i((0,o.NB)(a.error))},a.onerror=()=>{i((0,o.NB)(a.error))},a.oncomplete=()=>{i((0,n.ly)())};let c=new s.m(a,this._storeName);await c.set(e,t),a.commit&&a.commit()}catch(e){i((0,o.NB)(e))}})}setMany(e,t){return new Promise(async r=>{try{let i=this._database.transaction(this._storeName,"readwrite",t);i.onabort=()=>{r((0,o.NB)(i.error))},i.onerror=()=>{r((0,o.NB)(i.error))},i.oncomplete=()=>{r((0,n.ly)())};let a=new s.m(i,this._storeName);await a.setMany(e),i.commit&&i.commit()}catch(e){r((0,o.NB)(e))}})}delete(e,t){return new Promise(async r=>{try{let i=this._database.transaction(this._storeName,"readwrite",t);i.onabort=()=>{r((0,o.E_)(i.error))},i.onerror=()=>{r((0,o.E_)(i.error))},i.oncomplete=()=>{r((0,n.ly)())};let a=new s.m(i,this._storeName);await a.delete(e),i.commit&&i.commit()}catch(e){r((0,o.E_)(e))}})}deleteMany(e,t){return new Promise(async r=>{try{let i=this._database.transaction(this._storeName,"readwrite",t);i.onabort=()=>{r((0,o.E_)(i.error))},i.onerror=()=>{r((0,o.E_)(i.error))},i.oncomplete=()=>{r((0,n.ly)())};let a=new s.m(i,this._storeName);await a.deleteMany(e),i.commit&&i.commit()}catch(e){r((0,o.E_)(e))}})}deleteByIndex(e,t,r){return new Promise(async i=>{try{let a=this._database.transaction(this._storeName,"readwrite",r);a.onabort=()=>{i((0,o.E_)(a.error))},a.onerror=()=>{i((0,o.E_)(a.error))},a.oncomplete=()=>{i((0,n.ly)())};let c=new s.m(a,this._storeName);await c.deleteByIndex(e,t,null==r?void 0:r.range),a.commit&&a.commit()}catch(e){i((0,o.E_)(e))}})}query(e,t){return new Promise(async r=>{try{let i=this._database.transaction(this._storeName,"readonly",t);i.onabort=()=>{r((0,o.vI)(i.error))},i.onerror=()=>{r((0,o.vI)(i.error))};let a=new s.m(i,this._storeName),c=await a.query(e);i.commit&&i.commit(),r((0,n.oW)(c))}catch(e){r((0,o.vI)(e))}})}queryMany(e,t){return new Promise(async r=>{try{let i=this._database.transaction(this._storeName,"readonly",t);i.onabort=()=>{r((0,o.vI)(i.error))},i.onerror=()=>{r((0,o.vI)(i.error))};let a=new s.m(i,this._storeName),c=await a.queryMany(e);i.commit&&i.commit(),r((0,n.oW)(c))}catch(e){r((0,o.vI)(e))}})}queryByIndex(e,t,r){return new Promise(async i=>{try{let a=this._database.transaction(this._storeName,"readonly",r);a.onabort=()=>{i((0,o.vI)(a.error))},a.onerror=()=>{i((0,o.vI)(a.error))};let c=new s.m(a,this._storeName),u=await c.queryByIndex(e,t,null==r?void 0:r.range);a.commit&&a.commit(),i((0,n.oW)(u))}catch(e){i((0,o.vI)(e))}})}queryByConditions(e,t){return new Promise(async r=>{try{let i=this._database.transaction(this._storeName,"readonly",t);i.onabort=()=>{r((0,o.vI)(i.error))},i.onerror=()=>{r((0,o.vI)(i.error))};let a=new s.m(i,this._storeName),c=await a.queryByConditions(e);i.commit&&i.commit(),r((0,n.oW)(c))}catch(e){r((0,o.vI)(e))}})}clear(e){return new Promise(async t=>{try{let r=this._database.transaction(this._storeName,"readwrite",e);r.onabort=()=>{t((0,o.ks)(r.error))},r.onerror=()=>{t((0,o.ks)(r.error))},r.oncomplete=()=>{t((0,n.ly)())};let i=new s.m(r,this._storeName);await i.clear(),r.commit&&r.commit()}catch(e){t((0,o.ks)(e))}})}async reopenDatabase(){try{return this._database=await this._databasePool.getDatabase(this._database.name),(0,n.ly)()}catch(e){return(0,o.rM)(e)}}readyCleanup(){this._cleanupMgr.mark()}constructor(e,t,r,i){this._database=e,this._storeName=t,this._databasePool=r,this._cleanupMgr=i}}(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,"undefined"==typeof T?Object:T,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"set",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"setMany",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"delete",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"deleteMany",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Object,Object]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"deleteByIndex",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"query",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"queryMany",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Object,Object]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"queryByIndex",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Function,"undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"queryByConditions",null),(0,i.gn)([a.T,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IDataBaseTransactionOptions?Object:IDataBaseTransactionOptions]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],c.prototype,"clear",null)},544674:function(e,t,r){r.d(t,{Y:function(){return s}});var i=r(887383),n=r(587892),o=r(800788);class s{get result(){return this._cacheResult}set(e,t,r){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),new i.m(this._transaction,e).set(t,r).catch(e=>{this._onError.fire(e)})}setMany(e,t){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),new i.m(this._transaction,e).setMany(t).catch(e=>{this._onError.fire(e)})}delete(e,t){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),new i.m(this._transaction,e).delete(t).catch(e=>{this._onError.fire(e)})}deleteMany(e,t){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),new i.m(this._transaction,e).deleteMany(t).catch(e=>{this._onError.fire(e)})}query(e,t){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),this.queryMany(e,[t])}queryMany(e,t){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),new i.m(this._transaction,e).queryMany(t).then(t=>{if(!!t)for(let[r,i]of(!this._cacheResult.has(e)&&this._cacheResult.set(e,new Map),t))this._cacheResult.get(e).set(r,i)}).catch(e=>{this._onError.fire(e)})}clear(e){(0,o.Y2)(this._checkTable(e)),(0,o.Y2)(!this._done),new i.m(this._transaction,e).clear().catch(e=>{this._onError.fire(e)})}commit(){this._done=!0}_checkTable(e){return this._tables.has(e)}constructor(e,t){for(let r of(this._transaction=e,this._cacheResult=new Map,this._tables=new Set,this._onError=new n.Q,this._onComplete=new n.Q,this._done=!1,this.onError=this._onError.event,this.onComplete=this._onComplete.event,t))this._tables.add(r);this._transaction.onabort=()=>{this._onError.fire(this._transaction.error)},this._transaction.onerror=()=>{this._onError.fire(this._transaction.error)},this._transaction.oncomplete=()=>{this._onComplete.fire(this._cacheResult)}}}},232109:function(e,t,r){r.d(t,{T:function(){return o}});var i=r(566669),n=r(690613);class o{set(e,t){if(!this._localstorage)return(0,i.b5)();try{this._localstorage.setItem(e,t)}catch(e){return(0,i.SW)(e)}return(0,n.ly)()}delete(e){if(!this._localstorage)return(0,i.b5)();try{this._localstorage.removeItem(e)}catch(e){return(0,i.nr)(e)}return(0,n.ly)()}query(e){if(!this._localstorage)return(0,i.b5)();try{let t=this._localstorage.getItem(e);if(t)return(0,n.oW)(t)}catch(e){return(0,i.HA)(e)}return(0,n.oW)(void 0)}queryAndParse(e,t){if(!this._localstorage)return(0,i.b5)();try{let r=this._localstorage.getItem(e);if(r)return(0,n.oW)(t(r))}catch(e){return(0,i.HA)(e)}return(0,n.oW)(void 0)}clear(){if(!this._localstorage)return(0,i.b5)();try{this._localstorage.clear()}catch(e){return(0,i.Ec)(e)}return(0,n.ly)()}constructor(){this._localstorage=window.localStorage}}},594670:function(e,t,r){r.d(t,{X:function(){return i}});let i=(0,r(335290).yh)("theme-service")},485572:function(e,t,r){r.d(t,{i:function(){return n}});var i=r(177010);class n extends i.c{async _getModule(){return(await Promise.all([r.e("1818"),r.e("3072"),r.e("3930"),r.e("5699"),r.e("5642"),r.e("8381"),r.e("4374")]).then(r.bind(r,520727))).ThirdpartyUploadService}}},783122:function(e,t,r){r.d(t,{E:function(){return s},b:function(){return o}});var i,n=r(335290);var o=((i={}).GOOGLE_DRIVE="GoogleDrive",i.DROPBOX="Dropbox",i.TTLIVE="TTLive",i.SHOPIFY="Shopify",i);let s=(0,n.yh)("lazy-thirdparty-material-upload")},5507:function(e,t,r){r.d(t,{r:function(){return n}});var i,n=((i={})[i.Unknown=1]="Unknown",i[i.Cancel=2]="Cancel",i[i.Insufficient=20113]="Insufficient",i[i.Mismatch=200601]="Mismatch",i[i.AuthenticationFailed=200602]="AuthenticationFailed",i)},914069:function(e,t,r){r.d(t,{A:function(){return n}});var i,n=((i={}).Video="video",i.Image="image",i.Object="object",i)},921881:function(e,t,r){r.d(t,{O:function(){return o},X:function(){return u}});var i,n=r(645937);var o=((i={}).us="us-east-1",i.sg="ap-singapore-1",i.gcp="gcp",i.cn="cn-north-1",i.boe="boe",i);let s=`${n.an}${n.Rw}${n._8}ed`,a=`${n.an}${n.Rw}${n._8}evcloudapi`,c=`${n.tf}${n.aj}${n.QX}${n.tf}${n.lF}${n._8}api`;function u(e){let t={imageHost:"",videoHost:"",videoFallbackHost:"",imageFallbackHost:""};switch(e){case"us-east-1":t.videoHost=`https://vod-us-east-1.${a}.com`,t.imageHost=`https://imagex-va.${c}.com`,t.videoFallbackHost=`https://open-us-east-1.${a}.com`,t.imageFallbackHost=`https://open-us-east-1.${a}.com`;break;case"gcp":t.videoHost=`https://vod-us-east-2.${a}.com`,t.imageHost=`https://imagex-us-east-2.${a}.com`,t.videoFallbackHost=`https://open-us-east-2.${a}.com`,t.imageFallbackHost=`https://open-us-east-2.${a}.com`;break;case"ap-singapore-1":t.videoHost=`https://vod-ap-singapore-1.${a}.com`,t.imageHost=`https://imagex-ap-singapore-1.${a}.com`,t.videoFallbackHost=`https://open-ap-singapore-1.${a}.com`,t.imageFallbackHost=`https://open-ap-singapore-1.${a}.com`;break;case"cn-north-1":t.videoHost=`https://vod.${s}anceapi.com`,t.imageHost=`https://imagex.${s}anceapi.com`,t.videoFallbackHost=`https://open.${s}anceapi.com`,t.imageFallbackHost=`https://open.${s}anceapi.com`;break;case"boe":t.videoHost=`https://vod.${s}anceapi.com`,t.imageHost=`https://staging-openapi-boe.${s}.org`,t.videoFallbackHost=`https://vas-lf-x.${n.W}ns${n.W}dk.com`,t.imageFallbackHost=`https://open.${s}anceapi.com`;break;default:t.videoHost=`https://vod.${s}anceapi.com`,t.imageHost=`https://imagex.${s}anceapi.com`,t.videoFallbackHost=`https://vas-lf-x.${n.W}ns${n.W}dk.com`,t.imageFallbackHost=`https://open.${s}anceapi.com`}return t}},523327:function(e,t,r){r.d(t,{pd:function(){return n}});var i,n=((i={})[i.Image=0]="Image",i[i.File=1]="File",i)},570334:function(e,t,r){r.d(t,{N:function(){return c}});var i=r(587892),n=r(402655),o=r(690613),s=r(914069);class a extends n.JT{cancel(){this._sdk.cancel(this._key)}constructor(e,t){super(),this._sdk=e,this._key=t,this._onCompleted=new i.Q,this._onError=new i.Q,this._onProgress=new i.Q,this.onComplete=this._onCompleted.event,this.onError=this._onError.event,this.onProgress=this._onProgress.event,this._sdk.on("complete",e=>{var t,r;if(e.key!==this._key)return;let{uploadResult:i}=e;this._onCompleted.fire({uri:null!==(r=i.Uri)&&void 0!==r?r:"",md5:null===(t=i.ObjectMeta)||void 0===t?void 0:t.Md5})}),this._sdk.on("error",e=>{var t;if(e.key===this._key)this._onError.fire((0,o.wf)(null!==(t=e.extra.errorCode)&&void 0!==t?t:-1,e.extra.message))}),this._sdk.on("progress",e=>{if(e.key===this._key)this._onProgress.fire(e.percent)})}}function c(e,t){let r=e.addFile({file:t.file,stsToken:t.stsToken,type:s.A.Object});return e.start(r),new a(e,r)}},683728:function(e,t,r){r.d(t,{Z:function(){return i}});let i=(0,r(335290).yh)("upload-service")},374381:function(e,t,r){r.d(t,{C:()=>A});var i=r("789786"),n=r("230689"),o=r("105581"),s=r("690613"),a=r("800788"),c=r("669742"),u=r("361401"),l=r("999268"),d=r("921881"),_=r("442056"),h=r("587892"),p=r("402655"),g=r("914069");class v extends p.JT{cancel(){this._sdk.cancel(this._key)}constructor(e,t){super(),this._sdk=e,this._key=t,this._onCompleted=new h.Q,this._onError=new h.Q,this._onProgress=new h.Q,this.onComplete=this._onCompleted.event,this.onError=this._onError.event,this.onProgress=this._onProgress.event,this._sdk.on("complete",e=>{var t,r,i,n,o,s,a;if(e.key!==this._key)return;let{uploadResult:c}=e;this._onCompleted.fire({vid:null!==(a=c.Vid)&&void 0!==a?a:"",duration:null===(t=c.VideoMeta)||void 0===t?void 0:t.Duration,width:null===(r=c.VideoMeta)||void 0===r?void 0:r.Width,height:null===(i=c.VideoMeta)||void 0===i?void 0:i.Height,format:null===(n=c.VideoMeta)||void 0===n?void 0:n.Format,md5:null===(o=c.VideoMeta)||void 0===o?void 0:o.Md5,uri:null===(s=c.VideoMeta)||void 0===s?void 0:s.Uri,runId:c.RunId})}),this._sdk.on("error",e=>{var t;if(e.key===this._key)this._onError.fire((0,s.wf)(null!==(t=e.extra.errorCode)&&void 0!==t?t:-1,e.extra.message))}),this._sdk.on("progress",e=>{if(e.key===this._key)this._onProgress.fire(e.percent)})}}class f{setUserId(e){var t;this._config.userId=e,null===(t=this._sdk)||void 0===t||t.setOption({userId:e})}async uploadFile(e,t){if((0,a.Y2)(e.spaceName,"use vod must set `spaceName` in uploader."),await this._ensureSdk(e),!this._sdk)return(0,s.wf)(-1,"sdk undefined.");let r=(0,_.N)(this._sdk,{file:t,stsToken:this._convertToken(e)});return(0,s.oW)(r)}async uploadVideo(e,t){if((0,a.Y2)(e.spaceName,"use vod must set `spaceName` in uploader."),await this._ensureSdk(e),!this._sdk)return(0,s.wf)(-1,"sdk undefined.");let r=function(e,t){let r=e.addFile({file:t.file,stsToken:t.stsToken,type:g.A.Video});return e.start(r),new v(e,r)}(this._sdk,{file:t,stsToken:this._convertToken(e)});return(0,s.oW)(r)}async _ensureSdk(e){if(!this._sdk){if(!this._mutex.tryLock()){await this._mutex.lockShared(),this._mutex.unLockShared();return}try{let t;t=(await r.e("1586").then(r.t.bind(r,249220,23))).default,this._sdk=new t({userId:this._config.userId,appId:this._config.appId,region:e.region,stsToken:this._convertToken(e),videoConfig:{spaceName:e.spaceName,processAction:this._config.actions},objectConfig:{spaceName:e.spaceName,processAction:this._config.actions},...(0,d.X)(e.region),getSliceFunc:this._config.getSliceFunc})}finally{this._mutex.unLock()}}}_convertToken(e){return{AccessKeyId:e.accessKeyId,SecretAccessKey:e.secretAccessKey,SessionToken:e.sessionToken,ExpiredTime:e.expiredTime,CurrentTime:e.currentTime}}constructor(e){this._config=e,this._mutex=new l.L}}var m=r("544347"),y=r("836038"),w=r("531334");class k extends u.X{async uploadVideo(e){let{file:t}=e,r=await this._uploadVideoAndGetTask(t);if(!r.ok)return r;let i=r.value;return(0,c.i)(i)}async uploadVideoAndGetTask(e){let{file:t}=e,r=await this._uploadVideoAndGetTask(t);return r.ok?r.value:new y.y(r)}async uploadFile(e){let{file:t}=e,r=await this._uploadFileAndGetTask(t);if(!r.ok)return r;let i=r.value;return(0,c.i)(i)}async uploadFileAndGetTask(e){let{file:t}=e,r=await this._uploadFileAndGetTask(t);return r.ok?r.value:new y.y(r)}_getToken(){return this._spaceConfig.getVodToken()}_getSdkDriver(){return this._sdkDriver?this._sdkDriver:(!this._sdkDriver&&(this._sdkDriver=new f({appId:this._appId,userId:this._userIdProvider.userId,getSliceFunc:this._uploadSettings.sliceSize,actions:this._uploadSettings.actions})),this._sdkDriver)}async _uploadVideoAndGetTask(e){return((0,a.Y2)(this._spaceConfig.permissionSlots&1<<m.rA.Video,"this vod space no support upload video."),await super._flushToken(),this._token)?this._getSdkDriver().uploadVideo(this._token,e):(0,s.wf)(-1,"stsToken undefined.")}async _uploadFileAndGetTask(e){return((0,a.Y2)(this._spaceConfig.permissionSlots&1<<m.rA.File,"this vod space no support upload file."),await super._flushToken(),this._token)?this._getSdkDriver().uploadFile(this._token,e):(0,s.wf)(-1,"stsToken undefined.")}constructor(e,t,r,i){super(),this._appId=e,this._spaceConfig=t,this._uploadSettings=r,this._containerService=i,void 0!==this._uploadSettings.userId?this._userIdProvider=new w.k(this._uploadSettings.userId):this._userIdProvider=this._containerService.createInstance(w.w),this._userIdProvider.onUserIdChange(()=>{if(!!this._sdkDriver)this._sdkDriver.setUserId(this._userIdProvider.userId)})}}k=(0,i.gn)([(0,i.fM)(3,n.t),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Number,"undefined"==typeof IVodUploaderConfigProxy?Object:IVodUploaderConfigProxy,"undefined"==typeof IVodSettings?Object:IVodSettings,void 0===n.t?Object:n.t])],k);var b=r("405051"),S=r("894339"),R=r("121130"),C=r("515207"),I=r("621249");class P{syncUrlToEverPhoto(e,t){return this._networkClient.post("/lv/v2/intelligence/tts/curl_sync_everphoto",e,t)}constructor(){this._networkClient=function(){let e=new b.yk().build({headers:{"Content-Type":"application/json"}});return(0,S.mH)(e),(0,R.e_)(e),(0,C.J)(e),e}()}}function E(e,t){var r;return`${e}-${JSON.stringify(null!==(r=t.actions)&&void 0!==r?r:"")}`}(0,i.gn)([(0,I.K)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof SyncEverPhotoRequest?Object:SyncEverPhotoRequest,"undefined"==typeof NetworkRequestConfig?Object:NetworkRequestConfig]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],P.prototype,"syncUrlToEverPhoto",null);class A{preloadImageXSdk(){this._preloadBytedUploaderSdk()}preloadVodSdk(){this._preloadBytedUploaderSdk()}getImageXUploader(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this._getUploaderCache(E(e,r),t);if(i)return i;let n=this._containerService.createInstance(t),s=this._containerService.createInstance(o.A,e,n,r);return this._setUploaderCache(E(e,r),t,s),s}getVodUploader(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this._getUploaderCache(E(e,r),t);if(i)return i;let n=this._containerService.createInstance(t),o=this._containerService.createInstance(k,e,n,r);return this._setUploaderCache(E(e,r),t,o),o}syncUrlToEverPhoto(e){return this._syncEverPhotoRepository.syncUrlToEverPhoto(e)}_getUploaderCache(e,t){if(this._caches.has(e))return this._caches.get(e).get(t)}_setUploaderCache(e,t,r){!this._caches.has(e)&&this._caches.set(e,new Map),this._caches.get(e).set(t,r)}async _preloadBytedUploaderSdk(){if(!this._hasPreloadBytedUploaderSdk){this._hasPreloadBytedUploaderSdk=!0;await r.e("1586").then(r.t.bind(r,249220,23))}}constructor(e){this._containerService=e,this._hasPreloadBytedUploaderSdk=!1,this._caches=new Map,this._syncEverPhotoRepository=new P}}A=(0,i.gn)([(0,i.fM)(0,n.t),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.t?Object:n.t])],A)},775352:function(e,t,r){r.d(t,{H9:function(){return u},ec:function(){return l},f7:function(){return c},m5:function(){return a}});var i,n,o,s=r(335290);var a=((i={})[i.NoCopy=4]="NoCopy",i[i.NoOccupation=8]="NoOccupation",i[i.Invisible=16]="Invisible",i[i.InvisibleNoOccupation=24]="InvisibleNoOccupation",i);var c=((n={}).Vod="vod",n.Normal="normal",n);var u=((o={})[o.Unknown=1]="Unknown",o[o.Cancel=2]="Cancel",o[o.FolderNotExist=23001]="FolderNotExist",o[o.Insufficient=20113]="Insufficient",o[o.EncodingNotSupport=20209]="EncodingNotSupport",o[o.InvalidFormat=200206]="InvalidFormat",o[o.NotMatchExtFormat=20233]="NotMatchExtFormat",o[o.InvalidMaterialInformation=200204]="InvalidMaterialInformation",o[o.InvalidMaterialName=24001]="InvalidMaterialName",o);let l=(0,s.yh)("user-material-upload")},849830:function(e,t,r){r.d(t,{P:function(){return u}});var i=r(789786),n=r(402655),o=r(690613),s=r(775352),a=r(273238),c=r(426020);class u extends n.JT{get uploaderType(){var e;return(null===(e=this._options.uploaderConfig)||void 0===e?void 0:e.type)===s.f7.Vod?s.f7.Vod:s.f7.Normal}async upload(e){try{let t=Object.assign({},{times:1},e.retry),r=await this._userMaterialService.getEvercloudInstance(e.workspaceId),i=`${e.file.name}-${Date.now().valueOf}-${Math.floor(1e3*Math.random())}`,n=0,a=t=>new Promise(async a=>{var u,l;try{let l=await r.uploadAsset({file:e.file,fileType:e.skipTranscode?"file":void 0,flags:e.uploadFlag,workspaceId:e.workspaceId,autoPromote:e.autoPromote,skipDuplicate:!0,meta:e.bussinessMeta,folderId:null!==(u=e.folderId)&&void 0!==u?u:c.ZF,isMultiDefTranscode:e.isMultiDefTranscode,transcodeTemplateType:e.transcodeTemplateType,uploaderType:null==t?void 0:t.uploaderType,uploaderConfig:null==t?void 0:t.uploaderConfig});this._uploadTaskMap.set(i,l),l.onUploadMetaReady=t=>{var r;null===(r=e.onUploadMetaReady)||void 0===r||r.call(e,t)},l.onProgress=t=>{let{done:r,total:i}=t;if(i){var o;n=Math.max(n,r/i),null===(o=e.onProgress)||void 0===o||o.call(e,n)}},l.onFinish=t=>{if("success"===t.status){if(!(t.entryId||t.fileId)){a((0,o.wf)(-1,"assetId is undefined after finishing upload."));return}e.onFinish((0,o.oW)({md5:t.md5,assetId:t.entryId||t.fileId})),a((0,o.ly)())}if("cancel"===t.status&&(e.onFinish((0,o.wf)(s.H9.Cancel,"cancel upload")),a((0,o.ly)())),"error"===t.status){var r;let{code:i,msg:n}=null!==(r=t.errInfo)&&void 0!==r?r:{},c=null!=i?i:s.H9.Unknown,u=(0,o.wf)(c,null!=n?n:"unknown failure.");[s.H9.Cancel,s.H9.EncodingNotSupport,s.H9.Insufficient,s.H9.InvalidFormat,s.H9.InvalidMaterialInformation,s.H9.InvalidMaterialName,s.H9.NotMatchExtFormat].includes(c)&&(e.onFinish(u),a((0,o.ly)())),a(u)}}}catch(t){let e=(0,o.wf)(null!==(l=t.code)&&void 0!==l?l:-1,t.message||t.msg||"unknown failure.");a(e)}}),u=async r=>{var n,o,c;let l={uploaderConfig:{type:s.f7.Normal}};if((null===(o=this._options)||void 0===o?void 0:null===(n=o.uploaderConfig)||void 0===n?void 0:n.type)===s.f7.Vod){let e=null===(c=this._options)||void 0===c?void 0:c.uploaderConfig.noCopy;l=r>=t.times?{uploaderConfig:{type:s.f7.Normal}}:{uploaderConfig:{type:s.f7.Vod,noCopy:e}}}let d=await a(l);if(!d.ok){if(r>=t.times){e.onFinish(d),this._uploadTaskMap.delete(i);return}u(r+1);return}this._uploadTaskMap.delete(i)};return u(0),(0,o.oW)({taskId:i,requestId:i})}catch(e){return(0,o.wf)(s.H9.Unknown,`upload Asset failure: ${null==e?void 0:e.message}`)}}cancel(e){var t;return this._uploadTaskMap.has(e)?(null===(t=this._uploadTaskMap.get(e))||void 0===t||t.cancel(),(0,o.ly)()):(0,o.wf)(-1,"not found task")}constructor(e,t){super(),this._options=e,this._userMaterialService=t,this._uploadTaskMap=new Map}}u=(0,i.gn)([(0,i.fM)(1,a.b),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IUserMaterialUploadServiceOptions?Object:IUserMaterialUploadServiceOptions,void 0===a.b?Object:a.b])],u)},229106:function(e,t,r){r.d(t,{$E:()=>_,fl:()=>d,uC:()=>p,O1:()=>h});var i=r("827322"),n=r("690613"),o=r("800788"),s=r("210360"),a=r("269331");function c(e,t){return new Promise(t=>{e.toBlob(e=>{e?t(e.arrayBuffer()):t(new ArrayBuffer(0))})})}function u(e,t){return Promise.resolve(t.getImageData(0,0,e.width,e.height))}var l=r("229502");class d{captureSingleFrame(e,t){let r=this._getReturnDataProcessFunction(t);return this._makeFrameBuilder(r).getFrame(e)}captureByTimes(e,t){let r=this._getReturnDataProcessFunction(t),i=this._makeFrameBuilder(r);return new l.J(i,e)}captureByInterval(e,t){(0,o.Y2)(e>0);let r=1e3*this._video.duration,i=[];for(let t=0;t<=r;t+=e)i.push(t);return this.captureByTimes(i,t)}captureByCount(e,t){(0,o.Y2)(e>0);let r=1e3*this._video.duration;return this.captureByInterval(r/e,t)}_makeFrameBuilder(e){return new a.L(this._video,this._canvas,this._ctx,e)}_getReturnDataProcessFunction(e){switch(e){case s.l.ArrayBuffer:return c;case s.l.ImageData:return u;default:(0,o.bP)(e)}}constructor(e,t){this._video=e,this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvas.width=t.width,this._canvas.height=t.height}}function _(e){return new Promise(t=>{e.addEventListener("canplay",()=>{t((0,n.ly)())}),e.addEventListener("error",e=>{t((0,n.Mx)(-1,"video cant play.",e.error))})})}async function h(e,t){let r=document.createElement("video");r.crossOrigin="anonymous",r.src=(0,i.C)(e,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"cc_web_editor",region:"maliva",urlLimit:"10000",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!1});let o=await _(r);return o.ok?(0,n.oW)(new d(r,t)):o}async function p(e){let t=[];for await(let r of e)t.push(r);return t}},57775:function(e,t,r){r.d(t,{z:()=>u});var i=r("690613"),n=r("229106"),o=r("827322"),s=r("358046");class a extends n.fl{_makeFrameBuilder(e){return new s.X(this._video,this._canvas,this._ctx,e)}}async function c(e,t){let r=document.createElement("video");r.crossOrigin="anonymous",r.src=(0,o.C)(e,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"cc_web_editor",region:"maliva",urlLimit:"10000",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!1});let s=await (0,n.$E)(r);return s.ok?(0,i.oW)(new a(r,t)):s}class u{createCapturer(e,t){return 0===t.width||0===t.height?Promise.resolve((0,i.wf)(-1,"capture video must have size.")):(0,n.O1)(e,t)}createIdleCapturer(e,t){return 0===t.width||0===t.height?Promise.resolve((0,i.wf)(-1,"capture video must have size.")):c(e,t)}}},210360:function(e,t,r){r.d(t,{T:function(){return s},l:function(){return o}});var i,n=r(335290);var o=((i={})[i.ArrayBuffer=0]="ArrayBuffer",i[i.ImageData=1]="ImageData",i);let s=(0,n.yh)("video-capture-service")},445788:function(e,t,r){r.d(t,{U:()=>l});var i=r("827322"),n=r("800788"),o=r("587892"),s=r("690613"),a=r("407899"),c=r("666466");class u extends c.w{play(){return this._mediaPlay()}changeDefinition(e,t){let r=super.changeDefinition(e,t);return r.then(()=>{var r;null===(r=this._onDefinitionChange)||void 0===r||r.fire({to:e,from:t})}).catch(()=>{}),r}get onPlay(){return!this._onPlay&&(this._onPlay=this._register(new o.Q),this._register((0,a.n)(this._element,"play",()=>{this._onPlay.fire()}))),this._onPlay.event}get onPause(){return!this._onPause&&(this._onPause=this._register(new o.Q),this._register((0,a.n)(this._element,"pause",()=>{this._onPause.fire()}))),this._onPause.event}get onSeeking(){return!this._onSeeking&&(this._onSeeking=this._register(new o.Q),this._register((0,a.n)(this._element,"seeking",()=>{this._onSeeking.fire()}))),this._onSeeking.event}get onSeeked(){return!this._onSeeked&&(this._onSeeked=this._register(new o.Q),this._register((0,a.n)(this._element,"seeked",()=>{this._onSeeked.fire(this._element.currentTime)}))),this._onSeeked.event}get onTimeUpdate(){return!this._onTimeUpdate&&(this._onTimeUpdate=this._register(new o.Q),this._register((0,a.n)(this._element,"timeupdate",()=>{this._onTimeUpdate.fire(this._element.currentTime)}))),this._onTimeUpdate.event}get onEnded(){return!this._onEnded&&(this._onEnded=this._register(new o.Q),this._register((0,a.n)(this._element,"ended",()=>{this._onEnded.fire()}))),this._onEnded.event}get onLoadStart(){return!this._onLoadStart&&(this._onLoadStart=this._register(new o.Q),this._register((0,a.n)(this._element,"loadstart",()=>{this._onLoadStart.fire()}))),this._onLoadStart.event}get onLoaded(){return!this._onLoaded&&(this._onLoaded=this._register(new o.Q),this._register((0,a.n)(this._element,"loadeddata",()=>{this._onLoaded.fire()}))),this._onLoaded.event}get onLoadedMetadata(){return!this._onLoadedMetadata&&(this._onLoadedMetadata=this._register(new o.Q),this._register((0,a.n)(this._element,"loadedmetadata",()=>{this._onLoadedMetadata.fire()}))),this._onLoadedMetadata.event}get onError(){return!this._onError&&(this._onError=this._register(new o.Q),this._register((0,a.n)(this._element,"error",e=>{this._onError.fire((0,s.wf)(e.code,e.message))}))),this._onError.event}get onDurationChange(){return!this._onDurationChange&&(this._onDurationChange=this._register(new o.Q),this._register((0,a.n)(this._element,"durationchange",()=>{this._onDurationChange.fire(this._element.duration)}))),this._onDurationChange.event}get onWaiting(){return!this._onWaiting&&(this._onWaiting=this._register(new o.Q),this._register((0,a.n)(this._element,"waiting",()=>{this._onWaiting.fire()}))),this._onWaiting.event}get onCanPlay(){return!this._onCanPlay&&(this._onCanPlay=this._register(new o.Q),this._register((0,a.n)(this._element,"canplay",e=>{this._onCanPlay.fire(e)}))),this._onCanPlay.event}get onDownloadProgress(){return!this._onDownloadProgress&&(this._onDownloadProgress=this._register(new o.Q),this._register((0,a.n)(this._element,"progress",()=>{this._onDownloadProgress.fire()}))),this._onDownloadProgress.event}get onVolumeChange(){return!this._onVolumeChange&&(this._onVolumeChange=this._register(new o.Q),this._register((0,a.n)(this._element,"volumechange",()=>{this._onVolumeChange.fire(this._element.volume)}))),this._onVolumeChange.event}get onPlayStart(){return!this._onPlayStart&&(this._onPlayStart=this._register(new o.Q)),this._onPlayStart.event}get onFullscreenChange(){return!this._onFullscreenChange&&(this._onFullscreenChange=this._register(new o.Q),this._register((0,a.n)(document,"fullscreenchange",()=>{!document.fullscreenElement&&this._fullscreen?(this._onFullscreenChange.fire(!1),this._fullscreen=!1):document.fullscreenElement===this._fullscreenElem&&(this._onFullscreenChange.fire(!0),this._fullscreen=!0)}))),this._onFullscreenChange.event}get onDefinitionChange(){return!this._onDefinitionChange&&(this._onDefinitionChange=this._register(new o.Q)),this._onDefinitionChange.event}_mediaPlay(){let e=this._element.play();return e.then(()=>{var e;null===(e=this._onPlayStart)||void 0===e||e.fire()}).catch(()=>{}),e}constructor(...e){super(...e),this._fullscreen=!1}}class l{createVideoPlayer(e,t){var r;let o="string"==typeof e?document.getElementById(e):e;(0,n.ZB)(o,"video player must has parent.");let s=null!==(r=t.reuseVideo)&&void 0!==r?r:document.createElement("video");return t.url&&s.src!==t.url?s.src=(0,i.C)(t.url,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"cc_web_editor",region:"maliva",urlLimit:"10000",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!1}):(0,n.Y2)(t.reuseVideo,"must provide url if not reuse video."),t.reuseVideo&&this._resetStyle(s),void 0!==t.volume&&(s.volume=t.volume),void 0!==t.loop&&(s.loop=t.loop),void 0!==t.width?s.style.width=String(t.width):s.style.width="100%",void 0!==t.height?s.style.height=String(t.height):s.style.height="100%",t.muted&&(s.muted=!0),t.autoplay?s.autoplay=!0:t.autoplayMuted&&(s.muted=!0,s.autoplay=!0),t.crossOrigin&&(s.crossOrigin=t.crossOrigin),t.preload&&(s.preload=t.preload),s.parentElement&&s.remove(),o.appendChild(s),new u(s)}_resetStyle(e){e.removeAttribute("class"),e.removeAttribute("style"),e.style.width="100%",e.style.height="100%",e.style.display="block"}}},882760:function(e,t,r){r.d(t,{v:function(){return s}});var i=r(800788),n=r(15754),o=r(248952);r(794579);class s{async createXgVideoPlayer(e,t){let{SimplePlayer:n}=await Promise.all([r.e("6440"),r.e("8263")]).then(r.bind(r,514089)),s="";s="string"==typeof e?e:e.id,(0,i.Y2)(s,"video player must has rootId.");let a=new n(await this._makeBaseOptions(s,t));return new o.w(a)}async createXgPresetVideoPlayer(e,t){var n;let{default:s}=await Promise.all([r.e("6440"),r.e("8263")]).then(r.bind(r,514089));(0,i.Y2)(e,"video player must root.");let a=await this._makeBaseOptions(e,t);a.ignores=null!==(n=t.ignoresControl)&&void 0!==n?n:[];let c=new s(a);return new o.w(c)}async _makeBaseOptions(e,t){var r,i,o,s;let a={};t.crossOrigin&&(a.crossOrigin=t.crossOrigin),t.preload&&(a.preload=t.preload);let c={..."string"==typeof e?{id:e}:{el:e},url:t.url,width:t.width,height:t.height,loop:null!==(r=t.loop)&&void 0!==r&&r,autoplay:null!==(i=t.autoplay)&&void 0!==i&&i,autoplayMuted:t.autoplayMuted,muted:null!==(o=t.muted)&&void 0!==o&&o,videoFillMode:null!==(s=t.fillMode)&&void 0!==s?s:n.t.Auto,lang:t.lang,volume:t.volume,plugins:[],videoConfig:a,controls:!1,keyShortcut:!1,seekedStatus:"auto"};return(t.decryptKey||t.forceMp4EncryptPlugin)&&await this._bindMp4Encrypt(c,t),c}async _bindMp4Encrypt(e,t){let{default:i}=await Promise.all([r.e("6440"),r.e("5376"),r.e("8070"),r.e("1566"),r.e("443"),r.e("3069"),r.e("7226"),r.e("9329"),r.e("9158"),r.e("894"),r.e("3436"),r.e("927"),r.e("7969"),r.e("1306"),r.e("5027"),r.e("5957"),r.e("5595"),r.e("2778")]).then(r.bind(r,278231));e.plugins.push(i),e.Mp4EncryptPlayer={useEME:!1,preloadSize:t.preloadSize,fixEditListOffset:!1,disableInactiveWaitingCheck:t.disableInactiveWaitingCheck},t.heads&&(e.Mp4EncryptPlayer.reqOptions={headers:t.heads}),t.decryptKey&&(e.Mp4EncryptPlayer.keyValue=t.decryptKey)}}},528573:function(e,t,r){r.d(t,{J:function(){return a}});var i=r(827322),n=r(609591),o=r(402655),s=r(800788);r(448082);class a extends o.JT{get video(){return this._playerSdk.media}get root(){return(0,s.ZB)(this._playerSdk.root),this._playerSdk.root}get mediaUrl(){return this._playerSdk.currentSrc}get duration(){return this._playerSdk.duration}get paused(){return this._playerSdk.paused}get isFullscreen(){return this._playerSdk.isFullscreen}get currentTime(){return this._playerSdk.currentTime}set currentTime(e){this._playerSdk.currentTime=e}get volume(){return this._playerSdk.volume}set volume(e){this._playerSdk.volume=e}get muted(){return this._playerSdk.muted}set muted(e){this._playerSdk.muted=e}get loop(){return this._playerSdk.loop}set loop(e){this._playerSdk.loop=e}get autoplay(){return this._playerSdk.autoplay}set autoplay(e){this._playerSdk.autoplay=e}setConfig(e){this._playerSdk.setConfig(e),e.url&&this.video.src!==e.url&&(this.video.src=(0,i.C)(e.url,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"cc_web_editor",region:"maliva",urlLimit:"10000",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!1})),void 0!==e.volume&&(this.video.volume=e.volume),void 0!==e.loop&&(this.video.loop=e.loop),void 0!==e.muted&&(this.video.muted=e.muted),void 0!==e.autoplay&&(this.video.autoplay=e.autoplay),e.autoplayMuted&&(this.video.muted=e.autoplayMuted,this.video.autoplay=e.autoplayMuted),void 0!==e.crossOrigin&&(this.video.crossOrigin=e.crossOrigin),void 0!==e.width&&(this.video.style.width=String(e.width)),void 0!==e.height&&(this.video.style.height=String(e.height))}play(){return this._playerSdk.play()}replay(){return this._playerSdk.replay()}pause(){this._playerSdk.pause()}seek(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.j.Auto;this._playerSdk.seek(e,t)}reset(){this._playerSdk.reset()}getPlugin(e){return this._playerSdk.getPlugin(e)}load(){this._playerSdk.load()}setMediaUrl(e){this._playerSdk.src=(0,i.C)(e,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"cc_web_editor",region:"maliva",urlLimit:"10000",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!1})}changeDefinition(e,t){this._playerSdk.changeDefinition({url:e.url,definition:e.definition},t?{url:t.url,definition:t.definition}:t)}getFullscreen(e){return this._playerSdk.getFullscreen(e)}exitFullscreen(){return this._playerSdk.exitFullscreen()}getBufferedRange(){return this._playerSdk.getBufferedRange()}dispose(){this._playerSdk.destroy(),super.dispose()}constructor(e){super(),this._playerSdk=e}}},230689:function(e,t,r){r.d(t,{t:function(){return o}});var i=r(335290),n=r(55449);let o=(0,i.LO)(n.T)},654042:function(e,t,r){r.d(t,{H:function(){return i}});let i=(0,r(335290).yh)("ai-tool-data-service")},688193:function(e,t,r){r.d(t,{u:function(){return d}});var i=r(789786),n=r(55449),o=r(402655),s=r(690613),a=r(716045),c=r(578209),u=r(528395),l=r(349168);class d extends o.JT{async createAiTask(e,t){let r=await this._aiToolRepository.createAiTask(e,t);return r.ok?(0,s.oW)(new u.z(this._aiToolRepository,r.value,{workspaceId:e.workspaceId,aiToolType:e.aiToolType,urlParams:t},c.dZ.SmartTool)):r}async createGraphicAiTask(e,t){let r=await this._aiToolRepository.createGraphicAiTask(e,t);return r.ok?(0,s.oW)(new u.z(this._aiToolRepository,r.value,{workspaceId:e.workspaceId,aiToolType:e.aiToolType,urlParams:t},c.dZ.GraphEditor)):r}aiCheckPopup(){return this._aiToolRepository.aiCheckPopup()}aiConfirmPopup(){return this._aiToolRepository.aiConfirmPopup()}avCheckControllableArea(e){return this._aiToolRepository.avCheckControllableArea(e)}imageHighlightAnalyse(e){return this._aiToolRepository.imageHighlightAnalyse(e)}promptToText(e){return this._aiToolRepository.promptToText(e)}promptSug(e){return this._aiToolRepository.promptSug(e)}getTextToVideoPreset(){return this._aiToolRepository.getTextToVideoPreset()}generateVideo(e){return this._aiToolRepository.generateVideo(e)}syncPackageStatus(e){return this._aiToolRepository.syncPackageStatus(e)}createRenderTask(e){return this._aiToolRepository.createRenderTask(e)}getAudioSNR(e){return this._aiToolRepository.getAudioSNR(e)}cancelEditorTask(e){return this._aiToolRepository.cancelEditorTask(e)}async createEditorTask(e,t){let r=await this._aiToolRepository.createEditorTask(e,t);if(r.ok){var i,n;let o={tasks:null===(n=r.value)||void 0===n?void 0:null===(i=n.tasks)||void 0===i?void 0:i.map(t=>({id:t.id,bindId:t.bind_id,algoType:e.tasks[0].algoType,token:t.token})),canQueue:!0,enterFrom:e.enterFrom,workspaceId:e.workspaceId};return this._aiEditorTask?(this._aiEditorTask.reStartPollingProgress(o.tasks),(0,s.oW)(this._aiEditorTask)):(this._aiEditorTask=new l.O(this._aiToolRepository,r.value,o,t),(0,s.oW)(this._aiEditorTask))}return r}addIntelligentProduct(e){return this._aiToolRepository.addIntelligentProduct(e)}updateIntelligentProduct(e){return this._aiToolRepository.updateIntelligentProduct(e)}getIntelligentProductList(e){return this._aiToolRepository.getIntelligentProductList(e)}constructor(e){super(),this._instantiationService=e,this._aiEditorTask=void 0,this._aiToolRepository=this._instantiationService.createInstance(a.W)}}d=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],d)},256030:function(e,t,r){r.d(t,{P:function(){return p}});var i=r(690613),n=r(114861),o=r(998498),s=r.n(o),a=r(702049),c=r(405051),u=r(121130),l=r(894339),d=r(870590),_=r(556418),h=r(801497);class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new c.yk().build({...c.kk,timeout:9e4});return(0,u.i3)(e),(0,l.mH)(e),(0,n.V)(e),e}()),this._networkClientInstance}get _api(){return`${a._L.getVar("web_domain")}${d.b.PROMPT_TO_TEXT}`}async promptToText(e){var t,r,n;try{let r=this._formatParams(e),n=performance.now(),o=await this._networkClient.post(this._api,r,{withCredentials:!0});if("0"!==o.ret)return(0,i.wf)(Number(o.ret),null!==(t=o.errmsg)&&void 0!==t?t:"");return(0,i.oW)(this._formatResponse(o,r,performance.now()-n))}catch(t){let e=null!==(r=t.ret)&&void 0!==r?r:-1;return(0,i.Mx)(Number(e),null!==(n=(0,_.az)(e))&&void 0!==n?n:h.oc.t("web_ai_writer_hover_generate_error",{},"Couldn\u2019t generate. Try again later."),t)}}_formatParams(e){let{prompt:t,promptPrefix:r}=e,i=`${r}${t}`;return{request_id:e.requestId,mode:"en_toc",oral_script:{prompt:i},smart_script_id:s()(`${i}${e.workSpaceId}`)}}_formatResponse(e,t,r){let{data:{status:i,texts:n}}=e;return{status:i,texts:n.map(e=>({text:e.text.slice(0,1e3),label:e.label,moduleName:e.model_name,scriptId:e.script_id,scriptRequestId:t.request_id,smartScriptId:t.smart_script_id,duration:Math.floor(r)}))}}}},533710:function(e,t,r){r.d(t,{u:function(){return p}});var i=r(690613),n=r(114861),o=r(702049),s=r(405051),a=r(121130),c=r(999432),u=r(894339),l=r(870590),d=r(801497),_=r(134429);let h={businessHeader:{loc:"sg",appSDKVesion:_.Mr,lan:"en",pf:"7",appVersion:_.$U,tdid:"web",signVer:1}};class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build({...s.kk,timeout:9e4});return(0,a.i3)(e),(0,c.V)(e,{...h.businessHeader,lan:d.ZP.language}),(0,u.mH)(e),(0,n.V)(e),e}()),this._networkClientInstance}get _api(){return`${o._L.getVar("web_domain")}${l.b.REPORT}`}async report(e){try{let t=this._formatParams(e),r=await this._networkClient.post(this._api,t,{withCredentials:!0});return(0,i.oW)(r.data)}catch(n){var t,r;let e=null!==(t=n.ret)&&void 0!==t?t:-1;return(0,i.Mx)(Number(e),null!==(r=n.errmsg)&&void 0!==r?r:"report error.",n)}}_formatParams(e){let t=this._generateRandomId();return{id:t,reason:e.reason,reason_key:e.reasonKey,reason_type:e.reasonType,report_type:9,extra:{ai_material:[{object_id:t,type:"text",gen_text:e.genText,prompt_text:e.promptText}]}}}_generateRandomId(){return String(Math.floor(Math.random()*(0xfffffffe+1))+1)}}},276939:function(e,t,r){r.d(t,{L:function(){return s}});var i=r(801497),n=r(690613),o=r(556418);function s(e,t){var r,s,a,c;if(!(void 0!==t))return!e.trim()||/^[^a-zA-Z]*$/.test(e)||e.trim().length<=1?(0,n.wf)(20001,i.oc.t("web_ai_writer_hover_only_support_english",{},"Use prompt in English to generate.")):/[^\u0000-\u007F!"#$%&'’()*+,\-./:;<=>?@\[\]^_`{|}~]/.test(e)?(0,n.wf)(20001,i.oc.t("web_ai_writer_hover_only_support_english",{},"Use prompt in English to generate")):null;let u={[o.Yq.Rewrite]:i.oc.t("web_ai_writer_toast_polish_failure_try_english",{},"Use prompt in English to polish"),[o.Yq.Shorter]:i.oc.t("web_ai_writer_toast_shorten_failure_try_english",{},"Use prompt in English to shorten"),[o.Yq.Longer]:i.oc.t("web_ai_writer_toast_expand_failure_try_english",{},"Use prompt in English to expand")},l={[o.Yq.Rewrite]:i.oc.t("web_ai_writer_toast_content_insufficient_polish",{},"Can\u2019t polish. Add more content and try again."),[o.Yq.Shorter]:i.oc.t("web_ai_writer_toast_content_insufficient_shorten",{},"Can\u2019t shorten. Add more content and try again."),[o.Yq.Longer]:i.oc.t("web_ai_writer_toast_content_insufficient_expand",{},"Can\u2019t expand. Add more content and try again.")};if(!e.trim())return(0,n.wf)(10003,null!==(r=l[t])&&void 0!==r?r:i.oc.t("web_ai_writer_toast_content_insufficient_polish",{},"Can\u2019t polish. Add more content and try again."));if(/^[^a-zA-Z]*$/.test(e)||e.trim().length<=1)return(0,n.wf)(10001,null!==(s=u[t])&&void 0!==s?s:i.oc.t("web_ai_writer_toast_polish_failure_try_english",{},"Use prompt in English to polish"));if(/[^\u0000-\u007F!"#$%&'()*+,\-./:;<=>?@\[\]^_`{|}~]/.test(e))return(0,n.wf)(10001,null!==(a=u[t])&&void 0!==a?a:i.oc.t("web_ai_writer_toast_polish_failure_try_english",{},"Use prompt in English to polish"));if(t===o.Yq.Shorter&&1===e.trim().split(/\s+/).length)return(0,n.wf)(10002,i.oc.t("web_ai_writer_hover_cannot_understand",{},"Couldn\u2019t shorten. Add more content and try again."));if([o.Yq.Longer,o.Yq.Rewrite].includes(t)&&e.trim().split(/\s+/).length<3)return(0,n.wf)(10003,l[t]);if([o.Yq.Longer,o.Yq.Rewrite,o.Yq.Shorter].includes(t)&&e.trim().split(/\s+/).length>500){let e={[o.Yq.Rewrite]:i.oc.t("web_ai_writer_toast_words_limit",{},"Can\u2019t polish. Delete some words and try again."),[o.Yq.Shorter]:i.oc.t("web_ai_writer_toast_words_limit_shorten_failure",{},"Can\u2019t shorten. Delete some words and try again."),[o.Yq.Longer]:i.oc.t("web_ai_writer_toast_words_limit_expand_failure",{},"Can\u2019t expand. Delete some words and try again.")};return(0,n.wf)(10004,null!==(c=e[t])&&void 0!==c?c:i.oc.t("web_ai_writer_toast_words_limit",{},"Can\u2019t polish. Delete some words and try again."))}return null}},390129:function(e,t,r){r.d(t,{m:function(){return i}});let i=(0,r(335290).yh)("audio-voice-data-service")},721389:function(e,t,r){r.d(t,{d:function(){return l}});var i=r(789786),n=r(966697),o=r(273340),s=r(174416),a=r(789869),c=r(33883),u=r(685795);class l extends a.A{get resourceType(){return o.g.VoiceChange}get resourcePanelType(){return c.q.VoiceChange}parseHeycanResponseDataToResources(e){return(0,s.A)(e)}constructor(e,t){super(e,t)}}l=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,u.L),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===u.L?Object:u.L])],l)},374149:function(e,t,r){r.d(t,{CK:function(){return c},T9:function(){return u},Tx:function(){return l},vG:function(){return a}});var i,n,o,s,a=((i={})[i.Audio=0]="Audio",i[i.Video=1]="Video",i);var c=((n={})[n.Official=1]="Official",n[n.Clone=2]="Clone",n);var u=((o={})[o.Processing=1]="Processing",o[o.Success=2]="Success",o[o.Failed=3]="Failed",o[o.NotFound=4]="NotFound",o);var l=((s={})[s.Success=0]="Success",s[s.Processing=1]="Processing",s)},52798:function(e,t,r){r.d(t,{a:()=>y});var i=r("789786"),n=r("415266"),o=r("127830"),s=r("702049"),a=r("405051"),c=r("121130"),u=r("894339"),l=r("905180"),d=r("768101"),_=r("141314"),h=r("966697"),p=r("690613"),g=r("114861"),v=r("374149");let f={CREATE_VC_TASK:"/lv/v2/intelligence/create",QUERY_VC_TASK:"/lv/v2/intelligence/query"};var m=r("920704");class y{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,g.V)(e),(0,l.Y)(e),e}()),this._networkClientInstance}get resourceType(){return o._g.VoiceChange}_getVcParams(e,t){return JSON.stringify({resource_type:t,item_id:e.effectId,speaker_source:e.isCloneVoice?v.CK.Clone:v.CK.Official})}_getVcReqJson(e){var t;return JSON.stringify({speaker:null===(t=e.extra)||void 0===t?void 0:t.speaker_id})}_getApi(e){return`${s._L.getVar("web_domain")}${e}`}async create(e,t){let{assetId:r,platform:i,voice:n,resourceType:o,scene:s=m.KC.Editor}=e;try{let a=await this._networkClient.post(this._getApi(f.CREATE_VC_TASK),{asset_id:r,params:this._getVcParams(n,o),req_json:this._getVcReqJson(n),platform:i,workspace_id:e.workspaceId,smart_tool_type:40,scene:s,is_from_editor:!0},{withCredentials:!0,params:t});return(0,p.oW)(a)}catch(e){return(0,d.m)(e,-1,"create error")}}async query(e,t){let{task_id:r,workspaceId:i}=e;try{let e=await this._networkClient.post(this._getApi(f.QUERY_VC_TASK),{task_id:r,workspace_id:i,smart_tool_type:40},{withCredentials:!0,params:t});return(0,p.oW)(e)}catch(e){return(0,d.m)(e,-1,"query error")}}constructor(e){this.accountService=e,this._urlGenerator=new _.w(n.c)}}y=(0,i.gn)([(0,i.fM)(0,h.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===h.Gw?Object:h.Gw])],y)},720646:function(e,t,r){r.d(t,{w:function(){return a}});var i=r(789786),n=r(966697),o=r(106937),s=r(277714);class a extends o.n{get resourceType(){return this._resourceType}parseHeycanResponseDataToResources(e){return(0,s.Fi)(e,this._resourceType)}constructor(e,t){super(t),this._resourceType=e}}a=(0,i.gn)([(0,i.fM)(1,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof AudioEffectType?Object:AudioEffectType,void 0===n.Gw?Object:n.Gw])],a)},97506:function(e,t,r){r.d(t,{b:function(){return n}});var i,n=((i={}).Music="music",i.SoundEffect="soundEffect",i)},680452:function(e,t,r){r.d(t,{E:function(){return a}});var i=r(789786),n=r(966697),o=r(277714),s=r(733110);class a extends s.i{get resourceType(){return this._resourceType}parseHeycanResponseDataToResources(e){return(0,o.Fi)(e,this._resourceType)}buildCustomRequest(e){var t;return{pack_optional:{need_thumb:!0,thumb_opt:'{"is_support_webp":1}',only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t}}}constructor(e,t){super(t),this._resourceType=e}}a=(0,i.gn)([(0,i.fM)(1,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof AudioEffectType?Object:AudioEffectType,void 0===n.Gw?Object:n.Gw])],a)},846373:function(e,t,r){r.d(t,{u:function(){return s}});var i=r(393958),n=r(565520),o=r(277714);class s extends i.h{get brandResourceType(){return n.Q.Audio}parseResponseDataToResources(e){return(0,o.Fi)(e,void 0,!0)}}},551525:function(e,t,r){r.d(t,{Y:function(){return v}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(894339),l=r(866006),d=r(512505),_=r(966697),h=r(277714),p=r(768101),g=r(772270);class v{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,o.V)(e),e}()),this._networkClientInstance}async getAlbumSongs(e){let t=e instanceof l.yt?e.config:e;try{var r,i;let o=await this._networkClient.post(`${this._api}?lite_aid=${g.AF}`,{id:t.id,...this._getTokenParams(e)}),s=Number(null!==(r=o.ret)&&void 0!==r?r:0),a=null!==(i=o.errmsg)&&void 0!==i?i:"";if(0!==s)return(0,n.wf)(null!=s?s:-1,null!=a?a:"");let c=this._convertResponseToQueryToken(e,o);return(0,n.oW)(c)}catch(e){return(0,p.m)(e,-1,"getMusicAlbums api error")}}_getTokenParams(e){var t,r;return(0,l.ky)(e)?{offset:e.offset,count:null!==(t=e.config.limit)&&void 0!==t?t:50}:{offset:0,count:null!==(r=e.limit)&&void 0!==r?r:50}}_convertResponseToQueryToken(e,t){var r,i;let n=e instanceof l.yt?e.config:e,o=null!==(i=null===(r=t.data.songs)||void 0===r?void 0:r.map(e=>(0,h.y3)(e)))&&void 0!==i?i:[],s=e instanceof l.yt?e.offset:0,a=t.data.has_more,c=s+o.length;return(0,l.ib)(n,{list:o},{hasMore:a,offset:c})}get _api(){return`${s._L.getVar("web_domain")}${d.J.GET_COLLECTION_SONGS}`}constructor(e){this._capcutAccountService=e}}v=(0,i.gn)([(0,i.fM)(0,_.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===_.Gw?Object:_.Gw])],v)},596150:function(e,t,r){r.d(t,{x:function(){return v}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(894339),l=r(866006),d=r(786022),_=r(727334),h=r(966697),p=r(277714),g=r(768101);class v{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,o.V)(e),e}()),this._networkClientInstance}async getAlbumSongs(e){let t=e instanceof l.yt?e.config:e;try{var r,i;let o=await this._networkClient.post(this._api,{app_id:d.kJ,region:this._capcutAccountService.userProfile.region,id:t.id,...this._getTokenParams(e)}),s=Number(null!==(r=o.ret)&&void 0!==r?r:0),a=null!==(i=o.errmsg)&&void 0!==i?i:"";if(0!==s)return(0,n.wf)(null!=s?s:-1,null!=a?a:"");let c=this._convertResponseToQueryToken(e,o);return(0,n.oW)(c)}catch(e){return(0,g.m)(e,-1,"getMusicAlbums api error")}}_getTokenParams(e){var t,r;return(0,l.ky)(e)?{offset:e.offset,count:null!==(t=e.config.limit)&&void 0!==t?t:50}:{offset:0,count:null!==(r=e.limit)&&void 0!==r?r:50}}_convertResponseToQueryToken(e,t){var r,i;let n=e instanceof l.yt?e.config:e,o=null!==(i=null===(r=t.data.songs)||void 0===r?void 0:r.map(e=>(0,p.y3)(e)))&&void 0!==i?i:[],s=e instanceof l.yt?e.offset:0,a=t.data.has_more,c=s+o.length;return(0,l.ib)(n,{list:o},{hasMore:a,offset:c})}get _api(){return`${s._L.getVar("web_domain")}${_.J.GET_COLLECTION_SONGS}`}constructor(e){this._capcutAccountService=e}}v=(0,i.gn)([(0,i.fM)(0,h.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===h.Gw?Object:h.Gw])],v)},620752:function(e,t,r){r.d(t,{g:function(){return p}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(894339),l=r(786022),d=r(768101),_=r(727334),h=r(966697);class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,o.V)(e),e}()),this._networkClientInstance}async getMusicAlbums(){try{var e,t;let r=await this._networkClient.post(this._api,{app_id:l.kJ,region:this._capcutAccountService.userProfile.region}),i=Number(null!==(e=r.ret)&&void 0!==e?e:0),o=null!==(t=r.errmsg)&&void 0!==t?t:"";if(0!==i)return(0,n.wf)(null!=i?i:-1,null!=o?o:"");let s=this._convertResponseToCollectionData(r);return(0,n.oW)(s)}catch(e){return(0,d.m)(e,-1,"getMusicAlbums api error")}}_convertResponseToCollectionData(e){let{data:t}=e;return{albums:t.collections.map(e=>{let t=Object.values(e.cover_url).map(e=>this._parseUrlToTranscodeInfo(e));return{id:e.id,name:e.name,coverUrl:e.cover_url.medium,transcodeInfo:t}})}}_parseUrlToTranscodeInfo(e){var t,r;let i=e.match(/_(\d+)x(\d+)\./);return{url:e,width:Number(null!==(t=null==i?void 0:i[1])&&void 0!==t?t:0),height:Number(null!==(r=null==i?void 0:i[2])&&void 0!==r?r:0)}}get _api(){return`${s._L.getVar("web_domain")}${_.J.GET_MUSIC_COLLECTIONS}`}constructor(e){this._capcutAccountService=e}}p=(0,i.gn)([(0,i.fM)(0,h.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===h.Gw?Object:h.Gw])],p)},446204:function(e,t,r){r.d(t,{F:function(){return p}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(894339),l=r(786022),d=r(768101),_=r(727334),h=r(966697);class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,o.V)(e),e}()),this._networkClientInstance}async getSoundEffectAlbums(){try{var e,t;let r=await this._networkClient.post(this._api,{app_id:l.kJ,region:this._capcutAccountService.userProfile.region}),i=Number(null!==(e=r.ret)&&void 0!==e?e:0),o=null!==(t=r.errmsg)&&void 0!==t?t:"";if(0!==i)return(0,n.wf)(null!=i?i:-1,null!=o?o:"");let s=this._convertResponseToCollectionData(r);return(0,n.oW)(s)}catch(e){return(0,d.m)(e,-1,"getMusicAlbums api error")}}_convertResponseToCollectionData(e){let{data:t}=e;return{albums:t.collections.map(e=>{let t=Object.values(e.cover_url).map(e=>this._parseUrlToTranscodeInfo(e));return{id:e.id,name:e.name,coverUrl:e.cover_url.large,transcodeInfo:t}})}}_parseUrlToTranscodeInfo(e){var t,r;let i=e.match(/_(\d+)x(\d+)\./);return{url:e,width:Number(null!==(t=null==i?void 0:i[1])&&void 0!==t?t:0),height:Number(null!==(r=null==i?void 0:i[2])&&void 0!==r?r:0)}}get _api(){return`${s._L.getVar("web_domain")}${_.J.GET_SOUND_EFFECT_COLLECTIONS}`}constructor(e){this._capcutAccountService=e}}p=(0,i.gn)([(0,i.fM)(0,h.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===h.Gw?Object:h.Gw])],p)},184754:function(e,t,r){r.d(t,{S:function(){return n}});var i,n=((i={})[i.music=0]="music",i[i.audioEffect=1]="audioEffect",i)},155513:function(e,t,r){r.d(t,{X:function(){return l}});var i=r(789786),n=r(966697),o=r(273340),s=r(748020),a=r(789869),c=r(33883),u=r(685795);class l extends a.A{get resourceType(){return o.g.AutoBeautyBody}get resourcePanelType(){return c.q.AutoBeautyBody}parseHeycanResponseDataToResources(e){return(0,s.r)(e)}constructor(e,t){super(e,t)}}l=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,u.L),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===u.L?Object:u.L])],l)},859765:function(e,t,r){r.d(t,{w:function(){return o}});var i=r(127830),n=r(512363);class o extends n.L{get resourceType(){return i._g.AutoBeautyBody}}},217809:function(e,t,r){r.d(t,{T:function(){return a}});var i=r(872443),n=r(33883),o=r(748020),s=r(127830);class a extends i.L{get resourceType(){return s._g.AutoBeautyBody}get resourcePanelType(){return n.q.AutoBeautyBody}parseHeycanResponseDataToResources(e){return(0,o.r)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t}}}}},500071:function(e,t,r){r.d(t,{Z:function(){return s}});var i=r(773943),n=r(623094),o=r(127830);class s extends i.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return o._g.AutoBeautyFace}parseEffectsToResources(e,t){return e.map(e=>(0,n.t)(e,t))}}},649607:function(e,t,r){r.d(t,{E:function(){return a}});var i=r(872443),n=r(33883),o=r(521687),s=r(127830);class a extends i.L{get resourcePanelType(){return n.q.AutoBeautyFace}get resourceType(){return s._g.AutoBeautyFace}parseHeycanResponseDataToResources(e){return(0,o.L)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t}}}}},623094:function(e,t,r){r.d(t,{t:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r,extra:o}=(0,i.sh)(n._g.AutoBeautyFace,e,t);return{...r,intensityKey:o.intensity_key,effectType:o.effect_type,order:o.order,selectedIcon:o.selected_icon}}},521687:function(e,t,r){r.d(t,{L:function(){return a}});var i=r(889862),n=r(127830),o=r(981632),s=r(32372);function a(e){var t,r;let a=(0,i.E)(e,n._g.AutoBeautyFace),c=(0,o.D)(e.common_attr.extra),u=null===(r=e.collection)||void 0===r?void 0:null===(t=r.resources)||void 0===t?void 0:t.map(e=>({id:e.id,effectType:e.effect_type,source:e.source}));return{key:`${n._g.AutoBeautyFace}_${a.resourceId}`,resourceId:a.resourceId,thirdResourceId:a.thirdResourceId,effectId:a.effectId,md5:a.md5,name:a.title,isBusiness:a.isBusiness,isVip:a.isVip,icon:{uri:(0,s.s)(a.coverUrl),urlList:[a.coverUrl]},previewUrl:a.coverUrl,package:{uri:(0,s.s)(a.originUrl),urlList:[a.originUrl]},requirements:a.requirements,modelNames:a.modelNames,source:a.source,collection:u,sdkVersion:"",isPrefab:!1,intensityKey:c.intensity_key,effectType:c.effect_type,effectTypeId:a.effectType,order:c.order,selectedIcon:c.selected_icon,skinColor:c.skin_color,sliderDefaultValue:c.slider_defaultValue,exclusionGroup:null==c?void 0:c.exclusion_group}}},731275:function(e,t,r){r.d(t,{X:function(){return l}});var i=r(789786),n=r(966697),o=r(273340),s=r(1939),a=r(789869),c=r(33883),u=r(685795);class l extends a.A{get resourceType(){return o.g.AutoBeautyMakeup}get resourcePanelType(){return c.q.AutoBeautyMakeup}parseHeycanResponseDataToResources(e){return(0,s.T)(e)}constructor(e,t){super(e,t)}}l=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,u.L),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===u.L?Object:u.L])],l)},939152:function(e,t,r){r.d(t,{_:function(){return o}});var i=r(127830),n=r(512363);class o extends n.L{get resourceType(){return i._g.AutoBeautyMakeup}}},388520:function(e,t,r){r.d(t,{M:function(){return s}});var i=r(773943),n=r(743612),o=r(127830);class s extends i.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return o._g.AutoBeautyMakeup}parseEffectsToResources(e,t){return e.map(e=>(0,n.W)(e,t))}}},15365:function(e,t,r){r.d(t,{f:function(){return s}});var i=r(773943),n=r(381280),o=r(127830);class s extends i.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return o._g.AutoBeautyShape}parseEffectsToResources(e,t){return e.map(e=>(0,n.c)(e,t))}}},725402:function(e,t,r){r.d(t,{g:function(){return a}});var i=r(872443),n=r(33883),o=r(430675),s=r(127830);class a extends i.L{get resourceType(){return s._g.AutoBeautyShape}get resourcePanelType(){return n.q.AutoBeautyShape}parseHeycanResponseDataToResources(e){return(0,o.x)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t}}}buildCustomRequestParams(){var e;return{device_type:"default",channel:null!==(e=new URLSearchParams(location.search).get("lokiChannel"))&&void 0!==e?e:"online"}}}},852968:function(e,t,r){r.d(t,{X:function(){return i}});let i=(0,r(335290).yh)("auto-beauty-data-service")},121761:function(e,t,r){r.d(t,{i:function(){return _}});var i=r(789786),n=r(55449),o=r(402655),s=r(800788),a=r(966421),c=r(625569),u=r(941953),l=r(65934),d=r(127830);class _ extends o.JT{getAutoBeautyFace(e){return this._autoBeautyFaceDataService.getAutoBeautyFace(e)}batchGetAutoBeautyFacesByIdAndType(e){return this._autoBeautyFaceDataService.batchGetAutoBeautyFacesByIdAndType(e)}getAutoBeautyFaceCategories(e){return this._autoBeautyFaceDataService.getAutoBeautyFaceCategories(e)}getAutoBeautyBodyCategories(e){return this._autoBeautyBodyDataService.getAutoBeautyBodyCategories(e)}getAutoBeautyBody(e){return this._autoBeautyBodyDataService.getAutoBeautyBody(e)}getAutoBeautyShape(e){return this._autoBeautyShapeDataService.getAutoBeautyShape(e)}getAutoBeautyShapeCategories(e){return this._autoBeautyShapeDataService.getAutoBeautyShapeCategories(e)}getAutoBeautyMakeup(e){return this._autoBeautyMakeupDataService.getAutoBeautyMakeup(e)}getAutoBeautyMakeupCategories(e){return this._autoBeautyMakeupDataService.getAutoBeautyMakeupCategories(e)}batchGetAutoBeautyByIds(e){let{resourceType:t}=e;if(t===d._g.AutoBeautyBody)return this._autoBeautyBodyDataService.batchGetAutoBeautyBodiesByIds(e);if(t===d._g.AutoBeautyFace)return this._autoBeautyFaceDataService.batchGetAutoBeautyFacesByIds(e);if(t===d._g.AutoBeautyShape)return this._autoBeautyShapeDataService.batchGetAutoBeautyShapesByIds(e);else if(t===d._g.AutoBeautyMakeup)return this._autoBeautyMakeupDataService.batchGetAutoBeautyMakeupsByIds(e);(0,s.ss)(`unknown resourceType ${t}`)}constructor(e={},t){super(),this._options=e,this._instantiationService=t,this._autoBeautyFaceDataService=this._instantiationService.createInstance(a.z),this._autoBeautyBodyDataService=this._instantiationService.createInstance(c.r),this._autoBeautyShapeDataService=this._instantiationService.createInstance(l.w),this._autoBeautyMakeupDataService=this._instantiationService.createInstance(u.s,this._options)}}_=(0,i.gn)([(0,i.fM)(1,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,void 0===n.T?Object:n.T])],_)},76552:function(e,t,r){r.d(t,{D:function(){return s},d:function(){return a}});var i=r(926770),n=r(308665);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["appVersion","sdkVersion"];return Object.keys(e).filter(e=>-1===t.indexOf(e)).sort((e,t)=>e.localeCompare(t)).reduce((t,r)=>{let i=e[r];return(Array.isArray(i)?i=i.join(","):"object"==typeof i&&null!==i&&(i=o(i)),""===t)?`${r}_${i}`:`${t}_${r}_${i}`},"")}function s(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(s)return e.postWithCache=e.post,e;let a=e.post;return e.postWithCache=async function(){let e,s;for(var c,u,l,d=arguments.length,_=Array(d),h=0;h<d;h++)_[h]=arguments[h];let p=o(null!==(u=_[1])&&void 0!==u?u:{}),g=r?`${r}_${p}`:p,v=(null===(c=_[1])||void 0===c?void 0:c.sortingPosition)!==0;if(!v){performance.now();let r=await t.database.connect(i.P.id,n.m.name);if(r.ok){s=r.value;let t=await s.query(g);t.ok&&t.value&&(e=t.value)}}if(e)return a.apply(this,_).then(e=>{s&&e&&s.set(g,{id:g,request:_,response:e,maxAge:432e5})}),e.response;try{let e=await a.apply(this,_),t=(null==e?void 0:null===(l=e.BaseResp)||void 0===l?void 0:l.StatusCode)===0;return s&&t&&!v&&s.set(g,{id:g,request:_,response:e,maxAge:432e5}),e}catch(e){throw e}},e}function a(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(s)return e.postWithCache=e.post,e;let a=e.post,c=!0;return e.postWithCache=function(){for(var e,s,u=arguments.length,l=Array(u),d=0;d<u;d++)l[d]=arguments[d];let _=c;c=!1;let h=o(null!==(s=l[1])&&void 0!==s?s:{}),p=r?`${r}_${h}`:h,g=(null===(e=l[1])||void 0===e?void 0:e.sortingPosition)!==0,v=(async()=>{try{let e=await t.database.connect(i.P.id,n.m.name);if(e.ok)return e.value;return null}catch(e){return null}})(),{promise:f,resolve:m,reject:y}=Promise.withResolvers(),w=async()=>{let e=performance.now();try{let e=await v;if(e){let t=await e.query(p);if(t.ok&&t.value){let e=t.value;m(e.response)}}}finally{_&&performance.measure(`QUERY_DB_${h}`,{start:e})}};return(async()=>{var e;let t=performance.now(),r=null;try{r=await a.apply(this,l),m(r)}catch(e){y(e);return}finally{_&&performance.measure(`FETCH_${h}`,{start:t})}let i=await v,n=(null==r?void 0:null===(e=r.BaseResp)||void 0===e?void 0:e.StatusCode)===0;i&&n&&!g&&i.set(p,{id:p,request:l,response:r,maxAge:432e5})})(),!g&&w(),f},e}},502600:function(e,t,r){r.d(t,{DP:function(){return o},HI:function(){return n},bl:function(){return i}});let i={GET_CATEGORY_BY_PANEL:"/artist/v1/panel/get_panel_info",GET_RECOMMENDS:"/artist/v1/effect/ccweb/feed",GET_CATEGORY_RESOURCE:"/artist/v1/effect/get_resources_by_category_id",GET_SEARCH_WORDS:"/artist/v1/effect/get_search_words",GET_SUGGEST_WORDS:"/artist/v1/effect/get_suggest_words",SEARCH:"/artist/v1/effect/search",SEARCH_FROM_TUCHONG:"/artist/v1/library/tuchong/search",BATCH_GET_RESOURCES_BY_ID:"/artist/v1/effect/mget_artist_item",BATCH_GET_TUCHONG_RESOURCES_BY_ID:"/artist/v1/effect/mget_item",GET_ADOBE_PHOTO_BY_ID:"/artist/v1/effect/mget_item",GET_THIRD_PARTY_RESOURCES_BY_ID:"/artist/v1/effect/mget_item",ORDER:"/artist/v1/library/tuchong/order",GET_COLLECTIONS:"/artist/v1/effect/user_favorite_list",BATCH_FAVORITE:"/artist/v1/effect/batch_favorite",BATCH_UNFAVORITE:"/artist/v1/effect/batch_unfavorite",GET_SIMILARITIES:"/artist/v1/effect/get_recommend_items",COPYRIGHT_TIPS:"/artist/v1/effect/copyright_tips",GET_HOMEPAGE_EFFECT_LIST:"/artist/v1/homepage/get_effect_list",POST_EFFECT:"/artist/v1/post/effect"},n="11.0.0",o="web"},273340:function(e,t,r){r.d(t,{g:function(){return n}});var i,n=((i={})[i.WordArt=1]="WordArt",i[i.Sticker=2]="Sticker",i[i.AudioEffect=3]="AudioEffect",i[i.Song=4]="Song",i[i.Video=5]="Video",i[i.TextTemplate=6]="TextTemplate",i[i.SpecialEffect=7]="SpecialEffect",i[i.FaceTool=8]="FaceTool",i[i.Image=9]="Image",i[i.Font=10]="Font",i[i.Timbre=11]="Timbre",i[i.Filter=12]="Filter",i[i.VideoAnimation=13]="VideoAnimation",i[i.Color=14]="Color",i[i.TextAnimation=18]="TextAnimation",i[i.Transitions=19]="Transitions",i[i.SubtitleTemplate=48]="SubtitleTemplate",i[i.Recipe=50]="Recipe",i[i.CloneVoice=51]="CloneVoice",i[i.DreaminaAiVideo=53]="DreaminaAiVideo",i[i.DigitalHuman=58]="DigitalHuman",i[i.AiAvatarMask=69]="AiAvatarMask",i[i.WordArtCollection=101]="WordArtCollection",i[i.StickerCollection=102]="StickerCollection",i[i.AudioEffectCollection=103]="AudioEffectCollection",i[i.VideoEffectCollection=104]="VideoEffectCollection",i[i.EmoticonCollection=105]="EmoticonCollection",i[i.TextTemplateCollection=106]="TextTemplateCollection",i[i.ImageCollection=109]="ImageCollection",i[i.FilterCollection=112]="FilterCollection",i[i.VideoImage=201]="VideoImage",i[i.WebTemplate=202]="WebTemplate",i[i.GraphicSticker=206]="GraphicSticker",i[i.AutoBeautyCollection=121]="AutoBeautyCollection",i[i.AutoBeautyFace=21]="AutoBeautyFace",i[i.AutoBeautyShape=20]="AutoBeautyShape",i[i.AutoBeautyBody=23]="AutoBeautyBody",i[i.AutoBeautyMakeup=22]="AutoBeautyMakeup",i[i.VoiceChange=26]="VoiceChange",i[i.VideoBackground=27]="VideoBackground",i[i.ShapeAnimation=54]="ShapeAnimation",i[i.StickerMotion=35]="StickerMotion",i[i.PathAnimation=32]="PathAnimation",i[i.Graffiti=31]="Graffiti",i[i.MattingStroke=38]="MattingStroke",i[i.ShortVideo=210]="ShortVideo",i[i.CanvasProduction=211]="CanvasProduction",i[i.TextGlow=29]="TextGlow",i[i.CurveHSL=147]="CurveHSL",i[i.Mask=28]="Mask",i[i.Emoji=2]="Emoji",i[i.SmartColorAdjust=25]="SmartColorAdjust",i[i.Integration=138]="Integration",i[i.Bubble=49]="Bubble",i[i.Mix=36]="Mix",i[i.CurvePreset=146]="CurvePreset",i[i.CurveSpeed=37]="CurveSpeed",i)},758027:function(e,t,r){r.d(t,{B:function(){return R}});var i=r(789786),n=r(200247),o=r(702049),s=r(405051),a=r(121130),c=r(866006),u=r(768101),l=r(690613),d=r(114861),_=r(502600),h=r(606805),p=r(801497),g=r(916636),v=r(932606),f=r(9590),m=r(544688),y=r(744268),w=r(847083),k=r(685795),b=r(76552),S=r(332557);class R{shouldUseRace(){return!1}get _networkClient(){if(!this._networkClientInstance){let e=function(e){let{addBusinessPlugins:t}=e,r=new s.yk().build(s.kk);return t(r,[w.U.Preload]),(0,a.i3)(r),(0,d.V)(r),r}(this._clientPluginService);this._networkClientInstance=this.shouldUseRace()?(0,b.d)(e,this._storageService,this._accountService.uniqueId,this._configurationService.disableRequestCache):(0,b.D)(e,this._storageService,this._accountService.uniqueId,this._configurationService.disableRequestCache)}return this._networkClientInstance}setFixedRegion(e){this._fixedRegion=e}async getResources(e){var t,r,i,n,o,s,a,d;let g=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=Date.now(),f=e instanceof c.yt?e.config:e;try{let a=await this._convertParamsToRequest(e,g),u=this._configurationService.getAppConfigurationValue("heycanDataService.fixedRegion")||this._fixedRegion,d=(0,h._)(null!==(t=null!=u?u:this._accountService.userProfile.region)&&void 0!==t?t:"",p.ZP.language,f.sdkVersion,f.appID,!!u),m=await this._networkClient.postWithCache(this.getResourcesApi,a,{params:{...d.params,...this.buildCustomRequestParams()},withCredentials:d.withCredentials}),y=Number(null!==(r=m.ret)&&void 0!==r?r:0),w=null!==(i=m.errmsg)&&void 0!==i?i:"";try{null===(s=this._slardarAdapterService)||void 0===s||s.sendEvent("vimo_material_fetch_result",{path:_.bl.GET_CATEGORY_RESOURCE,ret:String(y),msg:w,category_id:String(f.category),category_key:f.category_key||"",panel:this.resourcePanelType,logid:m.logid,detailCount:null===(o=m.data)||void 0===o?void 0:null===(n=o.effect_item_list)||void 0===n?void 0:n.length,duration:Date.now()-v})}catch(e){console.error("_slardarAdapterService error",e)}if(0!==y)return(0,l.wf)(null!=y?y:-1,null!=w?w:"");let k=e instanceof c.yt?e.config:e,b=this._convertResponseToQueryToken(k,m);return(0,l.oW)(b)}catch(t){let e=(0,u.m)(t,-1,`${this.resourcePanelType} getResources api error: ${null==t?void 0:t.message}`);console.error("BaseGetResourcesByCategoryRepository getResources error",t);try{null===(d=this._slardarAdapterService)||void 0===d||d.sendEvent("vimo_material_fetch_result",{path:_.bl.GET_CATEGORY_RESOURCE,category_id:String(f.category),category_key:f.category_key||"",ret:String(e.code),logid:null===(a=e.cause)||void 0===a?void 0:a.logid,msg:e.msg,panel:this.resourcePanelType,duration:Date.now()-v})}catch(e){console.error("_slardarAdapterService error",e)}return e}}get skipSingleDataParseError(){return!1}get defaultQueryToken(){return{offset:0,count:50}}buildCustomRequest(e){return{}}buildCustomRequestParams(){return{}}async _convertParamsToRequest(e,t){var r,i;let n=e instanceof c.yt?e.config:e,o=this.buildCustomRequest(n),s=t?{}:await this.buildCustomFilterParams(n),a=(0,c.ky)(e)?{count:null!==(r=e.config.limit)&&void 0!==r?r:50,offset:null!==(i=e.offset)&&void 0!==i?i:0}:{...this.defaultQueryToken,...e.limit?{count:e.limit}:void 0};return{panel:this.resourcePanelType,...s,...o,...a}}_convertResponseListToResourceList(e){return e.map(e=>{let t={...e,panel:this.resourcePanelType};if(!this.skipSingleDataParseError)return this.parseHeycanResponseDataToResources(t);try{return this.parseHeycanResponseDataToResources(t)}catch(e){return console.error(`${this.resourceType} parse error:`,e),null}}).filter(Boolean)}_convertResponseToQueryToken(e,t){let r=this._convertResponseListToResourceList(t.data.effect_item_list),i=t.data.next_offset,n=t.data.has_more;return(0,c.ib)(e,{list:r},{hasMore:n,offset:i})}get getResourcesApi(){return`${o._L.getVar("web_domain")}${_.bl.GET_CATEGORY_RESOURCE}`}async _getWhiteUserPermission(){if(!this._accountService.hasLogin)return!1;let[e,t]=(await this._userPermissionDataService.getUserPermission({})).pair();return!e&&!!t.publishWebTemplatePermission||!1}async buildCustomFilterVipParams(){let e=await this._getWhiteUserPermission();return!this._configurationService.getAppConfigurationValue("vip.disableFilter")&&await (0,v.g)(e,this.resourceType)?{filter_paid_type:[f.m.Subscribe]}:{}}buildCustomFilterOtherParams(e){return{}}async buildCustomFilterParams(e){let t=await this.buildCustomFilterVipParams(),r=this.buildCustomFilterOtherParams(e),i={...t,...r};return Object.keys(i).length>0?{filter_optional:{...i}}:{}}constructor(e,t,r,i,n,o,s){this._accountService=e,this._userPermissionDataService=t,this._effectAbTestService=r,this._configurationService=i,this._slardarAdapterService=n,this._clientPluginService=o,this._storageService=s}}R=(0,i.gn)([(0,i.fM)(0,n.D),(0,i.fM)(1,m.c),(0,i.fM)(2,g.c),(0,i.fM)(3,y.Ui),(0,i.fM)(4,k.L),(0,i.fM)(5,w.a),(0,i.fM)(6,S.U),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.D?Object:n.D,void 0===m.c?Object:m.c,void 0===g.c?Object:g.c,void 0===y.Ui?Object:y.Ui,void 0===k.L?Object:k.L,void 0===w.a?Object:w.a,void 0===S.U?Object:S.U])],R)},733110:function(e,t,r){r.d(t,{i:function(){return g}});var i=r(789786),n=r(966697),o=r(702049),s=r(405051),a=r(121130),c=r(866006),u=r(690613),l=r(114861),d=r(502600),_=r(606805),h=r(801497),p=r(768101);class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,l.V)(e),e}()),this._networkClientInstance}async getResources(e){try{var t,r;let i=await this._networkClient.post(this._getResourcesApi,this._convertParamsToRequest(e),(0,_._)(this._accountService.userProfile.region,h.ZP.language)),n=Number(null!==(t=i.ret)&&void 0!==t?t:0),o=null!==(r=i.errmsg)&&void 0!==r?r:"";if(0!==n)return(0,u.wf)(null!=n?n:-1,null!=o?o:"");let s=e instanceof c.yt?e.config:e,a=this._convertResponseToQueryToken(s,i);return(0,u.oW)(a)}catch(e){return(0,p.m)(e,-1,`[${this.resourceType}] getResources api error`)}}get defaultQueryToken(){return{offset:0,count:50}}buildCustomRequest(e){return{}}_convertParamsToRequest(e){var t,r;let i=e instanceof c.yt?e.config:e,n=this.buildCustomRequest(i),o=(0,c.ky)(e)?{count:null!==(t=e.config.limit)&&void 0!==t?t:50,offset:null!==(r=e.offset)&&void 0!==r?r:0}:{...this.defaultQueryToken,...e.limit?{count:e.limit}:void 0};return{effect_type:this.resourceType,...n,...o}}_convertResponseToQueryToken(e,t){let r=t.data.effect_item_list.map(e=>this.parseHeycanResponseDataToResources(e)),i=t.data.next_offset,n=t.data.has_more;return(0,c.ib)(e,{list:r},{hasMore:n,offset:i,requestId:t.logid})}get _getResourcesApi(){return`${o._L.getVar("web_domain")}${d.bl.GET_RECOMMENDS}`}constructor(e){this._accountService=e}}g=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],g)},622472:function(e,t,r){r.d(t,{T:function(){return h}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(606805),u=r(801497),l=r(966697),d=r(502600),_=r(335534);class h{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,o.V)(e),e}()),this._networkClientInstance}async order(e){try{var t,r;let i=this._convertRequest(e),o=await this._networkClient.post(this._api,i,(0,c._)(this._accountService.userProfile.region,u.ZP.language)),s=Number(null!==(t=o.data.ret)&&void 0!==t?t:0),a=null!==(r=o.data.errmsg)&&void 0!==r?r:"";if(0!==s)return(0,n.wf)(_.D.OrderFailedFE,`order failed ${e.id}`,{code:s,message:a,logid:o.data.log_id});return this._convertResponse(o.data,e)}catch(t){return(0,n.wf)(_.D.OrderFailedFE,`order failed ${e.id}`,{code:-1,message:"string"==typeof t?t:"order api error",logid:""})}}buildCustomRequest(e){return{}}_convertRequest(e){return{items:[{id:e.id,effect_type:this.effectType,source:this.effectSource}],scene:this.scene,...this.buildCustomRequest(e)}}_convertResponse(e,t){var r;return(null===(r=e.data.origin_resource)||void 0===r?void 0:r[t.id])?(0,n.oW)({url:e.data.origin_resource[t.id]}):(0,n.wf)(_.D.OrderFailedFE,`order failed ${t.id}`,{code:Number(e.ret),message:e.errmsg,logid:e.log_id})}get _api(){return`${s._L.getVar("web_domain")}${d.bl.ORDER}`}constructor(e){this._accountService=e}}h=(0,i.gn)([(0,i.fM)(0,l.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===l.Gw?Object:l.Gw])],h)},44859:function(e,t,r){r.d(t,{F:function(){return v}});var i=r(789786),n=r(690613),o=r(114861),s=r(502600),a=r(702049),c=r(606805),u=r(966697),l=r(801497),d=r(405051),_=r(121130),h=r(768101),p=r(134429),g=r(772270);class v{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new d.yk().build(d.kk);return(0,_.i3)(e),(0,o.V)(e),e}()),this._networkClientInstance}async postEffect(e){try{var t,r,i;let o=await this._networkClient.post(this._getPostEffectApi,this._convertParamsToRequest(e),(0,c._)(this._accountService.userProfile.region,l.ZP.language,void 0,null!==(t=e.appId)&&void 0!==t?t:g.AF)),s=Number(null!==(r=o.ret)&&void 0!==r?r:0);if(0!==s)return(0,n.wf)(s,null!==(i=o.errmsg)&&void 0!==i?i:"");return(0,n.oW)(this._convertResponseToData(o))}catch(e){return(0,h.m)(e,-1,`${this.resourceType} postEffect error`)}}buildCustomRequest(e){return{}}_convertParamsToRequest(e){let t=this.buildCustomRequest(e),{title:r,description:i,tags:n,isOriginal:o,isBusiness:s,format:a,icon:c,file:u,webExtra:l,thirdResourceId:d}=e.commonData,_={common_data:{title:r,description:i,tags:n,is_original:o,source:"user_post_videocut",is_business:s,format:a,icon:{image_uri:null==c?void 0:c.imageUri,height:null==c?void 0:c.height,width:null==c?void 0:c.width},file:{file_uri:null==u?void 0:u.fileUri,size:null==u?void 0:u.size,file_md5:null==u?void 0:u.fileMd5},sdk_version:p.f4,web_extra:l,third_resource_id:d},is_vip:e.isVip,third_platform:e.thirdPlatform,effect_type:this.resourceType},h=e=>(Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t],e[t]&&"object"==typeof e[t]&&(h(e[t]),!Object.keys(e[t]).length&&delete e[t])}),e);return h(_),{..._,...t}}_convertResponseToData(e){return{resourceId:e.data.resource_id,source:e.data.source}}get _getPostEffectApi(){return`${a._L.getVar("web_domain")}${s.bl.POST_EFFECT}`}constructor(e){this._accountService=e}}v=(0,i.gn)([(0,i.fM)(0,u.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===u.Gw?Object:u.Gw])],v)},157021:function(e,t,r){r.d(t,{d:function(){return g}});var i=r(789786),n=r(966697),o=r(702049),s=r(405051),a=r(121130),c=r(866006),u=r(690613),l=r(114861),d=r(502600),_=r(606805),h=r(801497),p=r(768101);class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,l.V)(e),e}()),this._networkClientInstance}async searchResources(e){try{var t,r;let i=e instanceof c.yt?e.config:e,n=await this._networkClient.post(this._searchApi,this._convertParamsToRequest(e),(0,_._)(this._accountService.userProfile.region,h.ZP.language,i.sdkVersion,i.appID)),o=Number(null!==(t=n.ret)&&void 0!==t?t:0),s=null!==(r=n.errmsg)&&void 0!==r?r:"";if(0!==o)return(0,u.wf)(null!=o?o:-1,null!=s?s:"");let a=await this.filterServiceResponse(i,n),l=this._convertResponseToQueryToken(i,a),d=await this.filterResources(l);return(0,u.oW)(d)}catch(e){return(0,p.m)(e,-1,`[${this.resourceType}] searchResources api error`)}}get defaultQueryToken(){return{offset:0,count:50}}buildCustomRequest(e){return{}}filterResources(e){return Promise.resolve(e)}filterServiceResponse(e,t){return Promise.resolve(t)}_convertParamsToRequest(e){var t,r;let i=e instanceof c.yt?e.config:e,n={effect_type:this.resourceType,query:i.query,from:i.from,need_recommend:i.needRecommend},o=this.buildCustomRequest(i),s=(0,c.ky)(e)?{count:null!==(t=e.config.limit)&&void 0!==t?t:50,offset:null!==(r=e.offset)&&void 0!==r?r:0,search_id:e.searchId}:{...this.defaultQueryToken,...e.limit?{count:e.limit}:void 0};return{...n,...o,...s}}_convertResponseToQueryToken(e,t){let r=t.data.effect_item_list.map(e=>this.parseHeycanResponseDataToResources(e)),i=t.data.next_offset,n=t.data.has_more,o=t.data.related_words;return(0,c.ib)(e,{list:r,relativeWords:o},{hasMore:n,offset:i,searchId:t.data.search_id,requestId:t.data.request_id})}get _searchApi(){return`${o._L.getVar("web_domain")}${d.bl.SEARCH}`}constructor(e){this._accountService=e}}g=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],g)},222977:function(e,t,r){r.d(t,{g:function(){return s}});var i=r(702049),n=r(502600),o=r(157021);class s extends o.d{get _searchApi(){return`${i._L.getVar("web_domain")}${n.bl.SEARCH_FROM_TUCHONG}`}}},106937:function(e,t,r){r.d(t,{n:function(){return p}});var i=r(789786),n=r(966697),o=r(702049),s=r(405051),a=r(121130),c=r(768101),u=r(690613),l=r(114861),d=r(502600),_=r(606805),h=r(801497);class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,l.V)(e),e}()),this._networkClientInstance}async batchGetResources(e){try{var t,r;let i=await this._networkClient.post(this._batchGetResourcesApi,this._convertParamsToRequest(e),(0,_._)(this._accountService.userProfile.region,h.ZP.language,void 0,e.appId?Number(e.appId):void 0)),n=Number(null!==(t=i.ret)&&void 0!==t?t:0),o=null!==(r=i.errmsg)&&void 0!==r?r:"";if(0!==n)return(0,u.wf)(null!=n?n:-1,null!=o?o:"");let s=this._convertResponseToResourcesData(e,i);return(0,u.oW)(s)}catch(e){return(0,c.m)(e,-1,`[${this.resourceType}] batchGetResources api error`)}}buildCustomRequest(e){return{}}_convertParamsToRequest(e){let t={id_list:e.resourceIds},r=this.buildCustomRequest(e);return{...t,...r}}_convertResponseToResourcesData(e,t){return{list:t.data.effect_item_list.map(e=>this.parseHeycanResponseDataToResources(e))}}get _batchGetResourcesApi(){return`${o._L.getVar("web_domain")}${d.bl.BATCH_GET_RESOURCES_BY_ID}`}constructor(e){this._accountService=e}}p=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],p)},726563:function(e,t,r){r.d(t,{H:function(){return n}});var i,n=((i={})[i.UNKNOWN=0]="UNKNOWN",i[i.HEYCAN=1]="HEYCAN",i[i.LOKI=2]="LOKI",i[i.MUSIC=3]="MUSIC",i[i.TUCHONG=5]="TUCHONG",i[i.BRAND=6]="BRAND",i[i.VIMO=7]="VIMO",i)},789869:function(e,t,r){r.d(t,{A:function(){return g}});var i=r(789786),n=r(966697),o=r(702049),s=r(405051),a=r(121130),c=r(768101),u=r(690613),l=r(114861),d=r(502600),_=r(606805),h=r(801497),p=r(685795);class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,l.V)(e),e}()),this._networkClientInstance}async batchGetResources(e){var t,r,i,n,o,s;let a=Date.now();try{let o=this._convertParamsToRequest(e),s=await this._networkClient.post(this._batchGetResourcesApi,o,(0,_._)(this._accountService.userProfile.region,h.ZP.language)),c=Number(null!==(t=s.ret)&&void 0!==t?t:0),l=null!==(r=s.errmsg)&&void 0!==r?r:"";try{null===(n=this._slardarAdapterService)||void 0===n||n.sendEvent("vimo_material_fetch_result",{path:d.bl.GET_THIRD_PARTY_RESOURCES_BY_ID,ret:String(c),msg:l,panel:this.resourcePanelType,logid:s.logid,detailCount:null===(i=s.data.effect_item_list)||void 0===i?void 0:i.length,duration:Date.now()-a})}catch(e){console.error("_slardarAdapterService error",e)}if(0!==c)return(0,u.wf)(null!=c?c:-1,null!=l?l:"");let p=this._convertResponseToResourcesData(e,s);return(0,u.oW)(p)}catch(t){let e=(0,c.m)(t,-1,`${this.resourcePanelType} batchGetResources api error: ${null==t?void 0:t.message}`);console.error("BatchGetThirdPartyResourcesRepository batchGetResources error",t);try{null===(s=this._slardarAdapterService)||void 0===s||s.sendEvent("vimo_material_fetch_result",{path:d.bl.GET_THIRD_PARTY_RESOURCES_BY_ID,ret:String(e.code),logid:null===(o=e.cause)||void 0===o?void 0:o.logid,msg:e.msg,panel:this.resourcePanelType,duration:Date.now()-a})}catch(e){console.error("_slardarAdapterService error",e)}return e}}buildCustomRequest(e){return{}}_convertParamsToRequest(e){let{items:t}=e,r=this.buildCustomRequest(e);return{items:t,...r}}_convertResponseToResourcesData(e,t){return{list:t.data.effect_item_list.map(e=>this.parseHeycanResponseDataToResources({...e,panel:this.resourcePanelType}))}}get _batchGetResourcesApi(){return`${o._L.getVar("web_domain")}${d.bl.GET_THIRD_PARTY_RESOURCES_BY_ID}`}constructor(e,t){this._accountService=e,this._slardarAdapterService=t}}g=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,p.L),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===p.L?Object:p.L])],g)},736031:function(e,t,r){r.d(t,{$0:function(){return a},Jk:function(){return s},_Q:function(){return d},bY:function(){return c},lY:function(){return _},lo:function(){return u},sX:function(){return l}});var i=r(824547),n=r(866006);let o="loki2vimo",s="p0-3",a="p1p2",c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"p0";return e.abTestManager.getAbTestValue(`${o}-${t}`,{})},u=(e,t)=>e[`${o}_${t}`]||{},l=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"p0";return u(await e.abTestManager.getAbTestValue(`${o}-${r}`,{}),t)},d=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"p0";return"vimo"===u(await c(e,r),t).panel_path},_=(e,t,r)=>{let o=e instanceof n.yt?e.config:e,s={clientABParam:{loki2vimo:t},panelSource:(null==r?void 0:r.isSkipSetPanelSourceNull)?o.panelSource:null};if(e instanceof n.yt){var a;return null===(a=e.combineConfig)||void 0===a||a.call(e,{...s}),e}return(0,i.Z)(e,{...s})}},109685:function(e,t,r){r.d(t,{KL:function(){return c},ko:function(){return s},uS:function(){return a}});var i=r(249656);let n={[i.V6.DEPOSIT]:i.n9.MaterialPlatformTuchongDeposit,[i.V6.ADOBE]:i.n9.MaterialPlatformTuchongAdobe,[i.V6.POND5]:i.n9.MaterialPlatformTuchongPond5},o=(e,t)=>{let r;switch(e){case i.Hw.HEYCAN:return i.EE.EffectPlatformArtist;case i.Hw.LOKI:return i.EE.EffectPlatformLoki;case i.Hw.MUSIC:return i.Ll.AudioPlatformLibrary;case i.Hw.TUCHONG:if(r=t&&n[t])return r;default:return i.EE.EffectPlatformArtist}};function s(e){return!e.order||!!(e.order&&e.order.id&&e.order.source===i.Hw.TUCHONG&&e.order.url)}function a(e){let t=o(e.source,e.publishSource);return t===i.n9.MaterialPlatformTuchongAdobe||t===i.n9.MaterialPlatformTuchongPond5}function c(e){var t;return a(e)&&!!((t=e).order&&t.order.id&&t.order.source===i.Hw.TUCHONG&&!t.order.url)}},243254:function(e,t,r){r.d(t,{bl:function(){return i}});let i={GET_CATEGORY_BY_PANEL:"/lv/v1/effect/get_panel_info",GET_RESOURCES_BY_CATEGORY:"/lv/v1/effect/get_category_effects",GET_RESOURCE_BY_ID:"/lv/v1/effect/batch_by_resource",GET_RECENT_RESOURCE_BY_PANEL:"/lv/v1/editor/effect/recent_list",ADD_RECENT_RESOURCE:"/lv/v1/editor/use_report",SEARCH:"/lv/v1/effect/search",GET_TAG_TREE:"/lv/v1/effect/get_tag_tree"}},930852:function(e,t,r){r.d(t,{G:function(){return y}});var i=r(789786),n=r(966697),o=r(629351),s=r(702049),a=r(405051),c=r(121130),u=r(866006),l=r(768101),d=r(690613),_=r(114861),h=r(243254),p=r(801497),g=r(744268),v=r(924901),f=r(396190),m=r(134429);class y{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(e){let t=new a.yk().build(a.kk);return(0,c.i3)(t),(0,_.V)(t),(0,o.V)(t,{appVersion:e.appVersion}),t}({appVersion:this._environmentService.appVersion})),this._networkClientInstance}async searchResources(e){var t,r,i;let n=e instanceof u.yt?e.config:e;try{let i=await this._networkClient.post(this._searchApi,this._convertParamsToRequest(e),{withCredentials:!0}),o=Number(null!==(t=i.ret)&&void 0!==t?t:0),s=null!==(r=i.errmsg)&&void 0!==r?r:"";if(0!==o)return(0,d.wf)(null!=o?o:-1,null!=s?s:"");let a=this._convertResponseToQueryToken(n,i);return(0,d.oW)(a)}catch(t){let e=Number(null!==(i=t.ret)&&void 0!==i?i:-1);if(e!==v.e.NORMAL_ERROR&&e!==v.e.SENSITIVE_WORDS)return(0,l.m)(t,-1,`[${this.resourceType}] searchResources api error`);{let r=t.data.search_id,i=t.data.request_id;return(0,d.wf)(e,JSON.stringify({searchId:r,requestId:i,errmsg:t.errmsg}))}}}get defaultQueryToken(){return{offset:0,limit:50}}buildCustomRequest(e){return{}}_convertParamsToRequest(e){var t;let r=e instanceof u.yt?e.config:e,i={panel:this._configurationService.resourcePanel[this.resourceType],query:r.query,app_version:this._environmentService.appVersion,sdk_version:m.f4,lang:p.ZP.language,search_id:r.searchId,region:this._accountService.userProfile.region},n=this.buildCustomRequest(r),o=(0,u.ky)(e)?{...e.config.limit?{limit:e.config.limit}:void 0,offset:null!==(t=e.offset)&&void 0!==t?t:0}:{...this.defaultQueryToken,...e.limit?{limit:e.limit}:void 0};return{...i,...n,...o}}_convertResponseToQueryToken(e,t){var r;let i=this.parseEffectsToResources(null!==(r=t.data.items)&&void 0!==r?r:[]),{has_more:n,next_cursor:o,search_id:s,request_id:a}=t.data;return(0,u.ib)(e,{list:i,searchId:s,requestId:a},{hasMore:n,offset:o})}get _searchApi(){return`${s._L.getVar("web_domain")}${h.bl.SEARCH}`}constructor(e,t,r){this._accountService=e,this._configurationService=t,this._environmentService=r}}y=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,g.Ui),(0,i.fM)(2,f.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===g.Ui?Object:g.Ui,void 0===f.Y?Object:f.Y])],y)},412497:function(e,t,r){r.d(t,{r:function(){return m}});var i=r(789786),n=r(966697),o=r(702049),s=r(405051),a=r(121130),c=r(768101),u=r(690613),l=r(114861),d=r(243254),_=r(801497),h=r(744268),p=r(249656),g=r(454530),v=r(396190),f=r(134429);class m{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,l.V)(e),e}()),this._networkClientInstance}async batchGetResources(e){try{var t,r;let i=this._convertBatchGetResourcesParamsToRequest(e),n=await this._doBatchGetResource(i),o=null===(t=n.BaseResp)||void 0===t?void 0:t.StatusCode,s=null===(r=n.BaseResp)||void 0===r?void 0:r.StatusMessage;if(0!==o)return(0,u.wf)(null!=o?o:-1,null!=s?s:"");let a=this.parseEffectsToResources(n.data);return(0,u.oW)({list:a})}catch(e){return(0,c.m)(e,-1,"batchGetResourcesByIds api error")}}_doBatchGetResource(e){return this._networkClient.post(this._batchApi,e,{withCredentials:!0})}_convertBatchGetResourcesParamsToRequest(e){let t=this._configurationService.abTestManager.getBooleanAbTestValue(g.o.NewTransitionEffectEnabled),r=this._environmentService.isAutoTest||t?p.Nb.New:p.Nb.Old,i={appVersion:this._environmentService.appVersion,sdkVersion:f.f4,lang:_.ZP.language,region:this._accountService.userProfile.region,...e.enterFrom?{enter_from:e.enterFrom}:void 0,list:[{type:this._configurationService.resourcePanel[this.resourceType],ids:e.ids,appVersion:this._environmentService.appVersion}],cc_web_version:r},n=this.buildCustomRequest(e);return{...i,...n}}buildCustomRequest(e){return{}}get _batchApi(){return`${o._L.getVar("web_domain")}${d.bl.GET_RESOURCE_BY_ID}`}constructor(e,t,r){this._accountService=e,this._configurationService=t,this._environmentService=r}}m=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,h.Ui),(0,i.fM)(2,v.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===h.Ui?Object:h.Ui,void 0===v.Y?Object:v.Y])],m)},512363:function(e,t,r){r.d(t,{L:function(){return S}});var i=r(789786),n=r(966697),o=r(702049),s=r(405051),a=r(121130),c=r(866006),u=r(768101),l=r(690613),d=r(114861),_=r(243254),h=r(801497),p=r(744268),g=r(249656),v=r(332557),f=r(76552),m=r(454530),y=r(396190),w=r(134429),k=r(847083),b=r(952269);class S{shouldUseRace(){return!1}get _networkClient(){if(!this._networkClientInstance){let e=function(e){let{addBusinessPlugins:t}=e,r=new s.yk().build(s.kk);return t(r,[k.U.Preload]),(0,a.i3)(r),(0,d.V)(r),r}(this._clientPluginService);this._networkClientInstance=this.shouldUseRace()?(0,f.d)(e,this._storageService,this._accountService.uniqueId,this._configurationService.disableRequestCache):(0,f.D)(e,this._storageService,this._accountService.uniqueId,this._configurationService.disableRequestCache)}return this._networkClientInstance}async getCategories(e){let t=e instanceof c.yt?e.config:e;try{let r=this.convertGetResourceCategoriesParamsToRequest(e),i=await this._doGetCategories(r);if(!i.ok)return i;let n=this._convertGetResourceCategoriesResponseToQueryToken(t,i.value),o=await this.filterResources(n);return(0,l.oW)(o)}catch(e){return(0,u.m)(e,-1,"getCategories by panel api error")}}filterResources(e){return Promise.resolve(e)}async _doGetCategories(e){var t,r;let i=await this._networkClient.postWithCache(this._api,e,{withCredentials:!0}),n=null===(t=i.BaseResp)||void 0===t?void 0:t.StatusCode,o=null===(r=i.BaseResp)||void 0===r?void 0:r.StatusMessage;return 0!==n?(0,l.wf)(null!=n?n:-1,null!=o?o:"do getCategories error"):(0,l.oW)(i)}convertGetResourceCategoriesParamsToRequest(e){var t,r;let i=e instanceof c.yt?e.config:e,n=this._configurationService.abTestManager.getBooleanAbTestValue(m.o.NewTransitionEffectEnabled),o=this._environmentService.isAutoTest||n?g.Nb.New:g.Nb.Old,s={panel:i.panel||this._configurationService.resourcePanel[this.resourceType],appVersion:this._environmentService.appVersion,sdkVersion:null!==(t=i.sdkVersion)&&void 0!==t?t:w.f4,lang:h.ZP.language,hasCategoryEffects:!1,only_commercial:i.onlyCommercial,cc_web_version:o};void 0!==i.polyConfig&&(s.detail_count_cut=!0,s.category_count=i.polyConfig.categoryCount,s.detail_count=i.polyConfig.detailCount);let a=this.buildCustomRequest(i),{limit:u,offset:l}=(0,c.ky)(e)?{...e.config.limit?{limit:e.config.limit}:void 0,offset:null!==(r=e.offset)&&void 0!==r?r:0}:{...this.defaultQueryToken,...e.limit?{limit:e.limit}:void 0};return{...s,...a,...u?{limit:u}:void 0,sortingPosition:l}}get defaultQueryToken(){return{offset:0}}buildCustomRequest(e){return{}}parseDetailToResources(e){return{}}parseResultToCategories(e){return e.CategoryList.map(b.F)}get _api(){return`${o._L.getVar("web_domain")}${_.bl.GET_CATEGORY_BY_PANEL}`}_convertGetResourceCategoriesResponseToQueryToken(e,t){let r=this.parseResultToCategories(t.data),i=r.reduce((e,r)=>{var i,n,o,s;let a=null==t?void 0:null===(n=t.detail_info)||void 0===n?void 0:null===(i=n[r.key])||void 0===i?void 0:i.CategoryEffects;return a&&(e[r.id]={list:null!==(s=null===(o=a.Effects)||void 0===o?void 0:o.map(e=>this.parseDetailToResources(e)))&&void 0!==s?s:[],hasMore:a.HasMore,offset:a.Cursor}),e},{}),{HasMore:n,SortingPosition:o}=t.data.CategoryEffects;return(0,c.ib)(e,{list:r,details:i},{hasMore:n,offset:o})}constructor(e,t,r,i,n){this._accountService=e,this._configurationService=t,this._storageService=r,this._environmentService=i,this._clientPluginService=n}}S=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,p.Ui),(0,i.fM)(2,v.U),(0,i.fM)(3,y.Y),(0,i.fM)(4,k.a),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===p.Ui?Object:p.Ui,void 0===v.U?Object:v.U,void 0===y.Y?Object:y.Y,void 0===k.a?Object:k.a])],S)},318303:function(e,t,r){r.d(t,{e:function(){return n}});var i=r(800788);function n(e,t){for(let r of Object.keys(t))if(t[r]===e)return r;(0,i.ss)(`no match resource type for panel ${e}`)}},629351:function(e,t,r){r.d(t,{V:function(){return s}});var i=r(998498),n=r.n(i),o=r(604250);function s(e,t){return e.interceptors.request.use(e=>{let{url:r="",baseURL:i="",headers:s,data:a={}}=e,{pathname:c}=(0,o.GM)(`${i}${r}`),u=c.length>=7?c.slice(-7):c;s.lan="zh-hans",s.pf="1",s.appvr=t.appVersion,s.tdid="web",s["sign-ver"]=1,s["device-time"]=Math.floor(Date.now()/1e3);let l=`9e2c|${u}|${s.pf}|${s.appvr}|${s["device-time"]}|${s.tdid}|11ac`;return s.sign=n()(l).toLowerCase(),e.data=a,e.headers=s,e}),e}},993971:function(e,t,r){r.d(t,{j:function(){return i}});let i=(0,r(335290).yh)("package-info")},234763:function(e,t,r){r.d(t,{r:function(){return m}});var i=r(789786),n=r(415266),o=r(249656),s=r(702049),a=r(405051),c=r(768101),u=r(141314),l=r(402655),d=r(690613),_=r(114861),h=r(629351),p=r(744268),g=r(454530),v=r(396190),f=r(134429);class m extends l.JT{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(e){let t=new a.yk().build(a.kk);return(0,_.V)(t),(0,h.V)(t,{appVersion:e.appVersion}),t}({appVersion:this._environmentService.appVersion})),this._networkClientInstance}async createTextToVideoTask(e){let{content_md5:t}=e;try{var r,i;let e=await this._networkClient.post(this._urlGenerator.url("CREATE_TEXT_TO_VIDEO_DRAFT"),{content_md5:t},{withCredentials:!0});if((null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.ret)!=="0")return(0,d.wf)(1,null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.ret);return(0,d.oW)(e.data)}catch(e){return(0,c.m)(e,-1,"getPackageInfo api error")}}async getTextToVideoPackageInfo(e){let{lang:t,content_md5:r}=e,i=this._configurationService.abTestManager.getBooleanAbTestValue(g.o.NewTransitionEffectEnabled),n=this._environmentService.isAutoTest||i?o.Nb.New:o.Nb.Old;try{var a,u;let e=await this._networkClient.post(this._urlGenerator.url("GET_TEXT_TO_VIDEO_DRAFT"),{lang:t,content_md5:r,region:s._L.getVar("country_code"),app_version:this._environmentService.appVersion,sdk_version:f.f4,cc_web_version:n},{withCredentials:!0});if((null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.ret)!=="0")return(0,d.wf)(1,null==e?void 0:null===(u=e.data)||void 0===u?void 0:u.ret);return(0,d.oW)(e.data)}catch(e){return(0,c.m)(e,-1,"getPackageInfo api error")}}constructor(e,t){super(),this._configurationService=e,this._environmentService=t,this._urlGenerator=new u.w(n.c)}}m=(0,i.gn)([(0,i.fM)(0,p.Ui),(0,i.fM)(1,v.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===p.Ui?Object:p.Ui,void 0===v.Y?Object:v.Y])],m)},872962:function(e,t,r){r.d(t,{C:function(){return h}});var i=r(789786),n=r(415266),o=r(405051),s=r(768101),a=r(141314),c=r(402655),u=r(690613),l=r(114861),d=r(629351),_=r(396190);class h extends c.JT{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(e){let t=new o.yk().build(o.kk);return(0,l.V)(t),(0,d.V)(t,{appVersion:e.appVersion}),t}({appVersion:this._environmentService.appVersion})),this._networkClientInstance}async getUserInfo(e){try{var t,r;let e=await this._networkClient.post(this._urlGenerator.url("GET_USER_INFO"),{},{withCredentials:!0});if((null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.ret)!=="0")return(0,u.wf)(1,null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.ret);return(0,u.oW)(e.data)}catch(e){return(0,s.m)(e,-1,"getPackageInfo api error")}}constructor(e){super(),this._environmentService=e,this._urlGenerator=new a.w(n.c)}}h=(0,i.gn)([(0,i.fM)(0,_.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===_.Y?Object:_.Y])],h)},123567:function(e,t,r){r.d(t,{n:function(){return _}});var i=r(690613),n=r(114861),o=r(702049),s=r(405051),a=r(121130),c=r(894339),u=r(768101),l=r(323550),d=r(234207);class _{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,c.mH)(e),(0,n.V)(e),e}()),this._networkClientInstance}get _api(){return`${o._L.getVar("web_domain")}${l.b.GET_USER_PERMISSION}`}async getUserPermission(e){performance.mark("GET_USER_PERMISSION_START");try{try{let e=window.__user_permissions;if(e)return window.__user_permissions=null,(0,i.oW)((0,d.n)(e))}catch(e){}try{let r=await this._networkClient.post(this._api,e,{withCredentials:!0});if("0"!==r.ret){var t;return(0,i.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,i.oW)((0,d.P)(r))}catch(e){return(0,u.m)(e,-1,"getUserPermission api error")}}finally{performance.mark("GET_USER_PERMISSION_END")}}}},544688:function(e,t,r){r.d(t,{c:function(){return i}});let i=(0,r(335290).yh)("user-permission-data-service")},915208:function(e,t,r){r.d(t,{CM:function(){return a},gM:function(){return c},uL:function(){return _}});var i=r(127830),n=r(800788),o=r(234075),s=r.n(o);let a="/",c=()=>`${a}editor/effect/`;function u(e){if(i.is.has(e.type)){var t;return t=e,(0,n.Y2)(t.resourceId,"Effect should have a corresponding resourceId"),`${c()}${t.type}/${t.resourceId}`}return`${a}${e.key}`}function l(e){let t="";if(e.filename&&!s().extname(e.key)){var r;let{subType:i}=e;i&&!i.startsWith(".")&&(i=`.${i}`),t=null===(r=i||s().extname(e.filename))||void 0===r?void 0:r.toLowerCase()}return`${a}${e.key}${t}`}let d={[i._g.UserVideo]:l,[i._g.UserPhoto]:l,[i._g.UserFile]:l,[i._g.VideoBackground]:function(e){return`${a}${e.key}.png`},[i._g.ArithmeticModel]:function(e){return`${a}editor/model/${e.name}/${e.md5}`},[i._g.DigitalHuman]:function(e){return`${a}${e.previewVideo.key}`}};function _(e){var t;let r=null!==(t=d[e.type])&&void 0!==t?t:u;return(0,n.Y2)(r,`unsupported material type ${e.type}`),r(e)}},932606:function(e,t,r){r.d(t,{g:function(){return c}});var i=r(107469),n=r(127830);let o=[n._g.SubtitleTemplate,n._g.TextTemplate,n._g.TextPreset,n._g.Sticker,n._g.Effects,n._g.Filter,n._g.Transition,n._g.Tone,n._g.TextMotion,n._g.Video,n._g.VoiceChange,n._g.VideoMotion,n._g.AutoBeautyBody,n._g.AutoBeautyFace,n._g.AutoBeautyMakeup,n._g.AutoBeautyShape,n._g.TextGlow],s=[n._g.TextGlow],a=!0,c=async(e,t)=>{if(e||t&&s.includes(t))return!1;a&&performance.mark("REGION_CHECK_START");let r=await i._c.isAllow({scene:i.SA.common});return a&&performance.measure("REGION_CHECK","REGION_CHECK_START"),a=!1,!(r&&(!t||o.includes(t)))&&!0}},572029:function(e,t,r){r.d(t,{X:function(){return i}});let i=(0,r(335290).yh)("brand-data-service")},846562:function(e,t,r){r.d(t,{$:function(){return s}});var i=r(393958),n=r(565520),o=r(803894);class s extends i.h{get brandResourceType(){return n.Q.AdjustmentPreset}parseResponseDataToResources(e){return(0,o.J)(e)}}},450495:function(e,t,r){r.d(t,{z:function(){return s}});var i=r(393958),n=r(565520),o=r(354714);class s extends i.h{get brandResourceType(){return n.Q.Color}parseResponseDataToResources(e){return(0,o.T)(e)}}},525569:function(e,t,r){r.d(t,{Z:function(){return S}});var i=r(690613),n=r(800788),o=r(995706),s=r(768101),a=r(64886),c=r(127830),u=r(702049),l=r(565520),d=r(764091),_=r(801003),h=r(277714),p=r(482707),g=r(803894),v=r(692060),f=r(858725),m=r(354714),y=r(899797),w=r(527898),k=r(134429),b=r(826843);class S{async getMultiBrandResources(e){try{let t=await this._networkClient.post(this._url,this._convertParamsToRequest(e),{withCredentials:!0,headers:{effect_sdk_version:o._}}),r=this._convertResponseToResourceData(t);return(0,i.oW)(r)}catch(e){return(0,s.m)(e)}}_convertParamsToRequest(e){let{resourceTypes:t}=e,r=t.map(e=>{switch(e){case c._g.Video:return String(l.Q.Video);case c._g.Photo:return String(l.Q.Logo);case c._g.Sticker:return String(l.Q.Sticker);case c._g.Audio:return String(l.Q.Audio);case c._g.TextTemplate:return String(l.Q.TextTemplatePreset);case c._g.TextPreset:return String(l.Q.TextPreset);case c._g.AdjustmentPreset:return String(l.Q.AdjustmentPreset);case c._g.VideoBackground:return String(l.Q.Background);case c._g.BrandColor:return String(l.Q.Color);case c._g.Font:return String(l.Q.Font);default:(0,n.bP)(e)}});return{workspace_id:e.workspaceId,effect_sdk_version:o._,app_version:k.$U,resource_type_list:r,need_depend_resource:!0,need_sub_item:!0,need_vip_tag:!0}}_convertResponseToResourceData(e){let{count_map:t,hasmore_map:r}=e.data,i=Object.entries(null!=t?t:{}).reduce((e,t)=>{var i;let[n,o]=t;return e[(0,b.d)(Number(n))]={count:0,hasMore:null!==(i=null==r?void 0:r[Number(n)])&&void 0!==i&&i},e},{}),o={[c._g.Video]:[],[c._g.Photo]:[],[c._g.Audio]:[],[c._g.Sticker]:[],[c._g.AdjustmentPreset]:[],[c._g.TextPreset]:[],[c._g.TextTemplate]:[],[c._g.VideoBackground]:[],[c._g.BrandColor]:[],[c._g.Font]:[],countMap:i};return e.data.resource_info_list.forEach(e=>{switch(Number(e.common_attr.resource_type)){case l.Q.Video:o.countMap[c._g.Video].count++,o[c._g.Video].push((0,d.Mk)(e,!0));break;case l.Q.Logo:o.countMap[c._g.Photo].count++,o[c._g.Photo].push((0,_.Ar)(e,!0));break;case l.Q.Audio:o.countMap[c._g.Audio].count++,o[c._g.Audio].push((0,h.Fi)(e,void 0,!0));break;case l.Q.Sticker:o.countMap[c._g.Sticker].count++,o[c._g.Sticker].push((0,p.jh)(e,void 0,!0));break;case l.Q.AdjustmentPreset:o.countMap[c._g.AdjustmentPreset].count++,o[c._g.AdjustmentPreset].push((0,g.J)(e));break;case l.Q.TextPreset:o.countMap[c._g.TextPreset].count++,o[c._g.TextPreset].push((0,v.Ck)(e,!0));break;case l.Q.TextTemplatePreset:o.countMap[c._g.TextTemplate].count++,o[c._g.TextTemplate].push((0,f.K3)(e,!0));break;case l.Q.Background:o.countMap[c._g.VideoBackground].count++,o[c._g.VideoBackground].push((0,w.ll)(e,void 0,!0));break;case l.Q.Color:o.countMap[c._g.BrandColor].count++,o[c._g.BrandColor].push((0,m.T)(e));break;case l.Q.Font:o.countMap[c._g.Font].count++,o[c._g.Font].push((0,y.ey)(e,void 0,!0));break;default:(0,n.bP)(e.common_attr.resource_type)}}),o}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=(0,a.G)()),this._networkClientInstance}get _url(){return`${u._L.getVar("web_domain")}${o.l.getBrandResourcesByResourceTypes}`}}},803894:function(e,t,r){r.d(t,{J:function(){return n}});var i=r(981632);function n(e){let{common_attr:t}=e;return{key:t.id,md5:t.md5||t.id,itemUrl:t.item_url||t.download_info.url,title:t.title,coverUrl:t.cover_url.small,format:t.format,id:t.id,createTime:t.create_time,isDefault:e.IsDefault,userId:t.user_id,isVip:t.is_vip,brandExtraInfo:(0,i.D)(t.file_extra),workspaceId:t.workspace_id}}},163210:function(e,t,r){r.d(t,{C:function(){return a}});var i=r(273340),n=r(249656),o=r(565520),s=r(800788);function a(e){return{key:e.id,resourceId:e.id,effectId:e.id,md5:e.md5||e.id,effectType:function(e){switch(Number(e)){case o.Q.Video:return i.g.Video;case o.Q.Logo:return i.g.Image;case o.Q.Audio:return i.g.Song;case o.Q.Sticker:return i.g.Sticker;case o.Q.Font:return i.g.Font;case o.Q.TextTemplatePreset:case o.Q.TextPreset:return i.g.TextTemplate;case o.Q.AdjustmentPreset:return i.g.Filter;case o.Q.Background:case o.Q.Color:(0,s.ss)("brandResourceType should not be here");default:(0,s.bP)(e,"brandResourceType never")}}(e.resource_type),source:n.Hw.BRAND,isBusiness:!1,isVip:e.is_vip,title:e.title,description:"",coverUrl:e.cover_url.small,originUrl:e.item_url||e.download_info.url}}},354714:function(e,t,r){r.d(t,{T:function(){return i}});function i(e){let{common_attr:t}=e;return{key:t.id,color:t.color||t.title,title:t.title,isDefault:e.IsDefault,userId:t.user_id}}},512859:function(e,t,r){r.d(t,{w:function(){return a}});var i=r(273340),n=r(581797),o=r(789869),s=r(33883);class a extends o.A{get resourceType(){return i.g.Bubble}get resourcePanelType(){return s.q.Bubble}parseHeycanResponseDataToResources(e){return(0,n.E)(e)}}},581797:function(e,t,r){r.d(t,{E:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.Bubble);return{...t,key:`${n._g.Bubble}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},408435:function(e,t,r){r.d(t,{S:function(){return n}});var i,n=((i={})[i.ElevenLabs=1]="ElevenLabs",i[i.Sami=2]="Sami",i[i.SourceElevenLabs=3]="SourceElevenLabs",i[i.Vimo=6]="Vimo",i)},137681:function(e,t,r){r.d(t,{D:()=>a});var i=r("690613"),n=r("702049");let o="/api/biz/v1/videogen/text_to_speech";var s=r("1006");class a{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=(0,s.j)()),this._networkClientInstance}get _api(){return`${n._L.getVar("web_domain")}${o}`}async getGenerateTts(e){try{let r=await this._networkClient.post(this._api,e);if("0"!==r.ret){var t;return(0,i.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,i.oW)(function(e){let{data:t}=e;return{list:t.ttsResults.map(e=>({...e,normalizedVolume:e.normalizedVolume?Number(e.normalizedVolume):void 0})),logId:e.logId}}(r))}catch(e){return(0,i.Mx)(-1,"getGenerateTts api error",e)}}}},930447:function(e,t,r){r.d(t,{T:function(){return o},i:function(){return s}});var i,n=r(335290);var o=((i={})[i.Success=1]="Success",i[i.Process=0]="Process",i[i.Failure=-1]="Failure",i);let s=(0,n.yh)("caption-data-service")},966818:function(e,t,r){r.d(t,{u:function(){return a}});var i=r(690613),n=r(587892),o=r(402655),s=r(930447);class a extends o.JT{get error(){return this._error}get status(){return this._captionTaskStatus}get value(){return this._result}async _getTaskProgress(){let e=await this._captionRepository.getCaption(this._taskParams,this._urlParams);if(e.ok){this._getTaskProgressErrorCount=0;let{status:t}=e.value;0===t?(this._captionTaskStatus=s.T.Success,this._onSuccess.fire(e.value),this._result=e.value):(this._captionTaskStatus=s.T.Process,this._onProgress.fire(e.value))}else this._getTaskProgressErrorCount++;this._getTaskProgressErrorCount>=10&&(this._captionTaskStatus=s.T.Failure,this._error=(0,i.wf)(e.code,e.msg),this._onError.fire(this._error))}async _startPollingProgress(){await this._getTaskProgress(),this._captionTaskStatus===s.T.Process&&setTimeout(()=>{this._startPollingProgress()},500)}constructor(e,t,r){super(),this._captionRepository=e,this._taskParams=t,this._urlParams=r,this._onProgress=this._store.add(new n.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new n.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new n.Q),this.onSuccess=this._onSuccess.event,this._captionTaskStatus=s.T.Process,this._getTaskProgressErrorCount=0,this._error=(0,i.ly)(),this._startPollingProgress()}}},446768:function(e,t,r){r.d(t,{o:()=>b});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("702049"),a=r("405051"),c=r("121130"),u=r("894339"),l=r("768101"),d=r("690613"),_=r("114861"),h=r("101554");class p{async deleteCloneVoice(e){try{let t=await this._networkClient.post(this._getApi(h.bl.DELETE_VOICE),{item_id:e.id},{withCredentials:!0});if("0"!==t.ret)return(0,d.wf)(Number(t.ret),t.errmsg);return(0,d.oW)(t.data)}catch(e){return(0,l.m)(e,-1,"deleteCloneVoice api error")}}async releaseUnsavedCloneVoice(e){try{let t=await this._networkClient.post(this._getApi(h.bl.RELEASE_VOICE),{speaker_id:e.speakerId},{withCredentials:!0});if("0"!==t.ret)return(0,d.wf)(Number(t.ret),t.errmsg);return(0,d.oW)(t.data)}catch(e){return(0,l.m)(e,-1,"releaseCloneVoice api error")}}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,_.V)(e),e}()),this._networkClientInstance}_getApi(e){return`${s._L.getVar("web_domain")}${e}`}}var g=r("905180"),v=r("858362");class f{async checkCreatePermission(e){try{let t=await this._networkClient.post(this._getApi(h.bl.CHECK_CREATE_PERMISSION),{device_id:e.deviceId},{withCredentials:!0});if("0"!==t.ret)return(0,d.wf)(Number(t.ret),t.errmsg);return(0,d.oW)((0,v.pA)(t))}catch(e){return(0,l.m)(e,-1,"checkCreatePermission error")}}async createCloneVoiceTask(e,t){try{let r=await this._networkClient.post(this._getApi(h.bl.CREATE_TASK),{test_text:e.testText,audio_vid:e.audioVid,audio_format:e.audioFormat,prompt_text:e.promptText,prompt_audio_format:e.promptAudioFormat,lang:e.lang},{withCredentials:!0,params:t});if("0"!==r.ret)return(0,d.wf)(Number(r.ret),r.errmsg);return(0,d.oW)({taskId:r.data.id})}catch(e){return(0,l.m)(e,-1,"createCloneVoiceTask api error")}}async queryCloneVoiceTask(e,t){try{let r=await this._networkClient.post(this._getApi(h.bl.QUERY_TASK),{id:e.id},{withCredentials:!0,params:t});if("0"!==r.ret)return(0,d.wf)(Number(r.ret),r.errmsg);return(0,d.oW)((0,v.DC)(r))}catch(e){return(0,l.m)(e,-1,"queryCloneVoiceTask api error")}}async cancelCloneVoiceTask(e){try{let t=await this._networkClient.post(this._getApi(h.bl.CANCEL_TASK),{id:e.id},{withCredentials:!0});if("0"!==t.ret)return(0,d.wf)(Number(t.ret),t.errmsg);return(0,d.oW)({})}catch(e){return(0,l.m)(e,-1,"cancelCreatePermission error")}}async getCloneVoiceText(e){try{let t=await this._networkClient.post(this._getApi(h.bl.GET_TEXT),{lang:e.lang},{withCredentials:!0});if("0"!==t.ret)return(0,d.wf)(Number(t.ret),t.errmsg);return(0,d.oW)((0,v.yU)(t))}catch(e){return(0,l.m)(e,-1,"getCloneVoiceText api error")}}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,_.V)(e),(0,g.Y)(e),e}()),this._networkClientInstance}_getApi(e){return`${s._L.getVar("web_domain")}${e}`}}var m=r("966697"),y=r("574777"),w=r("967026"),k=r("316733");class b extends o.JT{getCloneVoiceText(e){return this._cloneVoiceTaskRepository.getCloneVoiceText(e)}checkCreatePermission(){let{webId:e}=this._capcutAccountService.userProfile;return this._cloneVoiceTaskRepository.checkCreatePermission({deviceId:e})}createCloneVoiceTask(e,t){return this._cloneVoiceTaskRepository.createCloneVoiceTask(e,t)}queryCloneVoiceTask(e,t){return this._cloneVoiceTaskRepository.queryCloneVoiceTask(e,t)}cancelCloneVoiceTask(e){return this._cloneVoiceTaskRepository.cancelCloneVoiceTask(e)}postCloneVoice(e){return this._cloneVoiceEffectPostRepository.postEffect(e)}deleteCloneVoice(e){return this._cloneVoiceOperationRepository.deleteCloneVoice(e)}releaseUnsavedCloneVoice(e){return this._cloneVoiceOperationRepository.releaseUnsavedCloneVoice(e)}getCloneVoiceList(e){return this._cloneVoiceListRepository.getHomepageEffects(e)}batchGetCloneVoice(e){return this._batchGetCloneVoiceRepository.batchGetResources(e)}constructor(e,t,r){super(),this._instantiationService=t,this._capcutAccountService=r,(0,h.P7)(e.apiType),this._cloneVoiceTaskRepository=this._instantiationService.createInstance(f),this._cloneVoiceOperationRepository=this._instantiationService.createInstance(p),this._cloneVoiceEffectPostRepository=this._instantiationService.createInstance(y.p),this._cloneVoiceListRepository=this._instantiationService.createInstance(w.k),this._batchGetCloneVoiceRepository=this._instantiationService.createInstance(k.q)}}b=(0,i.gn)([(0,i.fM)(1,n.T),(0,i.fM)(2,m.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,void 0===n.T?Object:n.T,void 0===m.Gw?Object:m.Gw])],b)},92690:function(e,t,r){r.d(t,{b:function(){return i}});let i={CHECK_CREATE_PERMISSION:"/lv/v2/intelligence/check_clone_voice_auth",CREATE_TASK:"/lv/v1/intelligence/submit_clone_timbre",QUERY_TASK:"/lv/v1/intelligence/query_clone_timbre_result",CANCEL_TASK:"/lv/v1/intelligence/cancel_timbre_clone",RELEASE_VOICE:"/lv/v1/intelligence/release_clone_timber",SAVE_VOICE:"/lv/v1/intelligence/save_timbre",DELETE_VOICE:"/lv/v1/intelligence/delete_clone_voice",GET_TEXT:"/lv/v2/intelligence/get_voice_clone_text"}},547997:function(e,t,r){r.d(t,{b:function(){return i}});let i={CHECK_CREATE_PERMISSION:"/api/biz/v1/voice/check_voice_clone_auth",CREATE_TASK:"/api/biz/v1/voice/submit_voice_clone_task",QUERY_TASK:"/api/biz/v1/voice/get_voice_clone_task",CANCEL_TASK:"/api/biz/v1/voice/cancel_voice_clone_task",RELEASE_VOICE:"/api/biz/v1/voice/free_voice_clone_resource",SAVE_VOICE:"/lv/v1/intelligence/save_timbre",DELETE_VOICE:"/api/biz/v1/voice/delete_clone_voice",GET_TEXT:"/api/biz/v1/voice/get_voice_clone_text"}},275481:function(e,t,r){r.d(t,{U:function(){return i}});let i=(0,r(335290).yh)("collaborator-data-service")},425402:function(e,t,r){r.d(t,{D:function(){return c}});var i=r(789786),n=r(861810),o=r(55449),s=r(402655),a=r(504393);class c extends s.JT{getCommercialTools(){return this._commercialRepository.getCommercialTools()}queryVoiceBenefit(e){return this._commercialRepository.queryVoiceBenefit(e)}reportVoiceUsage(e){return this._commercialRepository.reportVoiceUsage(e)}batchGetUserBenefit(e){return this._commercialRepository.batchGetUserBenefit(e)}reportUsage(e){return this._commercialRepository.reportUsage(e)}getBenefitMetadata(e){return this._commercialRepository.getBenefitMetadata(e)}batchGetUserBenefitV3(e){return this._commercialRepository.batchGetUserBenefitV3(e)}constructor(e={},t){super(),this._instantiationService=t,this._commercialRepository=t.createInstance(new n.M(a.a,[e],!1))}}c=(0,i.gn)([(0,i.fM)(1,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICommercialDataServiceOptions?Object:ICommercialDataServiceOptions,void 0===o.T?Object:o.T])],c)},286748:function(e,t,r){r.d(t,{b:function(){return i}});let i={COMMERCIAL_GET_BENEFITS:"/commerce/v1/vip/get_benefits",QUERY_VOICE_BENEFIT:"/commerce/v1/benefits/query_voice_benefit",REPORT_VOICE_USAGE:"/commerce/v1/benefits/report_voice_usage",BATCH_GET_USER_BENEFIT:"/commerce/v1/benefits/batch_get_user_benefit",REPORT_USAGE:"/commerce/v1/benefits/report_usage",BENEFIT_META:"/commerce/v3/resource/benefit_metadata",BATCH_GET_USER_BENEFIT_V3:"/commerce/v3/benefits/batch_get_user_benefit"}},238458:function(e,t,r){r.d(t,{B:function(){return s},p:function(){return o}});var i,n,o=((i={})[i.Pay=0]="Pay",i[i.LimitFree=1]="LimitFree",i[i.Disable=2]="Disable",i);var s=((n={}).CloneVoiceFreeLeft="clone_voice_left_free_token",n)},32001:function(e,t,r){r.d(t,{t:function(){return n}});var i=r(786022);function n(e){return{params:{aid:null!=e?e:i.kJ},withCredentials:!0}}},390908:function(e,t,r){r.d(t,{G:()=>f});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("690613"),a=r("114861"),c=r("405051"),u=r("121130"),l=r("786022"),d=r("502600"),_=r("702049"),h=r("606805"),p=r("801497"),g=r("966697");class v{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new c.yk().build(c.kk);return(0,u.i3)(e),(0,a.V)(e),e}()),this._networkClientInstance}async getTips(){try{var e,t;let r=await this._networkClient.post(this._api(),{app_id:l.kJ},(0,h._)(this._accountService.userProfile.region,p.ZP.language)),i=Number(null!==(e=r.ret)&&void 0!==e?e:0),n=null!==(t=r.errmsg)&&void 0!==t?t:"";if(0!==i)return(0,s.wf)(null!=i?i:-1,null!=n?n:"");let o=this._convertResponseToCopyrightTips(r);return(0,s.oW)(o)}catch(e){return(0,s.wf)(-1,"getTips api error")}}_api(){return`${_._L.getVar("web_domain")}${d.bl.COPYRIGHT_TIPS}`}_convertResponseToCopyrightTips(e){return e.data.copyright_tips.map(e=>({answerKey:e.answer_key,answerVal:e.answer_val,questionKey:e.question_key,questionVal:e.question_val}))}constructor(e){this._accountService=e}}v=(0,i.gn)([(0,i.fM)(0,g.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===g.Gw?Object:g.Gw])],v);class f extends o.JT{getTips(){return this._copyrightTipRepository.getTips()}constructor(e){super(),this._instantiationService=e,this._copyrightTipRepository=this._instantiationService.createInstance(v)}}f=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],f)},26372:function(e,t,r){r.d(t,{O:function(){return a}});var i=r(758027),n=r(127830),o=r(33883),s=r(857727);class a extends i.B{get resourceType(){return n._g.CurveHSL}get resourcePanelType(){return o.q.TextGlow}parseHeycanResponseDataToResources(e){return(0,s.z)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}},857727:function(e,t,r){r.d(t,{z:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.CurveHSL);return{...t,key:`${n._g.CurveHSL}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},176151:function(e,t,r){r.d(t,{s:function(){return i}});let i=(0,r(335290).yh)("curve-preset-data-service")},655499:function(e,t,r){r.d(t,{L:()=>w});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("857734"),a=r("644150"),c=r("276283"),u=r("744268"),l=r("736031"),d=r("249656"),_=r("305301"),h=r("602817"),p=r("64088"),g=r("872443"),v=r("33883"),f=r("127830"),m=r("481302");class y extends g.L{get resourceType(){return f._g.CurvePreset}get resourcePanelType(){return v.q.CurvePreset}parseHeycanResponseDataToResources(e){return(0,m.a)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}class w extends o.JT{async getCurvePreset(e){return await (0,l._Q)(this._configurationService,this._getHeycanCurvePresetByCategoryRepository.resourcePanelType,l.$0)?this._getHeycanCurvePresetByCategoryRepository.getResources(e):this._curvePresetRepository.getResources(e)}async batchGetCurvePresetsByIds(e){if(e.source===d.Hw.LOKI)return this._batchGetCurvePresetRepository.batchGetResources(e);{let t=await (0,l.bY)(this._configurationService,l.$0);return"loki"===(0,l.lo)(t,this._batchGetHeycanCurvePresetRepository.resourcePanelType).panel_path&&e.source!==d.Hw.HEYCAN?this._batchGetCurvePresetRepository.batchGetResources(e):this._batchGetHeycanCurvePresetRepository.batchGetResources((0,_.Q)(e.ids,this._batchGetHeycanCurvePresetRepository.resourceType,e.source))}}async getCurvePresetCategories(e){let t=await (0,l.bY)(this._configurationService,l.$0);return"vimo"===(0,l.lo)(t,this._getHeycanCurvePresetCategoriesRepository.resourcePanelType).panel_path?this._getHeycanCurvePresetCategoriesRepository.getCategories((0,l.lY)(e,t)):this._getCurvePresetCategoriesRepository.getCategories(e)}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._curvePresetRepository=this._instantiationService.createInstance(a.U),this._batchGetCurvePresetRepository=this._instantiationService.createInstance(s.U),this._getCurvePresetCategoriesRepository=this._instantiationService.createInstance(c.u),this._getHeycanCurvePresetByCategoryRepository=this._instantiationService.createInstance(p.r),this._getHeycanCurvePresetCategoriesRepository=this._instantiationService.createInstance(y),this._batchGetHeycanCurvePresetRepository=this._instantiationService.createInstance(h.V)}}w=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,u.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===u.Ui?Object:u.Ui])],w)},913446:function(e,t,r){r.d(t,{f:function(){return s}});var i=r(773943),n=r(198715),o=r(127830);class s extends i.b{buildCustomRequest(e){var t;return{enable_album:null!==(t=e.enableAlbum)&&void 0!==t&&t}}get resourceType(){return o._g.CurveSpeed}parseEffectsToResources(e,t){return e.map(e=>(0,n.T)(e,t))}}},677145:function(e,t,r){r.d(t,{r:function(){return a}});var i=r(273340),n=r(510879),o=r(789869),s=r(33883);class a extends o.A{get resourceType(){return i.g.CurveSpeed}get resourcePanelType(){return s.q.CurveSpeed}parseHeycanResponseDataToResources(e){return(0,n.t)(e)}}},462090:function(e,t,r){r.d(t,{A:function(){return a}});var i=r(758027),n=r(127830),o=r(33883),s=r(510879);class a extends i.B{get resourceType(){return n._g.CurveSpeed}get resourcePanelType(){return o.q.CurveSpeed}parseHeycanResponseDataToResources(e){return(0,s.t)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}},198715:function(e,t,r){r.d(t,{T:function(){return s}});var i=r(623935),n=r(981632),o=r(127830);function s(e,t){var r;let{common:s,extra:a}=(0,i.sh)(o._g.CurveSpeed,e,t),c=null!==(r=(0,n.D)(a.speed_points).speed_points)&&void 0!==r?r:[];return{...s,speedPoints:c}}},537745:function(e,t,r){r.d(t,{T:function(){return i}});let i=(0,r(335290).yh)("digital-human-data-service")},283213:function(e,t,r){r.d(t,{$:()=>P});var i=r("789786"),n=r("861810"),o=r("55449"),s=r("402655"),a=r("415906"),c=r("273340"),u=r("106937"),l=r("966697"),d=r("467209");class _ extends u.n{get resourceType(){return c.g.DigitalHuman}parseHeycanResponseDataToResources(e){return(0,d.A)(e)}buildCustomRequest(){return{pack_optional:{need_thumb:!0,only_commercial:!1,thumb_opt:JSON.stringify({is_support_webp:1})}}}constructor(e){super(e),this._capcutAccountService=e}}_=(0,i.gn)([(0,i.fM)(0,l.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===l.Gw?Object:l.Gw])],_);var h=r("156470"),p=r("256718"),g=r("396190");class v extends p.k{get resourceType(){return c.g.DigitalHuman}parseHeycanResponseDataToResources(e){return(0,d.A)(e)}buildCustomRequest(){return{loki_optional:{app_version:this._environmentService.appVersion,device_platform:"web"},pack_optional:{need_thumb:!0}}}constructor(e={},t,r){super(e,t),this._environmentService=r}}v=(0,i.gn)([(0,i.fM)(1,l.Gw),(0,i.fM)(2,g.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===l.Gw?Object:l.Gw,void 0===g.Y?Object:g.Y])],v);var f=r("690613"),m=r("114861"),y=r("702049"),w=r("405051"),k=r("121130"),b=r("894339"),S=r("768101"),R=r("543395");class C{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new w.yk().build(w.kk);return(0,k.i3)(e),(0,b.mH)(e),(0,m.V)(e),e}()),this._networkClientInstance}async saveDigitalHumanToCloud(e){try{var t,r;let i=await this._networkClient.post(this._api,{...e},{withCredentials:!0}),n=Number(null!==(t=i.ret)&&void 0!==t?t:0),o=null!==(r=i.errmsg)&&void 0!==r?r:"";if(0!==n)return(0,f.wf)(null!=n?n:-1,null!=o?o:"");let s=this._convertResponseToResourceData(i);return(0,f.oW)(s)}catch(e){return(0,S.m)(e,-1,"saveDigitalHumanToCloud api error")}}_convertResponseToResourceData(e){let{data:t}=e;return{list:t.assets.map(e=>({id:e.id,originVideo:e.rgb,maskVideo:e.mask}))}}get _api(){return`${y._L.getVar("web_domain")}${R.b.SAVE_TO_CLOUD}`}}var I=r("942133");class P extends s.JT{getDigitalHumanList(e){return this._getDigitalHumanListRepository.getResources(e)}getDigitalHumanByIds(e){return this._getDigitalHumanByIdsRepository.batchGetResources(e)}searchDigitalHuman(e){return this._searchDigitalHumanRepository.searchDigitalHuman(e)}getCollections(e){return this._collectionDigitalHumanRepository.getCollections(e)}addToCollection(e){return this._collectionDigitalHumanRepository.addToCollection(e)}removeFromCollection(e){return this._collectionDigitalHumanRepository.removeFromCollection(e)}saveDigitalHumanToCloud(e){return this._saveDigitalHumanToCloudRepository.saveDigitalHumanToCloud(e)}getCategories(e){return this._getDigitalHumanCategoriesRepository.getCategories(e)}constructor(e={},t){super(),this.collectionParam=e,this._instantiationService=t,this._getDigitalHumanListRepository=this._instantiationService.createInstance(a.z),this._getDigitalHumanByIdsRepository=this._instantiationService.createInstance(_),this._searchDigitalHumanRepository=this._instantiationService.createInstance(h.c,this._getDigitalHumanByIdsRepository),this._collectionDigitalHumanRepository=this._instantiationService.createInstance(new n.M(v,[e],!1)),this._saveDigitalHumanToCloudRepository=this._instantiationService.createInstance(C),this._getDigitalHumanCategoriesRepository=this._instantiationService.createInstance(I.H)}}P=(0,i.gn)([(0,i.fM)(1,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===o.T?Object:o.T])],P)},253055:function(e,t,r){r.d(t,{Q:function(){return i}});let i=(0,r(335290).yh)("draft-copy-data-service")},845981:function(e,t,r){r.d(t,{EA:function(){return c},G2:function(){return a},SH:function(){return u}});var i,n=r(475028),o=r(690613);let s=(0,n.i)(2317,"permission denied."),a=(0,n.i)(2408,"workspace quota.");function c(e,t){switch(e){case"2317":return s();case"2408":return a();default:return(0,o.wf)(Number(e),t)}}var u=((i={})[i.Initial=0]="Initial",i[i.Processing=1]="Processing",i[i.Cleanup=2]="Cleanup",i[i.Success=3]="Success",i[i.Failed=4]="Failed",i)},147081:function(e,t,r){r.d(t,{n:function(){return _}});var i=r(702049),n=r(405051),o=r(121130),s=r(894339),a=r(768101),c=r(690613),u=r(114861),l=r(465698),d=r(845981);class _{get _createTaskApi(){return`${i._L.getVar("web_domain")}${l.b.CREATE_COPY_TASK}`}get _getTaskDetailApi(){return`${i._L.getVar("web_domain")}${l.b.GET_COPY_TASK_DETAIL}`}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new n.yk().build({headers:{"Content-Type":"application/json"}});return(0,o.mK)(e),(0,s.mH)(e),(0,u.V)(e),e}()),this._networkClientInstance}async createDraftCopyTask(e){try{let t=await this._networkClient.post(this._createTaskApi,{...e},{withCredentials:!0});if("0"!==t.ret)return(0,d.EA)(t.ret,t.errmsg);return(0,c.oW)(t.data.process_id)}catch(e){return(0,a.m)(e,-1,"createCopyDraft api error.")}}async getDraftCopyTask(e){try{let t=await this._networkClient.post(this._getTaskDetailApi,e,{withCredentials:!0});if("0"!==t.ret)return(0,c.wf)(Number(t.ret),t.errmsg);return(0,c.oW)(t.data)}catch(e){return(0,a.m)(e,-1,"getDraftCopyDetail api error.")}}}},289041:function(e,t,r){r.d(t,{b:function(){return i}});let i={GET_PACK_RESOURCE:"/lv/v1/editor/pack_resource"}},575755:function(e,t,r){r.d(t,{C:function(){return i}});let i=(0,r(335290).yh)("draft-cover-data-service")},340163:function(e,t,r){r.d(t,{I:function(){return a}});var i=r(789786),n=r(55449),o=r(402655),s=r(644246);class a extends o.JT{getDraftCover(e){return this._draftCoverRepository.getDraftCover(e)}constructor(e){super(),this._instantiationService=e,this._draftCoverRepository=this._instantiationService.createInstance(s.g)}}a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},916636:function(e,t,r){r.d(t,{c:function(){return i}});let i=(0,r(335290).yh)("effect-ab-test-data-service")},100095:function(e,t,r){r.d(t,{s:()=>f});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("690613"),a=r("114861"),c=r("415266"),u=r("405051"),l=r("121130"),d=r("894339"),_=r("768101"),h=r("141314"),p=r("835342");class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new u.yk().build(u.kk);return(0,l.i3)(e),(0,d.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}async getEffectAbTest(){try{let t=await this._networkClient.post(this._urlGenerator.url("GET_EFFECT_AB_PARAM"),{},{withCredentials:!0});if("0"!==t.ret){var e;return(0,s.wf)(Number(t.ret),null!==(e=t.errmsg)&&void 0!==e?e:"")}return(0,s.oW)((0,p.o)(t))}catch(e){return(0,_.m)(e,-1,"getEffectAbTest api error")}}constructor(){this._urlGenerator=new h.w(c.c)}}var v=r("462589");class f extends o.JT{getEffectAbTest(){return this._effectAbTestRepository.getEffectAbTest()}constructor(e){super(),this._instantiationService=e,this._effectAbTestRepository=this._instantiationService.createInstance(g)}}(0,i.gn)([(0,v.o)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],f.prototype,"getEffectAbTest",null),f=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],f)},93090:function(e,t,r){r.d(t,{R:function(){return i}});let i=(0,r(335290).yh)("effect-settings-data-service")},853369:function(e,t,r){r.d(t,{w:function(){return c}});var i=r(789786),n=r(494158),o=r(966697),s=r(256718),a=r(396190);class c extends s.k{get resourceType(){return this._resourceType}parseHeycanResponseDataToResources(e){return(0,n.h)(e)}buildCustomRequest(){return{loki_optional:{app_version:this._environmentService.appVersion,device_platform:"web"},pack_optional:{need_thumb:!0}}}constructor(e,t={},r,i){super(t,r),this._resourceType=e,this._environmentService=i}}c=(0,i.gn)([(0,i.fM)(2,o.Gw),(0,i.fM)(3,a.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof EffectHeycanType?Object:EffectHeycanType,"undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===o.Gw?Object:o.Gw,void 0===a.Y?Object:a.Y])],c)},976058:function(e,t,r){r.d(t,{H:function(){return _}});var i=r(789786),n=r(966697),o=r(744268),s=r(512363),a=r(549367),c=r(127830),u=r(332557),l=r(396190),d=r(847083);class _ extends s.L{parseDetailToResources(e){return this._resourceType===c._g.Effects?(0,a.W6)(e):(0,a.LP)(e)}get resourceType(){return this._resourceType}constructor(e,t,r,i,n,o){super(t,r,i,n,o),this._resourceType=e}}_=(0,i.gn)([(0,i.fM)(1,n.Gw),(0,i.fM)(2,o.Ui),(0,i.fM)(3,u.U),(0,i.fM)(4,l.Y),(0,i.fM)(5,d.a),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof EffectResourceType?Object:EffectResourceType,void 0===n.Gw?Object:n.Gw,void 0===o.Ui?Object:o.Ui,void 0===u.U?Object:u.U,void 0===l.Y?Object:l.Y,void 0===d.a?Object:d.a])],_)},607572:function(e,t,r){r.d(t,{t:function(){return g}});var i=r(789786),n=r(966697),o=r(758027),s=r(127830),a=r(544688),c=r(916636),u=r(33883),l=r(744268),d=r(229622),_=r(685795),h=r(332557),p=r(847083);class g extends o.B{get resourceType(){return this._resourceType}get resourcePanelType(){return this._resourceType===s._g.Effects?u.q.Effects:u.q.FaceProp}parseHeycanResponseDataToResources(e){return this._resourceType===s._g.Effects?(0,d.qi)(e):(0,d.vf)(e)}buildCustomRequest(e){var t;return{panel:this._resourceType===s._g.Effects?u.q.Effects:u.q.FaceProp,category_id:Number(e.category),client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t,thumb_opt:'{"is_support_webp":1}',image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}constructor(e,t,r,i,n,o,s,a,c){super(t,r,i,n,o,s,a),this._resourceType=e}}g=(0,i.gn)([(0,i.fM)(1,n.Gw),(0,i.fM)(2,a.c),(0,i.fM)(3,c.c),(0,i.fM)(4,l.Ui),(0,i.fM)(5,_.L),(0,i.fM)(6,p.a),(0,i.fM)(7,h.U),(0,i.fM)(8,p.a),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof EffectResourceType?Object:EffectResourceType,void 0===n.Gw?Object:n.Gw,void 0===a.c?Object:a.c,void 0===c.c?Object:c.c,void 0===l.Ui?Object:l.Ui,void 0===_.L?Object:_.L,void 0===p.a?Object:p.a,void 0===h.U?Object:h.U,void 0===p.a?Object:p.a])],g)},151293:function(e,t,r){r.d(t,{v:function(){return o}});var i=r(96879),n=r(786022);class o extends i.S{buildCustomRequest(e){return{app_id:n.kJ,client_ab_param:e.clientABParam,search_option:{cc_web_use_new_search:!0,scene:e.scene||"i18n_vimo_effects2_web"},pack_optional:{need_thumb:!0,thumb_opt:'{"is_support_webp":1}',image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}}},977442:function(e,t,r){r.d(t,{U:function(){return i}});function i(e){if(e){var t,r;return null!==(r=null===(t=e.effect_adjust_params)||void 0===t?void 0:t.map(e=>({effectKey:e.effect_key,default:e.default,min:e.min,max:e.max})))&&void 0!==r?r:[]}return[]}},549367:function(e,t,r){r.d(t,{By:function(){return u},LP:function(){return c},W6:function(){return a}});var i=r(623935),n=r(127830),o=r(249656),s=r(977442);function a(e,t){let{common:r,extra:a,sdkExtra:c}=(0,i.sh)(n._g.Effects,e,t);return{...r,source:r.source===o.Hw.UNKNOWN?o.Hw.LOKI:r.source,effectDuration:a.effect_duration,adjustParams:(0,s.U)(c.setting),effectType:n._g.Effects}}function c(e,t){let{common:r,extra:a,sdkExtra:c}=(0,i.sh)(n._g.FaceProp,e,t);return{...r,source:r.source===o.Hw.UNKNOWN?o.Hw.LOKI:r.source,effectDuration:a.effect_duration,adjustParams:(0,s.U)(c.setting),effectType:n._g.FaceProp}}function u(e){return e===n._g.FaceProp?c:a}},117082:function(e,t,r){r.d(t,{l:function(){return i}});let i=(0,r(335290).yh)("emoji-data-service")},844763:function(e,t,r){r.d(t,{e:function(){return p}});var i=r(789786),n=r(55449),o=r(402655),s=r(568625),a=r(518683),c=r(768098),u=r(736031),l=r(744268),d=r(143177),_=r(249656),h=r(305301);class p extends o.JT{async getEmoji(e){return await (0,u._Q)(this._configurationService,this._getHeycanEmojiByCategoryRepository.resourcePanelType,u.$0)?this._getHeycanEmojiByCategoryRepository.getResources(e):this._emojiRepository.getResources(e)}async batchGetEmojisByIds(e){if(e.source===_.Hw.LOKI)return this._batchGetEmojiRepository.batchGetResources(e);{let t=await (0,u.bY)(this._configurationService,u.$0);return"loki"===(0,u.lo)(t,this._batchGetHeycanEmojiRepository.resourcePanelType).panel_path&&e.source!==_.Hw.HEYCAN?this._batchGetEmojiRepository.batchGetResources(e):this._batchGetHeycanEmojiRepository.batchGetResources((0,h.Q)(e.ids,this._batchGetHeycanEmojiRepository.resourceType,e.source))}}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._emojiRepository=this._instantiationService.createInstance(a.v),this._batchGetEmojiRepository=this._instantiationService.createInstance(s.F),this._getHeycanEmojiByCategoryRepository=this._instantiationService.createInstance(c.s),this._batchGetHeycanEmojiRepository=this._instantiationService.createInstance(d.x)}}p=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,l.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===l.Ui?Object:l.Ui])],p)},767528:function(e,t,r){r.d(t,{F:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.Emoji);return{...t,key:`${n._g.Emoji}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},121305:function(e,t,r){r.d(t,{b:function(){return i}});let i={GET_EVERCLOUD_TOKEN:"/cc/v1/workspace/get_ever_photo_token"}},117641:function(e,t,r){r.d(t,{_:function(){return a}});var i=r(789786),n=r(55449),o=r(529948),s=r(462589);class a{getEvercloudToken(){return this._evercloudTokenRepository.getEvercloudToken()}constructor(e){this._instantiationService=e,this._evercloudTokenRepository=this._instantiationService.createInstance(o.n)}}(0,i.gn)([(0,s.o)(72e5),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],a.prototype,"getEvercloudToken",null),a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},652705:function(e,t,r){r.d(t,{i:function(){return s}});var i=r(127830),n=r(412497),o=r(722807);class s extends n.r{get resourceType(){return i._g.Filter}parseEffectsToResources(e){return e.map(e=>(0,o.y)(e))}}},955977:function(e,t,r){r.d(t,{p:function(){return s}});var i=r(773943),n=r(722807),o=r(127830);class s extends i.b{buildCustomRequest(e){return{enable_album:e.enableAlbum,only_commercial:e.onlyCommercial}}get resourceType(){return o._g.Filter}parseEffectsToResources(e,t){return e.map(e=>(0,n.y)(e,t))}}},734372:function(e,t,r){r.d(t,{c:function(){return a}});var i=r(955310),n=r(758027),o=r(127830),s=r(33883);class a extends n.B{get resourceType(){return o._g.Filter}get resourcePanelType(){return s.q.Filter}parseHeycanResponseDataToResources(e){return(0,i.Q)(e)}buildCustomRequest(e){var t,r;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t,only_commercial:null!==(r=e.onlyCommercial)&&void 0!==r&&r,image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}}},955310:function(e,t,r){r.d(t,{Q:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.Filter);return{...t,key:`${n._g.Filter}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},540907:function(e,t,r){r.d(t,{T:function(){return s}});var i=r(773943),n=r(899797),o=r(127830);class s extends i.b{buildCustomRequest(e){var t,r;return{enable_album:null!==(t=e.enableAlbum)&&void 0!==t&&t,only_commercial:null!==(r=e.onlyCommercial)&&void 0!==r&&r}}get resourceType(){return o._g.Font}parseEffectsToResources(e,t){return e.map(e=>(0,n.ey)(e,t))}}},345577:function(e,t,r){r.d(t,{K:function(){return a}});var i=r(872443),n=r(33883),o=r(820590),s=r(127830);class a extends i.L{get resourceType(){return s._g.Font}get resourcePanelType(){return n.q.Font}parseHeycanResponseDataToResources(e){return(0,o.n)(e)}buildCustomRequest(e){var t,r;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t,only_commercial:null!==(r=e.onlyCommercial)&&void 0!==r&&r}}}buildCustomRequestParams(){var e;return{device_type:"default",channel:null!==(e=new URLSearchParams(location.search).get("lokiChannel"))&&void 0!==e?e:"online"}}}},899797:function(e,t,r){r.d(t,{es:function(){return l},ey:function(){return u}});var i=r(623935),n=r(127830),o=r(249656),s=r(981632),a=r(32372),c=r(134429);function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?function(e){let{common_attr:t,font_icon:r}=e,i=t.item_url||t.download_info.url,n=(null==r?void 0:r.ImageUrl)||t.cover_url.small;return{key:t.id,resourceId:t.id,effectId:t.id,md5:t.md5||t.id,name:t.title,isBusiness:!1,isVip:!1,package:{uri:(0,a.s)(i),urlList:[i]},icon:{uri:(0,a.s)(t.cover_url.small),urlList:[t.cover_url.small]},isFromBrand:!0,source:o.Hw.BRAND,sdkVersion:c.f4,previewUrl:n,isDefault:e.IsDefault,userId:t.user_id,createTime:t.create_time,isPrefab:!1}}(e):function(e,t){let r;let{common:o,extra:s,urlPrefix:a}=(0,i.sh)(n._g.Font,e,t),c=s.light_icon;return r=c?{uri:c,urlList:[`${a}${c}`]}:{uri:`${o.effectId}.svg`,urlList:[`https://lf16-web-buz.capcut.com/obj/capcut-web-buz-us/loki-font-svg/${o.effectId}.svg`]},{...o,icon:r}}(e,t)}let l=e=>{var t,r,i;let{id:n,effect_id:a,title:u,extra:l,md5:d,item_urls:_,cover_url:h}=e.common_attr,p=(0,s.D)(l),g=/^(https?:\/\/.*\/)(.*)/g.exec(null!==(t=null==_?void 0:_[0])&&void 0!==t?t:""),v=null!==(r=null==g?void 0:g[1])&&void 0!==r?r:"";return{key:n,resourceId:n,effectId:a,md5:d,name:u,isBusiness:!1,isVip:!1,package:{uri:(null==_?void 0:_.length)?_[0].split(v)[1]:"",urlList:_},icon:{uri:h.small.split(v)[1],urlList:[h.small]},isFromBrand:!1,source:o.Hw.LOKI,sdkVersion:c.f4,previewUrl:p.web_icon?`${v}${p.web_icon}`:"",sourceFrom:"dreamina",isArtFont:null!==(i=p.is_ai_artist)&&void 0!==i&&i}}},820590:function(e,t,r){r.d(t,{n:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.Font);return{...t,key:`${n._g.Font}_${t.resourceId}`,resourceId:t.resourceId,effectId:t.effectId,md5:t.md5,name:t.title,isBusiness:t.isBusiness,isVip:t.isVip,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},requirements:t.requirements,modelNames:t.modelNames,source:t.source,isPrefab:t.isPrefab,sdkVersion:s.f4}}},116010:function(e,t,r){r.d(t,{b:function(){return i}});let i={CREATE_DRAW_FRAME_TASK:"/lv/v1/intelligence/draw_frame",QUERY_DRAW_FRAME_TASK:"/lv/v1/intelligence/query_draw_frame_result"}},416549:function(e,t,r){r.d(t,{w:function(){return o}});var i=r(402655),n=r(651998);class o extends i.JT{createDrawFrameTask(e){return this._frameRepository.createDrawFrameTask(e)}queryDrawFrameTask(e){return this._frameRepository.queryDrawFrameTask(e)}constructor(){super(),this._frameRepository=new n.z}}},616315:function(e,t,r){r.d(t,{N:function(){return i}});let i=(0,r(335290).yh)("gif-data-service")},409565:function(e,t,r){r.d(t,{Y:function(){return i}});function i(e){e.interceptors.response.use(e=>{if(200===e.status){var t;let r=e.data;if((null==r?void 0:r.ret)==="0"||(null==r?void 0:null===(t=r.BaseResp)||void 0===t?void 0:t.StatusCode)===0||(null==r?void 0:r.status_code)===0)return Promise.resolve(e.data);if((null==r?void 0:r.ret)==="2013")return r.ret="0",r.data={has_more:!1,next_offset:0,library_item_list:[]},Promise.resolve(r)}return Promise.reject(e.data)})}},896002:function(e,t,r){r.d(t,{d:function(){return g}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(768101),l=r(966697),d=r(249833),_=r(620090),h=r(801497),p=r(606805);class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,o.V)(e),e}()),this._networkClientInstance}async getGifsByIds(e){try{let t=await this._networkClient.post(this._api,{idList:e.ids},(0,p._)(this._capcutAccountService.userProfile.region,h.ZP.language)),r=this._convertResponseToResourceData(t);return(0,n.oW)(r)}catch(e){return(0,u.m)(e,-1,"getGifsByIds api error")}}_convertResponseToResourceData(e){let{data:t}=e;return{list:t.library_item_list.map(e=>(0,_.g)(e))}}get _api(){return`${s._L.getVar("web_domain")}${d.b.MGET_BY_IDS}`}constructor(e){this._capcutAccountService=e}}g=(0,i.gn)([(0,i.fM)(0,l.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===l.Gw?Object:l.Gw])],g)},846760:function(e,t,r){r.d(t,{x:function(){return p}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(768101),l=r(966697),d=r(249833),_=r(801497),h=r(606805);class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,o.V)(e),e}()),this._networkClientInstance}async getTrendingSearchWords(){try{var e,t;let r=await this._networkClient.post(this._api,{},(0,h._)(this._capcutAccountService.userProfile.region,_.ZP.language)),i=Number(null!==(e=r.ret)&&void 0!==e?e:0),o=null!==(t=r.errmsg)&&void 0!==t?t:"";if(0!==i)return(0,n.wf)(null!=i?i:-1,null!=o?o:"");let s=this._convertResponseToResourceData(r);return(0,n.oW)(s)}catch(e){return(0,u.m)(e,-1,"getTrendingSearchWords api error")}}_convertResponseToResourceData(e){return{words:e.data.recommend_words}}get _api(){return`${s._L.getVar("web_domain")}${d.b.SEARCH_WORDS}`}constructor(e){this._capcutAccountService=e}}p=(0,i.gn)([(0,i.fM)(0,l.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===l.Gw?Object:l.Gw])],p)},259406:function(e,t,r){r.d(t,{o:()=>b});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("127830"),a=r("412497"),c=r("750503");class u extends a.r{get resourceType(){return s._g.Graffiti}parseEffectsToResources(e){return e.map(e=>(0,c.H)(e))}}var l=r("50580"),d=r("273340"),_=r("428934"),h=r("789869"),p=r("33883");class g extends h.A{get resourceType(){return d.g.TextAnimation}get resourcePanelType(){return p.q.Graffiti}parseHeycanResponseDataToResources(e){return(0,_.b)(e)}}var v=r("758027");class f extends v.B{get resourceType(){return s._g.Graffiti}get resourcePanelType(){return p.q.Graffiti}parseHeycanResponseDataToResources(e){return(0,_.b)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}var m=r("744268"),y=r("736031"),w=r("249656"),k=r("305301");class b extends o.JT{async getGraffiti(e){let t=await (0,y.bY)(this._configurationService,y.Jk);return"vimo"===(0,y.lo)(t,this._getHeycanGraffitiByCategoryRepository.resourcePanelType).panel_path?this._getHeycanGraffitiByCategoryRepository.getResources((0,y.lY)(e,t,{isSkipSetPanelSourceNull:!0})):this._graffitiRepository.getResources(e)}async batchGetGraffitisByIds(e){if(e.source===w.Hw.HEYCAN){let t=await (0,y.bY)(this._configurationService,y.Jk);return"loki"===(0,y.lo)(t,this._batchGetHeycanGraffitiRepository.resourcePanelType).panel_path&&e.source!==w.Hw.HEYCAN?this._batchGetGraffitiRepository.batchGetResources(e):this._batchGetHeycanGraffitiRepository.batchGetResources((0,k.Q)(e.ids,this._batchGetHeycanGraffitiRepository.resourceType,e.source))}return this._batchGetGraffitiRepository.batchGetResources(e)}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._graffitiRepository=this._instantiationService.createInstance(l.K),this._batchGetGraffitiRepository=this._instantiationService.createInstance(u),this._getHeycanGraffitiByCategoryRepository=this._instantiationService.createInstance(f),this._batchGetHeycanGraffitiRepository=this._instantiationService.createInstance(g)}}b=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,m.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===m.Ui?Object:m.Ui])],b)},428934:function(e,t,r){r.d(t,{b:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.Graffiti);return{...t,key:`${n._g.Graffiti}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},470824:function(e,t,r){r.d(t,{K:function(){return i}});let i={getUploadToken:"/artist/v2/tools/get_upload_token"}},658435:function(e,t,r){r.d(t,{x:function(){return i}});let i=(0,r(335290).yh)("heycan-upload-data-service")},74493:function(e,t,r){r.d(t,{b:()=>k});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("127830"),a=r("412497"),c=r("669773");class u extends a.r{get resourceType(){return s._g.Integration}parseEffectsToResources(e){return e.map(e=>(0,c.f)(e))}}var l=r("39039"),d=r("736031"),_=r("249656"),h=r("305301"),p=r("744268"),g=r("273340"),v=r("801363"),f=r("789869"),m=r("33883");class y extends f.A{get resourceType(){return g.g.Integration}get resourcePanelType(){return m.q.Integration}parseHeycanResponseDataToResources(e){return(0,v.O)(e)}}var w=r("883224");class k extends o.JT{async getIntegration(e){return await (0,d._Q)(this._configurationService,this._getHeycanIntegrationByCategoryRepository.resourcePanelType,d.$0)?this._getHeycanIntegrationByCategoryRepository.getResources(e):this._integrationRepository.getResources(e)}async batchGetIntegrationsByIds(e){if(e.source===_.Hw.LOKI)return this._batchGetIntegrationRepository.batchGetResources(e);{let t=await (0,d.bY)(this._configurationService,d.$0);return"loki"===(0,d.lo)(t,this._batchGetHeycanIntegrationRepository.resourcePanelType).panel_path&&e.source!==_.Hw.HEYCAN?this._batchGetIntegrationRepository.batchGetResources(e):this._batchGetHeycanIntegrationRepository.batchGetResources((0,h.Q)(e.ids,this._batchGetHeycanIntegrationRepository.resourceType,e.source))}}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._integrationRepository=this._instantiationService.createInstance(l.X),this._batchGetIntegrationRepository=this._instantiationService.createInstance(u),this._getHeycanIntegrationByCategoryRepository=this._instantiationService.createInstance(w.W),this._batchGetHeycanIntegrationRepository=this._instantiationService.createInstance(y)}}k=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,p.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===p.Ui?Object:p.Ui])],k)},669773:function(e,t,r){r.d(t,{f:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r}=(0,i.sh)(n._g.Integration,e,t);return{...r}}},949322:function(e,t,r){r.d(t,{x:function(){return a}});var i=r(789786),n=r(55449),o=r(402655),s=r(468661);class a extends o.JT{detectLanguage(e){return this._languageRepository.detectLanguage(e)}translateLanguage(e){return this._languageRepository.translateLanguage(e)}constructor(e){super(),this._instantiationService=e,this._languageRepository=this._instantiationService.createInstance(s.T)}}a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},177146:function(e,t,r){r.d(t,{S:()=>E});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("726258"),a=r("773943"),c=r("905449"),u=r("127830");class l extends a.b{buildCustomRequest(e){var t;return{enable_album:null!==(t=e.enableAlbum)&&void 0!==t&&t}}get resourceType(){return u._g.Mask}parseEffectsToResources(e,t){return e.map(e=>(0,c.m)(e,t))}}var d=r("660056"),_=r("479657"),h=r("412497"),p=r("937942");class g extends h.r{get resourceType(){return u._g.AiAvatarMask}parseEffectsToResources(e){return e.map(e=>(0,p.q)(e))}}var v=r("736031"),f=r("249656"),m=r("744268"),y=r("791569"),w=r("872443"),k=r("33883"),b=r("574329");class S extends w.L{get resourceType(){return u._g.Mask}get resourcePanelType(){return k.q.Mask}parseHeycanResponseDataToResources(e){return(0,b.B)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}var R=r("273340"),C=r("789869");class I extends C.A{get resourceType(){return R.g.Mask}get resourcePanelType(){return k.q.Mask}parseHeycanResponseDataToResources(e){return(0,b.B)(e)}}var P=r("305301");class E extends o.JT{async getMask(e){return await (0,v._Q)(this._configurationService,this._getHeycanMaskByCategoryRepository.resourcePanelType,v.$0)?this._getHeycanMaskByCategoryRepository.getResources(e):this._maskRepository.getResources(e)}async batchGetMasksByIds(e){if(e.source===f.Hw.LOKI)return this._batchGetMaskRepository.batchGetResources(e);{let t=await (0,v.bY)(this._configurationService,v.$0);return"loki"===(0,v.lo)(t,this._batchGetHeycanMaskRepository.resourcePanelType).panel_path&&e.source!==f.Hw.HEYCAN?this._batchGetMaskRepository.batchGetResources(e):this._batchGetHeycanMaskRepository.batchGetResources((0,P.Q)(e.ids,this._batchGetHeycanMaskRepository.resourceType,e.source))}}async getMaskCategories(e){let t=await (0,v.bY)(this._configurationService,v.$0);return"vimo"===(0,v.lo)(t,this._getHeycanMaskCategoriesRepository.resourcePanelType).panel_path?this._getHeycanMaskCategoriesRepository.getCategories((0,v.lY)(e,t)):this._getMaskCategoriesRepository.getCategories(e)}async getAiAvatarMask(e){var t,r;let[i,n]=(await this._aiAvatarMaskRepository.getCategories(e)).pair();if(i)return{list:[]};let o=null===(t=n.value.list[0])||void 0===t?void 0:t.id;return(null===(r=n.value.details)||void 0===r?void 0:r[o])||{list:[]}}batchGetAiAvatarMaskByIds(e){return this.__batchGetAiAvatarMaskRepository.batchGetResources(e)}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._maskRepository=this._instantiationService.createInstance(l),this._batchGetMaskRepository=this._instantiationService.createInstance(s.h),this._getMaskCategoriesRepository=this._instantiationService.createInstance(d.d),this._aiAvatarMaskRepository=this._instantiationService.createInstance(_.R),this.__batchGetAiAvatarMaskRepository=this._instantiationService.createInstance(g),this._getHeycanMaskByCategoryRepository=this._instantiationService.createInstance(y.z),this._getHeycanMaskCategoriesRepository=this._instantiationService.createInstance(S),this._batchGetHeycanMaskRepository=this._instantiationService.createInstance(I)}}E=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,m.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===m.Ui?Object:m.Ui])],E)},209342:function(e,t,r){r.d(t,{X:function(){return n}});var i,n=((i={}).LINE="line",i.MIRROR="mirror",i.CIRCLE="circle",i.RECTANGLE="rectangle",i.GEOMETRIC="geometric_shape",i)},937942:function(e,t,r){r.d(t,{q:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r}=(0,i.sh)(n._g.AiAvatarMask,e,t);return{...r}}},905449:function(e,t,r){r.d(t,{m:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r,extra:o,urlPrefix:s}=(0,i.sh)(n._g.Mask,e,t);return{...r,maskType:o.resource_type,themeIcon:{dark:{uri:o.dark_icon,urlList:[`${s}${o.dark_icon}`]},light:{uri:o.light_icon,urlList:[`${s}${o.light_icon}`]}}}}},503901:function(e,t,r){r.d(t,{J:function(){return a}});var i=r(273340),n=r(422711),o=r(789869),s=r(33883);class a extends o.A{get resourceType(){return i.g.TextAnimation}get resourcePanelType(){return s.q.MattingStroke}parseHeycanResponseDataToResources(e){return(0,n.l)(e)}}},63862:function(e,t,r){r.d(t,{G:function(){return a}});var i=r(422711),n=r(758027),o=r(127830),s=r(33883);class a extends n.B{get resourceType(){return o._g.MattingStroke}get resourcePanelType(){return s.q.MattingStroke}parseHeycanResponseDataToResources(e){return(0,i.l)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}},422711:function(e,t,r){r.d(t,{l:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){var t;let r=(0,i.E)(e,n._g.MattingStroke),a=null!==(t=r.modelNames)&&void 0!==t?t:[];return!a.includes("tt_matting_video")&&a.push("tt_matting_video"),{...r,key:`${n._g.MattingStroke}_${r.resourceId}`,name:r.title,icon:{uri:(0,o.s)(r.coverUrl),urlList:[r.coverUrl]},previewUrl:r.coverUrl,package:{uri:(0,o.s)(r.originUrl),urlList:[r.originUrl]},sdkVersion:s.f4,modelNames:a}}},438148:function(e,t,r){r.d(t,{m:function(){return a}});var i=r(273340),n=r(998342),o=r(789869),s=r(33883);class a extends o.A{get resourceType(){return i.g.Mix}get resourcePanelType(){return s.q.Mix}parseHeycanResponseDataToResources(e){return(0,n.n)(e)}}},81162:function(e,t,r){r.d(t,{_:function(){return a}});var i=r(758027),n=r(127830),o=r(33883),s=r(998342);class a extends i.B{get resourceType(){return n._g.Mix}get resourcePanelType(){return o.q.Mix}parseHeycanResponseDataToResources(e){return(0,s.n)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}},179314:function(e,t,r){r.d(t,{H:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r}=(0,i.sh)(n._g.Mix,e,t);return{...r}}},998342:function(e,t,r){r.d(t,{n:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.Mix);return{...t,key:`${n._g.Mix}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},967016:function(e,t,r){r.d(t,{l:function(){return i}});let i=(0,r(335290).yh)("dreamina-text-art-data-service")},584827:function(e,t,r){r.d(t,{w:function(){return a}});var i=r(789786),n=r(55449),o=r(402655),s=r(367846);class a extends o.JT{getNewGuideUser(){return this._newGuideUserRepository.getNewGuideUser()}constructor(e){super(),this._instantiationService=e,this._newGuideUserRepository=this._instantiationService.createInstance(s.R)}}a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},457775:function(e,t,r){r.d(t,{i:function(){return i}});let i=(0,r(335290).yh)("object-lock-data-service")},686247:function(e,t,r){r.d(t,{P:function(){return s}});var i=r(773943),n=r(777051),o=r(127830);class s extends i.b{buildCustomRequest(e){return{enable_album:e.enableAlbum}}get resourceType(){return o._g.ObjectLock}parseEffectsToResources(e,t){return e.map(e=>(0,n.U)(e,t))}}},100808:function(e,t,r){r.d(t,{g:function(){return i}});let i=(0,r(335290).yh)("path-animation-data-service")},723476:function(e,t,r){r.d(t,{S:function(){return a}});var i=r(273340),n=r(837477),o=r(789869),s=r(33883);class a extends o.A{get resourceType(){return i.g.TextAnimation}get resourcePanelType(){return s.q.PathAnimation}parseHeycanResponseDataToResources(e){return(0,n.r)(e)}}},493168:function(e,t,r){r.d(t,{a:function(){return a}});var i=r(837477),n=r(758027),o=r(127830),s=r(33883);class a extends n.B{get resourceType(){return o._g.PathAnimation}get resourcePanelType(){return s.q.PathAnimation}parseHeycanResponseDataToResources(e){return(0,i.r)(e)}buildCustomRequest(e){return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{}}}}},181844:function(e,t,r){r.d(t,{E:function(){return i}});let i=function(e){var t,r,i,n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channel_default";return{windowsVersion:"3.7.0",macVersions:"3.7.0",windowsDownloadPkg:null===(t=e.windows_download_pkg)||void 0===t?void 0:t[o],windowsDownloadInstaller:null===(r=e.windows_download_installer)||void 0===r?void 0:r[o],macDownloadPkg:null===(i=e.mac_download_pkg)||void 0===i?void 0:i[o],macDownloadInstaller:null===(n=e.mac_download_installer)||void 0===n?void 0:n[o]}}},960395:function(e,t,r){r.d(t,{q:function(){return i}});let i=(0,r(335290).yh)("permission-data-service")},713261:function(e,t,r){r.d(t,{S:function(){return l}});var i=r(690613),n=r(114861),o=r(405051),s=r(894339),a=r(121130),c=r(702049),u=r(102593);class l{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new o.yk().build(o.kk);return(0,n.V)(e),(0,s.mH)(e),(0,a.i3)(e),e}()),this._networkClientInstance}async applyToDraft(e){var t,r,n,o,s;try{let n=await this._networkClient.post(this._api(),{package_key:e.packageKey,workspace_id:e.workspaceId},{withCredentials:!0}),o=Number(null!==(t=n.ret)&&void 0!==t?t:0),s=null!==(r=n.errmsg)&&void 0!==r?r:"";if(0!==o)return(0,i.wf)(null!=o?o:-1,null!=s?s:"");return(0,i.oW)(n.data)}catch(r){let e=null!==(o=null!==(n=null==r?void 0:r.errmsg)&&void 0!==n?n:null==r?void 0:r.message)&&void 0!==o?o:"applyToDraft api error",t=null!==(s=null==r?void 0:r.ret)&&void 0!==s?s:-1;return(0,i.wf)(t,e)}}_api(){return`${c._L.getVar("web_domain")}${u.b.APPLICATION_CREATE}`}}},329598:function(e,t,r){r.d(t,{v:function(){return l}});var i=r(690613),n=r(114861),o=r(405051),s=r(894339),a=r(121130),c=r(702049),u=r(102593);class l{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new o.yk().build(o.kk);return(0,n.V)(e),(0,s.mH)(e),(0,a.i3)(e),e}()),this._networkClientInstance}async getWorkspaceInfoExternal(e){try{var t,r;let n=await this._networkClient.post(this._api(),{file_id:e.packageKey,workspace_id:e.workspaceId,source_type:e.sourceType},{withCredentials:!0}),o=Number(null!==(t=n.ret)&&void 0!==t?t:0),s=null!==(r=n.errmsg)&&void 0!==r?r:"";if(0!==o)return(0,i.wf)(null!=o?o:-1,null!=s?s:"");return(0,i.oW)(n.data)}catch(e){return(0,i.wf)(-1,"get_workspace_info_external api error")}}_api(){return`${c._L.getVar("web_domain")}${u.b.GET_WORKSPACE_INFO_EXTERNAL}`}}},473065:function(e,t,r){r.d(t,{r:function(){return i}});let i=[{width:288,height:288},{width:360,height:360},{width:720,height:720},{width:1080,height:1080}]},855909:function(e,t,r){r.d(t,{Y:()=>R});var i=r("789786"),n=r("595751"),o=r("273340"),s=r("157021"),a=r("801003");class c extends s.d{buildCustomRequest(e){return{search_option:{cc_web_use_new_search:!0,...this._buildFilterParams(e)}}}get resourceType(){return o.g.Image}parseHeycanResponseDataToResources(e){return(0,a.Ar)(e)}_buildFilterParams(e){var t,r,i;let n={};return(null===(t=e.filters)||void 0===t?void 0:t.colors)&&(n.custom_colors=e.filters.colors.map(e=>({R:e[0],G:e[1],B:e[2]}))),(null===(r=e.filters)||void 0===r?void 0:r.aspectRatios)&&(n.custom_aspect_ratios=e.filters.aspectRatios),(null===(i=e.filters)||void 0===i?void 0:i.onlyCommercial)&&(n.filter_uncommercial=e.filters.onlyCommercial),n}}var u=r("861810"),l=r("55449"),d=r("402655"),_=r("966697"),h=r("473065"),p=r("733110");class g extends p.i{get resourceType(){return o.g.Image}parseHeycanResponseDataToResources(e){return(0,a.Ar)(e)}buildCustomRequest(e){var t;return{pack_optional:{large_image_formats:h.r,need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t,need_contract:!0,thumb_opt:'{"is_support_webp":1}'}}}constructor(e){super(e),this._capcutAccountService=e}}g=(0,i.gn)([(0,i.fM)(0,_.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===_.Gw?Object:_.Gw])],g);var v=r("323439"),f=r("958481"),m=r("861335"),y=r("84149"),w=r("9322"),k=r("207486"),b=r("409779"),S=r("927193");class R extends d.JT{getPhotos(e){return this._getPhotoRepository.getResources(e)}getBrandPhotos(e){return this._getBrandPhotosRepository.getResources(e)}getPhotosByCategory(e){return this._getPhotoByCategoryRepository.getResources(e)}batchGetPhotos(e){let{isFromBrand:t=!1}=e;return t?this._getBrandPhotosByIdsRepository.getResourcesByIds({ids:e.resourceIds}):this._batchGetPhotoRepository.batchGetResources(e)}batchGetTuchongPhotos(e){return this._batchGetTuchongPhotoRepository.batchGetResources(e)}searchPhoto(e){return this._searchPhotoRepository.searchResources(e)}searchTuchongPhoto(e){return this._searchTuchongPhotoRepository.searchResources(e)}getCollections(e){return this._collectionPhotoRepository.getCollections(e)}addToCollection(e){return this._collectionPhotoRepository.addToCollection(e)}removeFromCollection(e){return this._collectionPhotoRepository.removeFromCollection(e)}order(e){return this._orderRepository.order(e)}getCategories(e){return this._getPhotoCategoriesRepository.getCategories(e)}constructor(e={},t){super(),this.collectionParam=e,this._instantiationService=t,this._searchPhotoRepository=this._instantiationService.createInstance(c),this._collectionPhotoRepository=this._instantiationService.createInstance(new u.M(n.T,[e],!1)),this._getPhotoRepository=this._instantiationService.createInstance(g),this._getPhotoByCategoryRepository=this._instantiationService.createInstance(y.y),this._orderRepository=this._instantiationService.createInstance(v.x),this._batchGetPhotoRepository=this._instantiationService.createInstance(f.h),this._batchGetTuchongPhotoRepository=this._instantiationService.createInstance(k.p),this._getPhotoCategoriesRepository=this._instantiationService.createInstance(m.l),this._searchTuchongPhotoRepository=this._instantiationService.createInstance(w.Q),this._getBrandPhotosRepository=this._instantiationService.createInstance(b.Y),this._getBrandPhotosByIdsRepository=this._instantiationService.createInstance(S.G)}}R=(0,i.gn)([(0,i.fM)(1,l.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===l.T?Object:l.T])],R)},801003:function(e,t,r){r.d(t,{Ar:function(){return u},bO:function(){return c}});var i=r(889862),n=r(15290),o=r(127830),s=r(163210),a=r(570811);let c=e=>null==e?void 0:e.includes("//local_item");function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?function(e){let{common_attr:t}=e,r=(0,s.C)(t);return{...r,isDefault:e.IsDefault,userId:t.user_id,createTime:t.create_time,workspaceId:t.workspace_id,width:t.width,height:t.height,aspectRatio:(0,a.o)(t.width,t.height,1),transcode:[],format:"gif"===t.format?n.P.gif:n.P.jpeg,isFromBrand:!0,originUrl:r.originUrl||t.cover_url.static_img}}(e):function(e){var t,r,n,s,a;let u=c(e.scheme),l=(0,i.E)(e,u?o._g.PhotoDreamina:o._g.Photo),d=null===(t=e.image.large_images)||void 0===t?void 0:t.sort((e,t)=>e.width-t.width);return{...l,coverUrl:null!==(n=null==d?void 0:null===(r=d[0])||void 0===r?void 0:r.image_url)&&void 0!==n?n:l.coverUrl,aspectRatio:Number(null!==(s=l.aspectRatio)&&void 0!==s?s:(()=>{var t;let r=null===(t=e.image.large_images)||void 0===t?void 0:t[0];return r?r.width/r.height:1})())||1,author:(null==e?void 0:e.author)?{name:e.author.name,avatar:e.author.avatar_url,source:e.author.source,uid:e.author.uid}:void 0,format:e.image.format,transcode:null!==(a=null==d?void 0:d.map(e=>({width:e.width,height:e.height,url:e.image_url})))&&void 0!==a?a:[]}}(e)}},941693:function(e,t,r){r.d(t,{G:()=>d});var i=r("405051"),n=r("121130"),o=r("894339"),s=r("768101"),a=r("690613"),c=r("114861");let u={GET_POPUP_STATUS:"/lv/v1/intelligence/popup/status",CONFIRM_POPUP_STATUS:"/lv/v1/intelligence/popup/confirm"};var l=r("702049");class d{get _networkClient(){var e;return null!==(e=this._networkClientInstance)&&void 0!==e?e:this._networkClientInstance=function(){let e=new i.yk().build(i.kk);return(0,n.i3)(e),(0,o.mH)(e),(0,c.V)(e),e}()}_getApi(e){return`${l._L.getVar("web_domain")}${e}`}async getPopupStatus(e){try{let t=await this._networkClient.post(this._getApi(u.GET_POPUP_STATUS),e,{withCredentials:!0});if("0"!==t.ret)return(0,a.wf)(Number(t.ret),t.errmsg);return(0,a.oW)(t.data)}catch(e){return(0,s.m)(e,-1,"getPopupStatus api error.")}}async confirmPopup(e){try{let t=await this._networkClient.post(this._getApi(u.CONFIRM_POPUP_STATUS),e,{withCredentials:!0});if("0"!==t.ret)return(0,a.wf)(Number(t.ret),t.errmsg);return(0,a.oW)(t.data)}catch(e){return(0,s.m)(e,-1,"confirmPopup api error.")}}}},19623:function(e,t,r){r.d(t,{o:()=>y});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("690613"),a=r("114861"),c=r("702049"),u=r("405051"),l=r("121130"),d=r("894339"),_=r("768101"),h=r("328777"),p=r("374904");let g=e=>{let t=JSON.stringify((0,p.m3)());return{upload_asset:e.uploadIds.map(r=>{var i,n;return{upload_id:r,meta:null!==(n=null===(i=e.metaMap)||void 0===i?void 0:i[r])&&void 0!==n?n:t}}),workspace_id:e.workspaceId}},v=e=>({upload_asset:e.uploadIds.map(e=>({upload_id:e,meta:"{}"})),workspace_id:e.workspaceId});var f=r("717545");class m{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new u.yk().build(u.kk);return(0,l.i3)(e),(0,d.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}_getApi(e){return`${c._L.getVar("web_domain")}${e}`}async createScreenRecordAsset(e){try{var t,r;let i=await this._networkClient.post(this._getApi(h.b.CREATE_ASSET),g(e),{withCredentials:!0});if("0"!==i.ret)return(0,s.wf)(Number(i.ret),null!==(t=i.errmsg)&&void 0!==t?t:"");if(204200===i.data.code)return(0,s.wf)(i.data.code,null!==(r=i.errmsg)&&void 0!==r?r:"SpaceOverflowError");return(0,s.ly)()}catch(e){return(0,_.m)(e,-1,"createScreenRecordAsset api error")}}async getScreenRecordAsset(e){try{let r=await this._networkClient.post(this._getApi(h.b.GET_ASSET),v(e),{withCredentials:!0});if("0"!==r.ret){var t;return(0,s.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,s.oW)((0,f.t)(r))}catch(e){return(0,_.m)(e,-1,"getScreenRecordAsset api error")}}}class y extends o.JT{createScreenRecordAsset(e){return this._screenRecordRepository.createScreenRecordAsset(e)}getScreenRecordAsset(e){return this._screenRecordRepository.getScreenRecordAsset(e)}constructor(e){super(),this._instantiationService=e,this._screenRecordRepository=this._instantiationService.createInstance(m)}}y=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],y)},250841:function(e,t,r){r.d(t,{b:function(){return i}});let i={GET_CONTENT:"/lv/v1/common/get_content",SET_CONTENT:"/lv/v1/common/set_content"}},299675:function(e,t,r){r.d(t,{z:function(){return i}});let i=(0,r(335290).yh)("server-storage-data-service")},517300:function(e,t,r){r.d(t,{b:()=>v});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("232851"),a=r("114861"),c=r("690613"),u=r("702049"),l=r("405051"),d=r("121130"),_=r("894339"),h=r("768101"),p=r("250841");class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new l.yk().build(l.kk);return(0,d.i3)(e),(0,_.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}get _api(){return`${u._L.getVar("web_domain")}${p.b.SET_CONTENT}`}async setServerStorage(e){try{let r=await this._networkClient.post(this._api,{id:e.draftId,type:e.key,content:e.value},{withCredentials:!0});if("0"!==r.ret){var t;return(0,c.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,c.ly)()}catch(e){return(0,h.m)(e,-1,"setServerStorage api error")}}}class v extends o.JT{getServerStorage(e){return this._getServerStorageRepository.getServerStorage(e)}setServerStorage(e){return this._setServerStorageRepository.setServerStorage(e)}constructor(e){super(),this._instantiationService=e,this._getServerStorageRepository=this._instantiationService.createInstance(s.B),this._setServerStorageRepository=this._instantiationService.createInstance(g)}}v=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],v)},101887:function(e,t,r){r.d(t,{v:function(){return s}});var i=r(127830),n=r(412497),o=r(424736);class s extends n.r{get resourceType(){return i._g.ShapeAnimation}parseEffectsToResources(e){return e.map(e=>(0,o.j)(e))}}},424736:function(e,t,r){r.d(t,{j:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r}=(0,i.sh)(n._g.ShapeAnimation,e,t);return{...r}}},806752:function(e,t,r){r.d(t,{o:function(){return a}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429);function a(e){let t=(0,i.E)(e,n._g.ShapeAnimation);return{...t,key:`${n._g.ShapeAnimation}_${t.resourceId}`,name:t.title,icon:{uri:(0,o.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,o.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:s.f4}}},801953:function(e,t,r){r.d(t,{K:function(){return i}});let i=(0,r(335290).yh)("shape-data-service")},405650:function(e,t,r){r.d(t,{e:function(){return i}});let i=(0,r(335290).yh)("smart-color-adjust-data-service")},865214:function(e,t,r){r.d(t,{t:()=>b});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("692825"),a=r("773943"),c=r("806050"),u=r("127830");class l extends a.b{buildCustomRequest(e){return{enable_album:e.enableAlbum}}get resourceType(){return u._g.SmartColorAdjust}parseEffectsToResources(e,t){return e.map(e=>(0,c.V)(e,t))}}var d=r("273340"),_=r("788808"),h=r("789869"),p=r("33883");class g extends h.A{get resourceType(){return d.g.SmartColorAdjust}get resourcePanelType(){return p.q.SmartColorAdjust}parseHeycanResponseDataToResources(e){return(0,_.a)(e)}}var v=r("758027");class f extends v.B{get resourceType(){return u._g.SmartColorAdjust}get resourcePanelType(){return p.q.SmartColorAdjust}parseHeycanResponseDataToResources(e){return(0,_.a)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}var m=r("736031"),y=r("249656"),w=r("305301"),k=r("744268");class b extends o.JT{async getSmartColorAdjust(e){return await (0,m._Q)(this._configurationService,this._getHeycanSmartColorAdjustByCategoryRepository.resourcePanelType,m.$0)?this._getHeycanSmartColorAdjustByCategoryRepository.getResources(e):this._smartColorAdjustRepository.getResources(e)}async batchGetSmartColorAdjustsByIds(e){if(e.source===y.Hw.LOKI)return this._batchGetSmartColorAdjustRepository.batchGetResources(e);{let t=await (0,m.bY)(this._configurationService,m.$0);return"loki"===(0,m.lo)(t,this._batchGetHeycanSmartColorAdjustRepository.resourcePanelType).panel_path&&e.source!==y.Hw.HEYCAN?this._batchGetSmartColorAdjustRepository.batchGetResources(e):this._batchGetHeycanSmartColorAdjustRepository.batchGetResources((0,w.Q)(e.ids,this._batchGetHeycanSmartColorAdjustRepository.resourceType,e.source))}}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._smartColorAdjustRepository=this._instantiationService.createInstance(l),this._batchGetSmartColorAdjustRepository=this._instantiationService.createInstance(s.B),this._getHeycanSmartColorAdjustByCategoryRepository=this._instantiationService.createInstance(f),this._batchGetHeycanSmartColorAdjustRepository=this._instantiationService.createInstance(g)}}b=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,k.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===k.Ui?Object:k.Ui])],b)},788808:function(e,t,r){r.d(t,{a:function(){return c}});var i=r(889862),n=r(127830),o=r(981632),s=r(32372),a=r(134429);function c(e){let t=(0,i.E)(e,n._g.SmartColorAdjust),r=(0,o.D)(e.common_attr.extra);return{...t,key:`${n._g.SmartColorAdjust}_${t.resourceId}`,name:t.title,icon:{uri:(0,s.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,s.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:a.f4,maxValue:r.max_value,minValue:r.min_value,defaultValue:r.default_value}}},920704:function(e,t,r){r.d(t,{KC:function(){return u},hn:function(){return a},uP:function(){return c},y:function(){return l}});var i,n,o,s,a=((i={})[i.HeyCan=0]="HeyCan",i[i.Giphy=1]="Giphy",i[i.VideoArch=2]="VideoArch",i[i.EverPhoto=3]="EverPhoto",i[i.ImageX=4]="ImageX",i[i.UserBrand=6]="UserBrand",i);var c=((n={})[n.Video=0]="Video",n[n.Image=1]="Image",n[n.Audio=2]="Audio",n[n.Product=4]="Product",n[n.LvVideoMask=5]="LvVideoMask",n[n.LvVideoReverse=6]="LvVideoReverse",n[n.Template=9]="Template",n[n.ImageAsset=10]="ImageAsset",n[n.VideoAsset=11]="VideoAsset",n[n.AudioAsset=12]="AudioAsset",n[n.STSOriginAsset=31]="STSOriginAsset",n[n.STSAudio=32]="STSAudio",n[n.STSVideo=33]="STSVideo",n[n.STSSNR=34]="STSSNR",n);var u=((o={})[o.ToolPage=0]="ToolPage",o[o.Editor=1]="Editor",o[o.TemplateEditor=2]="TemplateEditor",o[o.VideoEditor=3]="VideoEditor",o[o.BatchEditor=4]="BatchEditor",o);var l=((s={})[s.Success=1]="Success",s[s.Process=0]="Process",s[s.Failure=-1]="Failure",s)},252789:function(e,t,r){r.d(t,{X:()=>g});var i=r("789786"),n=r("402655"),o=r("690613"),s=r("39735"),a=r("197238"),c=r("587892"),u=r("432814"),l=r("920704"),d=r("786022");class _ extends n.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}get taskParams(){return this._taskParams}async _getTaskProgress(){let e=await this._intelligentRepository.getIntelligentTask({platform:this._taskParams.platform,task_id:this._taskParams.taskId,workspace_id:this._taskParams.workspaceId,tmp_id:this._taskParams.tmpId,app_id:d.kJ,scene:this._taskParams.scene,region:this._taskParams.region,smart_tool_type:this._taskParams.smartToolType},this._taskParams.urlParams);if(e.ok){var t,r,i,n,s;this._getTaskProgressErrorCount=0;let{status:a}=e.value;a===u.v.Success||a===u.v.ProgressSuccess?100===e.value.speed&&(!this._taskParams.hasLogin||(null===(r=e.value.task_detail)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.md5))&&(this._taskParams.hasLogin||(null===(n=e.value.task_detail)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:i.resource_id))?(this._smartTaskStatus=l.y.Success,this._result={speed:e.value.speed,taskId:this.taskParams.taskId,taskDetails:e.value.task_detail.map(e=>this._convertDetail(e)),resourceId:e.value.task_detail[0].resource_id,resourceName:e.value.task_detail[0].resource_name,originWorkspaceId:e.value.origin_workspace_id,originSpaceId:e.value.origin_space_id,originResourceName:e.value.origin_resource_name},this._onSuccess.fire(this._result)):(this._smartTaskStatus=l.y.Process,this._onProgress.fire({progress:Math.min(99,e.value.speed),status:this._smartTaskStatus})):(this._smartTaskStatus=l.y.Failure,this._error=(0,o.wf)(u.v.Failure,"intelligent task failed",{...e.value,logId:null===(s=e.value._meta)||void 0===s?void 0:s.log_id}),this._onError.fire(this._error))}else this._getTaskProgressErrorCount++;(this._getTaskProgressErrorCount>=10||204402===e.code)&&(this._smartTaskStatus=l.y.Failure,this._error=(0,o.wf)(e.code,e.msg),this._onError.fire(this._error))}_convertDetail(e){var t,r,i,n,o,s;return{md5:e.md5,vid:e.resource_id,transcodeVideoInfos:null!==(n=null===(t=e.transcode_video_infos)||void 0===t?void 0:t.map(e=>({defination:e.defination,encryptId:e.encrypt_id,key:e.key,storeUri:e.store_uri,url:e.url})))&&void 0!==n?n:[],transcodeAudioInfos:null!==(o=null===(r=e.transcode_audio_info)||void 0===r?void 0:r.map(e=>({defination:e.defination,encryptId:e.encrypt_id,key:e.key,storeUri:e.store_uri,url:e.url})))&&void 0!==o?o:[],transcodePreviewInfos:e.transcodePreviewInfos,thumbInfo:e.thumbInfo,resource_name:e.resource_name,transcodeImageInfos:null!==(s=null===(i=e.transcode_image_infos)||void 0===i?void 0:i.map(e=>({defination:e.defination,encryptId:e.encrypt_id,key:e.key,storeUri:e.store_uri,url:e.url})))&&void 0!==s?s:[],taskId:e.task_id,title:e.title,draftInfo:e.draft_info,previewInfo:e.preview_info,width:e.width,height:e.height,video:e.video,resourceId:e.resource_id}}async _startPollingProgress(){if(await this._getTaskProgress(),Date.now()-this._startTime>this._timeout){this._smartTaskStatus=l.y.Failure,this._error=(0,a.hO)(),this._onError.fire(this._error);return}if(this._smartTaskStatus===l.y.Process&&!this._canceled){var e;setTimeout(()=>{this._startPollingProgress()},null!==(e=this._taskParams.pollingInterval)&&void 0!==e?e:500)}}cancel(){if(!this._canceled)this._canceled=!0,this._onCancel.fire()}constructor(e,t,r){super(),this._timeout=e,this._intelligentRepository=t,this._taskParams=r,this._onProgress=this._store.add(new c.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new c.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new c.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new c.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=l.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,o.ly)(),this._canceled=!1,this._startTime=0,this._startTime=Date.now(),this._startPollingProgress()}}var h=r("966697");function p(e){return 16===e?6e4:3e5}class g extends n.JT{async createIntelligentTask(e){let t=await this._intelligentRepository.createIntelligentTask({uid:this._capcutAccountService.uniqueId,platform:e.platform,asset_id:e.assetId,workspace_id:e.workspaceId,tmp_id:e.tmpId,smart_tool_type:e.smartToolType,req_json:e.reqJson,is_from_editor:!0,params:e.params,region:this._capcutAccountService.userProfile.region},e.urlParams);return t.ok?(0,o.oW)(new _(p(e.smartToolType),this._intelligentRepository,{...e,taskId:t.value.data.task_id,region:this._capcutAccountService.userProfile.region,scene:e.scene,hasLogin:this._capcutAccountService.hasLogin})):t}createIntelligentTaskQueryTask(e){return new _(p(e.smartToolType),this._intelligentRepository,{...e})}constructor(e){super(),this._capcutAccountService=e,this._intelligentRepository=new s.c,this._intelligentRepositoryWithoutRetry=new s.c(!0)}}g=(0,i.gn)([(0,i.fM)(0,h.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===h.Gw?Object:h.Gw])],g)},243623:function(e,t,r){r.d(t,{W:function(){return _}});var i=r(702049),n=r(405051),o=r(121130),s=r(894339),a=r(786022),c=r(768101),u=r(690613),l=r(114861),d=r(50597);class _{get _createTaskApi(){return`${i._L.getVar("web_domain")}${d.b.CREATE_MATTING_TASK}`}get _getTaskDetailApi(){return`${i._L.getVar("web_domain")}${d.b.GET_MATTING_TASK_DETAIL}`}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new n.yk().build({headers:{"Content-Type":"application/json"}});return(0,o.i3)(e),(0,s.mH)(e),(0,l.V)(e),e}()),this._networkClientInstance}async createVideoMattingTask(e){try{let t=await this._networkClient.post(this._createTaskApi,{...e,app_id:a.kJ},{withCredentials:!0});if("0"!==t.ret)return(0,u.wf)(Number(t.ret),t.errmsg);return(0,u.ly)()}catch(e){return(0,c.m)(e,-1,"createMattingTask api error.")}}async getVideoMattingTask(e){try{let t=await this._networkClient.post(this._getTaskDetailApi,e,{withCredentials:!0});if("0"!==t.ret)return(0,u.wf)(Number(t.ret),t.errmsg);return(0,u.oW)(t.data)}catch(e){return(0,c.m)(e,-1,"getMattingTaskDetail api error.")}}async mattingGraphic(e){try{let t=await this._networkClient.post(this._createTaskApi,{...e,file_type:1},{withCredentials:!0});if("0"!==t.ret)return(0,u.wf)(Number(t.ret),t.errmsg);return(0,u.oW)(t.data)}catch(e){return(0,c.m)(e,-1,"createMattingTask api error.")}}}},991339:function(e,t,r){r.d(t,{$:function(){return a}});var i=r(690613),n=r(587892),o=r(402655),s=r(920704);class a extends o.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}cancel(){if(!this._canceled)this._canceled=!0,this._onCancel.fire()}constructor(e){super(),this._result=e,this._onProgress=this._store.add(new n.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new n.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new n.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new n.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=s.y.Success,this._error=(0,i.ly)(),this._canceled=!1,setTimeout(()=>{this._onSuccess.fire(this._result)},0)}}},214291:function(e,t,r){r.d(t,{Bf:function(){return s},DN:function(){return a},iM:function(){return u},su:function(){return c}});var i,n,o=r(335290);let s=37;var a=((i={})[i.Add=0]="Add",i[i.Update=1]="Update",i);var c=((n={})[n.Face=1]="Face",n[n.Body=2]="Body",n[n.LeftHand=3]="LeftHand",n[n.RightHand=4]="RightHand",n);let u=(0,o.yh)("object-lock-data-service")},437201:function(e,t,r){r.d(t,{K:()=>y});var i=r("789786"),n=r("966697"),o=r("690613"),s=r("114861"),a=r("223822"),c=r("702049"),u=r("405051"),l=r("121130"),d=r("894339"),_=r("191449"),h=r("768101"),p=r("786022"),g=r("214291");class v{async createObjectLockTask(e){try{let{ret:t,errmsg:r,data:i}=await this._networkClient.post(this._createTaskApi,this._convertCreateRequestParams(e),{withCredentials:!0});if("0"!==t)return(0,o.wf)(Number(t),r);return(0,o.oW)((0,_.b)(i))}catch(e){return(0,h.m)(e,-1,"create object lock task api error")}}async getObjectLockTaskDetail(e){try{let{ret:t,errmsg:r,data:i}=await this._networkClient.post(this._getTaskDetailApi,this._convertGetRequestParams(e),{withCredentials:!0});if("0"!==t)return(0,o.wf)(Number(t),r);return(0,o.oW)((0,_.b)(i))}catch(e){return(0,h.m)(e,-1,"get object lock task detail api error")}}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new u.yk().build({headers:{"Content-Type":"application/json"}});return(0,l.i3)(e),(0,d.mH)(e),(0,s.V)(e),e}()),this._networkClientInstance}_convertCreateRequestParams(e){return{...(0,_.X)(e),app_id:p.kJ,smart_tool_type:g.Bf}}_convertGetRequestParams(e){return{...(0,_.X)(e),smart_tool_type:g.Bf}}get _createTaskApi(){return`${c._L.getVar("web_domain")}${a.b.CREATE_OBJECT_LOCK_TASK}`}get _getTaskDetailApi(){return`${c._L.getVar("web_domain")}${a.b.GET_OBJECT_LOCK_TASK_DETAIL}`}}var f=r("402655"),m=r("576745");class y extends f.JT{async createObjectLockTask(e){let t=await this._objectLockRepository.createObjectLockTask(e);return t.ok?(0,o.oW)(new m.X(this._objectLockRepository,{taskId:t.value.taskId})):t}constructor(e){super(),this._capcutAccountService=e,this._objectLockRepository=new v}}y=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],y)},457004:function(e,t,r){r.d(t,{b:function(){return i}});let i={CREATE_PIPELINE_TASK:"/lv/v1/intelligence/pipeline_create",GET_PIPELINE_TASK_DETAIL:"/lv/v1/intelligence/pipeline_query",GET_PIPELINE_ORIGIN_TASK_DETAIL:"/lv/v1/intelligence/pipeline_query_origin"}},392138:function(e,t,r){r.d(t,{B:function(){return c}});var i=r(690613),n=r(587892),o=r(402655),s=r(920704),a=r(126729);class c extends o.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}async _getTaskProgress(){let e=await this._pipelineRepository.getPipelineTask(this._taskParams);if(e.ok){this._getTaskProgressErrorCount=0;let{pipeline_status:t,pipeline_detail:r,process:n,pipeline_id:o}=e.value;t===a.nI.Processing?(this._smartTaskStatus=s.y.Process,this._onProgress.fire({...r.find(e=>e.node_status===a.nI.Processing),progress:n,status:this._smartTaskStatus,successMidResult:r.filter(e=>e.node_status===a.nI.Success),pipelineId:o})):t===a.nI.Success?(this._smartTaskStatus=s.y.Success,this._result=e.value,this._onSuccess.fire(e.value)):(this._smartTaskStatus=s.y.Failure,this._error=(0,i.wf)(a.nI.Failed,"pipeline task failed"),this._onError.fire(this._error))}else this._getTaskProgressErrorCount++;this._getTaskProgressErrorCount>=10&&(this._smartTaskStatus=s.y.Failure,this._error=(0,i.wf)(e.code,e.msg),this._onError.fire(this._error))}async _startPollingProgress(){await this._getTaskProgress(),this._smartTaskStatus===s.y.Process&&!this._canceled&&setTimeout(()=>{this._startPollingProgress()},500)}cancel(){if(!this._canceled)this._canceled=!0,this._onCancel.fire()}constructor(e,t){super(),this._pipelineRepository=e,this._taskParams=t,this._onProgress=this._store.add(new n.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new n.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new n.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new n.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=s.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,i.ly)(),this._canceled=!1,this._startPollingProgress()}}},126729:function(e,t,r){r.d(t,{F2:function(){return o},FL:function(){return s},nI:function(){return a}});var i,n,o=((i={})[i.PictureIntelligentToning=7]="PictureIntelligentToning",i[i.VideoSlowMotion=12]="VideoSlowMotion",i[i.VideoStabilization=13]="VideoStabilization",i[i.TemplateCVTask=16]="TemplateCVTask",i[i.VideoMaskTask=17]="VideoMaskTask",i[i.VideoReverseTask=18]="VideoReverseTask",i[i.VideoIntelligentToning=19]="VideoIntelligentToning",i[i.ImageMaskTask=20]="ImageMaskTask",i[i.VideoCut=26]="VideoCut",i[i.VideoNoiseReduction=27]="VideoNoiseReduction",i[i.ImageNoiseReduction=28]="ImageNoiseReduction",i[i.Deflicker=29]="Deflicker",i);let s={7:"image_color_correction",12:"video_slow_motion",13:"video_stabilization",17:"video_mask",18:"video_reverse",19:"video_color_correction",20:"image_mask"};var a=((n={})[n.Processing=1]="Processing",n[n.Success=2]="Success",n[n.Failed=3]="Failed",n[n.NotFound=4]="NotFound",n[n.NotStart=5]="NotStart",n)},846738:function(e,t,r){r.d(t,{r:()=>w});var i=r("402655"),n=r("690613"),o=r("702049"),s=r("405051"),a=r("121130"),c=r("894339"),u=r("768101"),l=r("800788"),d=r("114861"),_=r("538379"),h=r("813072"),p=r("928623");class g{get _apiCheck(){return`${o._L.getVar("web_domain")}${_.b.SMART_CROP_CHECK}`}get _apiSubject(){return`${o._L.getVar("web_domain")}${_.b.SMART_CROP_SUBJECT}`}get _apiCreate(){return`${o._L.getVar("web_domain")}${_.b.SMART_CROP_CREATE}`}get _apiQuery(){return`${o._L.getVar("web_domain")}${_.b.SMART_CROP_QUERY}`}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build({headers:{"Content-Type":"application/json"},withCredentials:!0});return(0,a.i3)(e),(0,c.mH)(e),(0,d.V)(e),e}()),this._networkClientInstance}async checkSmartCropDisable(){try{let e=await this._networkClient.post(this._apiCheck,void 0,{withCredentials:!0});if("0"!==e.ret)return(0,n.wf)(Number(e.ret),e.errmsg);return(0,n.oW)(e.data)}catch(e){return(0,u.m)(e,-1,"smart crop check api error.")}}async getSmartCropSubject(e){(0,l.Y2)((0,h.Z)(e,(0,p.Z)(e,["current_frame_time","mask_color","current_frame_base64"])));let t=`${e.current_frame_time};${e.mask_color.join(",")};${e.current_frame_base64}`,r=e=>{this._subjectCacheMap.set(t,{data:e,maxAge:Date.now()+216e5})};try{let i=this._networkClient.post(this._apiSubject,e,{withCredentials:!0}).then(e=>("0"===e.ret&&r(e.data),e)),o=this._subjectCacheMap.get(t);if(o&&Date.now()<=o.maxAge)return(0,n.oW)(o.data);let s=await i;if("0"!==s.ret)return(0,n.wf)(Number(s.ret),s.errmsg);return(0,n.oW)(s.data)}catch(e){return(0,u.m)(e,-1,"smart crop subject api error.")}}async createSmartCropTask(e){try{let t=await this._networkClient.post(this._apiCreate,e,{withCredentials:!0});if("0"!==t.ret)return(0,n.wf)(Number(t.ret),t.errmsg);return(0,n.oW)(t.data)}catch(e){return(0,u.m)(e,-1,"smart crop create task api error.")}}async querySmartCropTask(e){try{let t=await this._networkClient.post(this._apiQuery,e,{withCredentials:!0});if("0"!==t.ret)return(0,n.wf)(Number(t.ret),t.errmsg);return(0,n.oW)({...t.data})}catch(e){return(0,u.m)(e,-1,"smart crop query task api error.")}}constructor(){this._subjectCacheMap=new Map}}var v=r("587892"),f=r("920704"),m=r("987527");class y extends i.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}cancel(){!this._canceled&&(this._canceled=!0,this._onCancel.fire())}async _getTaskProgress(){let e=await this._smartCropRepository.querySmartCropTask(this._taskParams);if(e.ok){this._getTaskProgressErrorCount=0;let{status:t,progress:r}=e.value;t===m.D.Success?(this._smartTaskStatus=f.y.Success,this._result=e.value,this._onSuccess.fire(e.value)):t===m.D.Failed?(this._smartTaskStatus=f.y.Failure,this._error=(0,n.wf)(m.D.Failed,"smart crop task failed"),this._onError.fire(this._error)):(this._smartTaskStatus=f.y.Process,this._onProgress.fire({progress:r,status:this._smartTaskStatus}))}else this._getTaskProgressErrorCount++;this._getTaskProgressErrorCount>=10&&(this._smartTaskStatus=f.y.Failure,this._error=(0,n.wf)(e.code,e.msg),this._onError.fire(this._error))}async _startPollingProgress(){await this._getTaskProgress(),this._smartTaskStatus===f.y.Process&&setTimeout(()=>{this._startPollingProgress()},500)}constructor(e,t){super(),this._smartCropRepository=e,this._taskParams=t,this._onProgress=this._store.add(new v.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new v.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new v.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new v.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=f.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,n.ly)(),this._canceled=!1,this._startPollingProgress()}}class w extends i.JT{async checkSmartCropDisable(){let e=await this._smartCropRepository.checkSmartCropDisable();return e.ok?(0,n.oW)(e.value.need_check):e}async getSmartCropSubject(e){let t=await this._smartCropRepository.getSmartCropSubject({current_frame_base64:e.currentFrameBase64,current_frame_time:e.currentFrameTime,mask_color:e.maskColor});return t.ok?(0,n.oW)({currentFrameTime:t.value.current_frame_time,subjectList:t.value.subject_list.map(e=>({mask:e.mask,boxList:e.box_list}))}):t}async createSmartCropTask(e){let t=await this._smartCropRepository.createSmartCropTask(this._buildRequestConfig(e));return t.ok?(0,n.oW)(new y(this._smartCropRepository,{task_id:t.value.task_id})):t}_buildRequestConfig(e){return{asset_id:e.assetId,platform:e.platform,workspace_id:e.workspaceId,asset_workspace_id:e.assetWorkspaceId,key_frame_fps:e.keyFrameFps,stable_weight:e.stableWeight,user_box:e.userBox,current_frame_time:e.currentFrameTime,total_time:null==e?void 0:e.totalTime,mask_list:e.maskList}}constructor(){super(),this._smartCropRepository=new g}}},245667:function(e,t,r){r.d(t,{o:function(){return u}});var i=r(690613),n=r(197238),o=r(587892),s=r(402655),a=r(920704),c=r(741827);class u extends s.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}async _getTaskProgress(){let e=await this._smartSplitRepository.getSmartSplitTask({platform:this._taskParams.platform,asset_id:this._taskParams.assetId,workspace_id:this._taskParams.workspaceId,tmp_id:this._taskParams.tmpId});if(e.ok){this._getTaskProgressErrorCount=0;let{status:r}=e.value;if(r===c.k.Process)this._smartTaskStatus=a.y.Process,this._onProgress.fire({progress:e.value.progress,status:this._smartTaskStatus});else if(r===c.k.Success){var t;this._smartTaskStatus=a.y.Success,this._result=null!==(t=e.value.original_result)&&void 0!==t?t:{},this._onSuccess.fire(this._result)}else this._smartTaskStatus=a.y.Failure,this._error=(0,i.wf)(c.k.Failure,"smart split task failed"),this._onError.fire(this._error)}else this._getTaskProgressErrorCount++;this._getTaskProgressErrorCount>=3&&(this._smartTaskStatus=a.y.Failure,this._error=(0,i.wf)(e.code,e.msg),this._onError.fire(this._error))}async _startPollingProgress(){if(await this._getTaskProgress(),Date.now()-this._startTime>this._timeout){this._smartTaskStatus=a.y.Failure,this._error=(0,n.hO)(),this._onError.fire(this._error);return}this._smartTaskStatus===a.y.Process&&setTimeout(()=>{this._startPollingProgress()},500)}cancel(){if(!this._canceled)this._canceled=!0,this._onCancel.fire()}constructor(e,t,r){super(),this._timeout=e,this._smartSplitRepository=t,this._taskParams=r,this._onProgress=this._store.add(new o.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new o.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new o.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new o.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=a.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,i.ly)(),this._canceled=!1,this._startTime=0,this._startTime=Date.now(),this._startPollingProgress()}}},317550:function(e,t,r){r.d(t,{_:function(){return i}});let i=(0,r(335290).yh)("sync-data-service")},936864:function(e,t,r){r.d(t,{o:()=>d});var i,n=r("690613"),o=r("587892"),s=r("402655"),a=r("674280"),c=r("800788");var u=((i={})[i.Process=1]="Process",i[i.Success=2]="Success",i[i.Failure=3]="Failure",i),l=r("920704");class d extends s.JT{get error(){return this._error}get status(){return this._smartTaskStatus}async _getTaskProgress(){let e=await this._syncRepository.getSyncTask({resource_id:this._taskParams.resourceId,resource_type:this._taskParams.resourceType,tmp_id:this._taskParams.tmpId,region:this._taskParams.region,scene:2,workspace_id:this._taskParams.workspaceId,is_gameplay:this._taskParams.isGameplay});if(e.ok){this._getTaskProgressErrorCount=0;let{status:r}=e.value;if(r===u.Process)this._smartTaskStatus=l.y.Process,this._onProgress.fire({status:this._smartTaskStatus,progress:0});else if(r===u.Failure)this._smartTaskStatus=l.y.Failure,this._error=(0,n.wf)(u.Failure,"sync task failed"),this._onError.fire(this._error);else if(r===u.Success){var t;this._smartTaskStatus=l.y.Success,this._result={md5:null!==(t=e.value.md5)&&void 0!==t?t:""},this._onSuccess.fire(this._result)}}else this._getTaskProgressErrorCount++;this._getTaskProgressErrorCount>=10&&(this._smartTaskStatus=l.y.Failure,this._error=(0,n.wf)(e.code,e.msg),this._onError.fire(this._error))}async _startPollingProgress(){if(this._taskParams.md5.length>0){this._fireSuccessWhenCreateHasMd5();return}await this._getTaskProgress(),this._smartTaskStatus===l.y.Process&&!this._canceled&&setTimeout(()=>{this._startPollingProgress()},500)}_fireSuccessWhenCreateHasMd5(){(0,c.Y2)(this._taskParams.md5.length>0),(0,a.R)(()=>{this._smartTaskStatus=l.y.Success,this._result={md5:this._taskParams.md5},this._onSuccess.fire(this._result)})}cancel(){if(!this._canceled)this._canceled=!0,this._onCancel.fire()}constructor(e,t){super(),this._syncRepository=e,this._taskParams=t,this._onProgress=this._store.add(new o.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new o.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new o.Q),this.onSuccess=this._onSuccess.event,this._onCancel=this._store.add(new o.Q),this.onCancel=this._onCancel.event,this._smartTaskStatus=l.y.Process,this._getTaskProgressErrorCount=0,this._error=(0,n.ly)(),this._canceled=!1,this._startPollingProgress()}}},548636:function(e,t,r){r.d(t,{d:function(){return i}});let i=(0,r(335290).yh)("video-tracking-data-service")},258849:function(e,t,r){r.d(t,{J:function(){return c}});var i=r(587892),n=r(402655),o=r(690613),s=r(138886),a=r(920704);class c extends n.JT{get error(){return this._error}get status(){return this._smartTaskStatus}get value(){return this._result}async _getTaskProgress(){let e=await this._videoTrackingRepository.getVideoTrackingTask(this._taskParams);e.ok?(this._getTaskProgressErrorCount=0,function(e){let{status:t}=e;return t!==s.M.Failure&&(t===s.M.Process||!1)}(e.value)?(this._smartTaskStatus=a.y.Process,this._onProgress.fire({progress:e.value.speed,status:this._smartTaskStatus})):function(e){let{status:t}=e;return t!==s.M.Failure&&t===s.M.Success&&!0}(e.value)?(this._smartTaskStatus=a.y.Success,this._onSuccess.fire(e.value)):(this._smartTaskStatus=a.y.Failure,this._error=(0,o.wf)(s.M.Failure,"video tracking task failed"),this._onError.fire(this._error))):this._getTaskProgressErrorCount++,this._getTaskProgressErrorCount>=10&&(this._smartTaskStatus=a.y.Failure,this._error=(0,o.wf)(e.code,e.msg),this._onError.fire(this._error))}async _startPollingProgress(){await this._getTaskProgress(),this._smartTaskStatus===a.y.Process&&!this._canceled&&(this._pollProgressTimer=setTimeout(()=>{this._startPollingProgress()},500))}cancel(){this._onCancel.fire(),this._canceled=!0,this._pollProgressTimer&&clearTimeout(this._pollProgressTimer)}constructor(e,t){super(),this._videoTrackingRepository=e,this._taskParams=t,this._onProgress=this._store.add(new i.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new i.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new i.Q),this.onSuccess=this._onSuccess.event,this._smartTaskStatus=a.y.Process,this._getTaskProgressErrorCount=0,this._pollProgressTimer=null,this._canceled=!1,this._error=(0,o.ly)(),this._onCancel=this._store.add(new i.Q),this.onCancel=this._onCancel.event,this._startPollingProgress()}}},520313:function(e,t,r){r.d(t,{J9:function(){return s},Rk:function(){return o},TW:function(){return a}});var i,n=r(335290);var o=((i={})[i.NULL=0]="NULL",i[i.ONE_QUARTER=25]="ONE_QUARTER",i[i.HALF=50]="HALF",i[i.THREE_QUARTERS=75]="THREE_QUARTERS",i[i.FULL=100]="FULL",i);let s=36,a=(0,n.yh)("vocal-beautify-data-service")},545797:function(e,t,r){r.d(t,{Tz:function(){return s},gx:function(){return o},ty:function(){return a}});var i,n=r(335290);var o=((i={}).NONE="none",i.HUMAN="human",i.BACKGROUND="background",i);let s=33,a=(0,n.yh)("vocal-separation-data-service")},887186:function(e,t,r){r.d(t,{c:function(){return a}});var i=r(789786),n=r(402655),o=r(545797),s=r(745860);class a extends n.JT{createVocalSeparationTask(e,t){var r;let{platform:i,assetId:n,tmpId:s,mode:a,timeRange:c=[]}=e,[u,l]=c,d=void 0!==u&&void 0!==l?{start_time:String(u),end_time:String(l)}:void 0,_=d?JSON.stringify({audio_trim_params:d}):void 0;return this._intelligentDataService.createIntelligentTask({platform:i,assetId:n,workspaceId:null!==(r=e.workspaceId)&&void 0!==r?r:"",tmpId:s,smartToolType:o.Tz,reqJson:_,urlParams:t,params:JSON.stringify({model:a})})}constructor(e){super(),this._intelligentDataService=e}}a=(0,i.gn)([(0,i.fM)(0,s.p),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===s.p?Object:s.p])],a)},70586:function(e,t,r){r.d(t,{b:function(){return i}});let i={GET_COMBINATION_SEGMENT_SPRITE:"/lv/v1/draft/complex_segment/frame_Info",GET_MUTABLE_SEGMENT_SPRITE:"/lv/v1/draft/mutable_segment/frame_Info"}},977794:function(e,t,r){r.d(t,{E:function(){return i}});let i={interval:"interval",last_segment_info:"lastSegmentSprites",status:"status",complex_frames:"latestSegmentSprites",common_info:"common",detail_infos:"details",single_frame_height:"singleFrameHeight",single_frame_width:"singleFrameWidth",total_set_num:"total",frame_count:"total",image_height:"imageHeight",image_width:"imageWidth",mime_type:"mimeType",change_list:"changes"}},31665:function(e,t,r){r.d(t,{o:()=>b});var i=r("789786"),n=r("492197"),o=r("483932"),s=r("292180"),a=r("799882"),c=r("702049"),u=r("405051"),l=r("999432"),d=r("121130"),_=r("894339"),h=r("768101"),p=r("786022"),g=r("690613"),v=r("114861"),f=r("966697"),m=r("70586");let y={interval:"interval",last_segment_info:"lastSegmentSprites",mutable_videos:"latestSegmentSprites",common_info:"common",detail_infos:"details",single_frame_height:"singleFrameHeight",single_frame_width:"singleFrameWidth",total_set_num:"total",frame_count:"total",image_height:"imageHeight",image_width:"imageWidth",mime_type:"mimeType",change_list:"changes"};var w=r("134429");let k={businessHeader:{loc:"sg",appSDKVesion:w.Mr,lan:"en",pf:"7",appVersion:w.$U,tdid:"web",signVer:1},draftVersion:w.Mr};class b{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new u.yk().build(u.kk);return(0,l.V)(e,k.businessHeader),(0,d.i3)(e),(0,v.V)(e),(0,_.mH)(e),e}()),this._networkClientInstance}async getMutablePolySegmentSprite(e){try{var t,r;let i=await this._networkClient.post(this._api(),this._buildRequest(e),{withCredentials:!0}),n=Number(null!==(t=i.ret)&&void 0!==t?t:0),o=null!==(r=i.errmsg)&&void 0!==r?r:"";if(0!==n)return(0,g.wf)(null!=n?n:-1,null!=o?o:"");return(0,g.oW)(this._formatDataFromServer(i.data))}catch(e){return(0,h.m)(e,-1,"getShape api error")}}_buildRequest(e){let t=(0,n.Z)(e,(0,o.Z)(s.Z,1));return{support_webp:!0,app_id:p.kJ,region:this._accountService.userProfile.region,...t}}_formatDataFromServer(e){return(0,n.Z)(e,(t,r)=>{let i=r in y?y[r]:r;return Array.isArray(t)?e[i]=t.map(this._formatDataFromServer):(0,a.Z)(t)&&(e[i]=this._formatDataFromServer(t)),i})}_api(){return`${c._L.getVar("web_domain")}${m.b.GET_MUTABLE_SEGMENT_SPRITE}`}constructor(e){this._accountService=e}}b=(0,i.gn)([(0,i.fM)(0,f.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===f.Gw?Object:f.Gw])],b)},593853:function(e,t,r){r.d(t,{D:function(){return i}});let i=(0,r(335290).yh)("sprite-data-service")},927221:function(e,t,r){r.d(t,{i:function(){return i}});let i=(0,r(335290).yh)("sticker-motion-data-service")},613447:function(e,t,r){r.d(t,{q:()=>C});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("237104"),a=r("773943"),c=r("309118"),u=r("127830");class l extends a.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return u._g.StickerMotion}parseEffectsToResources(e,t){return e.map(e=>(0,c.y)(e,t))}}var d=r("232148"),_=r("273340"),h=r("680978"),p=r("789869"),g=r("33883");class v extends p.A{get resourceType(){return _.g.TextAnimation}get resourcePanelType(){return g.q.StickerMotion}parseHeycanResponseDataToResources(e){return(0,h.R)(e)}}var f=r("758027");class m extends f.B{get resourceType(){return u._g.StickerMotion}get resourcePanelType(){return g.q.StickerMotion}parseHeycanResponseDataToResources(e){return(0,h.R)(e)}buildCustomRequest(e){return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_key:e.category,pack_optional:{image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}}var y=r("872443");class w extends y.L{get resourceType(){return u._g.StickerMotion}get resourcePanelType(){return g.q.StickerMotion}parseHeycanResponseDataToResources(e){return(0,h.R)(e)}buildCustomRequest(e){return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}}var k=r("744268"),b=r("736031"),S=r("249656"),R=r("305301");class C extends o.JT{async getStickerMotion(e){return await (0,b._Q)(this._configurationService,this._getHeycanStickerMotionByCategoryRepository.resourcePanelType,b.Jk)?this._getHeycanStickerMotionByCategoryRepository.getResources(e):this._motionRepository.getResources(e)}async batchGetStickerMotionsByIds(e){if(e.source===S.Hw.HEYCAN){let t=await (0,b.bY)(this._configurationService,b.Jk);return"loki"===(0,b.lo)(t,this._batchGetHeycanStickerMotionRepository.resourcePanelType).panel_path&&e.source!==S.Hw.HEYCAN?this._batchGetStickerMotionRepository.batchGetResources(e):this._batchGetHeycanStickerMotionRepository.batchGetResources((0,R.Q)(e.ids,this._batchGetHeycanStickerMotionRepository.resourceType,e.source))}return this._batchGetStickerMotionRepository.batchGetResources(e)}async getStickerMotionCategories(e){let t=await (0,b.bY)(this._configurationService,b.Jk);return"vimo"===(0,b.lo)(t,this._getHeycanStickerMotionCategoriesRepository.resourcePanelType).panel_path?this._getHeycanStickerMotionCategoriesRepository.getCategories((0,b.lY)(e,t)):this._getStickerMotionCategoriesRepository.getCategories(e)}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._motionRepository=this._instantiationService.createInstance(l),this._batchGetStickerMotionRepository=this._instantiationService.createInstance(s.x),this._getStickerMotionCategoriesRepository=this._instantiationService.createInstance(d.O),this._getHeycanStickerMotionByCategoryRepository=this._instantiationService.createInstance(m),this._getHeycanStickerMotionCategoriesRepository=this._instantiationService.createInstance(w),this._batchGetHeycanStickerMotionRepository=this._instantiationService.createInstance(v)}}C=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,k.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===k.Ui?Object:k.Ui])],C)},309118:function(e,t,r){r.d(t,{y:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){var r;let{common:o,extra:s}=(0,i.sh)(n._g.StickerMotion,e,t);return{...o,isKtv:"true"===s.is_ktv,ktvColor:null!==(r=s.ktv_color)&&void 0!==r?r:""}}},680978:function(e,t,r){r.d(t,{R:function(){return c}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429),a=r(981632);function c(e){var t;let r=(0,i.E)(e,n._g.StickerMotion),c=(0,a.D)(e.common_attr.extra);return{...r,key:`${n._g.StickerMotion}_${r.resourceId}`,name:r.title,icon:{uri:(0,o.s)(r.coverUrl),urlList:[r.coverUrl]},previewUrl:r.coverUrl,package:{uri:(0,o.s)(r.originUrl),urlList:[r.originUrl]},sdkVersion:s.f4,isKtv:"true"===c.is_ktv,ktvColor:null!==(t=c.ktv_color)&&void 0!==t?t:""}}},868870:function(e,t,r){r.d(t,{q:function(){return n}});var i,n=((i={}).SINGLE="panel-stickers",i.ALBUM="panel-albums",i)},784275:function(e,t,r){r.d(t,{Z:function(){return s}});var i=r(127830),n=r(412497),o=r(482707);class s extends n.r{get resourceType(){return i._g.Sticker}parseEffectsToResources(e){return e.map(e=>(0,o.jh)(e))}}},976995:function(e,t,r){r.d(t,{E:function(){return c}});var i=r(789786),n=r(966697),o=r(256718),s=r(378351),a=r(273340);class c extends o.k{get resourceType(){return a.g.Sticker}parseHeycanResponseDataToResources(e){return(0,s.U)(e)}buildCustomRequest(){return{pack_optional:{need_thumb:!0,thumb_opt:'{"is_support_webp":1}'}}}constructor(e={},t){super(e,t)}}c=(0,i.gn)([(0,i.fM)(1,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===n.Gw?Object:n.Gw])],c)},577337:function(e,t,r){r.d(t,{y:function(){return o}});var i=r(740446),n=r(482707);class o extends i.i{parseResponseDataToResources(e){return(0,n.jh)(e,void 0,!0)}}},773258:function(e,t,r){r.d(t,{Q:function(){return s}});var i=r(773943),n=r(482707),o=r(127830);class s extends i.b{buildCustomRequest(e){return{only_commercial:e.onlyCommercial,category:e.category,enter_from:e.enterFrom}}get resourceType(){return o._g.Sticker}parseEffectsToResources(e,t){return e.map(e=>(0,n.jh)(e,t))}}},455500:function(e,t,r){r.d(t,{B:()=>k});var i=r("789786"),n=r("966697"),o=r("629351"),s=r("702049"),a=r("405051"),c=r("121130"),u=r("866006"),l=r("768101"),d=r("690613"),_=r("114861"),h=r("243254"),p=r("801497"),g=r("744268"),v=r("396190"),f=r("134429");class m{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(e){let t=new a.yk().build(a.kk);return(0,c.i3)(t),(0,_.V)(t),(0,o.V)(t,{appVersion:e.appVersion}),t}({appVersion:this._environmentService.appVersion})),this._networkClientInstance}async getRecentResources(e){let t=e instanceof u.yt?e.config:e;try{let r=await this._networkClient.post(this._getRecentResourcesApi,this.convertGetRecentResourcesToRequest(e),{withCredentials:!0}),i=r.ret,n=r.errmsg;if("0"!==i)return(0,d.wf)(Number(null!=i?i:-1),null!=n?n:"");let o=this._convertGetResourcesByCategoryToQueryToken(t,r);return(0,d.oW)(o)}catch(e){return(0,l.m)(e,-1,"getResourcesByCategory api error")}}async addRecentResource(e){try{let t=await this._networkClient.post(this._addRecentResourceApi,this.convertAddRecentResourceToRequest(e),{withCredentials:!0}),r=t.ret,i=t.errmsg;if("0"!==r)return(0,d.wf)(Number(null!=r?r:-1),null!=i?i:"");return(0,d.oW)(void 0)}catch(e){return(0,l.m)(e,-1,"addRecentResource api error")}}convertGetRecentResourcesToRequest(e){var t;let r=e instanceof u.yt?e.config:e,i={panel:this.configurationService.resourcePanel[this.resourceType],app_version:this._environmentService.appVersion,sdk_version:f.f4,lang:p.ZP.language,category:r.category,region:this.accountService.userProfile.region},n=this.buildCustomRequest(r),{limit:o,offset:s}=(0,u.ky)(e)?{...e.config.limit?{limit:e.config.limit}:void 0,offset:null!==(t=e.offset)&&void 0!==t?t:0}:{...this.defaultQueryToken,...e.limit?{limit:e.limit}:void 0};return{...i,...n,...o?{count:o}:void 0,cursor:s}}get defaultQueryToken(){return{offset:0}}convertAddRecentResourceToRequest(e){return{panel:this.configurationService.resourcePanel[this.resourceType],effect_id:e.effectId,resource_id:e.resourceId,type:e.type,lang:p.ZP.language}}buildCustomRequest(e){return{}}get _getRecentResourcesApi(){return`${s._L.getVar("web_domain")}${h.bl.GET_RECENT_RESOURCE_BY_PANEL}`}get _addRecentResourceApi(){return`${s._L.getVar("web_domain")}${h.bl.ADD_RECENT_RESOURCE}`}_convertGetResourcesByCategoryToQueryToken(e,t){var r;let i=this.parseEffectsToResources(null!==(r=t.data.item_list)&&void 0!==r?r:[]),{has_more:n,new_cursor:o}=t.data;return(0,u.ib)(e,{list:i},{hasMore:n,offset:o})}constructor(e,t,r){this.accountService=e,this.configurationService=t,this._environmentService=r}}m=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.fM)(1,g.Ui),(0,i.fM)(2,v.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw,void 0===g.Ui?Object:g.Ui,void 0===v.Y?Object:v.Y])],m);var y=r("482707"),w=r("127830");class k extends m{buildCustomRequest(e){return{category:e.category}}get resourceType(){return w._g.Sticker}parseEffectsToResources(e,t){return e.map(e=>(0,y.jh)(e,t))}}},917835:function(e,t,r){r.d(t,{u:function(){return c}});var i=r(789786),n=r(157021),o=r(966697),s=r(273340),a=r(378351);class c extends n.d{buildCustomRequest(e){var t,r;return{search_option:{cc_web_use_new_search:!0,filter_uncommercial:null!==(r=null===(t=e.filters)||void 0===t?void 0:t.onlyCommercial)&&void 0!==r?r:void 0}}}get resourceType(){return s.g.Sticker}parseHeycanResponseDataToResources(e){return(0,a.U)(e)}constructor(e){super(e)}}c=(0,i.gn)([(0,i.fM)(0,o.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.Gw?Object:o.Gw])],c)},892292:function(e,t,r){r.d(t,{C:function(){return o},c:function(){return s}});var i,n=r(335290);var o=((i={}).Loki="loki",i.Heycan="heycan",i);let s=(0,n.yh)("sticker-data-service")},495322:function(e,t,r){r.d(t,{b:function(){return i}});let i={SMART_CROP:"/lv/v1/editor/image/subject_crop"}},352980:function(e,t,r){r.d(t,{v:function(){return c}});var i=r(789786),n=r(966697),o=r(273340),s=r(978874),a=r(106937);class c extends a.n{get resourceType(){return o.g.SubtitleTemplate}parseHeycanResponseDataToResources(e){return(0,s.G)(e)}constructor(e){super(e),this._capcutAccountService=e}}c=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],c)},611654:function(e,t,r){r.d(t,{B:function(){return i}});let i=(0,r(335290).yh)("subtitle-template-service")},10092:function(e,t,r){r.d(t,{R:function(){return i}});let i=(0,r(335290).yh)("suggest-word-data-service")},146293:function(e,t,r){r.d(t,{m:()=>m});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("690613"),a=r("114861"),c=r("405051"),u=r("121130"),l=r("786022"),d=r("768101"),_=r("502600"),h=r("702049"),p=r("606805"),g=r("801497"),v=r("966697");class f{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new c.yk().build(c.kk);return(0,u.i3)(e),(0,a.V)(e),e}()),this._networkClientInstance}async getSuggestWords(e){try{var t,r,i;let n=await this._networkClient.post(this._api(),{app_id:l.kJ,count:null!==(t=e.limit)&&void 0!==t?t:9,effect_type:e.effectType,query:e.query,search_option:{cc_web_use_new_search:!0}},(0,p._)(this._accountService.userProfile.region,g.ZP.language)),o=Number(null!==(r=n.ret)&&void 0!==r?r:0),a=null!==(i=n.errmsg)&&void 0!==i?i:"";if(0!==o)return(0,s.wf)(null!=o?o:-1,null!=a?a:"");let c=this._convertResponseToSuggestWords(n);return(0,s.oW)(c)}catch(e){return(0,d.m)(e,-1,"getShape api error")}}_api(){return`${h._L.getVar("web_domain")}${_.bl.GET_SUGGEST_WORDS}`}_convertResponseToSuggestWords(e){return e.data.sug_words.map(e=>({groupId:e.group_id,words:e.words,highlights:e.highlight}))}constructor(e){this._accountService=e}}f=(0,i.gn)([(0,i.fM)(0,v.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===v.Gw?Object:v.Gw])],f);class m extends o.JT{getSuggestWords(e){return this._suggestWordRepository.getSuggestWords(e)}constructor(e){super(),this._instantiationService=e,this._suggestWordRepository=this._instantiationService.createInstance(f)}}m=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],m)},597875:function(e,t,r){r.d(t,{H:function(){return n}});var i,n=((i={})[i.Package=1]="Package",i[i.Asset=2]="Asset",i)},70356:function(e,t,r){r.d(t,{E:()=>f});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("292180"),a=r("492197"),c=r("690613"),u=r("114861"),l=r("702049"),d=r("405051"),_=r("121130"),h=r("894339"),p=r("768101"),g=r("318819");class v{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new d.yk().build(d.kk);return(0,_.i3)(e),(0,h.mH)(e),(0,u.V)(e),e}()),this._networkClientInstance}get _api(){return`${l._L.getVar("web_domain")}${g.b.SYNC_FILE_OPEN_TIME}`}async syncFileOpenTime(e){try{let r=await this._networkClient.post(this._api,{...e},{withCredentials:!0});if("0"!==r.ret){var t;return(0,c.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,c.oW)(r.data)}catch(e){return(0,p.m)(e,-1,"syncFileOpenTime api error")}}}class f extends o.JT{syncFileOpenTime(e){let t=(0,a.Z)(e,(e,t)=>(0,s.Z)(t));return this._syncFileOpenTimeRepository.syncFileOpenTime(t)}constructor(e){super(),this._instantiationService=e,this._syncFileOpenTimeRepository=this._instantiationService.createInstance(v)}}f=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],f)},385827:function(e,t,r){r.d(t,{j:function(){return d}});var i=r(702049),n=r(405051),o=r(121130),s=r(323452),a=r(894339),c=r(690613),u=r(114861),l=r(174298);class d{get _createTaskApi(){return`${i._L.getVar("web_domain")}${l.b.CREATE_SYNC_TASK}`}get _getTaskDetailApi(){return`${i._L.getVar("web_domain")}${l.b.GET_SYNC_TASK_DETAIL}`}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new n.yk().build({headers:{"Content-Type":"application/json"}});return(0,o.i3)(e),(0,s.s)(e),(0,a.mH)(e),(0,u.V)(e),e}()),this._networkClientInstance}async createSyncTask(e){var t,r,i;try{let i=await this._networkClient.post(this._createTaskApi,{...e},{withCredentials:!0});if("0"!==i.ret)return(0,c.wf)(Number(i.ret),i.errmsg);return(0,c.oW)({successResource:null!==(t=i.succ_id_list)&&void 0!==t?t:[],failureResource:null!==(r=i.fail_id_list)&&void 0!==r?r:[]})}catch(r){let e=null==r?void 0:r.ret,t=null!==(i=null==r?void 0:r.errmsg)&&void 0!==i?i:"createSyncTemplateTask api error.";return(0,c.Mx)(parseInt(null!=e?e:-1),t,r)}}async getSyncTask(e){try{let t=await this._networkClient.post(this._getTaskDetailApi,e,{withCredentials:!0});if("0"!==t.ret)return(0,c.wf)(Number(t.ret),t.errmsg);return(0,c.oW)(this._formateSyncTaskDetailResponse(t))}catch(r){let e=null==r?void 0:r.ret,t=null==r?void 0:r.errmsg;return(0,c.Mx)(parseInt(null!=e?e:-1),t,r)}}_formateSyncTaskDetailResponse(e){var t,r;return{assets:null!==(r=null===(t=e.data.sync_asset_state)||void 0===t?void 0:t.map(e=>({resourceId:e.resource_id,assetId:e.asset_id,md5:e.md5,status:e.status,message:e.message})))&&void 0!==r?r:[]}}}},217123:function(e,t,r){r.d(t,{f:function(){return n}});var i,n=((i={})[i.Process=1]="Process",i[i.Success=2]="Success",i[i.Failure=3]="Failure",i[i.NotFound=4]="NotFound",i[i.USER_SPACE_NOT_ENOUGH=200406]="USER_SPACE_NOT_ENOUGH",i)},195511:function(e,t,r){r.d(t,{o:function(){return i}});let i=(0,r(335290).yh)("tag-state-data-service")},133597:function(e,t,r){r.d(t,{q:()=>v});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("690613"),a=r("114861"),c=r("702049"),u=r("405051"),l=r("121130"),d=r("894339"),_=r("768101"),h=r("63366");class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new u.yk().build(u.kk);return(0,l.i3)(e),(0,d.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}get _api(){return`${c._L.getVar("web_domain")}${h.b.GET_TAG_STATE}`}async getTagState(e){try{let r=await this._networkClient.post(this._api,{type_list:e.tags},{withCredentials:!0});if("0"!==r.ret){var t;return(0,s.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,s.oW)({...r.data.tag_map})}catch(e){return(0,_.m)(e,-1,"getTagState api error")}}}class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new u.yk().build(u.kk);return(0,l.i3)(e),(0,d.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}get _api(){return`${c._L.getVar("web_domain")}${h.b.SET_TAG_STATE}`}async setTagState(e){try{let r=await this._networkClient.post(this._api,{type:e.tag},{withCredentials:!0});if("0"!==r.ret){var t;return(0,s.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,s.ly)()}catch(e){return(0,_.m)(e,-1,"setTagState api error")}}}class v extends o.JT{getTagState(e){return this._getTagStateRepository.getTagState(e)}setTagState(e){return this._setTagStateRepository.setTagState(e)}constructor(e){super(),this._instantiationService=e,this._getTagStateRepository=this._instantiationService.createInstance(p),this._setTagStateRepository=this._instantiationService.createInstance(g)}}v=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],v)},483221:function(e,t,r){r.d(t,{g:()=>_});var i=r("690613"),n=r("114861"),o=r("405051"),s=r("191449"),a=r("768101"),c=r("231922"),u=r("349360");let l=()=>{let e=new o.yk().build();return(0,u.V)(e),(0,n.V)(e),e};class d{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=l()),this._networkClientInstance}async getSmartToolsConfig(){try{let e=await this._networkClient.get(c.b.GET_SMART_TOOL_TCC_CONFIG),t=(0,s.b)(e);return(0,i.oW)(t)}catch(e){return(0,a.m)(e,-1,"getSmartToolsConfig api error")}}async getUGDrainageFeconfig(){try{let e=await this._networkClient.get(c.b.GET_UG_DRAINAGE_FECONFIG);return(0,i.oW)(e)}catch(e){return(0,a.m)(e,-1,"getUGDrainageFeconfig api error")}}async getAiWatermarkConfig(){try{let e=await this._networkClient.get(c.b.GET_AI_WATERMARK_TCC_CONFIG);return(0,i.oW)(e)}catch(e){return(0,a.m)(e,-1,"getAiWatermarkConfig api error")}}async getAiGenerateForPcConfig(){try{let e=await this._networkClient.get(c.b.GET_AI_GENERATE_FOR_PC_TCC_CONFIG);return(0,i.oW)(e)}catch(e){return(0,a.m)(e,-1,"getAiGenerateForPcConfig api error")}}async getCommonConfig(e){try{var t;let r=await this._networkClient.get(e.url);return(0,i.oW)(null!==(t=null==r?void 0:r.data)&&void 0!==t?t:{})}catch(e){return(0,a.m)(e,-1,"getCommonConfig api error")}}}class _{dispose(){}getSmartToolsConfig(){return this._tccConfigRepository.getSmartToolsConfig()}getAiWatermarkConfig(){return this._tccConfigRepository.getAiWatermarkConfig()}getAiGenerateForPcConfig(){return this._tccConfigRepository.getAiGenerateForPcConfig()}getCommonConfig(e){return this._tccConfigRepository.getCommonConfig(e)}getUGDrainageFeconfig(){return this._tccConfigRepository.getUGDrainageFeconfig()}constructor(){this._tccConfigRepository=new d}}},727423:function(e,t,r){r.d(t,{M:function(){return o}});var i=r(127830),n=r(512363);class o extends n.L{get resourceType(){return i._g.TextMotion}}},208267:function(e,t,r){r.d(t,{N:function(){return s}});var i=r(773943),n=r(186607),o=r(127830);class s extends i.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return o._g.TextMotion}parseEffectsToResources(e,t){return e.map(e=>(0,n.W)(e,t))}}},133223:function(e,t,r){r.d(t,{A:function(){return a}});var i=r(273340),n=r(147194),o=r(789869),s=r(33883);class a extends o.A{get resourceType(){return i.g.TextAnimation}get resourcePanelType(){return s.q.TextMotion}parseHeycanResponseDataToResources(e){return(0,n.Q)(e)}}},75909:function(e,t,r){r.d(t,{t:function(){return a}});var i=r(147194),n=r(758027),o=r(127830),s=r(33883);class a extends n.B{get resourceType(){return o._g.TextMotion}get resourcePanelType(){return s.q.TextMotion}parseHeycanResponseDataToResources(e){return(0,i.Q)(e)}buildCustomRequest(e){return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_key:e.category,pack_optional:{image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}}},196563:function(e,t,r){r.d(t,{j:function(){return i}});let i=(0,r(335290).yh)("text-motion-data-service")},147194:function(e,t,r){r.d(t,{Q:function(){return c}});var i=r(889862),n=r(127830),o=r(32372),s=r(134429),a=r(981632);function c(e){var t;let r=(0,i.E)(e,n._g.TextMotion),c=(0,a.D)(e.common_attr.extra);return{...r,key:`${n._g.TextMotion}_${r.resourceId}`,name:r.title,icon:{uri:(0,o.s)(r.coverUrl),urlList:[r.coverUrl]},previewUrl:r.coverUrl,package:{uri:(0,o.s)(r.originUrl),urlList:[r.originUrl]},sdkVersion:s.f4,isKtv:"true"===c.is_ktv,ktvColor:null!==(t=c.ktv_color)&&void 0!==t?t:""}}},211808:function(e,t,r){r.d(t,{BQ:function(){return s},hh:function(){return c},ll:function(){return a}});var i,n,o=r(249656);var s=((i={}).loki="loki",i.artist="artist",i.brand="brand",i);var a=((n={})[n.text=1]="text",n[n.textTemplate=2]="textTemplate",n);let c=e=>{switch(e){case"artist":return o.Hw.HEYCAN;case"loki":return o.Hw.LOKI;default:return o.Hw.BRAND}}},656609:function(e,t,r){r.d(t,{k:function(){return s}});var i=r(127830),n=r(412497),o=r(43818);class s extends n.r{get resourceType(){return i._g.TextGlow}parseEffectsToResources(e){return e.map(e=>(0,o.B)(e))}}},808656:function(e,t,r){r.d(t,{S:function(){return s}});var i=r(773943),n=r(43818),o=r(127830);class s extends i.b{buildCustomRequest(e){return{enable_album:e.enableAlbum}}get resourceType(){return o._g.TextGlow}parseEffectsToResources(e,t){return e.map(e=>(0,n.B)(e,t))}}},439079:function(e,t,r){r.d(t,{G:function(){return a}});var i=r(146761),n=r(758027),o=r(127830),s=r(33883);class a extends n.B{get resourceType(){return o._g.TextGlow}get resourcePanelType(){return s.q.TextGlow}parseHeycanResponseDataToResources(e){return(0,i.b)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t}}}}},541295:function(e,t,r){r.d(t,{Z:function(){return i}});let i=(0,r(335290).yh)("text-glow-data-service")},43818:function(e,t,r){r.d(t,{B:function(){return o}});var i=r(623935),n=r(127830);function o(e,t){let{common:r,sdkExtra:o}=(0,i.sh)(n._g.TextGlow,e,t);return{...r,sdkExtra:o}}},146761:function(e,t,r){r.d(t,{b:function(){return c}});var i=r(889862),n=r(127830),o=r(981632),s=r(32372),a=r(134429);function c(e){let t=(0,i.E)(e,n._g.TextGlow),r=(0,o.D)(e.common_attr.sdk_extra);return{...t,key:`${n._g.TextGlow}_${t.resourceId}`,name:t.title,icon:{uri:(0,s.s)(t.coverUrl),urlList:[t.coverUrl]},previewUrl:t.coverUrl,package:{uri:(0,s.s)(t.originUrl),urlList:[t.originUrl]},sdkVersion:a.f4,sdkExtra:r}}},578767:function(e,t,r){r.d(t,{B:function(){return l}});var i=r(789786),n=r(966697),o=r(256718),s=r(786022),a=r(228310),c=r(273340),u=r(396190);class l extends o.k{get resourceType(){return c.g.WordArt}parseHeycanResponseDataToResources(e){return(0,a.Q)(e)}buildCustomRequest(){return{loki_optional:{app_version:this._environmentService.appVersion,device_platform:"web"},app_id:s.kJ}}constructor(e={},t,r){super(e,t),this._environmentService=r}}l=(0,i.gn)([(0,i.fM)(1,n.Gw),(0,i.fM)(2,u.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===n.Gw?Object:n.Gw,void 0===u.Y?Object:u.Y])],l)},196656:function(e,t,r){r.d(t,{a:function(){return s}});var i=r(393958),n=r(565520),o=r(692060);class s extends i.h{get brandResourceType(){return n.Q.TextPreset}parseResponseDataToResources(e){return(0,o.Ck)(e,!0)}}},557206:function(e,t,r){r.d(t,{d:function(){return s}});var i=r(692060),n=r(512363),o=r(127830);class s extends n.L{parseDetailToResources(e){return(0,i.Ck)(e)}get resourceType(){return o._g.TextPreset}}},151097:function(e,t,r){r.d(t,{V:function(){return a}});var i=r(228310),n=r(758027),o=r(127830),s=r(33883);class a extends n.B{get resourceType(){return o._g.TextPreset}get resourcePanelType(){return s.q.Flower}parseHeycanResponseDataToResources(e){return(0,i.Q)(e)}buildCustomRequest(e){var t,r;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,category_id:Number(e.categoryId),category_key:e.categoryKey,pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t,only_commercial:null!==(r=e.onlyCommercial)&&void 0!==r&&r,thumb_opt:'{"is_support_webp":1}',image_pack_param:e.imagePackParam}}}}},786501:function(e,t,r){r.d(t,{A:function(){return a}});var i=r(872443),n=r(33883),o=r(228310),s=r(127830);class a extends i.L{get resourceType(){return s._g.TextPreset}get resourcePanelType(){return n.q.Flower}parseHeycanResponseDataToResources(e){return(0,o.Q)(e)}buildCustomRequest(e){var t,r;return{client_ab_param:e.clientABParam,panel_source:e.panelSource,pack_optional:{need_thumb:null!==(t=e.enableAlbum)&&void 0!==t&&t,only_commercial:null!==(r=e.onlyCommercial)&&void 0!==r&&r}}}buildCustomRequestParams(){var e;return{device_type:"default",channel:null!==(e=new URLSearchParams(location.search).get("lokiChannel"))&&void 0!==e?e:"online"}}}},692060:function(e,t,r){r.d(t,{Ck:function(){return h}});var i=r(623935),n=r(127830),o=r(249656),s=r(565520),a=r(32372),c=r(981632),u=r(800788),l=r(134429),d=r(899797),_=r(582026);function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?function(e){try{var t,r,i,h,p,g,v,f;let m;let{common_attr:y}=e;e.sub_item_list=null===(t=e.sub_item_list)||void 0===t?void 0:t.filter(e=>!!e);let w=null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>Number(e.common_attr.resource_type)===s.Q.TextPreset),k=(0,c.D)(y.file_extra);try{m=null===(p=e.sub_item_list)||void 0===p?void 0:p.map(t=>{var r,i,c,h,p;let{common_attr:g}=t;switch(Number(t.common_attr.resource_type)){case s.Q.Font:let v=null===(i=null!==(c=e.depend_resource_list)&&void 0!==c?c:k.depend_resource_list)||void 0===i?void 0:null===(r=i.find(e=>e.resource_id===t.common_attr.id))||void 0===r?void 0:r.source_platform,f=(0,d.ey)(t,void 0,!0);return{...f,isFromBrand:v===_.$.brand||f.package.urlList[0].includes("brand")};case s.Q.TextPreset:return{key:g.id,resourceId:g.id,effectId:g.id,md5:g.md5||g.id,name:g.title,isBusiness:!1,isVip:g.is_vip,package:{uri:(0,a.s)(null!==(h=g.item_url)&&void 0!==h?h:g.download_info.url),urlList:[null!==(p=g.item_url)&&void 0!==p?p:g.download_info.url]},icon:{uri:(0,a.s)(g.cover_url.small),urlList:[g.cover_url.small]},aspectRatio:1,source:o.Hw.LOKI,sdkVersion:l.f4,previewUrl:g.cover_url.small,isFavorite:!1,isDefault:!1,userId:g.user_id,createTime:g.create_time,isPrefab:!1};case s.Q.Background:case s.Q.TextGlow:return{key:`${n._g.TextGlow}_${g.id}_${g.id}`,md5:g.md5,resourceId:g.id,isVip:g.is_vip,effectId:g.id};default:(0,u.bP)(t.common_attr.resource_type)}})}catch(e){m=[]}let b=null!==(g=(null==w?void 0:w.common_attr.item_url)||(null==w?void 0:w.common_attr.download_info.url))&&void 0!==g?g:"",S=null!==(v=null===(i=e.sub_item_list)||void 0===i?void 0:i.some(e=>e.common_attr.is_vip))&&void 0!==v?v:e.common_attr.is_vip,R=null===(h=null!==(f=e.depend_resource_list)&&void 0!==f?f:k.depend_resource_list)||void 0===h?void 0:h.some(t=>{var r;return(null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>e.common_attr.id===t.resource_id))===void 0});return{key:y.id,resourceId:y.id,effectId:y.id,md5:y.md5||y.id,name:y.title,isBusiness:!1,isVip:S,package:{uri:(0,a.s)(b),urlList:[b]},icon:{uri:(0,a.s)(y.cover_url.small),urlList:[y.cover_url.small]},presetSchemaUrl:y.item_url,aspectRatio:1,isFromBrand:!0,source:o.Hw.BRAND,sdkVersion:l.f4,previewUrl:y.cover_url.small,isFavorite:!1,isDefault:e.IsDefault,userId:y.user_id,createTime:y.create_time,brandExtraInfo:{funcs:k.funcs,textPresetType:k.text_preset_type,styleName:k.style_name,extra_info:k.extra_info},brandSubItemList:m,isPrefab:!1,isBrandTextLostDependencies:R}}catch(e){throw e}}(e):function(e){let{common:t}=(0,i.sh)(n._g.TextPreset,e);return{...t,isFavorite:e.IsFavorite,source:o.Hw.LOKI,aspectRatio:1}}(e)}},358243:function(e,t,r){r.d(t,{g:function(){return i}});let i=(0,r(335290).yh)("text-template-service")},611968:function(e,t,r){r.d(t,{H:()=>I});var i=r("789786"),n=r("861810"),o=r("55449"),s=r("402655"),a=r("701473"),c=r("894257"),u=r("683280"),l=r("177866"),d=r("249656"),_=r("866006"),h=r("393958"),p=r("565520"),g=r("858725");class v extends h.h{get brandResourceType(){return p.Q.TextTemplatePreset}parseResponseDataToResources(e){return(0,g.K3)(e,!0)}}var f=r("906965"),m=r("872443"),y=r("33883"),w=r("690831"),k=r("127830");class b extends m.L{get resourcePanelType(){return y.q.TextTemplate}get resourceType(){return k._g.TextTemplate}parseHeycanResponseDataToResources(e){return(0,w._)(e)}buildCustomRequest(e){var t;return{pack_optional:{need_thumb:!0,only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t}}}}var S=r("879496"),R=r("744268"),C=r("466956");class I extends s.JT{getTextCategories(e){if(this._configurationService.abTestManager.getBooleanAbTestValue("text-template-use-vimo",!1)){let t={...e instanceof _.yt?e.config:e,panelSource:"heycan"};return this._getHeycanTextTemplateCategoriesRepository.getCategories(t)}return this._getTextTemplateCategoriesRepository.getCategories(e)}getTextByCategory(e){return this._configurationService.abTestManager.getBooleanAbTestValue("text-template-use-vimo",!1)?this._getHeycanTextTemplateByCategoryRepository.getResources(e):this._getTextTemplateByCategoryRepository.getResources(e)}getBrandTextTemplates(e){return this._getBrandTextTemplatesRepository.getResources(e)}getTextByIds(e){let{isFromBrand:t=!1}=e;if(t){var r;return this._getBrandTextTemplatesByIdsRepository.getResourcesByIds({ids:null!==(r=e.ids)&&void 0!==r?r:[]})}return e.source===d.Hw.HEYCAN?this._getHeycanTextTemplateByIdsRepository.batchGetResources({resourceIds:e.ids}):this._getTextTemplateByIdsRepository.batchGetResources(e)}getCollections(e){return this._collectionTextTemplateRepository.getCollections(e)}addToCollection(e){return this._collectionTextTemplateRepository.addToCollection(e)}removeFromCollection(e){return this._collectionTextTemplateRepository.removeFromCollection(e)}constructor(e={},t,r){super(),this.collectionParam=e,this._instantiationService=t,this._configurationService=r,this._getTextTemplateCategoriesRepository=t.createInstance(a.z),this._collectionTextTemplateRepository=t.createInstance(new n.M(c.U,[e],!1)),this._getTextTemplateByCategoryRepository=t.createInstance(u.L),this._getTextTemplateByIdsRepository=t.createInstance(l.G),this._getBrandTextTemplatesRepository=this._instantiationService.createInstance(v),this._getBrandTextTemplatesByIdsRepository=this._instantiationService.createInstance(f._),this._getHeycanTextTemplateCategoriesRepository=this._instantiationService.createInstance(b),this._getHeycanTextTemplateByCategoryRepository=this._instantiationService.createInstance(S.K),this._getHeycanTextTemplateByIdsRepository=this._instantiationService.createInstance(C.R)}}I=(0,i.gn)([(0,i.fM)(1,o.T),(0,i.fM)(2,R.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof ICollectionResourcesRepositoryParam?Object:ICollectionResourcesRepositoryParam,void 0===o.T?Object:o.T,void 0===R.Ui?Object:R.Ui])],I)},690831:function(e,t,r){r.d(t,{_:function(){return o}});var i=r(127830),n=r(889862);function o(e){var t,r,o,s;let a=(0,n.E)(e,i._g.TextTemplate),c=null!==(o=null===(t=e.text_template)||void 0===t?void 0:t.depend_resource_list.map(e=>({type:e.type,resourceId:e.resource_id,source:e.source})))&&void 0!==o?o:[],u=e=>{var t;let r=e.match(/^(http:.+\/)[0-9a-z]+$/g);return null!==(t=null==r?void 0:r[0])&&void 0!==t?t:e};return{key:`${i._g.TextTemplate}_${a.resourceId}`,resourceId:a.resourceId,effectId:a.effectId,md5:a.md5,source:a.source,aspectRatio:1,isFavorite:null!==(s=a.isFavorite)&&void 0!==s&&s,dependentResources:c,name:a.title,isVip:a.isVip,isBusiness:a.isBusiness,icon:{uri:u(a.coverUrl),urlList:[a.coverUrl]},previewUrl:a.coverUrl,package:{uri:u(a.originUrl),urlList:[a.originUrl]},sdkVersion:"",scriptTemplateVersion:null===(r=e.text_template)||void 0===r?void 0:r.script_template_version,isPrefab:!1}}},858725:function(e,t,r){r.d(t,{H:function(){return _},K3:function(){return h}});var i=r(582026),n=r(623935),o=r(127830),s=r(249656),a=r(565520),c=r(32372),u=r(981632),l=r(134429),d=r(899797);function _(e){var t,r;let{common:i,sdkExtra:a}=(0,n.sh)(o._g.TextTemplate,e),c=null!==(r=null===(t=a.depend_resource_list)||void 0===t?void 0:t.map(e=>({type:e.type,source:e.source||s.Hw.LOKI,resourceId:e.resource_id})))&&void 0!==r?r:[];return{...i,aspectRatio:1,isFavorite:e.IsFavorite,source:s.Hw.LOKI,dependentResources:c,scriptTemplateVersion:a.script_template_version}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?function(e){var t,r,n,o,_,h,p,g,v,f,m;let{common_attr:y}=e;e.sub_item_list=null===(t=e.sub_item_list)||void 0===t?void 0:t.filter(e=>!!e);let w=(0,u.D)(y.file_extra),k=null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>{var t;return(null===(t=e.common_attr)||void 0===t?void 0:t.id)===w.from_resource_id});!k&&console.error(`[formatBrandTextTemplateFromServer]can't get origin text template resource: ${y.id}`);let b=null!==(h=(null==k?void 0:k.common_attr.item_url)||(null==k?void 0:k.common_attr.download_info.url))&&void 0!==h?h:"",S=(null===(n=e.sub_item_list)||void 0===n?void 0:n.some(e=>e.common_attr.is_vip))||e.common_attr.is_vip,R=null===(o=e.depend_resource_list)||void 0===o?void 0:o.some(t=>{var r;return(null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>e.common_attr.id===t.resource_id))===void 0}),C=null!==(p=null===(_=w.depend_resource_list)||void 0===_?void 0:_.filter(e=>e.resource_id!==w.from_resource_id))&&void 0!==p?p:[],I=C.filter(e=>e.source_platform===i.$.brand),P=[];return null==I||I.forEach(t=>{var r;let n=null===(r=e.sub_item_list)||void 0===r?void 0:r.find(e=>e.common_attr.id===t.resource_id);if(!n||Number(n.common_attr.resource_type)!==a.Q.Font)return;let o=(0,d.ey)(n,void 0,!0);P.push({...o,isFromBrand:t.source_platform===i.$.brand||o.package.urlList[0].includes("brand")})}),{key:e.common_attr.id,resourceId:null!==(g=null==k?void 0:k.common_attr.id)&&void 0!==g?g:"",effectId:null!==(v=null==k?void 0:k.common_attr.id)&&void 0!==v?v:"",md5:null!==(m=null!==(f=null==k?void 0:k.common_attr.md5)&&void 0!==f?f:null==k?void 0:k.common_attr.id)&&void 0!==m?m:"",name:y.title,isBusiness:!1,isVip:S,package:{uri:(0,c.s)(b),urlList:[b]},icon:{uri:(0,c.s)(y.cover_url.small),urlList:[y.cover_url.small]},presetSchemaUrl:y.item_url||y.download_info.url,aspectRatio:1,isFromBrand:!0,source:s.Hw.BRAND,sdkVersion:l.f4,previewUrl:y.cover_url.small,isFavorite:!1,dependentResources:C.map(e=>({resourceId:null==e?void 0:e.resource_id,type:null==e?void 0:e.resource_type,source:function(e){switch(e){case i.$.artist:return s.Hw.HEYCAN;case i.$.loki:return s.Hw.LOKI;case i.$.brand:return s.Hw.BRAND;default:return s.Hw.UNKNOWN}}(null==e?void 0:e.source_platform)})),scriptTemplateVersion:void 0,isDefault:e.IsDefault,userId:y.user_id,createTime:y.create_time,brandExtraInfo:{dependResourceList:I.map(e=>({resourceId:null==e?void 0:e.resource_id,resourceType:null==e?void 0:e.resource_type,sourcePlatform:null==e?void 0:e.source_platform})),funcs:w.funcs,textPresetType:w.text_preset_type,styleName:w.style_name,extra_info:w.extra_info,brandFonts:P},isPrefab:!1,isBrandTextLostDependencies:R||void 0===k}}(e):_(e)}},311928:function(e,t,r){r.d(t,{k:function(){return a}});var i=r(690613),n=r(673006),o=r(113974),s=r(943943);class a{getDataByChannel(e){let t=(0,n.d)(e);return this._request(t)}async _request(e){try{let t;let{url:r,data:n,config:o,isGetMethod:a}=e;return t=a?await this._networkClient.get(r,{...o,[s.$R]:!1}):await this._networkClient.post(r,n,{...o,[s.$R]:!1}),(0,i.oW)(t)}catch(c){var t;let{code:e,ret:r,msg:n,errmsg:o}=c||{},s=e?Number(null!=e?e:r):1002,a=null!==(t=null!=n?n:o)&&void 0!==t?t:"unknown error";return(0,i.wf)(s,a)}}constructor(){this._networkClient=(0,o.G)()}}},523732:function(e,t,r){r.d(t,{G:function(){return c}});var i=r(405051),n=r(515207),o=r(121130),s=r(894339),a=r(27074);function c(){let e=new i.yk().build({headers:{"Content-Type":"application/json","app-sdk-version":a.w}});return(0,n.J)(e),(0,o.i3)(e),(0,s.mH)(e),e}},78002:function(e,t,r){r.d(t,{r:function(){return l}});var i=r(789786),n=r(402655),o=r(563681),s=r(657605),a=r(658165),c=r(694101),u=r(200247);class l extends n.JT{constructor(e){super(),this._accountService=e,this._serviceBrand=void 0,this.channel=new o.v,this.management=new s.M,this.resource=new a.Z(this._accountService),this.user=new c.T(this._accountService)}}l=(0,i.gn)([(0,i.fM)(0,u.D),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===u.D?Object:u.D])],l)},327375:function(e,t,r){r.d(t,{x:function(){return i}});class i{registerOAuthConfig(e,t){this._oauthConfig.set(e,t)}getOAuthConfig(e){return this._oauthConfig.get(e)}constructor(){this._oauthConfig=new Map}}},684138:function(e,t,r){r.d(t,{g:function(){return i}});let i={RECENT_LIST_FILE_TYPE:"RECENT_LIST_FILE_TYPE",RECENT_LIST_VIEW_TYPE:"RECENT_LIST_VIEW_TYPE",LIST_VIEW_TYPE:"LIST_VIEW_TYPE",LIST_DISPLAY_TYPE:"LIST_DISPLAY_TYPE",LIST_SORT_BY:"LIST_SORT_BY",RECYCLE_LIST_SORT_BY:"RECYCLE_LIST_SORT_BY",LIST_SORT_DIRECTION:"LIST_SORT_DIRECTION",RECYCLE_LIST_SORT_DIRECTION:"RECYCLE_LIST_SORT_DIRECTION",COOKIE_CONSENT_PROMPT_CONFIG:"COOKIE_CONSENT_PROMPT_CONFIG",THIRTPARTY_FEEDBACK:"THIRTPARTY_FEEDBACK",LV_TASK_CENTER:"LV_TASK_CENTER",THIRDPARTY_CLOUD_AUTH:"THIRDPARTY_CLOUD_AUTH",SURVEY_OPEN:"SURVEY_OPEN",CLOUD_STORAGE_PAYMENT_AND_BINDING:"CLOUD_STORAGE_PAYMENT_AND_BINDING",THIRDPARTY_SHARE_AUTH:"THIRDPARTY_SHARE_AUTH",CAPCUT_THEME:"CAPCUT_THEME",CAPCUT_TEMPLATE_VIDEO_VOLUME:"CAPCUT_TEMPLATE_VIDEO_VOLUME",GUIDE_FROM_TEAM_INVITE:"GUIDE_FROM_TEAM_INVITE",GUIDE_FROM_SIGN_UP:"GUIDE_FROM_SIGN_UP",COMPREHENSIVE_SEARCH_HISTORY:"COMPREHENSIVE_SEARCH_HISTORY"}},141806:function(e,t,r){r.d(t,{G:function(){return c}});var i=r(405051),n=r(515207),o=r(121130),s=r(894339),a=r(27074);function c(){let e=new i.yk().build({headers:{"Content-Type":"application/json","app-sdk-version":a.w}});return(0,n.J)(e),(0,o.i3)(e),(0,s.mH)(e),e}},679565:function(e,t,r){r.d(t,{L:function(){return c}});var i=r(789786),n=r(55449),o=r(402655),s=r(200247),a=r(884007);class c extends o.JT{getIsBindShopify(){return void 0!==this._isBindShopify?Promise.resolve(this._isBindShopify):new Promise(async e=>{this._account.hasLogin?e(await this._getIsBindShopify()):this._account.onDidLogin(async()=>{e(await this._getIsBindShopify())})})}async _getIsBindShopify(){let{isBind:e}=await this._ShopifyDataService.getIsBindShopify();return this._isBindShopify=e,e}constructor(e,t){super(),this._account=e,this._instantiationService=t,this._ShopifyDataService=this._instantiationService.createInstance(a.q)}}c=(0,i.gn)([(0,i.fM)(0,s.D),(0,i.fM)(1,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===s.D?Object:s.D,void 0===n.T?Object:n.T])],c)},492795:function(e,t,r){r.d(t,{XW:function(){return l},jg:function(){return a},us:function(){return c},x$:function(){return u}});var i,n,o,s=r(404929);var a=((i={})[i.Male=0]="Male",i[i.Female=1]="Female",i);var c=((n={})[n.ElevenLabs=1]="ElevenLabs",n[n.VIMO=2]="VIMO",n);var u=((o={}).Sami="sami",o.ElevenLabs="11labs",o.SourceElevenLabs="source_11labs",o.Vimo="vimo",o.Microsoft="microsoft",o);s.i.SAMI,s.i.TTAM,s.i.ELEVENLABS,s.i.VIMO,s.i.VIMO;let l={"11labs":7,vimo:1,sami:7,source_11labs:7,microsoft:7}},796450:function(e,t,r){r.d(t,{X:()=>A});var i=r("789786"),n=r("861810"),o=r("55449"),s=r("402655"),a=r("845523"),c=r("127830"),u=r("412497"),l=r("424022");class d extends u.r{get resourceType(){return c._g.Tone}parseEffectsToResources(e){return e.map(e=>(0,l.t)(e))}}var _=r("651475"),h=r("773943");class p extends h.b{shouldUseRace(){return!0}buildCustomRequest(e){return{region:e.region,only_commercial:e.onlyCommercial,enter_from:e.enter_from}}get resourceType(){return c._g.Tone}parseEffectsToResources(e,t){return e.map(e=>(0,l.t)(e,t))}}var g=r("472026"),v=r("123522"),f=r("966697"),m=r("273340"),y=r("545604"),w=r("106937"),k=r("33883");class b extends w.n{get resourceType(){return m.g.Timbre}get resourcePanelType(){return k.q.Tone}parseHeycanResponseDataToResources(e){return(0,y.K)(e)}constructor(e){super(e),this._capcutAccountService=e}}b=(0,i.gn)([(0,i.fM)(0,f.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===f.Gw?Object:f.Gw])],b);var S=r("817342"),R=r("744268"),C=r("736031"),I=r("249656"),P=r("305301"),E=r("564961");class A extends s.JT{async getTone(e,t){let r=performance.now();return t===a.i.Heycan?this._heycanToneRepository.getResources(e):this._configurationService.getAppConfigurationValue("toolbar.tts.isFromHeycan")&&await (0,C._Q)(this._configurationService,this._heycanToneRepository.resourcePanelType)?this._heycanToneRepository.getResources(e):(performance.measure("CHECK_TONE_FROM_HEYCAN",{start:r}),this._toneRepository.getResources(e))}async batchGetTonesByIds(e,t){if(e.source===I.Hw.LOKI)return this._batchGetToneRepository.batchGetResources(e);{let t=await (0,C.bY)(this._configurationService);return"loki"===(0,C.lo)(t,this._getHeycanToneThirdPartyByIdRepository.resourcePanelType).panel_path&&e.source!==I.Hw.HEYCAN?this._batchGetToneRepository.batchGetResources(e):this._getHeycanToneThirdPartyByIdRepository.batchGetResources((0,P.Q)(e.ids,this._getHeycanToneThirdPartyByIdRepository.resourceType,e.source))}}async getToneCategories(e,t){if(t===a.i.Heycan)return this._getHeycanToneCategoriesRepository.getCategories(e);if(this._configurationService.getAppConfigurationValue("toolbar.tts.isFromHeycan")){let t=await (0,C.bY)(this._configurationService);if("vimo"===(0,C.lo)(t,this._getHeycanToneCategoriesRepository.resourcePanelType).panel_path)return this._getHeycanToneCategoriesRepository.getCategories((0,C.lY)(e,t))}return this._getToneCategoriesRepository.getCategories(e)}getHeycanToneThirdPartyByIds(e){return this._getHeycanToneThirdPartyByIdRepository.getHeycanToneByIds(e)}getToneCollections(e){return this._collectionToneRepository.getCollections(e)}addToCollection(e){return this._collectionToneRepository.addToCollection(e)}removeFromCollection(e){return this._collectionToneRepository.removeFromCollection(e)}getToneByIds(e){return this._getHeycanToneByIdsRepository.batchGetResources(e)}constructor(e={},t,r){var i;super(),this._options=e,this._instantiationService=t,this._configurationService=r,this._toneRepository=this._instantiationService.createInstance(p),this._batchGetToneRepository=this._instantiationService.createInstance(d),this._getToneCategoriesRepository=this._instantiationService.createInstance(_.Y),this._heycanToneRepository=this._instantiationService.createInstance(g.l),this._getHeycanToneCategoriesRepository=this._instantiationService.createInstance(new n.M(v.D,[null===(i=e.shouldUseCategoryIdAsKey)||void 0===i||i],!1)),this._getHeycanToneThirdPartyByIdRepository=this._instantiationService.createInstance(S.s),this._options.fixedRegion&&(this._heycanToneRepository.setFixedRegion(this._options.fixedRegion),this._getHeycanToneCategoriesRepository.setFixedRegion(this._options.fixedRegion)),this._collectionToneRepository=this._instantiationService.createInstance(new n.M(E.a,[e],!1)),this._getHeycanToneByIdsRepository=this._instantiationService.createInstance(new n.M(b,[],!1))}}A=(0,i.gn)([(0,i.fM)(1,o.T),(0,i.fM)(2,R.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,void 0===o.T?Object:o.T,void 0===R.Ui?Object:R.Ui])],A)},424022:function(e,t,r){r.d(t,{t:function(){return a}});var i=r(623935),n=r(127830),o=r(249656),s=r(981632);function a(e,t){var r,a,c,u,l;let{common:d,extra:_}=(0,i.sh)(n._g.Tone,e,t),h=(0,s.D)(_.tonetype),p=_.voice_alias_name,g=_.voice_gender,v=_.tone_avatar_url;if(v){let e=d.previewUrl.split("/");e[e.length-1]=v,v=e.join("/")}let f=null===(r=h.emotion)||void 0===r?void 0:r.map(e=>({emotion:e.emotion,emotionScale:e.emotion_scale,nameKey:e.name_key,text:e.text}));return{...d,source:d.source===o.Hw.UNKNOWN?o.Hw.LOKI:d.source,tone:{ttsVoice:null!==(a=h.tts_voice)&&void 0!==a?a:"",rate:null!==(c=h.rate)&&void 0!==c?c:"",name:null!==(u=h.name)&&void 0!==u?u:"",voiceType:null!==(l=h.voice_type)&&void 0!==l?l:"",voiceGender:_.voice_gender,isAiavatarIgnorePhonemes:_.is_aiavatar_ignore_phonemes,tonePlatform:h.platform,emotion:f},voiceGender:g,voiceAliasName:p,voiceAvatar:v,voiceAvatarUri:_.tone_avatar_url}}},305261:function(e,t,r){r.d(t,{b:function(){return i}});let i={CREATE:"/lv/v1/caption/sami/submit",QUERY:"/lv/v1/caption/sami/query"}},451505:function(e,t,r){r.d(t,{i:function(){return p}});var i=r(789786),n=r(690613),o=r(114861),s=r(702049),a=r(405051),c=r(121130),u=r(894339),l=r(768101),d=r(786022),_=r(305261),h=r(966697);class p{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new a.yk().build(a.kk);return(0,c.i3)(e),(0,u.mH)(e),(0,o.V)(e),e}()),this._networkClientInstance}get _api(){return`${s._L.getVar("web_domain")}${_.b.CREATE}`}async createTranscript(e){try{let r=await this._networkClient.post(this._api,this._formatCreateParams(e),{withCredentials:!0});if("0"!==r.ret){var t;return(0,n.wf)(Number(r.ret),null!==(t=r.errmsg)&&void 0!==t?t:"")}return(0,n.ly)()}catch(e){return(0,l.m)(e,-1,"createTranscript api error")}}_formatCreateParams(e){return{app_id:d.kJ,region:this._accountService.userProfile.region,resources:e.resources.map(e=>({workspace_id:e.workspaceId,resource_id:e.resourceId,url_from_type:e.urlFromType,language:e.language,caption_type:e.captionType,file_type:e.fileType,words_per_line:e.wordsPerLine,audio_text:e.audioText,transcript_category:e.transcriptCategory,asset_workspace_id:e.assetWorkspaceId})),reserve_sil:e.reserveSil}}constructor(e){this._accountService=e}}p=(0,i.gn)([(0,i.fM)(0,h.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===h.Gw?Object:h.Gw])],p)},667891:function(e,t,r){r.d(t,{M:function(){return i}});let i=e=>{var t;return{ret:e.ret,errmsg:e.errmsg,status:e.data.status,list:(null!==(t=e.data.caption)&&void 0!==t?t:[]).map(e=>({resourceId:e.resource_id,utterances:e.utterances.map(e=>{var t;return{text:e.text,startTime:e.start_time,endTime:e.end_time,attribute:e.attribute,words:null==e?void 0:null===(t=e.words)||void 0===t?void 0:t.map(e=>({text:e.text,startTime:e.start_time,endTime:e.end_time,attribute:e.attribute,tag:e.tag}))}})}))}}},484719:function(e,t,r){r.d(t,{T:function(){return i}});let i=(0,r(335290).yh)("transition-data-service")},306125:function(e,t,r){r.d(t,{g:()=>S});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("127830"),a=r("412497"),c=r("177813");class u extends a.r{get resourceType(){return s._g.Transition}parseEffectsToResources(e){return e.map(e=>(0,c.h)(e))}}var l=r("859125"),d=r("512363");class _ extends d.L{parseDetailToResources(e){return(0,c.h)(e)}get resourceType(){return s._g.Transition}}var h=r("726105"),p=r("575124"),g=r("758027"),v=r("33883");class f extends g.B{get resourceType(){return s._g.Transition}get resourcePanelType(){return v.q.Transitions}parseHeycanResponseDataToResources(e){return(0,p.f)(e)}buildCustomRequest(e){var t;return{client_ab_param:e.clientABParam,panel_source:e.panelSource||"heycan",category_id:Number(e.category),pack_optional:{only_commercial:null!==(t=e.onlyCommercial)&&void 0!==t&&t,image_pack_param:{icon_limit:{static_format:"webp",dynamic_format:"awebp",width:100,height:100}}}}}}var m=r("894124"),y=r("744268"),w=r("736031"),k=r("249656"),b=r("305301");class S extends o.JT{async getTransition(e){let t=await (0,w.bY)(this._configurationService,w.Jk);return"vimo"===(0,w.lo)(t,this._getHeycanTransitionByCategoryRepository.resourcePanelType).panel_path?this._getHeycanTransitionByCategoryRepository.getResources((0,w.lY)(e,t,{isSkipSetPanelSourceNull:!0})):this._transitionRepository.getResources(e)}async batchGetTransitionsByIds(e){if(e.source===k.Hw.HEYCAN){let t=await (0,w.bY)(this._configurationService,w.Jk);return"loki"===(0,w.lo)(t,this._batchGetHeycanTransitionRepository.resourcePanelType).panel_path&&e.source!==k.Hw.HEYCAN?this._batchGetTransitionRepository.batchGetResources(e):this._batchGetHeycanTransitionRepository.batchGetResources((0,b.Q)(e.ids,this._batchGetHeycanTransitionRepository.resourceType,e.source))}return this._batchGetTransitionRepository.batchGetResources(e)}async getTransitionCategories(e){let t=await (0,w.bY)(this._configurationService,w.Jk);return"vimo"===(0,w.lo)(t,this._getHeycanTransitionCategoriesRepository.resourcePanelType).panel_path?this._getHeycanTransitionCategoriesRepository.getCategories((0,w.lY)(e,t)):this._getTransitionCategoriesRepository.getCategories(e)}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._transitionRepository=this._instantiationService.createInstance(l.h),this._batchGetTransitionRepository=this._instantiationService.createInstance(u),this._getTransitionCategoriesRepository=this._instantiationService.createInstance(_),this._getHeycanTransitionByCategoryRepository=this._instantiationService.createInstance(f),this._getHeycanTransitionCategoriesRepository=this._instantiationService.createInstance(m.S),this._batchGetHeycanTransitionRepository=this._instantiationService.createInstance(h.J)}}S=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,y.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===y.Ui?Object:y.Ui])],S)},177813:function(e,t,r){r.d(t,{h:function(){return s}});var i=r(623935),n=r(127830),o=r(981632);function s(e,t){var r,s;let{common:a}=(0,i.sh)(n._g.Transition,e,t),c=(0,o.D)(e.SdkExtra);return{...a,duration:null===(r=c.transition)||void 0===r?void 0:r.defaultDura,isOverlap:null===(s=c.transition)||void 0===s?void 0:s.isOverlap}}},575124:function(e,t,r){r.d(t,{f:function(){return c}});var i=r(889862),n=r(981632),o=r(127830),s=r(32372),a=r(134429);function c(e){var t,r;let c=(0,i.E)(e,o._g.Transition),u=(0,n.D)(e.common_attr.sdk_extra);return{...c,key:`${o._g.Transition}_${c.resourceId}`,name:c.title,icon:{uri:(0,s.s)(c.coverUrl),urlList:[c.coverUrl]},previewUrl:c.coverUrl,package:{uri:(0,s.s)(c.originUrl),urlList:[c.originUrl]},sdkVersion:a.f4,duration:null===(t=u.transition)||void 0===t?void 0:t.defaultDura,isOverlap:null===(r=u.transition)||void 0===r?void 0:r.isOverlap}}},426020:function(e,t,r){r.d(t,{F0:function(){return l},Mc:function(){return d},YB:function(){return c},ZF:function(){return i},ov:function(){return u}});let i="-1";var n,o,s,a,c=((n={}).Video="video",n.Image="image",n.Audio="audio",n.File="file",n);var u=((o={}).EverCloud="everCloud",o.PublicSpace="publicSpace",o);var l=((s={})["360p"]="360p",s["480p"]="480p",s["720p"]="720p",s["1080p"]="1080p",s["2400p"]="2400p",s);var d=((a={})["360p"]="360p",a["480p"]="480p",a["720p"]="720p",a["1080p"]="1080p",a["2400p"]="2400p",a.origin="origin",a)},875320:function(e,t,r){r.d(t,{J:function(){return i}});function i(e){var t;if(!!e&&null!==e.detail_infos&&(null==e?void 0:null===(t=e.common_info)||void 0===t?void 0:t.single_frame_height)!==0)return{common:{singleFrameHeight:e.common_info.single_frame_height,singleFrameWidth:e.common_info.single_frame_width,totalSetNum:e.common_info.total_set_num},details:e.detail_infos.map(e=>({frameCount:e.frame_count,imageWidth:e.width,imageHeight:e.height,url:e.url,encryptedBucketKey:e.encrypted_bucket_key,encryptedKey:e.encrypted_key}))}}},532611:function(e,t,r){function i(e){return!e.filename}function n(e){var t,r;return!e.name||(null===(t=e.meta)||void 0===t?void 0:t.is_matting)||(null===(r=e.meta)||void 0===r?void 0:r.have_transcode)===!1}function o(e){var t;return null!==(t=e.is_matting)&&void 0!==t?t:e.is_reverse}function s(e){var t;return null!==(t=null==e?void 0:e.is_gameplay)&&void 0!==t&&t}r.d(t,{Ii:function(){return n},JI:function(){return s},Ml:function(){return i},jL:function(){return o}})},894365:function(e,t,r){r.d(t,{b:function(){return i}});let i={UPDATE_PRIVACY_POLICY:"/lv/v1/user/update"}},49698:function(e,t,r){r.d(t,{x:function(){return a}});var i=r(789786),n=r(55449),o=r(402655),s=r(556446);class a extends o.JT{updateUserPrivacyPolicy(e){return this._userPrivacyPolicyRepository.updateUserPrivacyPolicy(e)}constructor(e){super(),this._instantiationService=e,this._userPrivacyPolicyRepository=this._instantiationService.createInstance(s.V)}}a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},857116:function(e,t,r){r.d(t,{Z:()=>P});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("544432"),a=r("961235"),c=r("127830"),u=r("512363");class l extends u.L{get resourceType(){return c._g.VideoBackground}}var d=r("286800"),_=r("740446"),h=r("527898");class p extends _.i{parseResponseDataToResources(e){return(0,h.ll)(e,void 0,!0)}}var g=r("273340"),v=r("525944"),f=r("789869"),m=r("33883");class y extends f.A{get resourceType(){return g.g.VideoBackground}get resourcePanelType(){return m.q.VideoBackground}parseHeycanResponseDataToResources(e){return(0,v.s)(e)}}var w=r("75995"),k=r("872443");class b extends k.L{get resourceType(){return c._g.VideoBackground}get resourcePanelType(){return m.q.VideoBackground}parseHeycanResponseDataToResources(e){return(0,v.s)(e)}buildCustomRequest(e){return{client_ab_param:e.clientABParam,panel_source:e.panelSource}}}var S=r("744268"),R=r("736031"),C=r("249656"),I=r("305301");class P extends o.JT{async getVideoBackground(e){return await (0,R._Q)(this._configurationService,this._getHeycanVideoBackgroundByCategoryRepository.resourcePanelType,R.Jk)?this._getHeycanVideoBackgroundByCategoryRepository.getResources(e):this._backgroundRepository.getResources(e)}getBrandBackgrounds(e){return this._getBrandBackgroundsRepository.getResources(e)}async batchGetVideoBackgroundsByIds(e){let{isFromBrand:t=!1}=e;if(t)return this._getBrandBackgroundsByIdsRepository.getResourcesByIds(e);if(e.source===C.Hw.LOKI)return this._batchGetVideoBackgroundRepository.batchGetResources(e);{let t=await (0,R.bY)(this._configurationService,R.Jk);return"loki"===(0,R.lo)(t,this._batchGetHeycanVideoBackgroundRepository.resourcePanelType).panel_path&&e.source!==C.Hw.HEYCAN?this._batchGetVideoBackgroundRepository.batchGetResources(e):this._batchGetHeycanVideoBackgroundRepository.batchGetResources((0,I.Q)(e.ids,this._batchGetHeycanVideoBackgroundRepository.resourceType,e.source))}}async getVideoBackgroundCategories(e){let t=await (0,R.bY)(this._configurationService,R.Jk);return"vimo"===(0,R.lo)(t,this._getHeycanVideoBackgroundCategoriesRepository.resourcePanelType).panel_path?this._getHeycanVideoBackgroundCategoriesRepository.getCategories((0,R.lY)(e,t)):this._getVideoBackgroundCategoriesRepository.getCategories(e)}constructor(e,t){super(),this._instantiationService=e,this._configurationService=t,this._backgroundRepository=this._instantiationService.createInstance(a.C),this._batchGetVideoBackgroundRepository=this._instantiationService.createInstance(s.O),this._getVideoBackgroundCategoriesRepository=this._instantiationService.createInstance(l),this._getBrandBackgroundsRepository=this._instantiationService.createInstance(d.h),this._getBrandBackgroundsByIdsRepository=this._instantiationService.createInstance(p),this._getHeycanVideoBackgroundByCategoryRepository=this._instantiationService.createInstance(w.A),this._getHeycanVideoBackgroundCategoriesRepository=this._instantiationService.createInstance(b),this._batchGetHeycanVideoBackgroundRepository=this._instantiationService.createInstance(y)}}P=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.fM)(1,S.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T,void 0===S.Ui?Object:S.Ui])],P)},245044:function(e,t,r){r.d(t,{Z:function(){return i}});let i=(0,r(335290).yh)("video-dreamina-data-service")},981895:function(e,t,r){r.d(t,{S:function(){return c}});var i=r(789786),n=r(966697),o=r(764091),s=r(273340),a=r(612327);class c extends a.J{get resourceType(){return s.g.Video}parseHeycanResponseDataToResources(e){return(0,o.Mk)(e)}constructor(e){super(e),this._capcutAccountService=e}}c=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],c)},224603:function(e,t,r){r.d(t,{h:function(){return c}});var i=r(789786),n=r(966697),o=r(764091),s=r(273340),a=r(106937);class c extends a.n{get resourceType(){return s.g.Video}parseHeycanResponseDataToResources(e){return(0,o.Mk)(e)}constructor(e){super(e),this._capcutAccountService=e}}c=(0,i.gn)([(0,i.fM)(0,n.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.Gw?Object:n.Gw])],c)},793871:function(e,t,r){r.d(t,{z:function(){return o}});var i=r(740446),n=r(764091);class o extends i.i{parseResponseDataToResources(e){return(0,n.Mk)(e,!0)}}},116827:function(e,t,r){r.d(t,{_:function(){return s}});var i=r(393958),n=r(565520),o=r(764091);class s extends i.h{get brandResourceType(){return n.Q.Video}parseResponseDataToResources(e){return(0,o.Mk)(e,!0)}}},764091:function(e,t,r){r.d(t,{Mk:function(){return d},NU:function(){return _}});var i=r(597247),n=r(127830),o=r(889862),s=r(570811),a=r(800788),c=r(163210),u=r(154007);function l(e){var t,r,i,c,u,l,d,_,h,p,g,v,f,m,y,w,k,b,S,R,C,I;let P=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n._g.Video,E=(0,o.E)(e,P),A=e.video.origin_video;!A&&(A=null===(v=e.video.transcoded_video)||void 0===v?void 0:v[Object.keys(null!==(f=e.video.transcoded_video)&&void 0!==f?f:{})[0]]),(0,a.ZB)(A);let M=null===(t=e.mask_video)||void 0===t?void 0:t.origin_video;!M&&(M=null===(y=e.mask_video)||void 0===y?void 0:null===(m=y.transcoded_video)||void 0===m?void 0:m[Object.keys(null!==(w=e.mask_video.transcoded_video)&&void 0!==w?w:{})[0]]);let O={};M&&(O.maskVideo={definition:M.definition,format:M.format,height:M.height,width:M.width,size:M.size,url:M.video_url}),(null===(r=e.mask_video)||void 0===r?void 0:r.transcoded_video)&&(O.maskVideoTranscode=Object.keys(e.mask_video.transcoded_video).reduce((t,r)=>{let{video_url:i,...n}=e.mask_video.transcoded_video[r];return{...t,[r]:{url:i,...n}}},{}));let x=(0,s.o)(A.width,A.height,null!==(k=E.aspectRatio)&&void 0!==k?k:1);return{...E,aspectRatio:x,duration:e.video.duration,duration_ms:e.video.duration_ms,originVideo:{definition:A.definition,format:A.format,height:A.height,width:A.width,size:A.size,url:A.video_url},...O,thumb:{common:{singleFrameHeight:null!==(b=null===(c=e.video.thumb)||void 0===c?void 0:null===(i=c.common_info)||void 0===i?void 0:i.single_frame_height)&&void 0!==b?b:0,singleFrameWidth:null!==(S=null===(l=e.video.thumb)||void 0===l?void 0:null===(u=l.common_info)||void 0===u?void 0:u.single_frame_width)&&void 0!==S?S:0,totalSetNum:null!==(R=null===(_=e.video.thumb)||void 0===_?void 0:null===(d=_.common_info)||void 0===d?void 0:d.total_set_num)&&void 0!==R?R:0},details:null!==(C=null===(p=e.video.thumb)||void 0===p?void 0:null===(h=p.detail_infos)||void 0===h?void 0:h.map(e=>({frameCount:e.frame_count,imageHeight:e.image_height,imageWidth:e.image_width,mimeType:e.mime_type,url:e.url})))&&void 0!==C?C:[]},transcode:null===(g=Object.keys(null!==(I=e.video.transcoded_video)&&void 0!==I?I:{}))||void 0===g?void 0:g.reduce((t,r)=>{let{video_url:i,...n}=e.video.transcoded_video[r];return{...t,[r]:{url:i,...n}}},{}),order:e.order_info?{id:e.order_info.id,source:e.order_info.source}:void 0}}function d(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?function(e){var t,r,n,o,u,l,d,_,h,p,g,v,f,m;let{common_attr:y,video:w}=e,k=(0,c.C)(y);(0,a.ZB)(w);let b=null===(r=w.thumb)||void 0===r?void 0:null===(t=r.common_info)||void 0===t?void 0:t.single_frame_height;return{...k,isDefault:e.IsDefault,userId:y.user_id,originUrl:null!==(v=w.origin_video.video_url)&&void 0!==v?v:y.download_info.url,createTime:y.create_time,workspaceId:y.workspace_id,originVideo:{format:w.origin_video.format,definition:null!==(f=w.origin_video.definition)&&void 0!==f?f:"",width:w.origin_video.width,height:w.origin_video.height,size:w.origin_video.size,url:w.origin_video.video_url},aspectRatio:(0,s.o)(w.origin_video.width,w.origin_video.height,1),duration:w.duration,duration_ms:w.duration_ms,thumb:{common:{singleFrameWidth:null===(o=w.thumb)||void 0===o?void 0:null===(n=o.common_info)||void 0===n?void 0:n.single_frame_width,singleFrameHeight:null===(l=w.thumb)||void 0===l?void 0:null===(u=l.common_info)||void 0===u?void 0:u.single_frame_height,totalSetNum:null===(_=w.thumb)||void 0===_?void 0:null===(d=_.common_info)||void 0===d?void 0:d.total_set_num},details:null===(p=w.thumb)||void 0===p?void 0:null===(h=p.detail_infos)||void 0===h?void 0:h.map(e=>{let{url:t,frame_count:r,image_width:n,image_height:o}=e;return{url:t,imageWidth:n,imageHeight:b?r*b:o,frameCount:r,mimeType:i.V.jpeg}})},transcode:null===(g=Object.keys(null!==(m=w.transcoded_video)&&void 0!==m?m:{}))||void 0===g?void 0:g.reduce((e,t)=>{let{video_url:r,...i}=w.transcoded_video[t];return{...e,[t]:{url:r,decryptKey:i.key,...i}}},{}),isFromBrand:!0}}(e):l(e)}function _(e){return function(e){var t,r,i,o,s,a,c,d,_,h,p,g,v;let f=l(e,n._g.VideoDreamina);return{key:f.resourceId,createTime:null!==(_=f.createTime)&&void 0!==_?_:0,aigcItemId:"",historyRecordId:"",resourceId:f.resourceId,duration:f.duration,durationMs:f.duration_ms,coverUrl:f.coverUrl,originVideo:{...f.originVideo,url:f.originVideo.url},transcode:{origin:{videoUrl:f.transcode.origin.url}},thumb:{thumbCommonInfo:{singleFrameHeight:null!==(h=null===(r=e.video.thumb)||void 0===r?void 0:null===(t=r.common_info)||void 0===t?void 0:t.single_frame_height)&&void 0!==h?h:0,singleFrameWidth:null!==(p=null===(o=e.video.thumb)||void 0===o?void 0:null===(i=o.common_info)||void 0===i?void 0:i.single_frame_width)&&void 0!==p?p:0,totalSetNum:null!==(g=null===(a=e.video.thumb)||void 0===a?void 0:null===(s=a.common_info)||void 0===s?void 0:s.total_set_num)&&void 0!==g?g:0},detailInfos:null!==(v=null===(d=e.video.thumb)||void 0===d?void 0:null===(c=d.detail_infos)||void 0===c?void 0:c.map(e=>({frameCount:e.frame_count,imageHeight:e.image_height,imageWidth:e.image_width,mimeType:e.mime_type,url:e.url,uri:""})))&&void 0!==v?v:[]},videoId:"",transcodeStatus:u.l.success}}(e)}},734481:function(e,t,r){r.d(t,{X:function(){return s}});var i=r(773943),n=r(922465),o=r(127830);class s extends i.b{buildCustomRequest(e){return{category:e.category}}get resourceType(){return o._g.VideoMotion}parseEffectsToResources(e,t){return e.map(e=>(0,n.N)(e,t))}}},504826:function(e,t,r){r.d(t,{Cd:function(){return c},WY:function(){return s},cY:function(){return u},x8:function(){return a}});var i,n,o,s=((i={})[i.BUSINESS=9001]="BUSINESS",i[i.CONSUMER=1]="CONSUMER",i[i.NORMAL=0]="NORMAL",i[i.TEMPLATE=2]="TEMPLATE",i[i.COMMERCIAL=10]="COMMERCIAL",i[i.STORYBOARD=606]="STORYBOARD",i);let a=[9001,1];var c=((n={})[n.NORMAL=0]="NORMAL",n[n.COMPATIBLE=1]="COMPATIBLE",n[n.NOT_COMPATIBLE=2]="NOT_COMPATIBLE",n[n.PLATFORM=3]="PLATFORM",n[n.OFFLINE=4]="OFFLINE",n[n.REVIEWING=5]="REVIEWING",n[n.BANNED=6]="BANNED",n[n.SELFVIEW=7]="SELFVIEW",n[n.DELETED=100]="DELETED",n[n.CROSS_REGION=101]="CROSS_REGION",n[n.OTHER=1e4]="OTHER",n);var u=((o={})[o.Video=1]="Video",o[o.Image=2]="Image",o[o.AIStoryboard=4]="AIStoryboard",o)},213742:function(e,t,r){r.d(t,{P7:function(){return o},pH:function(){return s}});var i=r(801497),n=r(134429);let o={loc:"sg",appSDKVesion:n.Mr,appSDKVersion:n.Mr,lan:i.oc.language||"en",pf:"7",appVersion:n.$U,tdid:"web",signVer:1},s=n.Mr},827084:function(e,t,r){r.d(t,{Bc:function(){return s},kC:function(){return a},yt:function(){return p}});var i=r(818398),n=r.n(i),o=r(127830);function s(e){return`${o._g.VideoTemplate}_${e}`}function a(e){return e.split(`${o._g.VideoTemplate}_`)[1]}let c=e=>!!e.TransInfo||!1,u=e=>{var t;return{__segment_struct_type:"SegmentVideo",id:e.id,filled:!1,assetMD5:"",clip:e.Clip,cover_path:e.CoverPath,crop:[e.VideoCrop.upper_left_x,e.VideoCrop.upper_left_y,e.VideoCrop.upper_right_x,e.VideoCrop.upper_right_y,e.VideoCrop.lower_left_x,e.VideoCrop.lower_left_y,e.VideoCrop.lower_right_x,e.VideoCrop.lower_right_y],duration:e.duration,gameplay:{algorithm:e.GamePlay.algorithm,path:e.GamePlay.path,reshape:e.GamePlay.reshape},path:e.Path,height:e.Height,width:e.Width,track_idx:null!==(t=e.RenderIdx)&&void 0!==t?t:e.TrackIdx,is_cartoon:e.IsCartoon,material_id:e.MaterialId,material_name:e.MaterialName,source_duration:e.SourceDuration,relation_video_group:e.RelationVideoGroup,segment_id:e.SegmentId,source_platform:e.SourcePlatform,source_start:e.SourceStart,target_duration:e.TargetDuration,target_start:e.TargetStart,volume:e.Volume,animations:e.Animations}},l=e=>({id:e.id||"",material_name:e.name||""}),d=e=>{let t=e.replace(/<[^>]+>/g,"");try{return t.match(/\[([^\]]+)\]/g).map(e=>e.length&&"["===e[0]&&"]"===e[e.length-1]?e.slice(1,e.length-1):e).join("")}catch(e){}return t},_=e=>({__segment_struct_type:"SegmentText",id:e.Id,segment_id:e.SegmentId,target_start:e.Start,target_duration:e.Duration,text:d(e.Text),animations:e.Animations}),h=e=>{var t,r;if(c(e)){let t=JSON.parse(e.TransInfo.play_info),r=t.VideoMeta.Height&&t.VideoMeta.Width&&t.VideoMeta.Duration,i=!t.VideoMeta.Height&&!t.VideoMeta.Width&&t.VideoMeta.Duration,n=t.VideoMeta.Height&&t.VideoMeta.Width&&!t.VideoMeta.Duration,o="other";return o=r?"video":i?"audio":n?"image":"other",{uri:e.TransInfo.Uri,name:e.Name,path:e.Path,md5:e.TransInfo.Vid,url:t.MainUrl||t.BackupUrl,key:t.VideoMeta.EncryptionKey,type:o,aes:!1}}return{uri:e.Storage.Uri,name:e.Name,path:e.Path,width:null===(t=e.Storage.ImageMeta)||void 0===t?void 0:t.Width,height:null===(r=e.Storage.ImageMeta)||void 0===r?void 0:r.Height,md5:e.Storage.Encryption.SourceMd5,url:e.EncryptURL,key:e.Storage.Encryption.SecretKey,mime_type:e.Storage.Encryption.Extra.mime_type,aes:"false"!==e.Storage.Encryption.Extra.aes,type:"unkown"}};function p(e){return function(e){var t,r,i,o,a,c,d,p,g,v,f;let m={key:s(e.web_id),id:e.web_id,name:e.short_title,description:e.title,duration:e.duration/1e3,vid:e.vid,url:e.template_url,videoUrl:e.video_url,status:e.status,templateType:e.item_type,cover:{url:e.cover_url,width:e.cover_width,height:e.cover_height},author:{uid:e.author.uid,name:e.author.name,avatarUrl:e.author.avatar_url},preload:{json:null===(t=e.draft_parse_info)||void 0===t?void 0:t.TotalDraft.Draft,mutableVideos:[],mutableAudios:[],mutableTexts:[],mutableTextRects:{},avs:{},effects:{},online:[],builtIns:[]},segmentInfo:{textSegmentCount:e.draft_seg_info.text_seg_len,videoSegmentCount:e.draft_seg_info.video_seg_len},optimizedCoverUrl:{smallCoverUrl:null===(r=e.optimized_cover_url)||void 0===r?void 0:r.cover_url_small,mediumCoverUrl:null===(i=e.optimized_cover_url)||void 0===i?void 0:i.cover_url_medium,largeCoverUrl:null===(o=e.optimized_cover_url)||void 0===o?void 0:o.cover_url_large},usageAmount:e.usage_amount,extra:{},encryptedSprites:[],mute:!1,canUpdateMusic:e.can_update_music,producerAppId:e.producer_appid,producerBizId:e.producer_bizid,userBizId:e.user_bizid,isOperationalIntervention:null!==(d=e.is_operational_intervention)&&void 0!==d&&d,productInfos:e.product_infos,categories:null!==(p=e.category_id_list)&&void 0!==p?p:[],linkRatioTemplateInfo:null!==(g=e.link_ratio_template_info)&&void 0!==g?g:[],isFavorite:null!==(v=null==e?void 0:null===(a=e.item_relation)||void 0===a?void 0:a.is_favorite)&&void 0!==v&&v,businessTemplateTagsStr:e.business_template_tags};if(e.big_thumb){let{img_num:t,img_urls:r,img_x_len:i,img_x_size:n,img_y_len:o,img_y_size:s}=e.big_thumb,a=i*o,c=t;for(let e of r){let r=Math.min(c,a);c-=t,m.encryptedSprites.push({url:e,count:r,width:n*i,height:s*o,x:i,y:o,ratio:n/s})}}try{let t=/^[{].*[}]$/.test(e.extra)?e.extra:"{}";m.extra=JSON.parse(t)}catch(e){}try{let t=n().parse(e.draft_parse_info.LocalDraftInfo);m.preload.mutableVideos=t.VideoSegments.map(e=>u(e)),m.preload.mutableTexts=t.TextSegments.map(e=>_(e))}catch(e){}if(null==e?void 0:null===(c=e.draft_parse_info)||void 0===c?void 0:c.TextInfo)try{let t=JSON.parse(e.draft_parse_info.TextInfo);m.preload.mutableTextRects=t}catch(e){}try{let{avs:t,effects:r}=n().parse(e.draft_parse_info.TotalDraft.Preload);m.preload.avs=t,m.preload.effects=r}catch(e){}try{m.preload.online=n().parse(e.draft_parse_info.TotalDraft.MaterialList)}catch(e){}try{let t=n().parse(e.draft_parse_info.TotalDraft.Draft),r=(null==t?void 0:null===(f=t.materials)||void 0===f?void 0:f.audios)||[];m.preload.mutableAudios=r.map(e=>l(e)),0===t.tracks.filter(e=>"audio"===e.type).map(e=>e.segments).flat().length&&(m.canUpdateMusic=!0)}catch(e){}try{let t=n().parse(e.draft_parse_info.FileInfo||"[]").map(h);for(let r of n().parse(e.draft_parse_info.VideoInfo||"[]").map(h)){let e=t.findIndex(e=>e.path===r.path);e>=0&&(t[e]={...r,uri:t[e].uri})}m.preload.builtIns=t}catch(e){}return e.mute&&(m.mute=e.mute,m.canUpdateMusic=!0),m}(e)}},86571:function(e,t,r){r.d(t,{S:function(){return o}});var i=r(823981),n=r(614022);function o(e){return!(!(0,i.Z)(e)||3!==e.length||e.some(e=>!(0,n.Z)(e)))&&!0}},978112:function(e,t,r){r.d(t,{A:function(){return i}});let i=(0,r(335290).yh)("video-template-data-service")},550624:function(e,t,r){r.d(t,{E:()=>D});var i=r("789786"),n=r("55449"),o=r("402655"),s=r("690613"),a=r("114861"),c=r("966697"),u=r("249656"),l=r("702049"),d=r("405051"),_=r("999432"),h=r("121130"),p=r("768101"),g=r("827084"),v=r("87909"),f=r("744268"),m=r("454530"),y=r("213742"),w=r("396190");class k{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new d.yk().build(d.kk);return(0,_.V)(e,{...y.P7}),(0,h.i3)(e),(0,a.V)(e),e}()),this._networkClientInstance}async batchGetVideoTemplates(e){try{var t;let r=await this._networkClient.post(this._api,this._buildRequestRequest(e)),i=Number(null!==(t=r.ret)&&void 0!==t?t:0);if(0!==i)return(0,s.wf)(null!=i?i:-1,"get Model error");let n=this._convertResponseToVideoTemplateData(r);return(0,s.oW)(n)}catch(e){return(0,p.m)(e,-1,"getModel api error")}}_convertResponseToVideoTemplateData(e){return{list:e.data.templates.map(t=>(0,g.yt)({...t,user_bizid:e.data.user_bizid})),requestId:e.log_id,searchId:e.log_id}}_buildRequestRequest(e){var t;let r=this._configurationService.abTestManager.getBooleanAbTestValue(m.o.NewTransitionEffectEnabled),i=this._environmentService.isAutoTest||r?u.Nb.New:u.Nb.Old;return{biz_id:null,id:e.ids,enter_from:null!==(t=e.enterFrom)&&void 0!==t?t:"template_editor",sdk_version:y.pH,cc_web_version:i}}_getUniqueName(e){let t=new Map;return e.forEach(e=>{t.set(e,e)}),Array.from(t.keys()).join(",")}get _api(){return`${l._L.getVar("web_domain")}${v.b.MULTI_GET_TEMPLATES}`}constructor(e,t,r){this._accountService=e,this._configurationService=t,this._environmentService=r}}k=(0,i.gn)([(0,i.fM)(0,c.Gw),(0,i.fM)(1,f.Ui),(0,i.fM)(2,w.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===c.Gw?Object:c.Gw,void 0===f.Ui?Object:f.Ui,void 0===w.Y?Object:w.Y])],k);var b=r("957412"),S=r("894339"),R=r("866006");class C{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new d.yk().build(d.kk);return(0,_.V)(e,{...y.P7}),(0,h.i3)(e),(0,S.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}async batchGetRecommendedVideoTemplates(e){let t=e instanceof R.yt?e.config:e;try{var r,i;let e=await this._networkClient.post(this._api,this._buildRequestRequest({limit:20,...t})),n=Number(null!==(r=e.ret)&&void 0!==r?r:0);if(0!==n)return(0,s.wf)(null!=n?n:-1,null!==(i=e.errmsg)&&void 0!==i?i:"batchGetRecommendedVideoTemplates api error");let o=this._convertResponseToQueryToken(t,e);return(0,s.oW)(o)}catch(e){return(0,p.m)(e,-1,"batchGetRecommendedVideoTemplates api error")}}_convertResponseToQueryToken(e,t){let r={list:t.data.templates.map(e=>(0,g.yt)({...e,user_bizid:t.data.user_bizid})),requestId:t.log_id,searchId:t.log_id},{has_more:i,new_cursor:n}=t.data;return(0,R.ib)(e,r,{hasMore:i,offset:Number(null!=n?n:0),requestId:t.log_id,searchId:t.log_id})}_buildRequestRequest(e){var t,r;let i=this._configurationService.abTestManager.getBooleanAbTestValue(m.o.NewTransitionEffectEnabled),n=this._environmentService.isAutoTest||i?u.Nb.New:u.Nb.Old;return{id:e.id,enter_from:null!==(t=e.enterFrom)&&void 0!==t?t:"template_editor",sdk_version:y.pH,uuid:this._accountService.userProfile.uid,count:e.limit,cursor:`${null!==(r=e.offset)&&void 0!==r?r:e.limit}`,cc_web_version:n}}get _api(){return`${l._L.getVar("web_domain")}${v.b.GET_RECOMMENDED_TEMPLATES}`}constructor(e,t,r){this._accountService=e,this._configurationService=t,this._environmentService=r}}C=(0,i.gn)([(0,i.fM)(0,c.Gw),(0,i.fM)(1,f.Ui),(0,i.fM)(2,w.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===c.Gw?Object:c.Gw,void 0===f.Ui?Object:f.Ui,void 0===w.Y?Object:w.Y])],C);var I=r("801859"),P=r("876019");class E{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new d.yk().build(d.kk);return(0,_.V)(e,{...y.P7}),(0,h.i3)(e),(0,a.V)(e),e}()),this._networkClientInstance}async getPublishTemplateConfig(){try{var e;let t=await this._networkClient.post(this._api,{},{withCredentials:!0}),r=Number(null!==(e=t.ret)&&void 0!==e?e:0);if(0!==r)return(0,s.wf)(null!=r?r:-1,"get publish template config api error");let i=this._convertResponseToPublishTemplateConfig(t);return(0,s.oW)(i)}catch(e){return(0,p.m)(e,-1,"getPublishTemplateConfig api error")}}_convertResponseToPublishTemplateConfig(e){let{segment_template_collections:t=[]}=e.data;return{segmentTemplateCollections:t.map(e=>({id:e.id,name:e.name,starlingKey:e.starling_key}))}}get _api(){return`${l._L.getVar("web_domain")}${v.b.GET_PUBLISH_TEMPLATE_CONFIG}`}}var A=r("884461"),M=r("801497");class O{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new d.yk().build({...d.kk,withCredentials:!0});return(0,_.V)(e,{...y.P7,lan:M.ZP.language}),(0,h.i3)(e),(0,S.mH)(e),(0,a.V)(e),e}()),this._networkClientInstance}async searchVideoTemplates(e){let t=e instanceof R.yt?e.config:e;try{var r,i;let n=await this._networkClient.post(this._api,this._buildRequestRequest(e)),o=Number(null!==(r=n.ret)&&void 0!==r?r:0);if(0!==o)return(0,s.wf)(null!=o?o:-1,null!==(i=n.errmsg)&&void 0!==i?i:"searchVideoTemplateHijackByIdRepository api error");let a=this._convertResponseToQueryToken(t,n);return(0,s.oW)(a)}catch(e){return(0,p.m)(e,-1,"searchVideoTemplateHijackByIdRepository api error")}}_convertResponseToQueryToken(e,t){let r={list:t.data.templates.map(e=>(0,g.yt)({...e,user_bizid:t.data.user_bizid}))};return(0,R.ib)(e,r,{hasMore:!1,offset:0,searchId:"",requestId:t.log_id})}_buildRequestRequest(e){var t;let r=e instanceof R.yt?e.config:e,i=this._configurationService.abTestManager.getBooleanAbTestValue(m.o.NewTransitionEffectEnabled),n=this._environmentService.isAutoTest||i?u.Nb.New:u.Nb.Old;return{biz_id:null,id:[r.query],enter_from:null!==(t=r.enterFrom)&&void 0!==t?t:"template_editor",sdk_version:y.pH,cc_web_version:n}}get _api(){return`${l._L.getVar("web_domain")}${v.b.MULTI_GET_TEMPLATES}`}get defaultQueryToken(){return{offset:0,count:50}}constructor(e,t,r){this._accountService=e,this._configurationService=t,this._environmentService=r}}O=(0,i.gn)([(0,i.fM)(0,c.Gw),(0,i.fM)(1,f.Ui),(0,i.fM)(2,w.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===c.Gw?Object:c.Gw,void 0===f.Ui?Object:f.Ui,void 0===w.Y?Object:w.Y])],O);var x=r("922453");class D extends o.JT{batchGetVideoTemplatesByIds(e){return this._batchGetVideoTemplateRepository.batchGetVideoTemplates(e)}async getVideoTemplatesByJsonp(){var e,t,r;if(!document.getElementById("GTW_TEMPLATE_INFO_JSONP"))return(0,s.wf)(-1,"has no jsonp request");try{await window.pTemplateInfo}catch(e){return(0,p.m)(e,-1,"jsonp request error")}let i=window.__multi_get_templates__;return i&&"0"===i.ret&&(null===(t=i.data)||void 0===t?void 0:null===(e=t.templates)||void 0===e?void 0:e.length)!==0?(0,s.oW)({list:i.data.templates.map(e=>(0,g.yt)({...e,user_bizid:i.data.user_bizid})),requestId:"",searchId:""}):(0,s.wf)(null!==(r=null==i?void 0:i.ret)&&void 0!==r?r:-1,"get Model error")}batchGetVideoTemplatesByCategory(e){return this._batchGetVideoTemplatesByCategoryRepository.batchGetVideoTemplatesByCategory(e)}batchGetRecommendedVideoTemplates(e){return this._batchGetRecommendedVideoTemplatesRepository.batchGetRecommendedVideoTemplates(e)}searchVideoTemplates(e){return this._searchVideoTemplatesRepository.searchVideoTemplates(e)}searchVideoTemplateHijackById(e){return this._searchVideoTemplateHijackByIdRepository.searchVideoTemplates(e)}batchGetCategories(e){return this._batchGetCategoriesRepository.batchGetCategories(e)}getPublishTemplateConfig(){return this._getPublishTemplateConfigRepository.getPublishTemplateConfig()}publishTemplate(e){return this._publishTemplateRepository.publishTemplate(e)}impressionTemplates(e){this._impressionTemplatesRepository.impressionTemplates(e)}constructor(e){super(),this._instantiationService=e,this._batchGetVideoTemplateRepository=this._instantiationService.createInstance(k),this._batchGetVideoTemplatesByCategoryRepository=this._instantiationService.createInstance(b.a),this._batchGetRecommendedVideoTemplatesRepository=this._instantiationService.createInstance(C),this._searchVideoTemplatesRepository=this._instantiationService.createInstance(I.s),this._searchVideoTemplateHijackByIdRepository=this._instantiationService.createInstance(O),this._batchGetCategoriesRepository=this._instantiationService.createInstance(P.O),this._getPublishTemplateConfigRepository=this._instantiationService.createInstance(E),this._publishTemplateRepository=this._instantiationService.createInstance(A.K),this._impressionTemplatesRepository=this._instantiationService.createInstance(x.Y)}}D=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],D)},242369:function(e,t,r){r.d(t,{b:function(){return i}});let i={SAVE_DRAFT:"/lv/v1/editor/video_draft/save",DELTA_UPDATE:"/lv/v1/editor/video_draft/delta_update"}},905906:function(e,t,r){r.d(t,{b:function(){return i}});let i={CREATE_EXPORT_TASK:"/lv/v1/render_task/create",CANCLE_EXPORT_TASK:"/lv/v1/render_task/cancel",GET_EXPORT_TASK_DETAIL:"/lv/v1/render_task/batch_get"}},903943:function(e,t,r){r.d(t,{w:()=>p});var i,n,o,s=((i={})[i.Processing=0]="Processing",i[i.Success=1]="Success",i[i.Failure=-1]="Failure",i[i.FallSpace=-2]="FallSpace",i),a=r("690613"),c=r("587892"),u=r("402655"),l=r("800788");var d=((n=d||{})[n.Cancel=-3]="Cancel",n);var _=((o=_||{})[o.Stop=-4]="Stop",o);let h={...s,...d,..._};class p extends u.JT{async _getTaskProgress(){var e,t,r,i,n,o,s,c,u,d,_;(0,l.ZB)(this._taskId);let p=await this._exportRepository.getExportTask({task_ids:[this._taskId],need_task_info:!0,need_media_info:!0,task_id_to_render_type:{[this._taskId]:this._taskIdToRenderType}});if(this._taskStauts!==h.Cancel&&this._taskStauts!==h.Stop){if(p.ok){this._getTaskProgressErrorCount=0;let t=p.value.status;if(this._taskStauts=t,t===h.Processing)this._onProgress.fire((0,a.oW)(p.value));else if([h.Failure,h.FallSpace].includes(t))this._onError.fire((0,a.wf)(t,`export task failed. taskStatus: ${t===h.Failure?"failure":"fall_space"}`,{log_id:(null===(e=p.errorInfo)||void 0===e?void 0:e.log_id)||""}));else if(t===h.Success){;let e={...p.value,downloadUrl:null!==(d=null==(i=p.value.render_task_media_meta)?void 0:null===(s=i.VideoMeta)||void 0===s?void 0:null===(o=s.Asset)||void 0===o?void 0:null===(n=o.AssetMeta)||void 0===n?void 0:n.DownLoadUrl)&&void 0!==d?d:"",md5:null!==(_=null==i?void 0:null===(u=i.VideoMeta)||void 0===u?void 0:null===(c=u.Asset)||void 0===c?void 0:c.Md5)&&void 0!==_?_:""};this._onSuccess.fire(e)}}else this._getTaskProgressErrorCount++;this._getTaskProgressErrorCount>=10&&(this._taskStauts=h.Failure,this._onError.fire((0,a.wf)(p.code,p.msg,{log_id:null!==(r=null===(t=p.errorInfo)||void 0===t?void 0:t.log_id)&&void 0!==r?r:""})))}}async _startPollingProgress(){try{await this._getTaskProgress(),this._taskStauts===h.Processing&&(this._timer=setTimeout(()=>{this._startPollingProgress()},this._pollingProgressTimeout))}catch(e){}}async cancel(){var e;(0,l.ZB)(this._taskId);let t=await this._exportRepository.cancelExportTask({task_id:this._taskId,render_type:this._taskIdToRenderType});return t.ok?(this._taskStauts=h.Cancel,(0,a.ly)()):(0,a.wf)(t.code,t.msg,{log_id:(null==t?void 0:null===(e=t.errorInfo)||void 0===e?void 0:e.log_id)||""})}async retry(){var e;(0,l.ZB)(this._taskId),this._getTaskProgressErrorCount=0;let t=await this._exportRepository.retryExportTask({task_id:this._taskId,render_type:this._taskIdToRenderType});return t.ok?(this._taskStauts=h.Processing,(0,a.ly)()):(0,a.wf)(t.code,t.msg,{log_id:(null==t?void 0:null===(e=t.errorInfo)||void 0===e?void 0:e.log_id)||""})}stopPolling(){this._taskStauts=h.Stop,clearTimeout(this._timer)}constructor(e,t,r){var i;super(),this._exportRepository=e,this.value=t,this._onProgress=this._store.add(new c.Q),this.onProgress=this._onProgress.event,this._onError=this._store.add(new c.Q),this.onError=this._onError.event,this._onSuccess=this._store.add(new c.Q),this.onSuccess=this._onSuccess.event,this._taskStauts=h.Processing,this._getTaskProgressErrorCount=0,this._pollingProgressTimeout=500,this._taskId=this.value.task_id,this._taskIdToRenderType=null!==(i=this.value.render_type)&&void 0!==i?i:0,r&&(this._pollingProgressTimeout=r),this._startPollingProgress()}}},338473:function(e,t,r){r.d(t,{b:function(){return i}});let i={RENDER_FRAME:"/lv/v1/draft/frame_info/render"}},131169:function(e,t,r){r.d(t,{v:function(){return a}});var i=r(789786),n=r(55449),o=r(402655),s=r(530743);class a extends o.JT{renderFirstFrame(e){return this._firstFrameRepository.renderFirstFrame(e)}constructor(e){super(),this._instantiationService=e,this._firstFrameRepository=this._instantiationService.createInstance(s.Q)}}a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},125975:function(e,t,r){r.d(t,{N:function(){return g}});var i=r(789786),n=r(690613),o=r(114861),s=r(405051),a=r(121130),c=r(894339),u=r(866006),l=r(768101),d=r(786022),_=r(64479),h=r(702049),p=r(966697);class g{get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new s.yk().build(s.kk);return(0,a.i3)(e),(0,o.V)(e),(0,c.mH)(e),e}()),this._networkClientInstance}async getMusicBeats(e){var t,r,i;let o=e instanceof u.yt?e.config:e;try{let e=await this._networkClient.post(this._getApi(_.b.MUSIC_BEAT),{...this._getCommonParams(),resource_id:o.resourceId,url_from_type:o.urlFromType,workspace_id:o.workspaceId,asset_workspace_id:o.assetWorkspaceId},{withCredentials:!0});if("0"!==e.ret)return(0,n.wf)(Number(null!==(t=e.data.status_code)&&void 0!==t?t:-1),null!==(r=e.errmsg)&&void 0!==r?r:"");let i=e.data.beats,s=(0,u.ib)(o,i,{hasMore:!1,offset:0});return(0,n.oW)(s)}catch(e){return(0,n.wf)((null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.status_code)||-1,"getMusicBeats api error")}}async getMusicBeatAgreement(){try{var e;let t=await this._networkClient.post(this._getApi(_.b.MUSIC_BEAT_AGREEMENT),{...this._getCommonParams()},{withCredentials:!0});if("0"!==t.ret)return(0,n.wf)(Number(t.ret),t.errmsg);let{ai_detection:r}=JSON.parse(null!==(e=t.data.agree_privacy_policy)&&void 0!==e?e:'{"ai_detection":false}');return(0,n.oW)(r)}catch(e){return(0,l.m)(e,-1,"getMusicBeats api error")}}_getApi(e){return`${h._L.getVar("web_domain")}${e}`}_getCommonParams(){return{app_id:d.kJ,region:this._accountService.userProfile.region}}constructor(e){this._accountService=e}}g=(0,i.gn)([(0,i.fM)(0,p.Gw),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===p.Gw?Object:p.Gw])],g)},784994:function(e,t,r){r.d(t,{f:function(){return a}});var i=r(789786),n=r(402655),o=r(375503),s=r(462589);class a extends n.JT{getToken(){return this._textToSpeechRepository.getToken()}constructor(){super(),this._textToSpeechRepository=new o.$}}(0,i.gn)([(0,s.o)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype","undefined"==typeof Promise?Object:Promise)],a.prototype,"getToken",null)},910408:function(e,t,r){r.d(t,{m:function(){return i}});let i=(0,r(335290).yh)("workspace-member-data-service")},26713:function(e,t,r){r.d(t,{Z:function(){return a}});var i=r(789786),n=r(55449),o=r(402655),s=r(89683);class a extends o.JT{getMembers(e){return this._workspaceMemberRepository.getMembers(e)}constructor(e){super(),this._instantiationService=e,this._workspaceMemberRepository=this._instantiationService.createInstance(s.T)}}a=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],a)},241033:function(e,t,r){r.d(t,{Y:function(){return _}});var i=r(405051),n=r(121130),o=r(894339),s=r(768101),a=r(702049),c=r(690613),u=r(800788),l=r(114861),d=r(946561);class _{get _getWorkspacesApi(){return`${a._L.getVar("web_domain")}${d.b.GET_WOKRSPACES}`}get _networkClient(){return!this._networkClientInstance&&(this._networkClientInstance=function(){let e=new i.yk().build({headers:{"Content-Type":"application/json"}});return(0,n.i3)(e),(0,o.mH)(e),(0,l.V)(e),e}()),this._networkClientInstance}async getChanelWorkspace(e){try{let t=await this._networkClient.post(`${this._getWorkspacesApi}`,{count:1},{withCredentials:!0,params:{lite_aid:e.chanelAppId}});if("0"!==t.ret)return(0,c.wf)(Number(t.ret),t.errmsg);return(0,c.oW)(function(e){(0,u.Y2)(1===e.length);let t=e[0];return{workspaceId:t.workspace_id,name:t.name,spaceId:t.space_id,role:t.role,callerNickname:t.caller_nickname,memberLimit:t.member_limit,memberCnt:t.member_cnt,owner:t.owner,ownerName:t.owner_name,quota:t.quota,usage:t.usage,avatarColor:t.avatar_color,region:t.region,idc:Number(t.idc),spaceIdc:t.space_idc,spaceHost:t.space_host,spaceType:t.space_type,spaceResHost:t.space_res_host,rawSpaceType:t.raw_space_type,hasBrandPermission:t.has_brand_permission}}(t.data.workspace_infos))}catch(e){return(0,s.m)(e,-1,"getChanelWorkspace api error.")}}}},608339:function(e,t,r){r.d(t,{s:function(){return n}});var i=r(800788);class n{get userLocationInfo(){return this._locationInfo}updateRequestInfo(e){let{domainMap:t,locationInfo:r}=e;this._domainMap=t,this._locationInfo=r}getRequestURL(e){return(0,i.Y2)(this._domainMap,"updateRequestInfo should be call first before logic"),(0,i.Y2)(this._locationInfo,"updateRequestInfo should be call first before logic"),this._getRequestUrlImpl(e)}_getRequestUrlImpl(e){return`${this._domainMap[e.domainType]}${e.path}`}}},690465:function(e,t,r){r.d(t,{Y:function(){return o},x:function(){return s}});var i,n=r(335290);var o=((i={}).DEFAULT="default",i.TTS="tts",i.SAMI="sami",i.FRONTIER="frontier",i.COMMERCE="commerce",i.JIANYING="jianying",i);let s=(0,n.yh)("http-api-setting")},104985:function(e,t,r){r.d(t,{a:()=>_});var i=r("629687"),n=r("690613"),o=r("28791"),s=r("587892"),a=r("402655");class c extends a.JT{setLevel(e){this._level!==e&&(this._level=e,this._onDidChangeLogLevel.fire(this._level))}getLevel(){return this._level}dispose(){this._loggerService.destroy(this._label),super.dispose()}_checkLogLevel(e){return this._level<=e}constructor(e,t){super(),this._level=o.jd,this._onDidChangeLogLevel=this._register(new s.Q),this._label=e,this._loggerService=t,this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}}var u=r("685795");let l={timeZone:"Asia/Shanghai"};class d{build(){return this._contextParams}constructor(e){this._contextParams=e}}class _ extends c{debug(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!this._checkLogLevel(o.in.Debug))return;let s=(0,i.g)(e,...r);this._slardarAdapterService.sendLog(u.T.DEBUG,this._addPrefix(s),this._contextParamsBuilder.build())}info(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!this._checkLogLevel(o.in.Info))return;let s=(0,i.g)(e,...r);this._slardarAdapterService.sendLog(u.T.INFO,this._addPrefix(s),this._contextParamsBuilder.build())}warn(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(!this._checkLogLevel(o.in.Warning))return;let n=this._transformErrorMessage(e,...r);this._slardarAdapterService.sendLog(u.T.WARN,this._addPrefix(n),this._contextParamsBuilder.build())}error(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(!this._checkLogLevel(o.in.Error))return;let n=this._transformErrorMessage(e,...r);this._slardarAdapterService.sendLog(u.T.ERROR,this._addPrefix(n),this._contextParamsBuilder.build())}_addPrefix(e){return`${this._label?`[${this._label}]`:""}${this._timePrefix?`[${new Date().toLocaleString("en-US",l)}]${this._logPrefix?` [${this._logPrefix}]`:""}`:""}${e}`}_transformErrorMessage(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];let s="";return s=e instanceof Error?(0,i.g)(e.message,...r):(0,n.oi)(e)?(0,i.g)(e.toString(),...r):(0,i.g)(e,...r)}constructor(e,t,r="",i={}){var n,s,a,c,u;super(r,t),this._slardarAdapterService=e,this.setLevel(null!==(s=i.logLevel)&&void 0!==s?s:o.jd),this._timePrefix=null===(a=i.timePrefix)||void 0===a||a,this._logPrefix=null!==(c=i.logPrefix)&&void 0!==c?c:"",(null===(n=i.contextParams)||void 0===n?void 0:n.build)&&"function"==typeof i.contextParams.build?this._contextParamsBuilder=i.contextParams:this._contextParamsBuilder=new d(null!==(u=i.contextParams)&&void 0!==u?u:{})}}},725466:function(e,t,r){r.d(t,{E:function(){return n}});var i=r(402655);class n extends i.JT{getPlugins(){return this._plugins}constructor(e){super(),this._plugins=e,this.addBusinessPlugins=(e,t)=>{this._plugins.forEach(r=>{t.includes(r.type)&&r.func(e)})}}}},476624:function(e,t,r){r.d(t,{O:function(){return n}});class i{build(){return this._contextParams}constructor(e){this._contextParams=e}}class n{reportBusinessEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={...this._contextParamsBuilder.build(),...t};this._reportService.reportBusinessEvent(e,i,r)}reportBusinessEventByServer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._reportService.reportBusinessEventByServer(e,t)}reportBusinessExitEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={...this._contextParamsBuilder.build(),...t};this._reportService.reportBusinessExitEvent(e,i,r)}reportDevEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={...this._contextParamsBuilder.build(),...t};this._reportService.reportDevEvent(e,r)}reportDevError(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={};Object.entries(this._contextParamsBuilder.build()).forEach(e=>{let[t,r]=e;i[t]=String(r)}),Object.entries(r).forEach(e=>{let[t,r]=e;i[t]=r}),this._reportService.reportDevError(e,t,i)}constructor(e,t){this._reportService=t,e.build&&"function"==typeof e.build?this._contextParamsBuilder=e:this._contextParamsBuilder=new i(e)}}},786701:function(e,t,r){r.d(t,{J:function(){return a}});var i=r(230982),n=r(375197),o=r(800788),s=r(168550);class a{addTask(e){(0,o.Y2)(e.downloadType===s._5.Idle),(0,o.Y2)(!this._waitingTasks.has(e),"duplicate task.");let t=(0,i.n)(()=>e.fetch().finally(()=>{this._waitingTasks.delete(e)}),{priorityLevel:n.q.IdlePriority});this._waitingTasks.set(e,t)}removeTask(e){if(!!this._waitingTasks.has(e))this._waitingTasks.get(e).dispose(),this._waitingTasks.delete(e)}constructor(){this._waitingTasks=new Map}}},6002:function(e,t,r){r.d(t,{H:function(){return o}});var i=r(800788),n=r(168550);class o{addTask(e){(0,i.Y2)(e.downloadType===n._5.Eager),(0,i.Y2)(!this._tasks.has(e),"duplicate task."),this._waitingTasks.push(e),this._tasks.add(e),this._tryStart()}removeTask(e){let t=this._waitingTasks.indexOf(e);t>=0&&this._waitingTasks.splice(t,1),this._tasks.delete(e)}_tryStart(){this._next()}_next(){if(this._activeTasks.size===this._concurrency)return;let e=this._waitingTasks.splice(0,1)[0];if(!!e)this._executeTask(e)}_executeTask(e){this._activeTasks.add(e),e.fetch().finally(()=>{this._activeTasks.delete(e),this._tasks.delete(e),this._next()})}constructor(e){this._concurrency=e,this._activeTasks=new Set,this._waitingTasks=[],this._tasks=new Set,(0,i.Y2)(this._concurrency>0)}}},851894:function(e,t,r){r.d(t,{z:function(){return d}});var i=r(789786),n=r(168550),o=r(800788),s=r(315201),a=r(852968),c=r(127830),u=r(481710),l=r(744268);class d extends u.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,o.Y2)(!(0,s.R)(this.value));let[e,t]=(await this._autoBeautyDataService.batchGetAutoBeautyByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],resourceType:c._g.AutoBeautyBody,source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);let r=t.list[0];return{type:this.value.type,...r}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._autoBeautyDataService=i,this._configurationService=n}}d=(0,i.gn)([(0,i.fM)(2,n.tx),(0,i.fM)(3,a.X),(0,i.fM)(4,l.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IAutoBeautyBodyMeta?Object:IAutoBeautyBodyMeta,void 0===n.tx?Object:n.tx,void 0===a.X?Object:a.X,void 0===l.Ui?Object:l.Ui])],d)},970575:function(e,t,r){r.d(t,{p:function(){return d}});var i=r(789786),n=r(168550),o=r(800788),s=r(315201),a=r(852968),c=r(127830),u=r(481710),l=r(744268);class d extends u.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,o.Y2)(!(0,s.R)(this.value));let[e,t]=(await this._autoBeautyDataService.batchGetAutoBeautyByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],resourceType:c._g.AutoBeautyMakeup,source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);let r=t.list[0];return{type:this.value.type,...r}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._autoBeautyDataService=i,this._configurationService=n}}d=(0,i.gn)([(0,i.fM)(2,n.tx),(0,i.fM)(3,a.X),(0,i.fM)(4,l.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IAutoBeautyMakeupMeta?Object:IAutoBeautyMakeupMeta,void 0===n.tx?Object:n.tx,void 0===a.X?Object:a.X,void 0===l.Ui?Object:l.Ui])],d)},481710:function(e,t,r){r.d(t,{$:function(){return a}});var i=r(789786),n=r(168550),o=r(261939),s=r(277754);class a extends o.B{getContentResourceToken(){return this._getResourceTokenSync(this._createContentToken.bind(this),()=>this._contentResourceToken,e=>this._contentResourceToken=e)}_getDownloadConfig(e){return{}}_createContentToken(e){let t=this._getContentResourceKey(),r=this.getContentUrl(e);return(0,s.Dy)({key:t,url:r,md5:e.md5},this._downloadService,this._getDownloadConfig(e))}_getContentResourceKey(){return`${this.key}_content`}constructor(e,t,r){super(e,t,r),this.key=e,this._downloadService=r}}a=(0,i.gn)([(0,i.fM)(2,n.tx),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof Resource?Object:Resource,void 0===n.tx?Object:n.tx])],a)},261939:function(e,t,r){r.d(t,{B:function(){return u}});var i=r(789786),n=r(800788),o=r(315201),s=r(168550),a=r(420072),c=r(277754);class u extends a.i{getCoverResourceToken(){return this._getResourceTokenSync(this._createCoverToken.bind(this),()=>this._coverResourceToken,e=>this._coverResourceToken=e)}getCoverResourceTokenByFuzzyMatchWidth(e){return(0,n.Y2)((0,o.R)(this.value)),this.getCoverResourceToken()}_createCoverToken(e){let t=this._getCoverResourceKey(),r=this.getCover(e);return(0,c.MZ)({key:t,url:r},this._downloadService)}_getCoverResourceKey(){return`${this.key}_cover`}constructor(e,t,r){super(e,t),this.key=e,this._downloadService=r}}u=(0,i.gn)([(0,i.fM)(2,s.tx),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof Resource?Object:Resource,void 0===s.tx?Object:s.tx])],u)},507255:function(e,t,r){r.d(t,{e:function(){return s}});var i=r(789786),n=r(55449),o=r(800788);class s{add(e,t){if((0,o.Y2)(e,"key is not invalid"),this._cache.has(e))return;let r=this.createResource(e,t);r.onResourceCreated(),this._cache.set(e,r)}get(e){if(!!this._cache.has(e))return this._cache.get(e)}delete(e){if(!!this._cache.has(e))this._cache.delete(e)}constructor(e){this._instantiationService=e,this._cache=new Map}}s=(0,i.gn)([(0,i.fM)(0,n.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===n.T?Object:n.T])],s)},277754:function(e,t,r){r.d(t,{Dy:()=>g,MZ:()=>h,tT:()=>p,rW:()=>v,T0:()=>f});var i=r("959636"),n=r("397522"),o=r("747498");class s extends i.w{async doParseArrayBuffer(e){return await super.doParseArrayBuffer(e),Object.defineProperty(this.value,"file",{value:()=>e.buffer,enumerable:!0}),Promise.resolve()}}var a=r("107486"),c=r("773322");let u=new TextDecoder("utf-8"),l=e=>{if(!e)return null;let t=u.decode(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return null}};class d extends o.Q{async doParseArrayBuffer(e){await super.doParseArrayBuffer(e),await Promise.all([this._extractAttributes(),this._extractRequirements(),this._extractModelNames()])}async _extractModelNames(){var e,t,r;let i=await this.value.files(),n=l(null===(e=i["config.json"])||void 0===e?void 0:e.arrayBuffer),o=l(null===(t=i["algorithmConfig.json"])||void 0===t?void 0:t.arrayBuffer),s=new Set,a=e=>{if(!!e)Object.keys(e).forEach(t=>{let r=e[t];null==r||r.forEach(e=>null==s?void 0:s.add(e))})};a(null==n?void 0:null===(r=n.effect)||void 0===r?void 0:r.model_names),a(null==o?void 0:o.model_names),this.value.modelNames=Array.from(s)}constructor(...e){super(...e),this._extractAttributes=async()=>{var e,t,r,i,n;let o=await this.value.files(),s=l(null===(e=o["config.json"])||void 0===e?void 0:e.arrayBuffer),a=l(null===(t=o["extra.json"])||void 0===t?void 0:t.arrayBuffer),u=[],d=[];(null==s?void 0:null===(i=s.effect)||void 0===i?void 0:null===(r=i.Link)||void 0===r?void 0:r.length)&&(null==s||null===(n=s.effect)||void 0===n||n.Link.forEach(e=>{e.path&&u.push(e.path),"Filter"===e.type&&d.push({key:c.$3,defaultValue:1})})),(null==a?void 0:a.settings)&&Object.keys(a.settings).forEach(e=>{d.push({key:e,defaultValue:a.settings[e]})}),this.value.attributes=d},this._extractRequirements=async()=>{var e;let t=await this.value.files(),r=l(null===(e=t["config.json"])||void 0===e?void 0:e.arrayBuffer),i=[];(null==r?void 0:r.requirement)&&i.push(r.requirement),Object.keys(t).forEach(e=>{var r,n,o;if(/\/content.json$/.test(e)){let n=l(null===(r=t[e])||void 0===r?void 0:r.arrayBuffer);(null==n?void 0:n.requirement)&&i.push(n.requirement)}if(/^algorithmConfig.json$/.test(e)){let r=l(null===(n=t[e])||void 0===n?void 0:n.arrayBuffer);if(!(null==r?void 0:null===(o=r.nodes)||void 0===o?void 0:o.length))return;r.nodes.forEach(e=>{i.push({[e.type]:!0})})}});let n={};i.forEach(e=>{Object.keys(e).forEach(t=>{e[t]&&(n[t]=e[t])})}),this.value.requirements=n}}}let _=new Map;function h(e,t,r){if(_.has(e.key))return _.get(e.key);let n=new i.w(e,t,r);return _.set(e.key,n),n}function p(e,t,r){if(_.has(e.key))return _.get(e.key);let i=new n.D(e,t,r);return _.set(e.key,i),i}function g(e,t,r){if(_.has(e.key))return _.get(e.key);let i=new o.Q(e,t,r);return _.set(e.key,i),i}function v(e,t,r){let i=(0,a.d)(e)?`${e.key}_${e.shouldAutoDecrypt}`:e.key;if(_.has(i))return _.get(i);let n=new s(e,t,r);return _.set(i,n),n}let f=(e,t,r)=>{if(_.has(e.key))return _.get(e.key);let i=new d(e,t,r);return _.set(e.key,i),i}},420400:function(e,t,r){r.d(t,{R:function(){return s}});var i=r(475590),n=r(800788),o=r(312231);class s{get status(){return this._targetValue?o.G.complete:o.G.init}get value(){var e;return null!==(e=this._targetValue)&&void 0!==e?e:void 0}onReady(e){if(this._targetToken)return this._targetToken.onReady(e);let t=!1;return setTimeout(async()=>{if(await this._onTargetReadyDefer.promise,!t)(0,n.Y2)(this._targetToken),this._targetToken.onReady(e)}),{dispose:()=>{t=!0}}}onError(e){if(this._targetToken)return this._targetToken.onError(e);let t=!1;return setTimeout(async()=>{if(await this._onTargetReadyDefer.promise,!t)(0,n.Y2)(this._targetToken),this._targetToken.onError(e)}),{dispose:()=>{t=!0}}}start(e){if(this._targetToken)return this._targetToken.start(e);this._doTargetStart(e)}startImmediately(){return this._targetToken?this._targetToken.startImmediately():this._doTargetStartImmediately()}cancel(){if(this._targetToken)return this._targetToken.cancel();let e=this._isStartBeforeReady;return this._isStartBeforeReady=!1,e}async _doTargetStart(e){this._isStartImmediately=!!this._isStartImmediately||null!=e&&e,this._isStartBeforeReady=!0,await this._onTargetReadyDefer.promise,this._isStartBeforeReady&&((0,n.Y2)(this._targetToken),this._targetToken.start(this._isStartImmediately))}async _doTargetStartImmediately(){await this._onTargetReadyDefer.promise,(0,n.Y2)(this._targetToken),this._targetToken.startImmediately()}async _doCreateResourceToken(){this._targetToken=await this._resourceTokenBuilder(),this._targetValue=this._targetToken.value,this._onTargetReadyDefer.resolve(this._targetToken)}constructor(e){this._resourceTokenBuilder=e,this._isStartImmediately=!1,this._isStartBeforeReady=!1,this._onTargetReadyDefer=(0,i.PQ)(),this._doCreateResourceToken()}}},655650:function(e,t,r){r.d(t,{d:function(){return l}});var i=r(789786),n=r(643625),o=r(168550),s=r(800788),a=r(315201),c=r(481710),u=r(744268);class l extends c.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}get contentFileBubble(){return e=>e.endsWith(".json")}async doFetch(){(0,s.Y2)(!(0,a.R)(this.value));let[e,t]=(await this._bubbleDataService.batchGetBubblesByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._bubbleDataService=i,this._configurationService=n}}l=(0,i.gn)([(0,i.fM)(2,o.tx),(0,i.fM)(3,n.V),(0,i.fM)(4,u.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IBubbleMeta?Object:IBubbleMeta,void 0===o.tx?Object:o.tx,void 0===n.V?Object:n.V,void 0===u.Ui?Object:u.Ui])],l)},998170:function(e,t,r){r.d(t,{x:function(){return l}});var i=r(789786),n=r(168550),o=r(800788),s=r(315201),a=r(117082),c=r(744268),u=r(464954);class l extends u.m{getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,o.Y2)(!(0,s.R)(this.value));let[e,t]=(await this._emojiDataService.batchGetEmojisByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._emojiDataService=i,this._configurationService=n}}l=(0,i.gn)([(0,i.fM)(2,n.tx),(0,i.fM)(3,a.l),(0,i.fM)(4,c.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IEmojiMeta?Object:IEmojiMeta,void 0===n.tx?Object:n.tx,void 0===a.l?Object:a.l,void 0===c.Ui?Object:c.Ui])],l)},397583:function(e,t,r){r.d(t,{M:function(){return d}});var i=r(789786),n=r(416347),o=r(168550),s=r(800788),a=r(315201),c=r(744268),u=r(261939),l=r(277754);class d extends u.B{getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}getContentResourceToken(){return this._getResourceTokenSync(this._createContentToken.bind(this),()=>this._contentResourceToken,e=>this._contentResourceToken=e)}_createContentToken(e){let t=this._getContentResourceKey(),r=this.getContentUrl(e);return(0,l.T0)({key:t,url:r},this._downloadService)}_getContentResourceKey(){return`${this.key}_content`}async doFetch(){(0,s.Y2)(!(0,a.R)(this.value));let[e,t]=(await this._imageFigureEffectDataService.batchGetEffectByIds({enterFrom:this._configurationService.editorCategory,list:[{ids:[this.value.resourceId],type:this._configurationService.resourcePanel[this.resourceType]}]})).pair();if(e)throw Error(`doFetch error ${e.code}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._imageFigureEffectDataService=i,this._configurationService=n}}d=(0,i.gn)([(0,i.fM)(2,o.tx),(0,i.fM)(3,n.x),(0,i.fM)(4,c.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IImageFigureEffectMeta?Object:IImageFigureEffectMeta,void 0===o.tx?Object:o.tx,void 0===n.x?Object:n.x,void 0===c.Ui?Object:c.Ui])],d)},602923:function(e,t,r){r.d(t,{W:()=>_});var i=r("789786");let n=(0,r("335290").yh)("image-filter-data-service");var o=r("127830"),s=r("168550"),a=r("800788"),c=r("315201"),u=r("744268"),l=r("261939"),d=r("277754");new TextDecoder("utf-8");class _ extends l.B{getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}getContentResourceToken(){return this._getResourceTokenSync(this._createContentToken.bind(this),()=>this._contentResourceToken,e=>this._contentResourceToken=e)}_createContentToken(e){let t=this._getContentResourceKey(),r=this.getContentUrl(e);return(0,d.T0)({key:t,url:r},this._downloadService)}_getContentResourceKey(){return`${this.key}_content`}async doFetch(){(0,a.Y2)(!(0,c.R)(this.value));let[e,t]=(await this._imageFilterDataService.batchGetImageFiltersByIds({enterFrom:this._configurationService.editorCategory,list:[{ids:[this.value.resourceId],type:this._configurationService.resourcePanel[o._g.ImageEffect]}]})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._imageFilterDataService=i,this._configurationService=n}}_=(0,i.gn)([(0,i.fM)(2,s.tx),(0,i.fM)(3,n),(0,i.fM)(4,u.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IImageFilterMeta?Object:IImageFilterMeta,void 0===s.tx?Object:s.tx,void 0===n?Object:n,void 0===u.Ui?Object:u.Ui])],_)},107486:function(e,t,r){function i(e){return void 0!==e.decryptKey}r.d(t,{d:function(){return i},n:function(){return o}});var n,o=((n={}).init="init",n.fetching="fetching",n.complete="complete",n.error="error",n)},63726:function(e,t,r){r.d(t,{T:function(){return h}});var i=r(789786),n=r(462235),o=r(168550),s=r(277754),a=r(690613),c=r(800788),u=r(315201),l=r(261939),d=r(109685),_=r(396190);class h extends l.B{getCover(e){return e.coverUrl}getContentResourceToken(){return this._getResourceTokenSync(this._createContentResourceToken.bind(this),()=>this._contentResourceToken,e=>this._contentResourceToken=e)}async getContentOrderedResourceToken(){if(await this._onResourceReadyDefer.promise,(0,c.Y2)((0,u.R)(this.value)),this._contentOrderedResourceToken)return(0,a.oW)(this._contentOrderedResourceToken);if(!(0,d.uS)(this.value))return(0,a.oW)(this.getContentResourceToken());if((0,d.ko)(this.value))return(0,a.oW)(this._createContentOrderedResourceToken(this.value));let e=this.value.order,t=await this._photoDataService.order({id:e.id});if(!t.ok)return t;let{url:r}=t.value;return this.value.order.url=r,(0,a.oW)(this._createContentOrderedResourceToken(this.value))}getContentResolutionInfo(){return(0,c.Y2)((0,u.R)(this.value)),this._getPhotoResolutionInfo(this.value)}getIfNeedCredential(){return(0,c.Y2)((0,u.R)(this.value)),!!this.value.isFromBrand}_createCoverToken(e){let t=this._getCoverResourceKey(),r=this.getCover(e);return(0,s.MZ)({key:t,url:r},this._downloadService,this._getDownloadConfig(e))}_createContentResourceToken(e){let{url:t,resolution:r}=this._getPhotoResolutionInfo(e),i=this._getResolutionResourceKey(r);return(0,s.MZ)({key:i,url:t,md5:e.md5},this._downloadService,{withCredentials:e.isFromBrand})}_getDownloadConfig(e){return{withCredentials:e.isFromBrand}}_createContentOrderedResourceToken(e){(0,c.Y2)((0,u.R)(this.value));let{url:t,resolution:r}=this.getPhotoOrderedResolutionInfo(),i=this._getOrderedResolutionResourceKey();return this._contentOrderedResourceToken=(0,s.MZ)({key:i,url:t,md5:e.md5},this._downloadService),this._contentOrderedResourceToken}_getResolutionResourceKey(e){return`${this.key}_resolution_${e}`}_getOrderedResolutionResourceKey(){return`${this.key}_ordered`}_getPhotoResolutionInfo(e){let t=e.transcode.map(e=>{let{url:t,width:r,height:i}=e;return{url:t,resolution:this._getResolutionKeyByLongSide(r,i)}}).filter(e=>e.resolution);for(let e of this._environmentService.isAutoTest?["720p","1024p","540p","480p","360p","288p"]:["480p","720p","360p","540p","1024p","288p"]){let r=t.find(t=>t.resolution===e);if(r)return r}return{url:e.originUrl,resolution:"origin"}}getPhotoOrderedResolutionInfo(){return((0,c.Y2)((0,u.R)(this.value)),this.value.order)?((0,c.Y2)(this.value.order.url),{url:this.value.order.url,resolution:"origin"}):this.getContentResolutionInfo()}_getResolutionKeyByLongSide(e,t){let r=100,i=null;for(let n of[1024,720,540,480,360,288]){let o;(o=e>t?Math.abs(n-e):Math.abs(n-t))<r&&(r=o,i=n)}if(!!i)return`${i}p`}async doFetch(){(0,c.Y2)(!(0,u.R)(this.value));let[e,t]=(await this._photoDataService.batchGetPhotos({resourceIds:[this.value.resourceId]})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._photoDataService=i,this._environmentService=n}}h=(0,i.gn)([(0,i.fM)(2,o.tx),(0,i.fM)(3,n.B),(0,i.fM)(4,_.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IPhotoMeta?Object:IPhotoMeta,void 0===o.tx?Object:o.tx,void 0===n.B?Object:n.B,void 0===_.Y?Object:_.Y])],h)},483268:function(e,t,r){r.d(t,{z:()=>ti});var i=r("789786"),n=r("861810"),o=r("55449"),s=r("800788"),a=r("127830"),c=r("507255"),u=r("784104");class l extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(u.e,[e,t]))}constructor(e){super(e),this._instantiationService=e}}l=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],l);var d=r("396190"),_=r("961087"),h=r("968944");class p extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(h.p,[e,t]))}constructor(e){super(e),this._instantiationService=e}}p=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],p);class g{async load(){this.environmentService.isProd?this._svgResource=await r.e("9433").then(r.t.bind(r,421687,19)):this._svgResource=await r.e("4717").then(r.t.bind(r,86573,19)),this.initAwaitLock.initDone()}get(e){(0,s.ZB)(this._svgResource);let t=this._svgResource.svgMap.find(t=>t.id===e);return null==t?void 0:t.svg}getAll(){return this._svgResource}constructor(e){this.environmentService=e,this.initAwaitLock=new _.G}}g=(0,i.gn)([(0,i.fM)(0,d.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===d.Y?Object:d.Y])],g);var v=r("168550"),f=r("277754"),m=r("315201"),y=r("249656"),w=r("378481"),k=r("261939");class b extends k.B{getCover(e){return e.coverUrl}getAudioResourceToken(){return this._getResourceTokenSync(this._createAudioResourceToken.bind(this),()=>this._audioResourceToken,e=>this._audioResourceToken=e)}getAudioResourceDecryptKey(){return(0,s.Y2)((0,m.R)(this.value)),this.value?this.value.decryptKey:void 0}_createAudioResourceToken(e){let{originUrl:t}=e,r=this._getAudioResourceKey();if(e.isFromBrand){var i;return(0,f.MZ)({key:r,url:t,decryptKey:null!==(i=e.decryptKey)&&void 0!==i?i:"",shouldAutoDecrypt:!1,encryptType:y.PS.AES_GCM},this._downloadService,{withCredentials:e.isFromBrand})}return(0,f.MZ)({key:r,url:t,md5:e.md5},this._downloadService)}_getAudioResourceKey(){return`${this.key}_audio_${this.value.resourceId}`}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let{audioType:e}=this.value,[t,r]=(await this._audioDataService.batchGetAudios({resourceIds:[this.value.resourceId],audioResourceType:e})).pair();if(t)throw Error(`doFetch error-${t.code}-${t.msg}`);return{type:this.value.type,...r.list[0]}}constructor(e,t,r,i){super(e,t,r),this.key=e,this._downloadService=r,this._audioDataService=i}}b=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,w.F),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IAudioMeta?Object:IAudioMeta,void 0===v.tx?Object:v.tx,void 0===w.F?Object:w.F])],b);class S extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(b,[e,t]))}constructor(e){super(e),this._instantiationService=e}}S=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],S);var R=r("35216"),C=r("549447"),I=r("59315"),P=r("744268"),E=r("464954");class A extends E.m{getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._integrationDataService.batchGetIntegrationsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._integrationDataService=i,this._configurationService=n}}A=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,I.m),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IIntegrationMeta?Object:IIntegrationMeta,void 0===v.tx?Object:v.tx,void 0===I.m?Object:I.m,void 0===P.Ui?Object:P.Ui])],A);class M extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(A,[e,t]))}constructor(e){super(e),this._instantiationService=e}}M=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],M);var O=r("110146"),x=r("966442"),D=r("49713"),B=r("628178");class V extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(B.k,[e,t]))}constructor(e){super(e),this._instantiationService=e}}V=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],V);var F=r("131829");class U extends k.B{getCover(e){return e.previewUrl}getVideoBackgroundResourceToken(){return this._getResourceTokenSync(this._createVideoBackgroundResourceToken.bind(this),()=>this._videoBackgroundResourceToken,e=>this._videoBackgroundResourceToken=e)}_createVideoBackgroundResourceToken(e){let t=e.package.urlList[0],r=this._getVideoBackgroundResourceResourceKey();return(0,f.MZ)({key:r,url:t},this._downloadService,this._getDownloadConfig(e))}_getVideoBackgroundResourceResourceKey(){return`${this.key}_resource`}_getDownloadConfig(e){return{withCredentials:e.isFromBrand}}async doFetch(){let[e,t]=(await this._videoBackgroundDataService.batchGetVideoBackgroundsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._videoBackgroundDataService=i,this._configurationService=n}}U=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,F.k),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IVideoBackgroundMeta?Object:IVideoBackgroundMeta,void 0===v.tx?Object:v.tx,void 0===F.k?Object:F.k,void 0===P.Ui?Object:P.Ui])],U);class G extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(U,[e,t]))}constructor(e){super(e),this._instantiationService=e}}G=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],G);var L=r("789374"),j=r("604837"),H=r("987272"),N=r("927221"),$=r("481710");class Y extends $.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._stickerMotionDataService.batchGetStickerMotionsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._stickerMotionDataService=i,this._configurationService=n}}Y=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,N.i),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IStickerMotionMeta?Object:IStickerMotionMeta,void 0===v.tx?Object:v.tx,void 0===N.i?Object:N.i,void 0===P.Ui?Object:P.Ui])],Y);class q extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(Y,[e,t]))}constructor(e){super(e),this._instantiationService=e}}q=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],q);var W=r("366845"),K=r("354078"),Q=r("852968");class J extends $.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._autoBeautyDataService.batchGetAutoBeautyByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],resourceType:a._g.AutoBeautyFace,source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);let r=t.list[0];return{type:this.value.type,...r}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._autoBeautyDataService=i,this._configurationService=n}}J=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,Q.X),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IAutoBeautyFaceMeta?Object:IAutoBeautyFaceMeta,void 0===v.tx?Object:v.tx,void 0===Q.X?Object:Q.X,void 0===P.Ui?Object:P.Ui])],J);class Z extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(J,[e,t]))}constructor(e){super(e),this._instantiationService=e}}Z=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],Z);class z extends $.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._autoBeautyDataService.batchGetAutoBeautyByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],resourceType:a._g.AutoBeautyShape,source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);let r=t.list[0];return{type:this.value.type,...r}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._autoBeautyDataService=i,this._configurationService=n}}z=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,Q.X),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IAutoBeautyShapeMeta?Object:IAutoBeautyShapeMeta,void 0===v.tx?Object:v.tx,void 0===Q.X?Object:Q.X,void 0===P.Ui?Object:P.Ui])],z);class X extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(z,[e,t]))}constructor(e){super(e),this._instantiationService=e}}X=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],X);var ee=r("257856"),et=r("519633");class er extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(et.D,[e,t]))}constructor(e){super(e),this._instantiationService=e}}er=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],er);var ei=r("498768");class en extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(ei.U,[e,t]))}constructor(e){super(e),this._instantiationService=e}}en=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],en);var eo=r("921836");class es extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eo.C,[e,t]))}constructor(e){super(e),this._instantiationService=e}}es=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],es);var ea=r("463144");class ec extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(ea.I,[e,t]))}constructor(e){super(e),this._instantiationService=e}}ec=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],ec);var eu=r("680140");class el extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eu.W,[e,t]))}constructor(e){super(e),this._instantiationService=e}}el=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],el);var ed=r("345514"),e_=r("317419");class eh extends $.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._effectDataService.batchGetEffectsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],effectResourceType:this.value.type,source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._effectDataService=i,this._configurationService=n}}eh=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,e_.s),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IEffectMeta?Object:IEffectMeta,void 0===v.tx?Object:v.tx,void 0===e_.s?Object:e_.s,void 0===P.Ui?Object:P.Ui])],eh);class ep extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eh,[e,t]))}constructor(e){super(e),this._instantiationService=e}}ep=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],ep);var eg=r("845523"),ev=r("272421");class ef extends ev.R{getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}get contentFileFilter(){return e=>"config.json"===e}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let e=this._configurationService.getAppConfigurationValue("toolbar.tts.fromHeycan"),[t,r]=(await this._toneDataService.batchGetTonesByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source},e?eg.i.Heycan:eg.i.Loki)).pair();if(t)throw Error(`doFetch error-${t.code}-${t.msg}`);return{type:this.value.type,...r.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._toneDataService=i,this._configurationService=n}}ef=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,eg.T),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IToneMeta?Object:IToneMeta,void 0===v.tx?Object:v.tx,void 0===eg.T?Object:eg.T,void 0===P.Ui?Object:P.Ui])],ef);class em extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(ef,[e,t]))}constructor(e){super(e),this._instantiationService=e}}em=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],em);var ey=r("342565"),eT=r("779843"),ew=r("881961");class ek extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(ew.k,[e,t]))}constructor(e){super(e),this._instantiationService=e}}ek=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],ek);var eb=r("850513");class eS extends $.${getPresetSchemaResourceToken(){return this._getResourceTokenSync(this._createPresetSchemaToken.bind(this),()=>this._presetSchemaResourceToken,e=>this._presetSchemaResourceToken=e)}getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}_getDownloadConfig(e){return{withCredentials:e.isFromBrand}}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value)),(0,s.Y2)(this.value.resourceId,"text preset should have an resource id");let[e,t]=(await this._textPresetDataService.getTextByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}_createPresetSchemaToken(e){(0,s.ZB)(e.presetSchemaUrl);let t=this._getPresetSchemaResourceKey();return(0,f.MZ)({key:t,url:e.presetSchemaUrl},this._downloadService,{withCredentials:!0})}_getPresetSchemaResourceKey(){return`${this.key}_preset_schema`}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._textPresetDataService=i,this._configurationService=n}}eS=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,eb.J),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof ITextPresetMeta?Object:ITextPresetMeta,void 0===v.tx?Object:v.tx,void 0===eb.J?Object:eb.J,void 0===P.Ui?Object:P.Ui])],eS);class eR extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eS,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eR=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eR);var eC=r("359413"),eI=r("358872"),eP=r("777512"),eE=r("759544"),eA=r("287524");class eM extends $.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._graffitiDataService.batchGetGraffitisByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._graffitiDataService=i,this._configurationService=n}}eM=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,eA.a),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IGraffitiMeta?Object:IGraffitiMeta,void 0===v.tx?Object:v.tx,void 0===eA.a?Object:eA.a,void 0===P.Ui?Object:P.Ui])],eM);class eO extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eM,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eO=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eO);var ex=r("100808");class eD extends $.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}get contentFilePathAnimation(){return e=>e.endsWith(".json")}async doFetch(){(0,s.Y2)(!(0,m.R)(this.value));let[e,t]=(await this._pathAnimationDataService.batchGetPathAnimationsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId]})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._pathAnimationDataService=i,this._configurationService=n}}eD=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,ex.g),(0,i.fM)(4,P.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IPathAnimationMeta?Object:IPathAnimationMeta,void 0===v.tx?Object:v.tx,void 0===ex.g?Object:ex.g,void 0===P.Ui?Object:P.Ui])],eD);class eB extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eD,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eB=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eB);var eV=r("280478");class eF extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eV.g,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eF=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eF);var eU=r("609366"),eG=r("421598");class eL extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eG.D,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eL=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eL);var ej=r("15130"),eH=r("991907"),eN=r("782057"),e$=r("619282"),eY=r("189294");class eq extends k.B{getCover(e){return e.coverUrl}doFetch(){(0,s.ss)("dreamina user ai video should not trigger doFetch ")}getVideoResourceToken(){return this._getResourceTokenSync(this._createDreaminaAiVideoResourceToken.bind(this),()=>this._dreaminaAiVideoResourceToken,e=>this._dreaminaAiVideoResourceToken=e)}_createDreaminaAiVideoResourceToken(e){(0,s.Y2)((0,m.R)(e));let t=e.video.originVideo.videoUrl,{key:r}=e;return this._dreaminaAiVideoResourceToken=(0,f.MZ)({key:r,url:t},this._downloadService),this._dreaminaAiVideoResourceToken}constructor(e,t,r){super(e,t,r),this.key=e,this._downloadService=r}}eq=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IDreaminaAiVideoMeta?Object:IDreaminaAiVideoMeta,void 0===v.tx?Object:v.tx])],eq);class eW extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eq,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eW=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eW);class eK extends k.B{getVideoResolutionInfo(){var e,t;return(0,s.Y2)((0,m.R)(this.value)),{url:null!==(t=null===(e=this.value.video)||void 0===e?void 0:e.originVideo.videoUrl)&&void 0!==t?t:"",resolution:"origin"}}getThumbResourceTokens(){return this._getResourceTokenAsync(this._createUserVideoThumbTokens.bind(this),()=>this._dreaminaVideoThumbResourceTokens,e=>this._dreaminaVideoThumbResourceTokens=e)}getCover(e){return e.coverUrl}doFetch(){(0,s.ss)("dreamina user ai video should not trigger doFetch ")}getVideoResourceToken(){return this._getResourceTokenSync(this._createDreaminaUserAiVideoResourceToken.bind(this),()=>this._dreaminaUserAiVideoResourceToken,e=>this._dreaminaUserAiVideoResourceToken=e)}_createDreaminaUserAiVideoResourceToken(e){var t,r;(0,s.Y2)((0,m.R)(e)),(0,s.Y2)(null==e?void 0:null===(r=e.video)||void 0===r?void 0:null===(t=r.originVideo)||void 0===t?void 0:t.videoUrl);let i=e.video.originVideo.videoUrl,{key:n}=e,o=this._getVideoResourceKey(n,i);return this._dreaminaUserAiVideoResourceToken=(0,f.MZ)({key:o,url:i},this._downloadService),this._dreaminaUserAiVideoResourceToken}_getVideoResourceKey(e,t){return`${e}_${t}`}_getThumbResourceKey(e){return`${this.key?`${this.key}_`:""}thumb_${e}`}_createUserVideoThumbTokens(e){var t,r,i;(0,s.Y2)(null===(t=e.video)||void 0===t?void 0:t.thumb);let{singleFrameWidth:n,singleFrameHeight:o}=null===(r=e.video)||void 0===r?void 0:r.thumb.thumbCommonInfo;return this._dreaminaVideoThumbResourceTokens=null===(i=e.video)||void 0===i?void 0:i.thumb.detailInfos.map(e=>{let t=this._getThumbResourceKey(e.url),r={frameCount:e.frameCount,singleFrameWidth:n,singleFrameHeight:o,imageWidth:e.imageWidth,imageHeight:e.imageHeight};return(0,f.MZ)({key:t,url:e.url,...r},this._downloadService)}),this._dreaminaVideoThumbResourceTokens}constructor(e,t,r,i){super(e,t,r),this.key=e,this._downloadService=r,this._environmentService=i,(0,m.K)(this.value)}}eK=(0,i.gn)([(0,i.fM)(2,v.tx),(0,i.fM)(3,d.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IDreaminaUserAiVideoMeta?Object:IDreaminaUserAiVideoMeta,void 0===v.tx?Object:v.tx,void 0===d.Y?Object:d.Y])],eK);class eQ extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(eK,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eQ=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eQ);var eJ=r("906022"),eZ=r("195117"),ez=r("771708");class eX extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(ez.q,[e,t]))}constructor(e){super(e),this._instantiationService=e}}eX=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],eX);var e0=r("602131");class e1 extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(e0.d,[e,t]))}constructor(e){super(e),this._instantiationService=e}}e1=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],e1);class e6 extends k.B{getCover(e){return e.url}doFetch(){(0,s.ss)("dreamina lipsync audio should not trigger doFetch ")}}class e2 extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(e6,[e,t]))}constructor(e){super(e),this._instantiationService=e}}e2=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],e2);var e3=r("203388");class e8 extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(e3.j,[e,t]))}constructor(e){super(e),this._instantiationService=e}}e8=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],e8);var e7=r("555938"),e9=r("339381");class e4 extends c.e{createResource(e,t){return this._instantiationService.createInstance(new n.M(e9.t,[e,t]))}constructor(e){super(e),this._instantiationService=e}}e4=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],e4);var e5=r("959675"),te=r("189404"),tt=r("525393"),tr=r("693967");class ti{add(e,t){this._getChildResourceService(t.type).add(e,t)}get(e,t){return this._getChildResourceService(t).get(e)}delete(e,t){this._getChildResourceService(t).delete(e,t)}_getChildResourceService(e){let t=this._childResourceServices.get(e);if(!t){let r=this._childResourceServiceCreator.get(e);if((0,s.Y2)(r,`${e} ResourceService has not register yet. please register it at the resource service constructor!`),r instanceof Function){let e=r();t=this._instantiationService.createInstance(e)}else t=this._instantiationService.createInstance(...r);this._childResourceServices.set(e,t)}return t}_buildTextTemplateResourceServiceSyncDescriptorCreator(){return()=>{let e=[a._g.Font,a._g.Sticker,a._g.TextPreset,a._g.TextMotion,a._g.VideoMotion,a._g.StickerMotion,a._g.ShapeAnimation].map(e=>this._getChildResourceService(e));return new n.M(eC.U,e)}}_buildSubtitleTemplateResourceServiceSyncDescriptorCreator(){return()=>{let e=[a._g.Font,a._g.Sticker,a._g.TextPreset,a._g.TextMotion,a._g.VideoMotion,a._g.StickerMotion,a._g.ShapeAnimation].map(e=>this._getChildResourceService(e));return new n.M(eY.c,e)}}constructor(e){this._childResourceServiceCreator=new Map,this._childResourceServices=new Map,this._instantiationService=e,this._childResourceServiceCreator.set(a._g.TextTemplate,this._buildTextTemplateResourceServiceSyncDescriptorCreator()),this._childResourceServiceCreator.set(a._g.SubtitleTemplate,this._buildSubtitleTemplateResourceServiceSyncDescriptorCreator()),this._childResourceServiceCreator.set(a._g.Font,[er]),this._childResourceServiceCreator.set(a._g.Video,[l]),this._childResourceServiceCreator.set(a._g.Shape,[p]),this._childResourceServiceCreator.set(a._g.Photo,[R.y]),this._childResourceServiceCreator.set(a._g.Audio,[S]),this._childResourceServiceCreator.set(a._g.Mask,[x.C]),this._childResourceServiceCreator.set(a._g.Sticker,[en]),this._childResourceServiceCreator.set(a._g.VideoTemplate,[el]),this._childResourceServiceCreator.set(a._g.AutoBeautyBody,[K.v]),this._childResourceServiceCreator.set(a._g.AutoBeautyFace,[Z]),this._childResourceServiceCreator.set(a._g.AutoBeautyShape,[X]),this._childResourceServiceCreator.set(a._g.AutoBeautyMakeup,[ee._]),this._childResourceServiceCreator.set(a._g.Bubble,[eP.c]),this._childResourceServiceCreator.set(a._g.VideoBackground,[G]),this._childResourceServiceCreator.set(a._g.UserVideo,[L.t]),this._childResourceServiceCreator.set(a._g.UserPhoto,[W.o]),this._childResourceServiceCreator.set(a._g.UserAudio,[ec]),this._childResourceServiceCreator.set(a._g.UserFile,[es]),this._childResourceServiceCreator.set(a._g.Transition,[D.E]),this._childResourceServiceCreator.set(a._g.TextMotion,[j.J]),this._childResourceServiceCreator.set(a._g.VideoMotion,[H.h]),this._childResourceServiceCreator.set(a._g.StickerMotion,[q]),this._childResourceServiceCreator.set(a._g.ArithmeticModel,[ed.K]),this._childResourceServiceCreator.set(a._g.Effects,[ep]),this._childResourceServiceCreator.set(a._g.FaceProp,[ep]),this._childResourceServiceCreator.set(a._g.Filter,[ey.C]),this._childResourceServiceCreator.set(a._g.CurveSpeed,[eT.l]),this._childResourceServiceCreator.set(a._g.Mix,[ek]),this._childResourceServiceCreator.set(a._g.TextPreset,[eR]),this._childResourceServiceCreator.set(a._g.Tone,[em]),this._childResourceServiceCreator.set(a._g.VoiceChange,[V]),this._childResourceServiceCreator.set(a._g.CurvePreset,[C.R]),this._childResourceServiceCreator.set(a._g.Integration,[M]),this._childResourceServiceCreator.set(a._g.ObjectLock,[O.q]),this._childResourceServiceCreator.set(a._g.Gif,[eI.k]),this._childResourceServiceCreator.set(a._g.ShapeAnimation,[eE.P]),this._childResourceServiceCreator.set(a._g.Graffiti,[eO]),this._childResourceServiceCreator.set(a._g.PathAnimation,[eB]),this._childResourceServiceCreator.set(a._g.AiAvatarMask,[eF]),this._childResourceServiceCreator.set(a._g.Emoji,[eU.C]),this._childResourceServiceCreator.set(a._g.SmartColorAdjust,[eL]),this._childResourceServiceCreator.set(a._g.AdjustmentPreset,[ej.x]),this._childResourceServiceCreator.set(a._g.DigitalHuman,[eH.g]),this._childResourceServiceCreator.set(a._g.ImageFilter,[e$.z]),this._childResourceServiceCreator.set(a._g.ImageEffect,[e$.z]),this._childResourceServiceCreator.set(a._g.ImageFigureFaceEffect,[eN.i]),this._childResourceServiceCreator.set(a._g.ImageFigureMakeupEffect,[eN.i]),this._childResourceServiceCreator.set(a._g.ImageFigureBodyEffect,[eN.i]),this._childResourceServiceCreator.set(a._g.ImageFigureReshapeEffect,[eN.i]),this._childResourceServiceCreator.set(a._g.DreaminaAiVideo,[eW]),this._childResourceServiceCreator.set(a._g.DreaminaUserAiVideo,[eQ]),this._childResourceServiceCreator.set(a._g.DreaminaShowCaseVideo,[eJ.h]),this._childResourceServiceCreator.set(a._g.TextGlow,[eZ.z]),this._childResourceServiceCreator.set(a._g.PhotoDreamina,[eX]),this._childResourceServiceCreator.set(a._g.CurveHSL,[e1]),this._childResourceServiceCreator.set(a._g.DreaminaLipSyncAudio,[e2]),this._childResourceServiceCreator.set(a._g.VideoDreamina,[e8]),this._childResourceServiceCreator.set(a._g.MattingStroke,[e7.U]),this._childResourceServiceCreator.set(a._g.TextArt,[e4]),this._childResourceServiceCreator.set(a._g.TextArtIcon,[e5.t]),this._childResourceServiceCreator.set(a._g.ImageSource,[te.V]),this._childResourceServiceCreator.set(a._g.TemplatePhotoDreamina,[tt.e]),this._childResourceServiceCreator.set(a._g.VodVideoSource,[tr._])}}ti=(0,i.gn)([(0,i.fM)(0,o.T),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0===o.T?Object:o.T])],ti)},583039:function(e,t,r){r.d(t,{X:function(){return i}});let i=(0,r(335290).yh)("shape-animation-resource-service")},822796:function(e,t,r){r.d(t,{p:function(){return i}});let i=(0,r(335290).yh)("sticker-motion-resource-service")},843883:function(e,t,r){r.d(t,{G:function(){return l}});var i=r(789786),n=r(541295),o=r(168550),s=r(800788),a=r(315201),c=r(481710),u=r(744268);class l extends c.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,a.R)(this.value));let[e,t]=(await this._textGlowDataService.batchGetTextGlowsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._textGlowDataService=i,this._configurationService=n}}l=(0,i.gn)([(0,i.fM)(2,o.tx),(0,i.fM)(3,n.Z),(0,i.fM)(4,u.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof ITextGlowMeta?Object:ITextGlowMeta,void 0===o.tx?Object:o.tx,void 0===n.Z?Object:n.Z,void 0===u.Ui?Object:u.Ui])],l)},635761:function(e,t,r){r.d(t,{B:function(){return l}});var i=r(789786),n=r(196563),o=r(168550),s=r(800788),a=r(315201),c=r(481710),u=r(744268);class l extends c.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,a.R)(this.value));let[e,t]=(await this._textMotionDataService.batchGetTextMotionsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._textMotionDataService=i,this._configurationService=n}}l=(0,i.gn)([(0,i.fM)(2,o.tx),(0,i.fM)(3,n.j),(0,i.fM)(4,u.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof ITextMotionMeta?Object:ITextMotionMeta,void 0===o.tx?Object:o.tx,void 0===n.j?Object:n.j,void 0===u.Ui?Object:u.Ui])],l)},663393:function(e,t,r){r.d(t,{u:function(){return k}});var i=r(789786),n=r(358243),o=r(127830),s=r(168550),a=r(800788),c=r(315201),u=r(481710),l=r(186872),d=r(694471),_=r(822796),h=r(549611),p=r(966139),g=r(850592),v=r(583039),f=r(318303),m=r(744268),y=r(277754),w=r(320271);class k extends u.${getPresetSchemaResourceToken(){return this._getResourceTokenSync(this._createPresetSchemaToken.bind(this),()=>this._presetSchemaResourceToken,e=>this._presetSchemaResourceToken=e)}_createPresetSchemaToken(e){(0,a.ZB)(e.presetSchemaUrl);let t=this._getPresetSchemaResourceKey();return(0,y.MZ)({key:t,url:e.presetSchemaUrl},this._downloadService,{withCredentials:!0})}_getPresetSchemaResourceKey(){return`${this.key}_preset_schema`}getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,a.Y2)(!(0,c.R)(this.value));let[e,t]=(await this._textTemplateDataService.getTextByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId]})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}_getResourceKey(e){return`${e.type}_${e.key}`}_doResourceReady(e){super._doResourceReady(e),this.parseAndInitChildResources()}parseAndInitChildResources(){for(let e of this.dependencyResources)switch(e.type){case o._g.Font:this._fontResourceService.add(this._getResourceKey(e),{...e,key:this._getResourceKey(e),resourceId:e.key});break;case o._g.TextMotion:this._textMotionResourceService.add(this._getResourceKey(e),{...e,key:this._getResourceKey(e),resourceId:e.key});break;case o._g.StickerMotion:this._stickerMotionResourceService.add(this._getResourceKey(e),{...e,key:this._getResourceKey(e),resourceId:e.key});break;case o._g.Sticker:this._stickerResourceService.add(this._getResourceKey(e),{...e,key:this._getResourceKey(e),resourceId:e.key});break;case o._g.TextPreset:this._textPresetResourceService.add(this._getResourceKey(e),{...e,key:this._getResourceKey(e),resourceId:e.key});break;case o._g.ShapeAnimation:this._shapeAnimationResourceService.add(this._getResourceKey(e),{...e,key:this._getResourceKey(e),resourceId:e.key});break;case o._g.SystemFonts:break;default:(0,a.ss)("unsupported child resource type in text template resource!")}}getBuiltinContentTokens(){return this.dependencyResources.map(e=>{switch(e.type){case o._g.Font:let t=this._fontResourceService.get(this._getResourceKey(e));return(0,a.Y2)(t),t.getContentResourceToken();case o._g.TextMotion:let r=this._textMotionResourceService.get(this._getResourceKey(e));return(0,a.Y2)(r),r.getContentResourceToken();case o._g.StickerMotion:let i=this._stickerMotionResourceService.get(this._getResourceKey(e));return(0,a.Y2)(i),i.getContentResourceToken();case o._g.Sticker:let n=this._stickerResourceService.get(this._getResourceKey(e));return(0,a.Y2)(n),n.getContentResourceToken();case o._g.TextPreset:let s=this._textPresetResourceService.get(this._getResourceKey(e));return(0,a.Y2)(s),s.getContentResourceToken();case o._g.ShapeAnimation:let c=this._shapeAnimationResourceService.get(this._getResourceKey(e));return(0,a.Y2)(c),c.getContentResourceToken();case o._g.SystemFonts:return;default:(0,a.ss)("unsupported child resource type in text template resource!")}}).filter(e=>void 0!==e)}get dependencyResources(){var e;return(0,a.Y2)((0,c.R)(this.value),"resource is not ready yet! please call this function after resource ready."),(null!==(e=this.value.dependentResources)&&void 0!==e?e:[]).map(e=>((0,a.Y2)(e.resourceId,"dependency resource should have a resource id"),{type:(0,f.e)(w.j7[e.type]||e.type,this._configurationService.resourcePanel),source:e.source,key:e.resourceId}))}constructor(e,t,r,i,n,o,s,a,c,u,l,d){super(e,t,u),this.key=e,this._fontResourceService=r,this._stickerResourceService=i,this._textPresetResourceService=n,this._textMotionResourceService=o,this._videoMotionResourceService=s,this._stickerMotionResourceService=a,this._shapeAnimationResourceService=c,this._downloadService=u,this._textTemplateDataService=l,this._configurationService=d}}k=(0,i.gn)([(0,i.fM)(9,s.tx),(0,i.fM)(10,n.g),(0,i.fM)(11,m.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof ITextTemplateMeta?Object:ITextTemplateMeta,void 0===h.I?Object:h.I,void 0===p.B?Object:p.B,void 0===g.V?Object:g.V,void 0===l.n?Object:l.n,void 0===d.B?Object:d.B,void 0===_.p?Object:_.p,void 0===v.X?Object:v.X,void 0===s.tx?Object:s.tx,void 0===n.g?Object:n.g,void 0===m.Ui?Object:m.Ui])],k)},77324:function(e,t,r){r.d(t,{f:function(){return h}});var i=r(565520),n=r(764091),o=r(801003),s=r(277714),a=r(482707),c=r(899797),u=r(527898),l=r(127830),d=r(731992);let _=[{type:l._g.Video,typeParser:function(e){return Number(e.common_attr.resource_type)===i.Q.Video||!1},formatter:e=>(0,n.Mk)(e,!0)},{type:l._g.Photo,typeParser:function(e){return Number(e.common_attr.resource_type)===i.Q.Logo||!1},formatter:e=>(0,o.Ar)(e,!0)},{type:l._g.Audio,typeParser:function(e){return Number(e.common_attr.resource_type)===i.Q.Audio||!1},formatter:e=>(0,s.Fi)(e,void 0,!0)},{type:l._g.Sticker,typeParser:function(e){return Number(e.common_attr.resource_type)===i.Q.Sticker||!1},formatter:e=>(0,a.jh)(e,void 0,!0)},{type:l._g.Font,typeParser:function(e){return Number(e.common_attr.resource_type)===i.Q.Font||!1},formatter:e=>(0,c.ey)(e,void 0,!0)},{type:l._g.VideoBackground,typeParser:function(e){return Number(e.common_attr.resource_type)===i.Q.Background||!1},formatter:e=>(0,u.ll)(e,void 0,!0)}];function h(e){for(let t of _){let{typeParser:r,formatter:i}=t;if(r(e)){let r=i(e);return(0,d.l)(t.type,r)}}return null}},877033:function(e,t,r){r.d(t,{Z:function(){return n}});var i=r(966465);async function n(e,t){let r=i.Buffer.from(t,"base64"),n=await window.crypto.subtle.importKey("raw",r,{name:"AES-CBC",length:256},!1,["decrypt"]),o=e.slice(0,16),s=e.slice(16);return crypto.subtle.decrypt({name:"AES-CBC",iv:o,length:256},n,s)}},906236:function(e,t,r){r.d(t,{y:function(){return s}});var i=r(966465).Buffer;let n=(e,t)=>{let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r};async function o(e,t,r){let n=i.from(r,"hex"),o=await crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!1,["decrypt"]),s=e.slice(0,12),a=e.slice(12,t);return await crypto.subtle.decrypt({name:"AES-GCM",iv:s},o,a)}let s=async(e,t)=>{let r=e.byteLength,i=Number(new DataView(new Uint8Array(e.slice(0,256)).buffer).getBigInt64(24,!0));if(r<256||i<=0)throw Error("buf size invalid");let s=i+28,a=new Uint8Array(s),c=new Uint8Array,u=256;for(;u<r;){let i=Math.min(s,r-u);a.set(new Uint8Array(e.slice(u,u+i))),c=n(c,new Uint8Array(await o(a,i,t))),u+=i}return c.buffer}},241366:function(e,t,r){r.d(t,{Y:function(){return n}});var i=r(46037);function n(e){let{tokenKey:t,decryptKey:r}=e;return r?`${t}_${(0,i.Cv)(r)}`:t}},518911:function(e,t,r){r.d(t,{T:function(){return s}});var i=r(620090),n=r(127830),o=r(731992);function s(e){let t=(0,i.g)(e);return(0,o.l)(n._g.Gif,t)}},983171:function(e,t,r){r.d(t,{x:function(){return s}});var i=r(127830),n=r(277714),o=r(731992);function s(e){let t=(0,n.y3)(e);return(0,o.l)(i._g.Audio,t)}},731992:function(e,t,r){r.d(t,{l:function(){return n}});var i=r(315201);function n(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=Object.assign({},{type:e},t);return r&&(0,i.K)(n),{key:n.key,resource:n}}},820193:function(e,t,r){r.d(t,{GL:function(){return a},fA:function(){return s},nQ:function(){return c}});var i=r(127830),n=r(173888),o=r(731992);function s(e){return!![n.a.Transcoded,n.a.WaitForSync2UserMaterial,n.a.Syncing2UserMaterial,n.a.Synced2UserMaterial,n.a.Sync2UserMaterialFailure,n.a.Success].includes(e.status)||!1}function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{onModelUpdate:i,onResourceReady:n}=e;return(0,o.l)(t,{...e,onProgress:i,onReady:n},r||s(e))}function c(e,t,r){var n,s,c;let u;let l=(n=e,s=t,c=r,u=[i._g.UserAudio,i._g.UserFile,i._g.UserPhoto,i._g.UserVideo,i._g.UserFile].includes(s)?a(c,s):(0,o.l)(s,c),n.add(u.key,u.resource),u);return e.get(l.key,t)}},98498:function(e,t,r){r.d(t,{H:function(){return n}});var i=r(335290);let n=r(315201).R;(0,i.yh)("user-audio-resource-service")},689315:function(e,t,r){r.d(t,{H:function(){return n}});var i=r(335290);let n=r(315201).R;(0,i.yh)("user-file-resource-service")},808081:function(e,t,r){r.d(t,{r:function(){return g}});var i=r(789786),n=r(173888),o=r(627084),s=r(249656),a=r(168550),c=r(277754),u=r(475590),l=r(800788),d=r(315201),_=r(999872),h=r(479945),p=r(396190);class g extends h.k{isSupportFastImport(){return this._onFastImportDefer.promise}getOriginResourceToken(){return this._getResourceTokenSync(this._createOriginResourceToken.bind(this),()=>this._userVideoOriginResourceToken,e=>this._userVideoOriginResourceToken=e)}getPreviewResourceToken(){return this._getResourceTokenSyncWithCondition(e=>{if(!!e)return this._createPreviewResourceToken()},()=>this._userVideoPreviewResourceToken,e=>this._userVideoPreviewResourceToken=e,this._onFastImportDefer)}async _doResourceReady(e){if((0,l.Y2)((0,_.Y)(this.value)),this._isOriginUserFile(this.value.url)){let[e,t]=(await this._evercloudTokenDataService.getEvercloudToken()).pair();!e&&(this._liveRequestToken=t.token)}super._doResourceReady(e)}getCover(e){(0,l.Y2)(e.cover);let t=e.cover.key;return{url:e.cover.url,decryptKey:t,shouldAutoDecrypt:!!t,encryptType:s.PS.AES_CBC}}getUserVideoResourceToken(){return this._getResourceTokenSync(this._createEncryptedUserVideoResourceToken.bind(this),()=>this._userVideoEncryptedResourceToken,e=>this._userVideoEncryptedResourceToken=e)}getUserVideoDecryptedResourceToken(){return this._getResourceTokenSync(this._createDecryptedUserVideoResourceToken.bind(this),()=>this._userVideoResourceToken,e=>this._userVideoResourceToken=e)}getCoverResourceToken(){let e=this.value;if(!e.cover){var t,r;null===(r=e.uploading)||void 0===r||null===(t=r.generateCoverTrigger)||void 0===t||t.call(r)}return this._getResourceTokenSyncWithCondition(this._createCoverToken.bind(this),()=>this._coverResourceToken,e=>this._coverResourceToken=e,this._onCoverDefer)}async getThumbResourceTokens(){if(!this._userVideoThumbResourceTokens){var e,t,r;null===(r=this.value)||void 0===r||null===(t=r.uploading)||void 0===t||null===(e=t.generateThumbTrigger)||void 0===e||e.call(t)}return(await this._onThumbDefer.promise,this._userVideoThumbResourceTokens)?this._userVideoThumbResourceTokens:(this._userVideoThumbResourceTokens=this._createUserVideoThumbTokens(this.value),this._userVideoThumbResourceTokens)}_createDecryptedUserVideoResourceToken(e){(0,l.Y2)((0,_.Y)(this.value));let t=this._environmentService.isAutoTest||this._environmentService.forceHighQuality?["720p","540p","480p","360p"]:["480p","360p","540p","720p"];for(let r of((0,l.Y2)(e.videoTranscodeInfo,"videoTranscodeInfo should not be undefined!"),t)){let t=e.videoTranscodeInfo[r],{url:i,key:n}=null!=t?t:{};if(i){let e=this._getResolutionResourceKey(r);return(0,c.MZ)({key:e,url:i,decryptKey:n,shouldAutoDecrypt:!!n,encryptType:s.PS.AES_CBC},this._downloadService)}}(0,l.ss)("UserVideoResource::_createDecryptedUserVideoResourceToken no appropriate resolution")}_createEncryptedUserVideoResourceToken(e){(0,l.Y2)((0,_.Y)(this.value));let t=this._environmentService.isAutoTest||this._environmentService.forceHighQuality?["720p","480p","360p","540p"]:["480p","360p","540p","720p"];for(let r of((0,l.Y2)(e.videoTranscodeInfo,"videoTranscodeInfo should not be undefined!"),t)){let t=e.videoTranscodeInfo[r],{url:i,key:n}=null!=t?t:{};if(i){let e=this._getResolutionResourceKey(r);return(0,c.MZ)({key:e,url:i,decryptKey:n,shouldAutoDecrypt:!1,encryptType:s.PS.AES_CBC},this._downloadService)}}(0,l.ss)("UserVideoResource::_createEncryptedUserVideoResourceToken no appropriate resolution")}_createUserVideoThumbTokens(e){(0,l.Y2)(e.thumb);let{singleFrameWidth:t,singleFrameHeight:r}=e.thumb.common;return this._userVideoThumbResourceTokens=e.thumb.details.map(e=>{let i=this._getThumbResourceKey(e.url),n={frameCount:e.frameCount,singleFrameWidth:t,singleFrameHeight:r,imageWidth:e.imageWidth,imageHeight:e.imageHeight};return(0,c.MZ)({key:i,url:e.url,decryptKey:e.encryptedKey,shouldAutoDecrypt:!!e.encryptedKey,encryptType:s.PS.AES_CBC,...n},this._downloadService)}),this._userVideoThumbResourceTokens}_createPreviewResourceToken(){var e;let t=this.value;(0,l.Y2)(null===(e=t.uploading)||void 0===e?void 0:e.blobUrl);let r=`${this.key}_fast_import`,i=t.uploading.blobUrl;return(0,c.MZ)({key:r,url:i},this._downloadService)}_createOriginResourceToken(e){(0,l.Y2)((0,_.Y)(e));let t=`${this.key}_origin`;return(0,c.MZ)({key:t,url:e.url},this._downloadService,this.downloadConfig)}_createCoverToken(){var e;let t=this.value;return(0,l.Y2)(t.cover),(0,c.MZ)({key:this._getCoverResourceKey(),url:t.cover.url,decryptKey:null!==(e=t.cover.key)&&void 0!==e?e:"",shouldAutoDecrypt:!!t.cover.key,encryptType:s.PS.AES_CBC},this._downloadService)}_getResolutionResourceKey(e){return`${this.key}_resolution_${e}`}_getThumbResourceKey(e){return`${this.key?`${this.key}_`:""}thumb_${e}`}doFetch(){return new Promise(e=>{(0,l.Y2)(!(0,_.Y)(this.value)),this.value.onProgress(e=>{Object.assign(this.value,e),this._checkAndMarkResourceToken()}),this.value.onReady(t=>{if(Object.assign(this.value,t),!(0,_.Y)(this.value))(0,d.K)(this.value),this._checkAndMarkResourceToken(),(0,l.Y2)((0,_.Y)(this.value)),e(this.value)})})}get downloadConfig(){if(this._liveRequestToken)return{headers:{"x-everphoto-global-session-token":this._liveRequestToken,"x-everphoto-token":this._liveRequestToken}}}_isOriginUserFile(e){return(0,l.Y2)((0,_.Y)(this.value)),!!e&&!!e.match(/origin/)}_checkAndMarkResourceToken(){var e,t,r;let i=this.value;(null===(e=i.uploading)||void 0===e?void 0:e.isSupportFastImport)&&(null===(t=i.uploading)||void 0===t?void 0:t.file)&&this._onFastImportDefer.resolve(!0),(i.status===n.a.Success||(null===(r=i.uploading)||void 0===r?void 0:r.isSupportFastImport)===!1)&&this._onFastImportDefer.resolve(!1),i.thumb&&!this._userVideoThumbResourceTokens&&this._onThumbDefer.resolve(),i.cover&&this._onCoverDefer.resolve()}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._evercloudTokenDataService=i,this._environmentService=n,this._onFastImportDefer=(0,u.PQ)(),this._onThumbDefer=(0,u.PQ)(),this._onCoverDefer=(0,u.PQ)(),this._checkAndMarkResourceToken()}}g=(0,i.gn)([(0,i.fM)(2,a.tx),(0,i.fM)(3,o.o),(0,i.fM)(4,p.Y),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IUserVideoMeta?Object:IUserVideoMeta,void 0===a.tx?Object:a.tx,void 0===o.o?Object:o.o,void 0===p.Y?Object:p.Y])],g)},298073:function(e,t,r){r.d(t,{E:function(){return l}});var i=r(789786),n=r(618009),o=r(168550),s=r(800788),a=r(315201),c=r(481710),u=r(744268);class l extends c.${getCover(e){return e.icon.urlList[0]}getContentUrl(e){return e.package.urlList[0]}async doFetch(){(0,s.Y2)(!(0,a.R)(this.value));let[e,t]=(await this._videoMotionDataService.batchGetVideoMotionsByIds({enterFrom:this._configurationService.editorCategory,ids:[this.value.resourceId],source:this.value.source})).pair();if(e)throw Error(`doFetch error-${e.code}-${e.msg}`);return{type:this.value.type,...t.list[0]}}constructor(e,t,r,i,n){super(e,t,r),this.key=e,this._downloadService=r,this._videoMotionDataService=i,this._configurationService=n}}l=(0,i.gn)([(0,i.fM)(2,o.tx),(0,i.fM)(3,n.u),(0,i.fM)(4,u.Ui),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof IResourceKey?Object:IResourceKey,"undefined"==typeof IVideoMotionMeta?Object:IVideoMotionMeta,void 0===o.tx?Object:o.tx,void 0===n.u?Object:n.u,void 0===u.Ui?Object:u.Ui])],l)},492668:function(e,t,r){r.d(t,{t:function(){return o}});var i=r(261939),n=r(800788);class o extends i.B{getCover(e){return e.url}doFetch(){(0,n.ss)("vod video source should not trigger doFetch ")}}},926770:function(e,t,r){r.d(t,{P:function(){return i}});let i={id:"resource-request",version:1,tables:[r(308665).m]}},291081:function(e,t,r){r.d(t,{g:function(){return n}});var i=r(340073);let n={id:"resource-v2",version:1,tables:[i.d,i.z]}},340073:function(e,t,r){r.d(t,{d:function(){return i},z:function(){return n}});let i={name:"resource-meta",key:"key",index:[{name:"updateTime",unique:!1}]},n={name:"resource",key:"uniqueIdWithDecryptHash",index:[{name:"updateTime",unique:!1}]}},3375:function(e,t,r){r.d(t,{L:function(){return i}});let i={id:"template-post",version:1,tables:[r(686567).b]}}}]);